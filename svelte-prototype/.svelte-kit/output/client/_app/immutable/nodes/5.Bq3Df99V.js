const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["../chunks/Dc-to5eN.js","../chunks/DXfV3yLF.js","../chunks/BnpKoSs-.js","../chunks/D0QH3NT1.js","../chunks/BgszuZac.js","../assets/sessionStorage.2zs4CtXT.css"])))=>i.map(i=>d[i]);
import{_ as wn}from"../chunks/C1FmrZbK.js";import{S as po,i as vo,d as ee,s as _o,v as Ae,c as Te,a as So,H as kn,V as Cn,b as p,q as fe,r as X,u as j,f as W,w as de,I as bo,m as Z,x as me,p as $,y as ge,J as qo,K as Me,L as Ie,g,z as P,h as F,M as Ke,j as R,k as L,A as ve,l as G,N as je,o as N,t as U,e as Ce,Q as lt,n as Fn,R as xn}from"../chunks/DXfV3yLF.js";import{g as Do}from"../chunks/D0QH3NT1.js";import"../chunks/BnpKoSs-.js";import{b as it,g as vt}from"../chunks/BgszuZac.js";import{p as _t}from"../chunks/DmTKbiQ3.js";import{P as Bn,B as ut,C as Qe}from"../chunks/CrwomGmF.js";import{l as ce,a as Ue,h as St,P as Vn,b as Hn,V as wo}from"../chunks/BRZWrjh2.js";import{l as bt,s as tt,c as ko,r as Co,a as Rn,u as qt,b as Fo,d as Dt,p as Ro,o as No,e as Ao,f as wt,i as kt,g as To,h as Ct,n as Ft,j as Rt,k as Nt,t as At,E as Nn,m as nt,A as Qt,U as Xt,S as Mo,F as Io,C as Eo,I as Po,q as xo,T as Bo,P as Vo,M as zn,v as Ho,w as zo,x as Tt}from"../chunks/Dc-to5eN.js";const jo=!1,Lo=!1,nr=Object.freeze(Object.defineProperty({__proto__:null,prerender:Lo,ssr:jo},Symbol.toStringTag,{value:"Module"})),{Object:Oo,console:Go,document:An}=Do,A="src/routes/training/continuous/+page.svelte";function Tn(r,t,e){const i=r.slice();return i[98]=t[e],i[100]=e,i}function Mn(r,t,e){const i=r.slice();return i[101]=t[e],i}function Et(r){var B,D;let t,e,i,c,n,a,s,f,l,m,d=(((B=r[24])==null?void 0:B.length)||0)+"",y,b,h,v,x,Y,k,w,H=Math.round((((D=r[24])==null?void 0:D.length)||0)/8*100)+"",E,K,C,_,J,T=r[0]==="results"&&Pt(r);const q={c:function(){t=N("div"),e=N("div"),i=N("div"),c=N("span"),n=U("ã‚»ãƒƒã‚·ãƒ§ãƒ³ "),a=U(r[23]),s=U("/8"),f=$(),l=N("span"),m=U("å®Œäº†æ¸ˆã¿ "),y=U(d),b=U("ã‚»ãƒƒã‚·ãƒ§ãƒ³"),h=$(),v=N("div"),x=N("div"),Y=N("div"),k=$(),w=N("span"),E=U(H),K=U("%"),C=$(),T&&T.c(),_=je(),this.h()},l:function(I){t=R(I,"DIV",{class:!0});var Q=L(t);e=R(Q,"DIV",{class:!0});var ye=L(e);i=R(ye,"DIV",{class:!0});var ne=L(i);c=R(ne,"SPAN",{class:!0});var _e=L(c);n=G(_e,"ã‚»ãƒƒã‚·ãƒ§ãƒ³ "),a=G(_e,r[23]),s=G(_e,"/8"),_e.forEach(p),f=Z(ne),l=R(ne,"SPAN",{class:!0});var Se=L(l);m=G(Se,"å®Œäº†æ¸ˆã¿ "),y=G(Se,d),b=G(Se,"ã‚»ãƒƒã‚·ãƒ§ãƒ³"),Se.forEach(p),ne.forEach(p),h=Z(ye),v=R(ye,"DIV",{class:!0});var Ee=L(v);x=R(Ee,"DIV",{class:!0});var Le=L(x);Y=R(Le,"DIV",{class:!0,style:!0}),L(Y).forEach(p),Le.forEach(p),k=Z(Ee),w=R(Ee,"SPAN",{class:!0});var Ve=L(w);E=G(Ve,H),K=G(Ve,"%"),Ve.forEach(p),Ee.forEach(p),ye.forEach(p),Q.forEach(p),C=Z(I),T&&T.l(I),_=je(),this.h()},h:function(){var I;P(c,"class","completed-count svelte-rt5px1"),F(c,A,2542,12,85939),P(l,"class","remaining-text svelte-rt5px1"),F(l,A,2543,12,86016),P(i,"class","session-info svelte-rt5px1"),F(i,A,2541,10,85900),P(Y,"class","progress-fill svelte-rt5px1"),Ke(Y,"width",(((I=r[24])==null?void 0:I.length)||0)/8*100+"%"),F(Y,A,2547,14,86204),P(x,"class","progress-bar svelte-rt5px1"),F(x,A,2546,12,86163),P(w,"class","progress-text svelte-rt5px1"),F(w,A,2549,12,86330),P(v,"class","progress-section svelte-rt5px1"),F(v,A,2545,10,86120),P(e,"class","session-status svelte-rt5px1"),F(e,A,2540,8,85861),P(t,"class","session-progress svelte-rt5px1"),F(t,A,2539,6,85822)},m:function(I,Q){W(I,t,Q),g(t,e),g(e,i),g(i,c),g(c,n),g(c,a),g(c,s),g(i,f),g(i,l),g(l,m),g(l,y),g(l,b),g(e,h),g(e,v),g(v,x),g(x,Y),g(v,k),g(v,w),g(w,E),g(w,K),W(I,C,Q),T&&T.m(I,Q),W(I,_,Q),J=!0},p:function(I,Q){var ye,ne,_e;(!J||Q[0]&8388608)&&Ce(a,I[23]),(!J||Q[0]&16777216)&&d!==(d=(((ye=I[24])==null?void 0:ye.length)||0)+"")&&Ce(y,d),(!J||Q[0]&16777216)&&Ke(Y,"width",(((ne=I[24])==null?void 0:ne.length)||0)/8*100+"%"),(!J||Q[0]&16777216)&&H!==(H=Math.round((((_e=I[24])==null?void 0:_e.length)||0)/8*100)+"")&&Ce(E,H),I[0]==="results"?T?(T.p(I,Q),Q[0]&1&&j(T,1)):(T=Pt(I),T.c(),j(T,1),T.m(_.parentNode,_)):T&&(Me(),X(T,1,1,()=>{T=null}),Ie())},i:function(I){J||(j(T),J=!0)},o:function(I){X(T),J=!1},d:function(I){I&&(p(t),p(C),p(_)),T&&T.d(I)}};return ee("SvelteRegisterBlock",{block:q,id:Et.name,type:"if",source:"(2539:4) {#if microphoneState === 'granted' && !$isLoading}",ctx:r}),q}function Pt(r){let t,e,i;e=new Qt({props:{isCompleted:r[5],position:"top"},$$inline:!0}),e.$on("action",r[29]);const c={c:function(){t=N("div"),ge(e.$$.fragment),this.h()},l:function(a){t=R(a,"DIV",{class:!0});var s=L(t);me(e.$$.fragment,s),s.forEach(p),this.h()},h:function(){P(t,"class","top-action-buttons svelte-rt5px1"),F(t,A,2557,8,86569)},m:function(a,s){W(a,t,s),de(e,t,null),i=!0},p:function(a,s){const f={};s[0]&32&&(f.isCompleted=a[5]),e.$set(f)},i:function(a){i||(j(e.$$.fragment,a),i=!0)},o:function(a){X(e.$$.fragment,a),i=!1},d:function(a){a&&p(t),fe(e)}};return ee("SvelteRegisterBlock",{block:c,id:Pt.name,type:"if",source:"(2557:6) {#if trainingPhase === 'results'}",ctx:r}),c}function jn(r){let t,e;t=new Qe({props:{class:"error-card",$$slots:{default:[Un]},$$scope:{ctx:r}},$$inline:!0});const i={c:function(){ge(t.$$.fragment)},l:function(n){me(t.$$.fragment,n)},m:function(n,a){de(t,n,a),e=!0},p:function(n,a){const s={};a[3]&2048&&(s.$$scope={dirty:a,ctx:n}),t.$set(s)},i:function(n){e||(j(t.$$.fragment,n),e=!0)},o:function(n){X(t.$$.fragment,n),e=!1},d:function(n){fe(t,n)}};return ee("SvelteRegisterBlock",{block:i,id:jn.name,type:"else",source:"(2765:2) {:else}",ctx:r}),i}function Ln(r){let t,e,i,c,n,a,s,f={isActive:r[1]==="granted",trainingPhase:r[0],className:"pitch-detector-content",debugMode:!0,disableHarmonicCorrection:!1};e=new Hn({props:f,$$inline:!0}),r[34](e),e.$on("pitchUpdate",r[28]),e.$on("stateChange",so),e.$on("error",co),e.$on("microphoneHealthChange",r[31]);let l=r[0]!=="results"&&xt(r),m=r[0]!=="results"&&zt(r),d=r[0]==="results"&&Ot(r);const y={c:function(){t=N("div"),ge(e.$$.fragment),i=$(),l&&l.c(),c=$(),m&&m.c(),n=$(),d&&d.c(),a=je(),this.h()},l:function(h){t=R(h,"DIV",{style:!0});var v=L(t);me(e.$$.fragment,v),v.forEach(p),i=Z(h),l&&l.l(h),c=Z(h),m&&m.l(h),n=Z(h),d&&d.l(h),a=je(),this.h()},h:function(){Ke(t,"display","none"),F(t,A,2576,4,87049)},m:function(h,v){W(h,t,v),de(e,t,null),W(h,i,v),l&&l.m(h,v),W(h,c,v),m&&m.m(h,v),W(h,n,v),d&&d.m(h,v),W(h,a,v),s=!0},p:function(h,v){const x={};v[0]&2&&(x.isActive=h[1]==="granted"),v[0]&1&&(x.trainingPhase=h[0]),e.$set(x),h[0]!=="results"?l?(l.p(h,v),v[0]&1&&j(l,1)):(l=xt(h),l.c(),j(l,1),l.m(c.parentNode,c)):l&&(Me(),X(l,1,1,()=>{l=null}),Ie()),h[0]!=="results"?m?(m.p(h,v),v[0]&1&&j(m,1)):(m=zt(h),m.c(),j(m,1),m.m(n.parentNode,n)):m&&(Me(),X(m,1,1,()=>{m=null}),Ie()),h[0]==="results"?d?(d.p(h,v),v[0]&1&&j(d,1)):(d=Ot(h),d.c(),j(d,1),d.m(a.parentNode,a)):d&&(Me(),X(d,1,1,()=>{d=null}),Ie())},i:function(h){s||(j(e.$$.fragment,h),j(l),j(m),j(d),s=!0)},o:function(h){X(e.$$.fragment,h),X(l),X(m),X(d),s=!1},d:function(h){h&&(p(t),p(i),p(c),p(n),p(a)),r[34](null),fe(e),l&&l.d(h),m&&m.d(h),d&&d.d(h)}};return ee("SvelteRegisterBlock",{block:y,id:Ln.name,type:"if",source:"(2575:2) {#if microphoneState === 'granted'}",ctx:r}),y}function On(r){let t;const e={c:function(){t=U("ğŸ¤ ãƒã‚¤ã‚¯ãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸ã¸ç§»å‹•")},l:function(c){t=G(c,"ğŸ¤ ãƒã‚¤ã‚¯ãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸ã¸ç§»å‹•")},m:function(c,n){W(c,t,n)},d:function(c){c&&p(t)}};return ee("SvelteRegisterBlock",{block:e,id:On.name,type:"slot",source:'(2779:10) <Button variant=\\"primary\\" on:click={goToMicrophoneTest}>',ctx:r}),e}function Gn(r){let t;const e={c:function(){t=U("ğŸ  ãƒ›ãƒ¼ãƒ ã«æˆ»ã‚‹")},l:function(c){t=G(c,"ğŸ  ãƒ›ãƒ¼ãƒ ã«æˆ»ã‚‹")},m:function(c,n){W(c,t,n)},d:function(c){c&&p(t)}};return ee("SvelteRegisterBlock",{block:e,id:Gn.name,type:"slot",source:'(2782:10) <Button variant=\\"secondary\\" on:click={goHome}>',ctx:r}),e}function Un(r){let t,e,i="ğŸ¤",c,n,a="ãƒã‚¤ã‚¯ãƒ†ã‚¹ãƒˆãŒå¿…è¦ã§ã™",s,f,l="é€£ç¶šãƒãƒ£ãƒ¬ãƒ³ã‚¸ãƒ¢ãƒ¼ãƒ‰ã‚’é–‹å§‹ã™ã‚‹å‰ã«ã€ãƒã‚¤ã‚¯ãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸ã§éŸ³å£°å…¥åŠ›ã®ç¢ºèªã‚’ãŠé¡˜ã„ã—ã¾ã™ã€‚",m,d,y,b,h,v="ãƒã‚¤ã‚¯ãƒ†ã‚¹ãƒˆå®Œäº†å¾Œ",x,Y,k,w="ã¾ãšã¯ãƒã‚¤ã‚¯ãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸ã§éŸ³å£°ç¢ºèªã‚’è¡Œã£ã¦ãã ã•ã„ã€‚",H,E,K,C,_,J;K=new ut({props:{variant:"primary",$$slots:{default:[On]},$$scope:{ctx:r}},$$inline:!0}),K.$on("click",r[26]),_=new ut({props:{variant:"secondary",$$slots:{default:[Gn]},$$scope:{ctx:r}},$$inline:!0}),_.$on("click",r[27]);const T={c:function(){t=N("div"),e=N("div"),e.textContent=i,c=$(),n=N("h3"),n.textContent=a,s=$(),f=N("p"),f.textContent=l,m=$(),d=N("div"),y=N("p"),b=U("ã“ã®ãƒšãƒ¼ã‚¸ã¯"),h=N("strong"),h.textContent=v,x=U("ã«ã”åˆ©ç”¨ã„ãŸã ã‘ã¾ã™ã€‚"),Y=$(),k=N("p"),k.textContent=w,H=$(),E=N("div"),ge(K.$$.fragment),C=$(),ge(_.$$.fragment),this.h()},l:function(B){t=R(B,"DIV",{class:!0});var D=L(t);e=R(D,"DIV",{class:!0,"data-svelte-h":!0}),ve(e)!=="svelte-15rbx8n"&&(e.textContent=i),c=Z(D),n=R(D,"H3",{class:!0,"data-svelte-h":!0}),ve(n)!=="svelte-17kvze2"&&(n.textContent=a),s=Z(D),f=R(D,"P",{class:!0,"data-svelte-h":!0}),ve(f)!=="svelte-1t09god"&&(f.textContent=l),m=Z(D),d=R(D,"DIV",{class:!0});var V=L(d);y=R(V,"P",{class:!0});var I=L(y);b=G(I,"ã“ã®ãƒšãƒ¼ã‚¸ã¯"),h=R(I,"STRONG",{"data-svelte-h":!0}),ve(h)!=="svelte-1n3qsr6"&&(h.textContent=v),x=G(I,"ã«ã”åˆ©ç”¨ã„ãŸã ã‘ã¾ã™ã€‚"),I.forEach(p),Y=Z(V),k=R(V,"P",{class:!0,"data-svelte-h":!0}),ve(k)!=="svelte-v8nd09"&&(k.textContent=w),V.forEach(p),H=Z(D),E=R(D,"DIV",{class:!0});var Q=L(E);me(K.$$.fragment,Q),C=Z(Q),me(_.$$.fragment,Q),Q.forEach(p),D.forEach(p),this.h()},h:function(){P(e,"class","error-icon svelte-rt5px1"),F(e,A,2768,8,93449),P(n,"class","svelte-rt5px1"),F(n,A,2769,8,93490),P(f,"class","svelte-rt5px1"),F(f,A,2770,8,93519),F(h,A,2773,19,93635),P(y,"class","svelte-rt5px1"),F(y,A,2773,10,93626),P(k,"class","svelte-rt5px1"),F(k,A,2774,10,93687),P(d,"class","recommendation svelte-rt5px1"),F(d,A,2772,8,93587),P(E,"class","action-buttons"),F(E,A,2777,8,93753),P(t,"class","error-content svelte-rt5px1"),F(t,A,2767,6,93413)},m:function(B,D){W(B,t,D),g(t,e),g(t,c),g(t,n),g(t,s),g(t,f),g(t,m),g(t,d),g(d,y),g(y,b),g(y,h),g(y,x),g(d,Y),g(d,k),g(t,H),g(t,E),de(K,E,null),g(E,C),de(_,E,null),J=!0},p:function(B,D){const V={};D[3]&2048&&(V.$$scope={dirty:D,ctx:B}),K.$set(V);const I={};D[3]&2048&&(I.$$scope={dirty:D,ctx:B}),_.$set(I)},i:function(B){J||(j(K.$$.fragment,B),j(_.$$.fragment,B),J=!0)},o:function(B){X(K.$$.fragment,B),X(_.$$.fragment,B),J=!1},d:function(B){B&&p(t),fe(K),fe(_)}};return ee("SvelteRegisterBlock",{block:T,id:Un.name,type:"slot",source:'(2767:4) <Card class=\\"error-card\\">',ctx:r}),T}function xt(r){let t,e,i,c,n,a,s=!r[2]&&r[6].length>0&&Bt(r);i=new Qe({props:{class:"main-card half-width",$$slots:{default:[eo]},$$scope:{ctx:r}},$$inline:!0}),n=new Vn({props:{frequency:r[14],note:r[15],volume:r[13],isMuted:r[0]!=="guiding",muteMessage:"åŸºéŸ³å†ç”Ÿå¾Œã«é–‹å§‹",className:"half-width",showGuidance:!1},$$inline:!0});const f={c:function(){s&&s.c(),t=$(),e=N("div"),ge(i.$$.fragment),c=$(),ge(n.$$.fragment),this.h()},l:function(m){s&&s.l(m),t=Z(m),e=R(m,"DIV",{class:!0});var d=L(e);me(i.$$.fragment,d),c=Z(d),me(n.$$.fragment,d),d.forEach(p),this.h()},h:function(){P(e,"class","side-by-side-container svelte-rt5px1"),F(e,A,2615,6,88386)},m:function(m,d){s&&s.m(m,d),W(m,t,d),W(m,e,d),de(i,e,null),g(e,c),de(n,e,null),a=!0},p:function(m,d){!m[2]&&m[6].length>0?s?(s.p(m,d),d[0]&68&&j(s,1)):(s=Bt(m),s.c(),j(s,1),s.m(t.parentNode,t)):s&&(Me(),X(s,1,1,()=>{s=null}),Ie());const y={};d[0]&8395649|d[3]&2048&&(y.$$scope={dirty:d,ctx:m}),i.$set(y);const b={};d[0]&16384&&(b.frequency=m[14]),d[0]&32768&&(b.note=m[15]),d[0]&8192&&(b.volume=m[13]),d[0]&1&&(b.isMuted=m[0]!=="guiding"),n.$set(b)},i:function(m){a||(j(s),j(i.$$.fragment,m),j(n.$$.fragment,m),a=!0)},o:function(m){X(s),X(i.$$.fragment,m),X(n.$$.fragment,m),a=!1},d:function(m){m&&(p(t),p(e)),s&&s.d(m),fe(i),fe(n)}};return ee("SvelteRegisterBlock",{block:f,id:xt.name,type:"if",source:"(2594:4) {#if trainingPhase !== 'results'}",ctx:r}),f}function Bt(r){let t,e;t=new Qe({props:{class:"warning-card",$$slots:{default:[Wn]},$$scope:{ctx:r}},$$inline:!0});const i={c:function(){ge(t.$$.fragment)},l:function(n){me(t.$$.fragment,n)},m:function(n,a){de(t,n,a),e=!0},p:function(n,a){const s={};a[0]&64|a[3]&2048&&(s.$$scope={dirty:a,ctx:n}),t.$set(s)},i:function(n){e||(j(t.$$.fragment,n),e=!0)},o:function(n){X(t.$$.fragment,n),e=!1},d:function(n){fe(t,n)}};return ee("SvelteRegisterBlock",{block:i,id:Bt.name,type:"if",source:"(2597:6) {#if !microphoneHealthy && microphoneErrors.length > 0}",ctx:r}),i}function Vt(r){let t,e=r[101]+"",i;const c={c:function(){t=N("li"),i=U(e),this.h()},l:function(a){t=R(a,"LI",{class:!0});var s=L(t);i=G(s,e),s.forEach(p),this.h()},h:function(){P(t,"class","svelte-rt5px1"),F(t,A,2605,16,88154)},m:function(a,s){W(a,t,s),g(t,i)},p:function(a,s){s[0]&64&&e!==(e=a[101]+"")&&Ce(i,e)},d:function(a){a&&p(t)}};return ee("SvelteRegisterBlock",{block:c,id:Vt.name,type:"each",source:"(2605:14) {#each microphoneErrors as error}",ctx:r}),c}function Wn(r){let t,e,i="âš ï¸ ãƒã‚¤ã‚¯æ¥ç¶šã«å•é¡ŒãŒã‚ã‚Šã¾ã™",c,n,a,s="ãƒã‚¤ã‚¯ãŒæ­£å¸¸ã«å‹•ä½œã—ã¦ã„ã¾ã›ã‚“ã€‚ä»¥ä¸‹ã®å•é¡ŒãŒæ¤œå‡ºã•ã‚Œã¾ã—ãŸï¼š",f,l,m,d,y,b="è§£æ±ºæ–¹æ³•:",h,v=lt(r[6]),x=[];for(let k=0;k<v.length;k+=1)x[k]=Vt(Mn(r,v,k));const Y={c:function(){t=N("div"),e=N("h3"),e.textContent=i,c=$(),n=N("div"),a=N("p"),a.textContent=s,f=$(),l=N("ul");for(let w=0;w<x.length;w+=1)x[w].c();m=$(),d=N("p"),y=N("strong"),y.textContent=b,h=U(" ãƒšãƒ¼ã‚¸ã‚’å†èª­ã¿è¾¼ã¿ã—ã¦ãƒã‚¤ã‚¯è¨±å¯ã‚’å†åº¦å–å¾—ã—ã¦ãã ã•ã„ã€‚"),this.h()},l:function(w){t=R(w,"DIV",{class:!0});var H=L(t);e=R(H,"H3",{class:!0,"data-svelte-h":!0}),ve(e)!=="svelte-15qec5x"&&(e.textContent=i),H.forEach(p),c=Z(w),n=R(w,"DIV",{class:!0});var E=L(n);a=R(E,"P",{class:!0,"data-svelte-h":!0}),ve(a)!=="svelte-171o2p0"&&(a.textContent=s),f=Z(E),l=R(E,"UL",{class:!0});var K=L(l);for(let _=0;_<x.length;_+=1)x[_].l(K);K.forEach(p),m=Z(E),d=R(E,"P",{class:!0});var C=L(d);y=R(C,"STRONG",{"data-svelte-h":!0}),ve(y)!=="svelte-79o66n"&&(y.textContent=b),h=G(C," ãƒšãƒ¼ã‚¸ã‚’å†èª­ã¿è¾¼ã¿ã—ã¦ãƒã‚¤ã‚¯è¨±å¯ã‚’å†åº¦å–å¾—ã—ã¦ãã ã•ã„ã€‚"),C.forEach(p),E.forEach(p),this.h()},h:function(){P(e,"class","section-title svelte-rt5px1"),F(e,A,2599,12,87878),P(t,"class","card-header svelte-rt5px1"),F(t,A,2598,10,87840),P(a,"class","warning-message svelte-rt5px1"),F(a,A,2602,12,87992),P(l,"class","error-list svelte-rt5px1"),F(l,A,2603,12,88066),F(y,A,2609,14,88265),P(d,"class","fix-instruction svelte-rt5px1"),F(d,A,2608,12,88223),P(n,"class","card-content svelte-rt5px1"),F(n,A,2601,10,87953)},m:function(w,H){W(w,t,H),g(t,e),W(w,c,H),W(w,n,H),g(n,a),g(n,f),g(n,l);for(let E=0;E<x.length;E+=1)x[E]&&x[E].m(l,null);g(n,m),g(n,d),g(d,y),g(d,h)},p:function(w,H){if(H[0]&64){v=lt(w[6]);let E;for(E=0;E<v.length;E+=1){const K=Mn(w,v,E);x[E]?x[E].p(K,H):(x[E]=Vt(K),x[E].c(),x[E].m(l,null))}for(;E<x.length;E+=1)x[E].d(1);x.length=v.length}},d:function(w){w&&(p(t),p(c),p(n)),xn(x,w)}};return ee("SvelteRegisterBlock",{block:Y,id:Wn.name,type:"slot",source:'(2598:8) <Card class=\\"warning-card\\">',ctx:r}),Y}function Jn(r){let t;function e(a,s){return a[9]?Zn:a[0]==="guiding"?Yn:a[0]==="results"?Xn:Qn}let i=e(r),c=i(r);const n={c:function(){t=N("div"),c.c(),this.h()},l:function(s){t=R(s,"DIV",{class:!0});var f=L(t);c.l(f),f.forEach(p),this.h()},h:function(){P(t,"class","continuous-status svelte-rt5px1"),F(t,A,2632,14,89035)},m:function(s,f){W(s,t,f),c.m(t,null)},p:function(s,f){i===(i=e(s))&&c?c.p(s,f):(c.d(1),c=i(s),c&&(c.c(),c.m(t,null)))},i:Fn,o:Fn,d:function(s){s&&p(t),c.d()}};return ee("SvelteRegisterBlock",{block:n,id:Jn.name,type:"else",source:"(2631:12) {:else}",ctx:r}),n}function Kn(r){let t,e;t=new ut({props:{variant:"primary",$$slots:{default:[$n]},$$scope:{ctx:r}},$$inline:!0}),t.$on("click",r[30]);const i={c:function(){ge(t.$$.fragment)},l:function(n){me(t.$$.fragment,n)},m:function(n,a){de(t,n,a),e=!0},p:function(n,a){const s={};a[3]&2048&&(s.$$scope={dirty:a,ctx:n}),t.$set(s)},i:function(n){e||(j(t.$$.fragment,n),e=!0)},o:function(n){X(t.$$.fragment,n),e=!1},d:function(n){fe(t,n)}};return ee("SvelteRegisterBlock",{block:i,id:Kn.name,type:"if",source:"(2624:12) {#if trainingPhase === 'setup' && !isPlaying && !($currentSessionId > 1)}",ctx:r}),i}function Qn(r){let t,e,i,c;const n={c:function(){t=N("div"),e=U("âš¡ é€£ç¶šãƒ¢ãƒ¼ãƒ‰é€²è¡Œä¸­ ("),i=U(r[23]),c=U("/8)"),this.h()},l:function(s){t=R(s,"DIV",{class:!0});var f=L(t);e=G(f,"âš¡ é€£ç¶šãƒ¢ãƒ¼ãƒ‰é€²è¡Œä¸­ ("),i=G(f,r[23]),c=G(f,"/8)"),f.forEach(p),this.h()},h:function(){P(t,"class","status-text svelte-rt5px1"),F(t,A,2646,18,89625)},m:function(s,f){W(s,t,f),g(t,e),g(t,i),g(t,c)},p:function(s,f){f[0]&8388608&&Ce(i,s[23])},d:function(s){s&&p(t)}};return ee("SvelteRegisterBlock",{block:n,id:Qn.name,type:"else",source:"(2646:16) {:else}",ctx:r}),n}function Xn(r){let t,e,i,c;const n={c:function(){t=N("div"),e=U("âœ… ã‚»ãƒƒã‚·ãƒ§ãƒ³ "),i=U(r[23]),c=U("/8 å®Œäº†"),this.h()},l:function(s){t=R(s,"DIV",{class:!0});var f=L(t);e=G(f,"âœ… ã‚»ãƒƒã‚·ãƒ§ãƒ³ "),i=G(f,r[23]),c=G(f,"/8 å®Œäº†"),f.forEach(p),this.h()},h:function(){P(t,"class","status-text svelte-rt5px1"),F(t,A,2642,18,89479)},m:function(s,f){W(s,t,f),g(t,e),g(t,i),g(t,c)},p:function(s,f){f[0]&8388608&&Ce(i,s[23])},d:function(s){s&&p(t)}};return ee("SvelteRegisterBlock",{block:n,id:Xn.name,type:"if",source:"(2642:54) ",ctx:r}),n}function Yn(r){let t,e,i,c;const n={c:function(){t=N("div"),e=U("ğŸ¤ ã‚»ãƒƒã‚·ãƒ§ãƒ³ "),i=U(r[23]),c=U("/8: ãƒ‰ãƒ¬ãƒŸç™ºå£°ä¸­"),this.h()},l:function(s){t=R(s,"DIV",{class:!0});var f=L(t);e=G(f,"ğŸ¤ ã‚»ãƒƒã‚·ãƒ§ãƒ³ "),i=G(f,r[23]),c=G(f,"/8: ãƒ‰ãƒ¬ãƒŸç™ºå£°ä¸­"),f.forEach(p),this.h()},h:function(){P(t,"class","status-text svelte-rt5px1"),F(t,A,2638,18,89296)},m:function(s,f){W(s,t,f),g(t,e),g(t,i),g(t,c)},p:function(s,f){f[0]&8388608&&Ce(i,s[23])},d:function(s){s&&p(t)}};return ee("SvelteRegisterBlock",{block:n,id:Yn.name,type:"if",source:"(2638:54) ",ctx:r}),n}function Zn(r){let t,e,i,c;const n={c:function(){t=N("div"),e=U("ğŸµ åŸºéŸ³ "),i=U(r[23]),c=U("/8 å†ç”Ÿä¸­..."),this.h()},l:function(s){t=R(s,"DIV",{class:!0});var f=L(t);e=G(f,"ğŸµ åŸºéŸ³ "),i=G(f,r[23]),c=G(f,"/8 å†ç”Ÿä¸­..."),f.forEach(p),this.h()},h:function(){P(t,"class","status-text svelte-rt5px1"),F(t,A,2634,18,89117)},m:function(s,f){W(s,t,f),g(t,e),g(t,i),g(t,c)},p:function(s,f){f[0]&8388608&&Ce(i,s[23])},d:function(s){s&&p(t)}};return ee("SvelteRegisterBlock",{block:n,id:Zn.name,type:"if",source:"(2634:16) {#if isPlaying}",ctx:r}),n}function $n(r){let t;const e={c:function(){t=U("âš¡ é€£ç¶šãƒãƒ£ãƒ¬ãƒ³ã‚¸é–‹å§‹ï¼ˆ8ã‚»ãƒƒã‚·ãƒ§ãƒ³ï¼‰")},l:function(c){t=G(c,"âš¡ é€£ç¶šãƒãƒ£ãƒ¬ãƒ³ã‚¸é–‹å§‹ï¼ˆ8ã‚»ãƒƒã‚·ãƒ§ãƒ³ï¼‰")},m:function(c,n){W(c,t,n)},d:function(c){c&&p(t)}};return ee("SvelteRegisterBlock",{block:e,id:$n.name,type:"slot",source:'(2625:14) <Button                  variant=\\"primary\\"                 on:click={startContinuousMode}               >',ctx:r}),e}function Ht(r){let t,e,i,c,n,a=r[8].toFixed(1)+"",s,f;const l={c:function(){t=N("div"),e=U("ç¾åœ¨ã®åŸºéŸ³: "),i=N("strong"),c=U(r[7]),n=U(" ("),s=U(a),f=U("Hz)"),this.h()},l:function(d){t=R(d,"DIV",{class:!0});var y=L(t);e=G(y,"ç¾åœ¨ã®åŸºéŸ³: "),i=R(y,"STRONG",{});var b=L(i);c=G(b,r[7]),b.forEach(p),n=G(y," ("),s=G(y,a),f=G(y,"Hz)"),y.forEach(p),this.h()},h:function(){F(i,A,2655,23,89905),P(t,"class","base-note-info svelte-rt5px1"),F(t,A,2654,14,89853)},m:function(d,y){W(d,t,y),g(t,e),g(t,i),g(i,c),g(t,n),g(t,s),g(t,f)},p:function(d,y){y[0]&128&&Ce(c,d[7]),y[0]&256&&a!==(a=d[8].toFixed(1)+"")&&Ce(s,a)},d:function(d){d&&p(t)}};return ee("SvelteRegisterBlock",{block:l,id:Ht.name,type:"if",source:"(2654:12) {#if currentBaseNote}",ctx:r}),l}function eo(r){let t,e,i="ğŸ¹ åŸºéŸ³å†ç”Ÿ",c,n,a,s,f,l,m,d,y="ã‚¬ã‚¤ãƒ‰é–‹å§‹ã¾ã§",b,h,v,x,Y,k,w,H;const E=[Kn,Jn],K=[];function C(T,q){return T[0]==="setup"&&!T[9]&&!(T[23]>1)?0:1}a=C(r),s=K[a]=E[a](r);let _=r[7]&&Ht(r);k=new zn({props:{size:"20"},$$inline:!0});const J={c:function(){t=N("div"),e=N("h3"),e.textContent=i,c=$(),n=N("div"),s.c(),f=$(),_&&_.c(),l=$(),m=N("div"),d=N("div"),d.textContent=y,b=$(),h=N("div"),v=N("div"),x=$(),Y=N("div"),ge(k.$$.fragment),this.h()},l:function(q){t=R(q,"DIV",{class:!0});var B=L(t);e=R(B,"H3",{class:!0,"data-svelte-h":!0}),ve(e)!=="svelte-syc53b"&&(e.textContent=i),B.forEach(p),c=Z(q),n=R(q,"DIV",{class:!0});var D=L(n);s.l(D),f=Z(D),_&&_.l(D),l=Z(D),m=R(D,"DIV",{class:!0});var V=L(m);d=R(V,"DIV",{class:!0,"data-svelte-h":!0}),ve(d)!=="svelte-1dufnpv"&&(d.textContent=y),b=Z(V),h=R(V,"DIV",{class:!0});var I=L(h);v=R(I,"DIV",{class:!0,style:!0}),L(v).forEach(p),x=Z(I),Y=R(I,"DIV",{class:!0});var Q=L(Y);me(k.$$.fragment,Q),Q.forEach(p),I.forEach(p),V.forEach(p),D.forEach(p),this.h()},h:function(){P(e,"class","section-title svelte-rt5px1"),F(e,A,2619,12,88550),P(t,"class","card-header svelte-rt5px1"),F(t,A,2618,10,88512),P(d,"class","guide-start-label svelte-rt5px1"),F(d,A,2661,14,90130),P(v,"class","guide-progress-fill svelte-rt5px1"),Ke(v,"width",r[11]+"%"),F(v,A,2663,16,90235),P(Y,"class",w="guide-music-icon "+(r[12]?"glowing":"")+" svelte-rt5px1"),F(Y,A,2667,16,90383),P(h,"class","guide-start-bar svelte-rt5px1"),F(h,A,2662,14,90189),P(m,"class","guide-start-bar-container svelte-rt5px1"),F(m,A,2660,12,90076),P(n,"class","card-content svelte-rt5px1"),F(n,A,2621,10,88616)},m:function(q,B){W(q,t,B),g(t,e),W(q,c,B),W(q,n,B),K[a].m(n,null),g(n,f),_&&_.m(n,null),g(n,l),g(n,m),g(m,d),g(m,b),g(m,h),g(h,v),g(h,x),g(h,Y),de(k,Y,null),H=!0},p:function(q,B){let D=a;a=C(q),a===D?K[a].p(q,B):(Me(),X(K[D],1,1,()=>{K[D]=null}),Ie(),s=K[a],s?s.p(q,B):(s=K[a]=E[a](q),s.c()),j(s,1),s.m(n,f)),q[7]?_?_.p(q,B):(_=Ht(q),_.c(),_.m(n,l)):_&&(_.d(1),_=null),(!H||B[0]&2048)&&Ke(v,"width",q[11]+"%"),(!H||B[0]&4096&&w!==(w="guide-music-icon "+(q[12]?"glowing":"")+" svelte-rt5px1"))&&P(Y,"class",w)},i:function(q){H||(j(s),j(k.$$.fragment,q),H=!0)},o:function(q){X(s),X(k.$$.fragment,q),H=!1},d:function(q){q&&(p(t),p(c),p(n)),K[a].d(),_&&_.d(),fe(k)}};return ee("SvelteRegisterBlock",{block:J,id:eo.name,type:"slot",source:'(2618:8) <Card class=\\"main-card half-width\\">',ctx:r}),J}function zt(r){let t,e;t=new Qe({props:{class:"main-card",$$slots:{default:[to]},$$scope:{ctx:r}},$$inline:!0});const i={c:function(){ge(t.$$.fragment)},l:function(n){me(t.$$.fragment,n)},m:function(n,a){de(t,n,a),e=!0},p:function(n,a){const s={};a[0]&1025|a[3]&2048&&(s.$$scope={dirty:a,ctx:n}),t.$set(s)},i:function(n){e||(j(t.$$.fragment,n),e=!0)},o:function(n){X(t.$$.fragment,n),e=!1},d:function(n){fe(t,n)}};return ee("SvelteRegisterBlock",{block:i,id:zt.name,type:"if",source:"(2689:4) {#if trainingPhase !== 'results'}",ctx:r}),i}function jt(r){let t,e=r[98].name+"",i,c,n;const a={c:function(){t=N("div"),i=U(e),c=$(),this.h()},l:function(f){t=R(f,"DIV",{class:!0});var l=L(t);i=G(l,e),c=Z(l),l.forEach(p),this.h()},h:function(){P(t,"class",n="scale-item "+r[98].state+" svelte-rt5px1"),F(t,A,2697,14,91285)},m:function(f,l){W(f,t,l),g(t,i),g(t,c)},p:function(f,l){l[0]&1024&&e!==(e=f[98].name+"")&&Ce(i,e),l[0]&1024&&n!==(n="scale-item "+f[98].state+" svelte-rt5px1")&&P(t,"class",n)},d:function(f){f&&p(t)}};return ee("SvelteRegisterBlock",{block:a,id:jt.name,type:"each",source:"(2697:12) {#each scaleSteps as step, index}",ctx:r}),a}function Lt(r){let t,e,i,c="ãƒ‰ãƒ¬ãƒŸãƒ•ã‚¡ã‚½ãƒ©ã‚·ãƒ‰",n;const a={c:function(){t=N("div"),e=U("ã‚¬ã‚¤ãƒ‰ã«åˆã‚ã›ã¦ "),i=N("strong"),i.textContent=c,n=U(" ã‚’æ­Œã£ã¦ãã ã•ã„"),this.h()},l:function(f){t=R(f,"DIV",{class:!0});var l=L(t);e=G(l,"ã‚¬ã‚¤ãƒ‰ã«åˆã‚ã›ã¦ "),i=R(l,"STRONG",{"data-svelte-h":!0}),ve(i)!=="svelte-1dipf74"&&(i.textContent=c),n=G(l," ã‚’æ­Œã£ã¦ãã ã•ã„"),l.forEach(p),this.h()},h:function(){F(i,A,2706,23,91552),P(t,"class","guide-instruction svelte-rt5px1"),F(t,A,2705,12,91497)},m:function(f,l){W(f,t,l),g(t,e),g(t,i),g(t,n)},d:function(f){f&&p(t)}};return ee("SvelteRegisterBlock",{block:a,id:Lt.name,type:"if",source:"(2705:10) {#if trainingPhase === 'guiding'}",ctx:r}),a}function to(r){let t,e,i="ğŸµ ãƒ‰ãƒ¬ãƒŸéŸ³éšã‚¬ã‚¤ãƒ‰",c,n,a,s,f=lt(r[10]),l=[];for(let y=0;y<f.length;y+=1)l[y]=jt(Tn(r,f,y));let m=r[0]==="guiding"&&Lt(r);const d={c:function(){t=N("div"),e=N("h3"),e.textContent=i,c=$(),n=N("div"),a=N("div");for(let b=0;b<l.length;b+=1)l[b].c();s=$(),m&&m.c(),this.h()},l:function(b){t=R(b,"DIV",{class:!0});var h=L(t);e=R(h,"H3",{class:!0,"data-svelte-h":!0}),ve(e)!=="svelte-1mor0as"&&(e.textContent=i),h.forEach(p),c=Z(b),n=R(b,"DIV",{class:!0});var v=L(n);a=R(v,"DIV",{class:!0});var x=L(a);for(let Y=0;Y<l.length;Y+=1)l[Y].l(x);x.forEach(p),s=Z(v),m&&m.l(v),v.forEach(p),this.h()},h:function(){P(e,"class","section-title svelte-rt5px1"),F(e,A,2692,10,91096),P(t,"class","card-header svelte-rt5px1"),F(t,A,2691,8,91060),P(a,"class","scale-guide svelte-rt5px1"),F(a,A,2695,10,91199),P(n,"class","card-content svelte-rt5px1"),F(n,A,2694,8,91162)},m:function(b,h){W(b,t,h),g(t,e),W(b,c,h),W(b,n,h),g(n,a);for(let v=0;v<l.length;v+=1)l[v]&&l[v].m(a,null);g(n,s),m&&m.m(n,null)},p:function(b,h){if(h[0]&1024){f=lt(b[10]);let v;for(v=0;v<f.length;v+=1){const x=Tn(b,f,v);l[v]?l[v].p(x,h):(l[v]=jt(x),l[v].c(),l[v].m(a,null))}for(;v<l.length;v+=1)l[v].d(1);l.length=f.length}b[0]==="guiding"?m||(m=Lt(b),m.c(),m.m(n,null)):m&&(m.d(1),m=null)},d:function(b){b&&(p(t),p(c),p(n)),xn(l,b),m&&m.d()}};return ee("SvelteRegisterBlock",{block:d,id:to.name,type:"slot",source:'(2691:6) <Card class=\\"main-card\\">',ctx:r}),d}function Ot(r){let t,e,i,c,n;const a=[oo,no],s=[];function f(d,y){return d[4]&&d[5]?0:d[21]?1:-1}~(t=f(r))&&(e=s[t]=a[t](r));let l=r[0]==="results"&&Gt(r);const m={c:function(){e&&e.c(),i=$(),l&&l.c(),c=je()},l:function(y){e&&e.l(y),i=Z(y),l&&l.l(y),c=je()},m:function(y,b){~t&&s[t].m(y,b),W(y,i,b),l&&l.m(y,b),W(y,c,b),n=!0},p:function(y,b){let h=t;t=f(y),t===h?~t&&s[t].p(y,b):(e&&(Me(),X(s[h],1,1,()=>{s[h]=null}),Ie()),~t?(e=s[t],e?e.p(y,b):(e=s[t]=a[t](y),e.c()),j(e,1),e.m(i.parentNode,i)):e=null),y[0]==="results"?l?(l.p(y,b),b[0]&1&&j(l,1)):(l=Gt(y),l.c(),j(l,1),l.m(c.parentNode,c)):l&&(Me(),X(l,1,1,()=>{l=null}),Ie())},i:function(y){n||(j(e),j(l),n=!0)},o:function(y){X(e),X(l),n=!1},d:function(y){y&&(p(i),p(c)),~t&&s[t].d(y),l&&l.d(y)}};return ee("SvelteRegisterBlock",{block:m,id:Ot.name,type:"if",source:"(2716:4) {#if trainingPhase === 'results'}",ctx:r}),m}function no(r){let t,e;t=new Xt({props:{scoreData:r[21],showDetails:!1,className:"mb-6 iphone-no-margin",currentScoreData:r[16],intervalData:r[3],consistencyData:r[17],feedbackData:r[18],technicalFeedbackData:r[19],sessionStatistics:r[20]},$$inline:!0});const i={c:function(){ge(t.$$.fragment)},l:function(n){me(t.$$.fragment,n)},m:function(n,a){de(t,n,a),e=!0},p:function(n,a){const s={};a[0]&2097152&&(s.scoreData=n[21]),a[0]&65536&&(s.currentScoreData=n[16]),a[0]&8&&(s.intervalData=n[3]),a[0]&131072&&(s.consistencyData=n[17]),a[0]&262144&&(s.feedbackData=n[18]),a[0]&524288&&(s.technicalFeedbackData=n[19]),a[0]&1048576&&(s.sessionStatistics=n[20]),t.$set(s)},i:function(n){e||(j(t.$$.fragment,n),e=!0)},o:function(n){X(t.$$.fragment,n),e=!1},d:function(n){fe(t,n)}};return ee("SvelteRegisterBlock",{block:i,id:no.name,type:"if",source:"(2731:40) ",ctx:r}),i}function oo(r){let t,e;t=new Xt({props:{scoreData:r[4],showDetails:!1,className:"mb-6 iphone-no-margin",currentScoreData:r[16],intervalData:r[3],consistencyData:r[17],feedbackData:r[18],technicalFeedbackData:r[19],sessionStatistics:r[20]},$$inline:!0});const i={c:function(){ge(t.$$.fragment)},l:function(n){me(t.$$.fragment,n)},m:function(n,a){de(t,n,a),e=!0},p:function(n,a){const s={};a[0]&16&&(s.scoreData=n[4]),a[0]&65536&&(s.currentScoreData=n[16]),a[0]&8&&(s.intervalData=n[3]),a[0]&131072&&(s.consistencyData=n[17]),a[0]&262144&&(s.feedbackData=n[18]),a[0]&524288&&(s.technicalFeedbackData=n[19]),a[0]&1048576&&(s.sessionStatistics=n[20]),t.$set(s)},i:function(n){e||(j(t.$$.fragment,n),e=!0)},o:function(n){X(t.$$.fragment,n),e=!1},d:function(n){fe(t,n)}};return ee("SvelteRegisterBlock",{block:i,id:oo.name,type:"if",source:"(2718:6) {#if $unifiedScoreData && $isCompleted}",ctx:r}),i}function Gt(r){let t,e;t=new Qe({props:{class:"main-card bottom-action-card",$$slots:{default:[ro]},$$scope:{ctx:r}},$$inline:!0});const i={c:function(){ge(t.$$.fragment)},l:function(n){me(t.$$.fragment,n)},m:function(n,a){de(t,n,a),e=!0},p:function(n,a){const s={};a[0]&32|a[3]&2048&&(s.$$scope={dirty:a,ctx:n}),t.$set(s)},i:function(n){e||(j(t.$$.fragment,n),e=!0)},o:function(n){X(t.$$.fragment,n),e=!1},d:function(n){fe(t,n)}};return ee("SvelteRegisterBlock",{block:i,id:Gt.name,type:"if",source:"(2749:6) {#if trainingPhase === 'results'}",ctx:r}),i}function ro(r){let t,e,i;e=new Qt({props:{isCompleted:r[5],position:"bottom"},$$inline:!0}),e.$on("action",r[29]);const c={c:function(){t=N("div"),ge(e.$$.fragment),this.h()},l:function(a){t=R(a,"DIV",{class:!0});var s=L(t);me(e.$$.fragment,s),s.forEach(p),this.h()},h:function(){P(t,"class","card-content svelte-rt5px1"),F(t,A,2750,10,92999)},m:function(a,s){W(a,t,s),de(e,t,null),i=!0},p:function(a,s){const f={};s[0]&32&&(f.isCompleted=a[5]),e.$set(f)},i:function(a){i||(j(e.$$.fragment,a),i=!0)},o:function(a){X(e.$$.fragment,a),i=!1},d:function(a){a&&p(t),fe(e)}};return ee("SvelteRegisterBlock",{block:c,id:ro.name,type:"slot",source:'(2750:8) <Card class=\\"main-card bottom-action-card\\">',ctx:r}),c}function ao(r){let t,e,i="âš¡ é€£ç¶šãƒãƒ£ãƒ¬ãƒ³ã‚¸ãƒ¢ãƒ¼ãƒ‰",c,n,a="ä¸­ç´šè€…å‘ã‘ï¼š8ã‚»ãƒƒã‚·ãƒ§ãƒ³é€£ç¶šã§åŸºéŸ³ãŒè‡ªå‹•å†ç”Ÿã•ã‚Œã‚‹é›†ä¸­ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°",s,f,l,m,d,y,b,h,v,x,Y,k,w,H,E,K,C=r[1]==="granted"&&!r[25]&&Et(r);const _=[Ln,jn],J=[];function T(B,D){return B[1]==="granted"?0:1}w=T(r),H=J[w]=_[w](r);const q={c:function(){t=N("div"),e=N("h1"),e.textContent=i,c=$(),n=N("p"),n.textContent=a,s=$(),C&&C.c(),f=$(),l=N("div"),m=U("ğŸ“± "),d=U(Wt),y=U(" | "),b=U(Jt),h=N("br"),v=$(),x=N("small"),Y=U(Kt),k=$(),H.c(),E=je(),this.h()},l:function(D){t=R(D,"DIV",{class:!0});var V=L(t);e=R(V,"H1",{class:!0,"data-svelte-h":!0}),ve(e)!=="svelte-1nub9gt"&&(e.textContent=i),c=Z(V),n=R(V,"P",{class:!0,"data-svelte-h":!0}),ve(n)!=="svelte-gneggn"&&(n.textContent=a),s=Z(V),C&&C.l(V),f=Z(V),l=R(V,"DIV",{class:!0});var I=L(l);m=G(I,"ğŸ“± "),d=G(I,Wt),y=G(I," | "),b=G(I,Jt),h=R(I,"BR",{}),v=Z(I),x=R(I,"SMALL",{style:!0});var Q=L(x);Y=G(Q,Kt),Q.forEach(p),I.forEach(p),V.forEach(p),k=Z(D),H.l(D),E=je(),this.h()},h:function(){P(e,"class","page-title svelte-rt5px1"),F(e,A,2533,4,85617),P(n,"class","page-description svelte-rt5px1"),F(n,A,2534,4,85662),F(h,A,2568,42,86868),Ke(x,"font-size","0.6rem"),F(x,A,2569,6,86880),P(l,"class","debug-info svelte-rt5px1"),F(l,A,2567,4,86801),P(t,"class","header-section svelte-rt5px1"),F(t,A,2532,2,85584)},m:function(D,V){W(D,t,V),g(t,e),g(t,c),g(t,n),g(t,s),C&&C.m(t,null),g(t,f),g(t,l),g(l,m),g(l,d),g(l,y),g(l,b),g(l,h),g(l,v),g(l,x),g(x,Y),W(D,k,V),J[w].m(D,V),W(D,E,V),K=!0},p:function(D,V){D[1]==="granted"&&!D[25]?C?(C.p(D,V),V[0]&33554434&&j(C,1)):(C=Et(D),C.c(),j(C,1),C.m(t,f)):C&&(Me(),X(C,1,1,()=>{C=null}),Ie());let I=w;w=T(D),w===I?J[w].p(D,V):(Me(),X(J[I],1,1,()=>{J[I]=null}),Ie(),H=J[w],H?H.p(D,V):(H=J[w]=_[w](D),H.c()),j(H,1),H.m(E.parentNode,E))},i:function(D){K||(j(C),j(H),K=!0)},o:function(D){X(C),X(H),K=!1},d:function(D){D&&(p(t),p(k),p(E)),C&&C.d(),J[w].d(D)}};return ee("SvelteRegisterBlock",{block:q,id:ao.name,type:"slot",source:"(2531:0) <PageLayout>",ctx:r}),q}function Ut(r){let t,e,i;e=new Bn({props:{$$slots:{default:[ao]},$$scope:{ctx:r}},$$inline:!0});const c={c:function(){t=$(),ge(e.$$.fragment),this.h()},l:function(a){bo("svelte-13kpo59",An.head).forEach(p),t=Z(a),me(e.$$.fragment,a),this.h()},h:function(){An.title="é€£ç¶šãƒãƒ£ãƒ¬ãƒ³ã‚¸ãƒ¢ãƒ¼ãƒ‰ - ç›¸å¯¾éŸ³æ„Ÿãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°"},m:function(a,s){W(a,t,s),de(e,a,s),i=!0},p:function(a,s){const f={};s[0]&67108863|s[3]&2048&&(f.$$scope={dirty:s,ctx:a}),e.$set(f)},i:function(a){i||(j(e.$$.fragment,a),i=!0)},o:function(a){X(e.$$.fragment,a),i=!1},d:function(a){a&&p(t),fe(e,a)}};return ee("SvelteRegisterBlock",{block:c,id:Ut.name,type:"component",source:"",ctx:r}),c}const Wt="v2.3.1-ANIMATED",Jt="07/29 04:15",Kt="ğŸ¬ è©•ä¾¡åˆ†å¸ƒã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè£…ãƒ»UXå‘ä¸Š";function In(){const r=/iPhone/.test(navigator.userAgent),t=/iPad/.test(navigator.userAgent),e=/Macintosh/.test(navigator.userAgent)&&"ontouchend"in document;return r||t||e?(console.log("ğŸ”Š [RandomTraining] iOS/iPadOSæ¤œå‡º - éŸ³é‡35dBè¨­å®š"),35):(console.log("ğŸ”Š [RandomTraining] PCæ¤œå‡º - éŸ³é‡-6dBè¨­å®š"),-6)}function Uo(){return{mode:"continuous",timestamp:new Date,duration:480,totalNotes:64,measuredNotes:59,averageAccuracy:79,baseNote:"C5",baseFrequency:523.25,sessionHistory:[{grade:"excellent",accuracy:92,baseNote:"C4",baseFrequency:261.63,timestamp:new Date(Date.now()-7*6e4),measuredNotes:8,noteResults:[{name:"ãƒ‰",note:"ãƒ‰",frequency:262,detectedFrequency:264,cents:13,grade:"excellent"},{name:"ãƒ¬",note:"ãƒ¬",frequency:294,detectedFrequency:291,cents:-18,grade:"good"},{name:"ãƒŸ",note:"ãƒŸ",frequency:330,detectedFrequency:335,cents:26,grade:"pass"},{name:"ãƒ•ã‚¡",note:"ãƒ•ã‚¡",frequency:349,detectedFrequency:346,cents:-15,grade:"excellent"},{name:"ã‚½",note:"ã‚½",frequency:392,detectedFrequency:388,cents:-18,grade:"good"},{name:"ãƒ©",note:"ãƒ©",frequency:440,detectedFrequency:444,cents:16,grade:"good"},{name:"ã‚·",note:"ã‚·",frequency:494,detectedFrequency:499,cents:17,grade:"good"},{name:"ãƒ‰ï¼ˆé«˜ï¼‰",note:"ãƒ‰ï¼ˆé«˜ï¼‰",frequency:523,detectedFrequency:520,cents:-10,grade:"excellent"}]},{grade:"good",accuracy:78,baseNote:"D4",baseFrequency:293.66,timestamp:new Date(Date.now()-6*6e4),measuredNotes:7,noteResults:[{name:"ãƒ‰",note:"ãƒ‰",frequency:294,detectedFrequency:290,cents:-23,grade:"good"},{name:"ãƒ¬",note:"ãƒ¬",frequency:330,detectedFrequency:340,cents:53,grade:"needWork"},{name:"ãƒŸ",note:"ãƒŸ",frequency:370,detectedFrequency:375,cents:23,grade:"good"},{name:"ãƒ•ã‚¡",note:"ãƒ•ã‚¡",frequency:392,detectedFrequency:385,cents:-31,grade:"pass"},{name:"ã‚½",note:"ã‚½",frequency:440,detectedFrequency:432,cents:-31,grade:"pass"},{name:"ãƒ©",note:"ãƒ©",frequency:494,detectedFrequency:510,cents:56,grade:"needWork"},{name:"ã‚·",note:"ã‚·",frequency:554,detectedFrequency:null,cents:null,grade:"notMeasured"},{name:"ãƒ‰ï¼ˆé«˜ï¼‰",note:"ãƒ‰ï¼ˆé«˜ï¼‰",frequency:587,detectedFrequency:580,cents:-21,grade:"good"}]},{grade:"excellent",accuracy:95,baseNote:"E4",baseFrequency:329.63,timestamp:new Date(Date.now()-5*6e4),measuredNotes:8,noteResults:[{name:"ãƒ‰",note:"ãƒ‰",frequency:330,detectedFrequency:332,cents:10,grade:"excellent"},{name:"ãƒ¬",note:"ãƒ¬",frequency:370,detectedFrequency:368,cents:-9,grade:"excellent"},{name:"ãƒŸ",note:"ãƒŸ",frequency:415,detectedFrequency:418,cents:12,grade:"excellent"},{name:"ãƒ•ã‚¡",note:"ãƒ•ã‚¡",frequency:440,detectedFrequency:436,cents:-16,grade:"good"},{name:"ã‚½",note:"ã‚½",frequency:494,detectedFrequency:497,cents:11,grade:"excellent"},{name:"ãƒ©",note:"ãƒ©",frequency:554,detectedFrequency:551,cents:-9,grade:"excellent"},{name:"ã‚·",note:"ã‚·",frequency:622,detectedFrequency:625,cents:8,grade:"excellent"},{name:"ãƒ‰ï¼ˆé«˜ï¼‰",note:"ãƒ‰ï¼ˆé«˜ï¼‰",frequency:659,detectedFrequency:655,cents:-10,grade:"excellent"}]},{grade:"needWork",accuracy:45,baseNote:"F4",baseFrequency:349.23,timestamp:new Date(Date.now()-4*6e4),measuredNotes:6,noteResults:[{name:"ãƒ‰",note:"ãƒ‰",frequency:349,detectedFrequency:345,cents:-20,grade:"good"},{name:"ãƒ¬",note:"ãƒ¬",frequency:392,detectedFrequency:420,cents:124,grade:"needWork"},{name:"ãƒŸ",note:"ãƒŸ",frequency:440,detectedFrequency:435,cents:-20,grade:"good"},{name:"ãƒ•ã‚¡",note:"ãƒ•ã‚¡",frequency:466,detectedFrequency:520,cents:195,grade:"needWork"},{name:"ã‚½",note:"ã‚½",frequency:523,detectedFrequency:410,cents:-455,grade:"needWork"},{name:"ãƒ©",note:"ãƒ©",frequency:587,detectedFrequency:null,cents:null,grade:"notMeasured"},{name:"ã‚·",note:"ã‚·",frequency:659,detectedFrequency:650,cents:-24,grade:"good"},{name:"ãƒ‰ï¼ˆé«˜ï¼‰",note:"ãƒ‰ï¼ˆé«˜ï¼‰",frequency:698,detectedFrequency:null,cents:null,grade:"notMeasured"}]},{grade:"good",accuracy:85,baseNote:"G4",baseFrequency:392,timestamp:new Date(Date.now()-3*6e4),measuredNotes:8,noteResults:[{name:"ãƒ‰",note:"ãƒ‰",frequency:392,detectedFrequency:395,cents:13,grade:"excellent"},{name:"ãƒ¬",note:"ãƒ¬",frequency:440,detectedFrequency:438,cents:-8,grade:"excellent"},{name:"ãƒŸ",note:"ãƒŸ",frequency:494,detectedFrequency:500,cents:21,grade:"good"},{name:"ãƒ•ã‚¡",note:"ãƒ•ã‚¡",frequency:523,detectedFrequency:520,cents:-10,grade:"excellent"},{name:"ã‚½",note:"ã‚½",frequency:587,detectedFrequency:595,cents:24,grade:"good"},{name:"ãƒ©",note:"ãƒ©",frequency:659,detectedFrequency:665,cents:16,grade:"good"},{name:"ã‚·",note:"ã‚·",frequency:740,detectedFrequency:755,cents:35,grade:"pass"},{name:"ãƒ‰ï¼ˆé«˜ï¼‰",note:"ãƒ‰ï¼ˆé«˜ï¼‰",frequency:784,detectedFrequency:780,cents:-9,grade:"excellent"}]},{grade:"excellent",accuracy:94,baseNote:"A4",baseFrequency:440,timestamp:new Date(Date.now()-2*6e4),measuredNotes:8,noteResults:[{name:"ãƒ‰",note:"ãƒ‰",frequency:440,detectedFrequency:442,cents:8,grade:"excellent"},{name:"ãƒ¬",note:"ãƒ¬",frequency:494,detectedFrequency:492,cents:-7,grade:"excellent"},{name:"ãƒŸ",note:"ãƒŸ",frequency:554,detectedFrequency:558,cents:12,grade:"excellent"},{name:"ãƒ•ã‚¡",note:"ãƒ•ã‚¡",frequency:587,detectedFrequency:585,cents:-6,grade:"excellent"},{name:"ã‚½",note:"ã‚½",frequency:659,detectedFrequency:665,cents:16,grade:"good"},{name:"ãƒ©",note:"ãƒ©",frequency:740,detectedFrequency:738,cents:-5,grade:"excellent"},{name:"ã‚·",note:"ã‚·",frequency:831,detectedFrequency:840,cents:19,grade:"good"},{name:"ãƒ‰ï¼ˆé«˜ï¼‰",note:"ãƒ‰ï¼ˆé«˜ï¼‰",frequency:880,detectedFrequency:882,cents:4,grade:"excellent"}]},{grade:"pass",accuracy:68,baseNote:"Bb4",baseFrequency:466.16,timestamp:new Date(Date.now()-1*6e4),measuredNotes:7,noteResults:[{name:"ãƒ‰",note:"ãƒ‰",frequency:466,detectedFrequency:470,cents:15,grade:"excellent"},{name:"ãƒ¬",note:"ãƒ¬",frequency:523,detectedFrequency:535,cents:39,grade:"pass"},{name:"ãƒŸ",note:"ãƒŸ",frequency:587,detectedFrequency:600,cents:38,grade:"pass"},{name:"ãƒ•ã‚¡",note:"ãƒ•ã‚¡",frequency:622,detectedFrequency:615,cents:-19,grade:"good"},{name:"ã‚½",note:"ã‚½",frequency:698,detectedFrequency:720,cents:54,grade:"needWork"},{name:"ãƒ©",note:"ãƒ©",frequency:784,detectedFrequency:null,cents:null,grade:"notMeasured"},{name:"ã‚·",note:"ã‚·",frequency:880,detectedFrequency:895,cents:29,grade:"pass"},{name:"ãƒ‰ï¼ˆé«˜ï¼‰",note:"ãƒ‰ï¼ˆé«˜ï¼‰",frequency:932,detectedFrequency:925,cents:-13,grade:"excellent"}]},{grade:"good",accuracy:82,baseNote:"C5",baseFrequency:523.25,timestamp:new Date,measuredNotes:8,noteResults:[{name:"ãƒ‰",note:"ãƒ‰",frequency:523,detectedFrequency:526,cents:10,grade:"excellent"},{name:"ãƒ¬",note:"ãƒ¬",frequency:587,detectedFrequency:584,cents:-9,grade:"excellent"},{name:"ãƒŸ",note:"ãƒŸ",frequency:659,detectedFrequency:665,cents:16,grade:"good"},{name:"ãƒ•ã‚¡",note:"ãƒ•ã‚¡",frequency:698,detectedFrequency:692,cents:-15,grade:"excellent"},{name:"ã‚½",note:"ã‚½",frequency:784,detectedFrequency:795,cents:24,grade:"good"},{name:"ãƒ©",note:"ãƒ©",frequency:880,detectedFrequency:890,cents:19,grade:"good"},{name:"ã‚·",note:"ã‚·",frequency:988,detectedFrequency:1010,cents:38,grade:"pass"},{name:"ãƒ‰ï¼ˆé«˜ï¼‰",note:"ãƒ‰ï¼ˆé«˜ï¼‰",frequency:1047,detectedFrequency:1042,cents:-8,grade:"excellent"}]}]}}function Mt(r){return[{scale:"ãƒ‰",interval:"unison",intervalName:"ãƒ¦ãƒ‹ã‚¾ãƒ³"},{scale:"ãƒ¬",interval:"major_second",intervalName:"é•·2åº¦"},{scale:"ãƒŸ",interval:"major_third",intervalName:"é•·3åº¦"},{scale:"ãƒ•ã‚¡",interval:"perfect_fourth",intervalName:"å®Œå…¨4åº¦"},{scale:"ã‚½",interval:"perfect_fifth",intervalName:"å®Œå…¨5åº¦"},{scale:"ãƒ©",interval:"major_sixth",intervalName:"é•·6åº¦"},{scale:"ã‚·",interval:"major_seventh",intervalName:"é•·7åº¦"},{scale:"ãƒ‰ï¼ˆé«˜ï¼‰",interval:"octave",intervalName:"ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–"}].map((e,i)=>{const c=r.find(n=>n.targetNote&&n.targetNote.includes(e.scale))||r[i];if(c&&c.accuracy!=="notMeasured"){const n=parseFloat(c.accuracy)||0,a=Math.round((100-n)*.5);return{type:e.interval,scale:e.scale,intervalName:e.intervalName,attempts:1,averageError:a,accuracy:n}}else return{type:e.interval,scale:e.scale,intervalName:e.intervalName,attempts:0,averageError:null,accuracy:0}})}function En(r){if(!r||!Array.isArray(r))return console.warn("âš ï¸ [RandomTraining] sessionHistory ãŒç„¡åŠ¹ã§ã™"),[];const t=[{type:"unison",scale:"ãƒ‰",intervalName:"ãƒ¦ãƒ‹ã‚¾ãƒ³",noteIndex:0},{type:"major_second",scale:"ãƒ¬",intervalName:"é•·2åº¦",noteIndex:1},{type:"major_third",scale:"ãƒŸ",intervalName:"é•·3åº¦",noteIndex:2},{type:"perfect_fourth",scale:"ãƒ•ã‚¡",intervalName:"å®Œå…¨4åº¦",noteIndex:3},{type:"perfect_fifth",scale:"ã‚½",intervalName:"å®Œå…¨5åº¦",noteIndex:4},{type:"major_sixth",scale:"ãƒ©",intervalName:"é•·6åº¦",noteIndex:5},{type:"major_seventh",scale:"ã‚·",intervalName:"é•·7åº¦",noteIndex:6},{type:"octave",scale:"ãƒ‰ï¼ˆé«˜ï¼‰",intervalName:"ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–",noteIndex:7}],e={};return t.forEach(i=>{e[i.type]={type:i.type,scale:i.scale,intervalName:i.intervalName,attempts:0,successCount:0,accuracySum:0,accuracyValues:[],errorValues:[]}}),r.forEach(i=>{!i.noteResults||!Array.isArray(i.noteResults)||i.noteResults.forEach((c,n)=>{if(n>=t.length)return;const a=t[n].type,s=e[a];if(s.attempts++,c.accuracy!=="notMeasured"&&typeof c.accuracy=="number"){s.accuracyValues.push(c.accuracy),s.accuracySum+=c.accuracy;const f=Math.round((100-c.accuracy)*.5);s.errorValues.push(f),c.accuracy>=70&&s.successCount++}})}),t.map(i=>{const c=e[i.type];if(c.attempts===0)return{type:i.type,scale:i.scale,intervalName:i.intervalName,attempts:0,averageError:null,accuracy:0};const n=c.accuracyValues.length>0?Math.round(c.accuracySum/c.accuracyValues.length):0,a=c.errorValues.length>0?Math.round(c.errorValues.reduce((f,l)=>f+l,0)/c.errorValues.length):null,s=c.accuracyValues.length>0?Math.round(c.successCount/c.accuracyValues.length*100):0;return{type:i.type,scale:i.scale,intervalName:i.intervalName,mastery:s,attempts:c.attempts,averageError:a,accuracy:n}})}function Pn(r){const t=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];if(r<=0)return"ãƒ¼ãƒ¼";const i=Math.round(12*Math.log2(r/440)),c=(i+9+120)%12,n=Math.floor((i+9)/12)+4;return t[c]+n}function It(r,t){const e=[{factor:4,freq:r*4,description:"2ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–ä¸Š"},{factor:3,freq:r*3,description:"1.5ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–ä¸Š"},{factor:2.5,freq:r*2.5,description:"1.3ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–ä¸Š"},{factor:2,freq:r*2,description:"1ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–ä¸Š"},{factor:1.5,freq:r*1.5,description:"0.5ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–ä¸Š"},{factor:1,freq:r,description:"è£œæ­£ãªã—"},{factor:.75,freq:r*.75,description:"0.33ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–ä¸‹"},{factor:.67,freq:r*.67,description:"0.5ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–ä¸‹"},{factor:.5,freq:r*.5,description:"1ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–ä¸‹"},{factor:.4,freq:r*.4,description:"1.3ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–ä¸‹"},{factor:.33,freq:r*.33,description:"1.5ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–ä¸‹"},{factor:.25,freq:r*.25,description:"2ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–ä¸‹"}];let i=null,c=1/0;const n=t*.5,a=t*1.5,s=e.filter(f=>f.freq>=n&&f.freq<=a);for(const f of s){const l=Math.abs(f.freq-t);l<c&&(c=l,i=f)}if(!i)for(const f of e){const l=Math.abs(f.freq-t);l<c&&(c=l,i=f)}return i?{correctedFrequency:i.freq,factor:i.factor,description:i.description,error:c}:{correctedFrequency:r,factor:1,description:"è£œæ­£ãªã—ï¼ˆãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼‰",error:Math.abs(r-t)}}function ot(){try{"scrollTo"in window&&"behavior"in document.documentElement.style?window.scrollTo({top:0,behavior:"smooth"}):window.scrollTo(0,0),document.body&&(document.body.scrollTop=0),document.documentElement&&(document.documentElement.scrollTop=0),document.querySelectorAll("[data-scroll-container], .scroll-container, main").forEach(t=>{t.scrollTo?t.scrollTo(0,0):t.scrollTop=0})}catch(r){console.warn("ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã‚¨ãƒ©ãƒ¼:",r);try{window.scroll(0,0)}catch(t){console.error("ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«å®Œå…¨å¤±æ•—:",t)}}}function so(r){}function co(r){console.error("âŒ PitchDetectorã‚¨ãƒ©ãƒ¼:",r.detail)}function Wo(r,t,e){let i,c,n,a,s,f,l,m,d,y,b,h;Ae(Nt,"currentSessionId"),Te(r,Nt,o=>e(23,n=o)),Ae(qt,"unifiedScoreData"),Te(r,qt,o=>e(4,a=o)),Ae(kt,"isCompleted"),Te(r,kt,o=>e(5,s=o)),Ae(_t,"page"),Te(r,_t,o=>e(53,f=o)),Ae(Dt,"remainingSessions"),Te(r,Dt,o=>e(54,l=o)),Ae(Ft,"nextBaseName"),Te(r,Ft,o=>e(55,m=o)),Ae(Rt,"nextBaseNote"),Te(r,Rt,o=>e(56,d=o)),Ae(wt,"sessionHistory"),Te(r,wt,o=>e(24,y=o)),Ae(At,"trainingProgress"),Te(r,At,o=>e(57,b=o)),Ae(Ct,"isLoading"),Te(r,Ct,o=>e(25,h=o));let{$$slots:v={},$$scope:x}=t;So("Page",v,[]);function Y(o){return nt.evaluateOverall(o)}let k="setup",w=typeof window<"u"?new URLSearchParams(window.location.search).get("from")==="microphone-test"?(ce.info("[RandomTraining] ãƒã‚¤ã‚¯ãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸ã‹ã‚‰ã®é·ç§»ã‚’æ¤œå‡º"),"granted"):(ce.info("[RandomTraining] ãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã‚¢ã‚¯ã‚»ã‚¹ã‚’æ¤œå‡º"),"checking"):"checking",H=!0,E=[];const K=["ãƒ‰","ãƒ¬","ãƒŸ","ãƒ•ã‚¡","ã‚½","ãƒ©","ã‚·","ãƒ‰ï¼ˆé«˜ï¼‰"];let C="",_=0,J=!1,T=0,q=K.map(o=>({name:o,state:"inactive",completed:!1})),B=null,D=!1,V=0,I=!1,Q=null,ye=!1,ne=[],_e=[],Se=0,Ee=0,Le="ãƒ¼ãƒ¼",Ve=0,He={correctCount:0,totalCount:8,averageAccuracy:0,averageTime:0,isCompleted:!1},we=null,ze={totalScore:0,grade:"C",componentScores:{pitchAccuracy:0,recognitionSpeed:0,intervalMastery:0,directionAccuracy:0,consistency:0}},ke=[],Pe=[],Oe={},Xe={},Fe={totalAttempts:0,successRate:0,averageScore:0,bestScore:0,sessionDuration:0,streakCount:0,fatigueLevel:"fresh",mostDifficultInterval:"-",mostSuccessfulInterval:"-",averageResponseTime:0,sessionStart:Date.now()},ft="intervals",oe=[],le=null,ue=null,Re=!0,re=null,xe=null,rt=null,at=null,We=null;const Ge=[{note:"C4",name:"ãƒ‰ï¼ˆä¸­ï¼‰",frequency:261.63,semitonesFromC:0},{note:"Db4",name:"ãƒ‰#ï¼ˆä¸­ï¼‰",frequency:277.18,semitonesFromC:1},{note:"D4",name:"ãƒ¬ï¼ˆä¸­ï¼‰",frequency:293.66,semitonesFromC:2},{note:"Eb4",name:"ãƒ¬#ï¼ˆä¸­ï¼‰",frequency:311.13,semitonesFromC:3},{note:"E4",name:"ãƒŸï¼ˆä¸­ï¼‰",frequency:329.63,semitonesFromC:4},{note:"F4",name:"ãƒ•ã‚¡ï¼ˆä¸­ï¼‰",frequency:349.23,semitonesFromC:5},{note:"Gb4",name:"ãƒ•ã‚¡#ï¼ˆä¸­ï¼‰",frequency:369.99,semitonesFromC:6},{note:"Ab4",name:"ãƒ©bï¼ˆä¸­ï¼‰",frequency:415.3,semitonesFromC:8},{note:"Bb3",name:"ã‚·bï¼ˆä½ï¼‰",frequency:233.08,semitonesFromC:-2},{note:"B3",name:"ã‚·ï¼ˆä½ï¼‰",frequency:246.94,semitonesFromC:-1}];async function Je(){var o;e(1,w="checking");try{if(console.log("ğŸ¤ [RandomTraining] AudioManagerçµŒç”±ã§ãƒã‚¤ã‚¯è¨±å¯ç¢ºèªé–‹å§‹"),!((o=navigator.mediaDevices)!=null&&o.getUserMedia)){e(1,w="error");return}const u=await Ue.initialize();rt=u.audioContext,xe=u.mediaStream,at=u.sourceNode,console.log("âœ… [RandomTraining] AudioManager ãƒªã‚½ãƒ¼ã‚¹å–å¾—å®Œäº†"),e(1,w="granted"),e(0,k="setup"),setTimeout(async()=>{if(re){ce.audio("[RandomTraining] PitchDetectoråˆæœŸåŒ–é–‹å§‹");const S=/iPhone/.test(navigator.userAgent),M=/iPad/.test(navigator.userAgent),z=/Macintosh/.test(navigator.userAgent)&&"ontouchend"in document;(M||z)&&(console.log("ğŸ”§ [RandomTraining] iPadæ¤œå‡º - ãƒã‚¤ã‚¯æ„Ÿåº¦7.0xè‡ªå‹•è¨­å®šé–‹å§‹"),Ue.setSensitivity(7),console.log("âœ… [RandomTraining] iPad ãƒã‚¤ã‚¯æ„Ÿåº¦7.0xè‡ªå‹•è¨­å®šå®Œäº†"));try{console.log("ğŸ¤ [RandomTraining] AudioManagerå†åˆæœŸåŒ–é–‹å§‹ï¼ˆiPadå¯¾å¿œï¼‰"),await Ue.initialize(),console.log("âœ… [RandomTraining] AudioManagerå†åˆæœŸåŒ–å®Œäº†")}catch(O){console.warn("âš ï¸ AudioManagerå†åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼:",O)}await re.initialize(),ce.audio("[RandomTraining] PitchDetectoråˆæœŸåŒ–å®Œäº†")}},200)}catch(u){ce.error("[RandomTraining] ãƒã‚¤ã‚¯è¨±å¯ã‚¨ãƒ©ãƒ¼:",u),e(1,w=(u==null?void 0:u.name)==="NotAllowedError"?"denied":"error")}}function dt(){const o=d,u=m,S=Ge.find(M=>M.note===o)||Ge.find(M=>M.name===u)||Ge[0];if(e(7,C=S.name),e(8,_=S.frequency),ce.info(`[BaseNote] åŸºéŸ³è¨­å®šï¼ˆlocalStorageé€£æºï¼‰: ${C} = ${_}Hz`),ce.info(`[BaseNote] localStorageåŸºéŸ³æƒ…å ±: note=${o}, name=${u}`),!_||_<=0)throw ce.error("[BaseNote] åŸºéŸ³å‘¨æ³¢æ•°è¨­å®šã‚¨ãƒ©ãƒ¼:",S),new Error(`Invalid base frequency: ${_}`)}async function Yt(){if(J||!ue||Re)return;if(w!=="granted"){console.log("ğŸ¤ [RandomTraining] ãƒã‚¤ã‚¯è¨±å¯ãŒå¿…è¦ã§ã™ã€‚è¨±å¯å–å¾—ã‚’é–‹å§‹...");try{await Je(),console.log("ğŸ¤ [RandomTraining] ãƒã‚¤ã‚¯è¨±å¯å–å¾—å®Œäº†")}catch(u){console.error("âŒ ãƒã‚¤ã‚¯è¨±å¯ã‚¨ãƒ©ãƒ¼:",u);return}}if(!xe&&w==="granted"){console.log("ğŸ¤ [RandomTraining] AudioManagerãƒªã‚½ãƒ¼ã‚¹æœªåˆæœŸåŒ–ã®ãŸã‚å–å¾—ã—ã¾ã™");try{await Je()}catch(u){console.error("âŒ AudioManagerãƒªã‚½ãƒ¼ã‚¹åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼:",u);return}}else xe&&console.log("ğŸ¤ [RandomTraining] AudioManagerãƒªã‚½ãƒ¼ã‚¹æ—¢å­˜ã®ãŸã‚å†åˆ©ç”¨");e(9,J=!0),e(0,k="listening"),We=Date.now(),dt();const o=Ge.find(u=>u.name===C).note;ue.triggerAttackRelease(o,2,Tt(),.7),setTimeout(()=>{e(9,J=!1),e(0,k="waiting"),setTimeout(()=>gt(),500)},2e3)}async function Zt(){if(J||!ue||h||!C)return;if(w!=="granted"){console.log("ğŸ¤ [RandomTraining] ãƒã‚¤ã‚¯è¨±å¯ãŒå¿…è¦ã§ã™ã€‚è¨±å¯å–å¾—ã‚’é–‹å§‹...");try{await Je(),console.log("ğŸ¤ [RandomTraining] ãƒã‚¤ã‚¯è¨±å¯å–å¾—å®Œäº†")}catch(u){console.error("âŒ ãƒã‚¤ã‚¯è¨±å¯ã‚¨ãƒ©ãƒ¼:",u);return}}if(!xe&&w==="granted"){console.log("ğŸ¤ [RandomTraining] AudioManagerãƒªã‚½ãƒ¼ã‚¹æœªåˆæœŸåŒ–ã®ãŸã‚å–å¾—ã—ã¾ã™");try{await Je()}catch(u){console.error("âŒ AudioManagerãƒªã‚½ãƒ¼ã‚¹åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼:",u);return}}else xe&&console.log("ğŸ¤ [RandomTraining] AudioManagerãƒªã‚½ãƒ¼ã‚¹æ—¢å­˜ã®ãŸã‚å†åˆ©ç”¨");if(e(9,J=!0),e(0,k="listening"),We=Date.now(),typeof window<"u"&&window.Tone){const u=window.Tone.context||window.Tone.getContext();u&&u.state==="suspended"&&(console.log("ğŸ”„ [RandomTraining] AudioContext suspendedæ¤œå‡º - å†é–‹ä¸­..."),await u.resume(),console.log("âœ… [RandomTraining] AudioContextå†é–‹å®Œäº†"))}const o=Ge.find(u=>u.name===C).note;ue.triggerAttackRelease(o,2,Tt(),.7),setTimeout(()=>{e(9,J=!1),e(0,k="waiting"),setTimeout(()=>gt(),500)},2e3)}async function io(){if(J||!ue||h||!C){console.log("ğŸ”„ [BaseNoteOnly] å†ç”Ÿæ¡ä»¶æœªæº€: isPlaying:",J,"sampler:",!!ue,"isLoading:",h,"currentBaseNote:",C);return}if(console.log("ğŸµ [BaseNoteOnly] åŸºéŸ³ã®ã¿å†ç”Ÿé–‹å§‹:",C),typeof window<"u"&&window.Tone){const u=window.Tone.context||window.Tone.getContext();u&&u.state==="suspended"&&(console.log("ğŸ”„ [BaseNoteOnly] AudioContext suspendedæ¤œå‡º - å†é–‹ä¸­..."),await u.resume(),console.log("âœ… [BaseNoteOnly] AudioContextå†é–‹å®Œäº†"))}const o=Ge.find(u=>u.name===C).note;ue.triggerAttackRelease(o,1.5,Tt(),.7),console.log("ğŸµ [BaseNoteOnly] åŸºéŸ³å†ç”Ÿå®Œäº†:",o)}function mt(){C&&_>0?Zt():Yt(),$t()}function $t(){Q&&clearInterval(Q),e(11,V=0),I=!0,e(12,ye=!1),console.log("ğŸµ [GuideStartBar] ã‚¬ã‚¤ãƒ‰ã‚¹ã‚¿ãƒ¼ãƒˆãƒãƒ¼é–‹å§‹"),Q=setInterval(()=>{e(11,V+=2.5),V>=100&&(e(11,V=100),e(12,ye=!0),console.log("ğŸµ [GuideStartBar] ã‚¬ã‚¤ãƒ‰é–‹å§‹ã‚¿ã‚¤ãƒŸãƒ³ã‚°ï¼"),setTimeout(()=>{I=!1,e(12,ye=!1),e(11,V=0)},800),clearInterval(Q),Q=null)},50)}function lo(){Q&&(clearInterval(Q),Q=null),I=!1,e(12,ye=!1),e(11,V=0)}function Ye(o,u){const M=[0,2,4,5,7,9,11,12][u],z=o*Math.pow(2,M/12);return ce.debug(`[calculateExpectedFrequency] ${q[u].name}: åŸºéŸ³${o.toFixed(1)}Hz + ${M}åŠéŸ³ = ${z.toFixed(1)}Hz`),z}function en(o,u){return Ye(o,u)}function gt(){e(0,k="guiding"),T=0,D=!0,ne=[],console.log(`ğŸ¬ ã‚¬ã‚¤ãƒ‰é–‹å§‹: ${C} (${_.toFixed(1)}Hz)`);function o(){if(T<q.length){T>0&&e(10,q[T-1].state="inactive",q),e(10,q[T].state="active",q);const u=en(_,T);St.setScaleContext({baseFrequency:_,currentScale:q[T].name,targetFrequency:u}),console.log(`ğŸµ [Scale] åŸºéŸ³:${C}(${_.toFixed(0)}Hz) ç¾åœ¨:${q[T].name} ç›®æ¨™:${u.toFixed(0)}Hz`),T>=4&&console.log(`ğŸ” [ãƒ‡ãƒãƒƒã‚°] Step ${T}: currentBaseFrequency=${_}, currentBaseNote='${C}'`),T++,B=setTimeout(()=>{o()},600)}else tn()}o()}function tn(){D=!1,console.log(`ğŸ ã‚¬ã‚¤ãƒ‰å®Œäº†: ${ne.length}/${q.length}ã‚¹ãƒ†ãƒƒãƒ—è©•ä¾¡`),q.length>0&&e(10,q[q.length-1].state="inactive",q),re&&re.stopDetection(),St.clearContext(),nn(),cn(),oe=K.map(o=>{const u=ne.find(S=>S.stepName===o);return u?{name:u.stepName,cents:u.adjustedFrequency?Math.round(u.centDifference):null,targetFreq:u.expectedFrequency,detectedFreq:u.adjustedFrequency||null,diff:u.adjustedFrequency?u.adjustedFrequency-u.expectedFrequency:null,accuracy:u.accuracy}:{name:o,cents:null,targetFreq:null,detectedFreq:null,diff:null,accuracy:"notMeasured"}}),un(),dn(),e(0,k="results")}function nn(){let o=0,u=0;ne.forEach((z,O)=>{z.isCorrect&&o++,u+=z.accuracy});const S=ne.length>0?Math.round(u/ne.length):0,M=Math.round(o/q.length*100);He={correctCount:o,totalCount:q.length,averageAccuracy:S,averageTime:0,isCompleted:!0},console.log(`ğŸ¯ çµæœ: ${o}/${q.length}æ­£è§£ (${M}%) å¹³å‡ç²¾åº¦${S}%`),ne.length>0&&(_e=[...ne])}function uo(){switch(k){case"setup":return Re||!ue?"ğŸµ éŸ³æºèª­ã¿è¾¼ã¿ä¸­...":"ğŸ¤ ãƒã‚¤ã‚¯æº–å‚™å®Œäº† - ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°é–‹å§‹å¯èƒ½";case"listening":return"ğŸµ åŸºéŸ³å†ç”Ÿä¸­...";case"waiting":return"â³ é–“ã‚‚ãªãé–‹å§‹...";case"guiding":return"ğŸ™ï¸ ã‚¬ã‚¤ãƒ‰ã«åˆã‚ã›ã¦ãƒ‰ãƒ¬ãƒŸãƒ•ã‚¡ã‚½ãƒ©ã‚·ãƒ‰ã‚’æ­Œã£ã¦ãã ã•ã„";case"results":return"ğŸ‰ æ¡ç‚¹çµæœ";default:return"ğŸ”„ æº–å‚™ä¸­..."}}function fo(){return ne.length>0?ne:_e.length>0?_e:[]}function on(){vt(`${it}/microphone-test`)}function Ze(){vt(`${it}/`)}async function rn(){try{e(33,Re=!0),e(32,ue=new zo({urls:{C4:"C4.mp3"},baseUrl:`${it}/audio/piano/`,release:1.5,volume:In(),onload:()=>{e(33,Re=!1)},onerror:z=>{console.error("âŒ Salamander PianoéŸ³æºèª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:",z),e(33,Re=!1)}}).toDestination());const o=/iPhone/.test(navigator.userAgent),u=/iPad/.test(navigator.userAgent),S=/Macintosh/.test(navigator.userAgent)&&"ontouchend"in document,M=o||u||S;console.log(u?"ğŸ” [RandomTraining] iPadæ¤œå‡º:":S?"ğŸ” [RandomTraining] iPadOSæ¤œå‡º:":o?"ğŸ” [RandomTraining] iPhoneæ¤œå‡º:":"ğŸ” [RandomTraining] ãã®ä»–ãƒ‡ãƒã‚¤ã‚¹æ¤œå‡º:",navigator.userAgent),console.log("ğŸ”Š [RandomTraining] éŸ³é‡è¨­å®šç¶­æŒ: 35dB")}catch(o){console.error("ã‚µãƒ³ãƒ—ãƒ©ãƒ¼åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼:",o),e(33,Re=!1)}}async function st(){try{(await navigator.permissions.query({name:"microphone"})).state==="granted"?await Je():e(1,w="denied")}catch{e(1,w="denied")}}function an(){try{we=new Nn,ce.info("[RandomTraining] æ¡ç‚¹ã‚¨ãƒ³ã‚¸ãƒ³åˆæœŸåŒ–å®Œäº†")}catch(o){ce.error("[RandomTraining] æ¡ç‚¹ã‚¨ãƒ³ã‚¸ãƒ³åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼:",o)}}function sn(o,u){if(!we||!D)return;const S=T-1;if(S<0||S>=q.length)return;const M=Ye(_,S),z={baseFrequency:_,targetFrequency:M,detectedFrequency:o,detectedNote:u,volume:Se,timestamp:Date.now(),scaleIndex:S,scaleName:q[S].name};try{we.processAttempt(z)}catch(O){ce.error("[RandomTraining] æ¡ç‚¹ã‚¨ãƒ³ã‚¸ãƒ³ã‚¨ãƒ©ãƒ¼:",O)}}function cn(){if(!we){ce.error("[RandomTraining] æ¡ç‚¹ã‚¨ãƒ³ã‚¸ãƒ³ãŒåˆæœŸåŒ–ã•ã‚Œã¦ã„ã¾ã›ã‚“"),ln();return}try{const o=we.generateDetailedReport();e(16,ze={totalScore:o.totalScore,grade:o.grade,componentScores:o.componentScores}),o.intervalAnalysis&&o.intervalAnalysis.masteryLevels?e(3,ke=Object.entries(o.intervalAnalysis.masteryLevels).map(([u,S])=>{var M,z;return{type:u,mastery:Math.round(S),attempts:((M=o.intervalAnalysis.attemptCounts)==null?void 0:M[u])||0,accuracy:((z=o.intervalAnalysis.accuracyRates)==null?void 0:z[u])||0}})):(console.warn("âš ï¸ [RandomTraining] intervalAnalysis.masteryLevels ãŒæœªå®šç¾©ã§ã™"),e(3,ke=[])),o.consistencyHistory&&Array.isArray(o.consistencyHistory)?e(17,Pe=o.consistencyHistory.map((u,S)=>({score:Math.round(u),timestamp:Date.now()-(o.consistencyHistory.length-S)*1e3}))):(console.warn("âš ï¸ [RandomTraining] consistencyHistory ãŒæœªå®šç¾©ã¾ãŸã¯é…åˆ—ã§ã¯ã‚ã‚Šã¾ã›ã‚“"),e(17,Pe=[])),e(18,Oe=o.feedback||{primary:"æ¡ç‚¹çµæœã‚’ç”Ÿæˆä¸­ã§ã™...",detailed:[],suggestions:[]}),e(20,Fe={totalAttempts:o.totalAttempts||0,successRate:o.successRate||0,averageScore:o.totalScore||0,bestScore:Math.max(o.totalScore||0,Fe.bestScore||0),sessionDuration:Math.round((Date.now()-Fe.sessionStart)/6e4)||0,streakCount:o.streak||0,fatigueLevel:o.fatigueLevel||"normal",mostDifficultInterval:o.mostDifficultInterval||"-",mostSuccessfulInterval:o.mostSuccessfulInterval||"-",averageResponseTime:o.averageResponseTime||0}),ce.info("[RandomTraining] æ¡ç‚¹çµæœç”Ÿæˆå®Œäº†:",ze)}catch(o){ce.error("[RandomTraining] æ¡ç‚¹çµæœç”Ÿæˆã‚¨ãƒ©ãƒ¼:",o)}}function ln(){ce.info("[RandomTraining] ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã§æ¡ç‚¹çµæœã‚’ç”Ÿæˆ"),e(16,ze={totalScore:78,grade:"B+",componentScores:{pitchAccuracy:82,recognitionSpeed:75,intervalMastery:80,directionAccuracy:85,consistency:70}}),e(3,ke=[{type:"unison",mastery:95,attempts:8,accuracy:98},{type:"major_second",mastery:82,attempts:8,accuracy:85},{type:"major_third",mastery:78,attempts:8,accuracy:80},{type:"perfect_fourth",mastery:65,attempts:8,accuracy:68},{type:"perfect_fifth",mastery:88,attempts:8,accuracy:90},{type:"major_sixth",mastery:72,attempts:8,accuracy:75},{type:"major_seventh",mastery:58,attempts:8,accuracy:62},{type:"octave",mastery:92,attempts:8,accuracy:94}]),e(17,Pe=[{score:65,timestamp:Date.now()-42e4},{score:72,timestamp:Date.now()-36e4},{score:68,timestamp:Date.now()-3e5},{score:75,timestamp:Date.now()-24e4},{score:78,timestamp:Date.now()-18e4},{score:82,timestamp:Date.now()-12e4},{score:80,timestamp:Date.now()-6e4},{score:85,timestamp:Date.now()}]),e(18,Oe={type:"improvement",primary:"è‰¯ã„é€²æ­©ãŒè¦‹ã‚‰ã‚Œã¾ã™ï¼",summary:"éŸ³ç¨‹ã®èªè­˜ç²¾åº¦ãŒå‘ä¸Šã—ã¦ã„ã¾ã™ã€‚ç‰¹ã«å®Œå…¨5åº¦ã¨ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–ã®ç¿’å¾—åº¦ãŒé«˜ãã€åŸºæœ¬çš„ãªéŸ³æ„ŸãŒèº«ã«ã¤ã„ã¦ãã¦ã„ã¾ã™ã€‚",details:[{category:"strengths",text:"ãƒ¦ãƒ‹ã‚¾ãƒ³ã¨ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–ã®èªè­˜ãŒã»ã¼å®Œç’§ã§ã™"},{category:"strengths",text:"å®Œå…¨5åº¦ã®å®‰å®šæ€§ãŒå„ªç§€ã§ã™"},{category:"improvements",text:"å®Œå…¨4åº¦ã®ç·´ç¿’ã‚’ã‚‚ã†å°‘ã—å¢—ã‚„ã—ã¾ã—ã‚‡ã†"},{category:"improvements",text:"é•·7åº¦ã®èªè­˜ç²¾åº¦ã‚’å‘ä¸Šã•ã›ã¾ã—ã‚‡ã†"},{category:"tips",text:"4åº¦ã¯ã€Œã‚½ãƒ¼ãƒ•ã‚¡ãƒ¼ã€ã®éŸ³ç¨‹ã§ã™"},{category:"practice",text:"æ¯æ—¥15åˆ†ã®ç¶™ç¶šç·´ç¿’ã‚’å¿ƒãŒã‘ã¾ã—ã‚‡ã†"}],nextSteps:["å®Œå…¨4åº¦ã®é›†ä¸­ç·´ç¿’ã‚’è¡Œã„ã¾ã—ã‚‡ã†","é€£ç¶šãƒãƒ£ãƒ¬ãƒ³ã‚¸ãƒ¢ãƒ¼ãƒ‰ã§å®Ÿè·µç·´ç¿’ã‚’","1æ—¥15åˆ†ã®ç¶™ç¶šç·´ç¿’ã‚’å¿ƒãŒã‘ã¾ã—ã‚‡ã†"],motivation:"ç¶™ç¶šã¯åŠ›ãªã‚Šï¼ã‚ãªãŸã®ç›¸å¯¾éŸ³æ„Ÿã¯ç¢ºå®Ÿã«å‘ä¸Šã—ã¦ã„ã¾ã™ï¼"}),e(20,Fe={totalAttempts:32,successRate:68.8,averageScore:78,bestScore:85,sessionDuration:8,streakCount:4,fatigueLevel:"normal",mostDifficultInterval:"å®Œå…¨4åº¦",mostSuccessfulInterval:"ãƒ¦ãƒ‹ã‚¾ãƒ³",averageResponseTime:2.1,sessionStart:Date.now()-48e4}),ce.info("[RandomTraining] ãƒ†ã‚¹ãƒˆæ¡ç‚¹çµæœç”Ÿæˆå®Œäº†")}function mo(o){ft=o}function un(){if(!oe||oe.length===0){console.warn("[UnifiedScore] noteResultsForDisplay ãŒç©ºã§ã™");return}const o=oe.filter(te=>te.accuracy!=="notMeasured").length,u=oe.length,S=oe.filter(te=>te.accuracy!=="notMeasured"&&typeof te.accuracy=="number").map(te=>te.accuracy),M=S.length>0?Math.round(S.reduce((te,Ne)=>te+Ne,0)/S.length):0,z=C||"Unknown",O=_||0,ae=oe.map(te=>({name:te.name,note:te.note||te.name,frequency:te.targetFreq||te.expectedFrequency,detectedFrequency:te.detectedFreq,cents:te.cents,grade:nt.evaluateNote(te.cents),targetFreq:te.targetFreq,diff:te.diff})),ie=b,se=(ie==null?void 0:ie.sessionHistory)||[],qe={timestamp:new Date,baseNote:z,baseFrequency:O,noteResults:ae,measuredNotes:o,accuracy:M,grade:nt.evaluateSession(oe)},Be=[...se,qe];e(21,le={mode:"continuous",timestamp:new Date,duration:60,totalNotes:u,measuredNotes:o,averageAccuracy:M,baseNote:z,baseFrequency:O,noteResults:ae,distribution:nt.calculateDistribution(oe),sessionHistory:Be,unifiedGrade:Y(Be)}),console.log("[UnifiedScore] çµ±åˆæ¡ç‚¹ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆå®Œäº†ï¼ˆå®Œå…¨ç‰ˆï¼‰:",le),fn()}async function fn(){if(!oe||oe.length===0){console.warn("ğŸ“Š [SessionStorage] ä¿å­˜ãƒ‡ãƒ¼ã‚¿ãªã—");return}try{console.log("ğŸ“Š [SessionStorage] ã‚»ãƒƒã‚·ãƒ§ãƒ³çµæœä¿å­˜é–‹å§‹");const o=oe.map(O=>({name:O.name,cents:O.cents,targetFreq:O.targetFreq||O.expectedFrequency,detectedFreq:O.detectedFreq,diff:O.diff,accuracy:typeof O.accuracy=="number"?O.accuracy:0})),u=We?Math.round((Date.now()-We)/1e3):60;await Rn(o,u,d,m)?(console.log("ğŸ“Š [SessionStorage] ã‚»ãƒƒã‚·ãƒ§ãƒ³çµæœä¿å­˜å®Œäº†"),console.log("ğŸ“Š [SessionStorage] ä¿å­˜å¾Œã®çŠ¶æ³:",{currentSession:n,totalSessions:y.length,isCompleted:s,nextBaseNote:d,nextBaseName:m})):console.error("ğŸ“Š [SessionStorage] ã‚»ãƒƒã‚·ãƒ§ãƒ³çµæœä¿å­˜å¤±æ•—")}catch(o){console.error("ğŸ“Š [SessionStorage] ã‚»ãƒƒã‚·ãƒ§ãƒ³ä¿å­˜ã‚¨ãƒ©ãƒ¼:",o)}}async function dn(){try{if(we){const o=y||[];for(const[S,M]of o.entries())if(M.noteResults&&M.noteResults.length>0){const z=M.baseFrequency||262;for(const O of M.noteResults)O.detectedFreq&&O.targetFreq&&await we.analyzePerformance({baseFreq:z,targetFreq:O.targetFreq,detectedFreq:O.detectedFreq,responseTime:2e3,volume:50,harmonicCorrection:null})}const u=we.generateDetailedReport();e(16,ze={totalScore:u.totalScore||0,grade:u.grade||"C",componentScores:u.componentScores||{accuracy:0,speed:0,consistency:0}}),u.intervalAnalysis&&u.intervalAnalysis.masteryLevels?e(3,ke=Object.entries(u.intervalAnalysis.masteryLevels).map(([S,M])=>{var z;return{type:S,mastery:Math.round(M),attempts:((z=u.intervalAnalysis.attemptCounts)==null?void 0:z[S])||0,accuracy:Math.round(M*.9)}})):e(3,ke=Mt(oe)),u.consistencyHistory&&Array.isArray(u.consistencyHistory)?e(17,Pe=u.consistencyHistory.map((S,M)=>({score:Math.round(S),timestamp:Date.now()-(u.consistencyHistory.length-M)*1e3}))):e(17,Pe=ht(oe)),e(18,Oe=pt(oe)||u.feedback),console.log("ğŸ¯ [generateEnhancedScoringData] æŠ€è¡“åˆ†æçµæœç”Ÿæˆã‚’é–‹å§‹"),console.log("ğŸ¯ [generateEnhancedScoringData] results:",u),e(19,Xe=mn(u)),console.log("ğŸ¯ [generateEnhancedScoringData] technicalFeedbackDataçµæœ:",Xe),e(20,Fe={totalAttempts:u.totalAttempts||oe.length,successRate:u.successRate||oe.filter(S=>S.accuracy!=="notMeasured").length/oe.length*100,averageScore:u.totalScore||(le==null?void 0:le.averageAccuracy)||0,bestScore:Math.max(u.totalScore||0,Fe.bestScore||0),sessionDuration:Math.round(60),streakCount:u.streak||0,fatigueLevel:u.fatigueLevel||"normal",mostDifficultInterval:u.mostDifficultInterval||"æœªç‰¹å®š",mostSuccessfulInterval:u.mostSuccessfulInterval||"æœªç‰¹å®š",averageResponseTime:u.averageResponseTime||2.5,sessionStart:Date.now()-6e4})}else yt();console.log("[EnhancedScoring] è¿½åŠ æ¡ç‚¹ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆå®Œäº†")}catch(o){console.error("[EnhancedScoring] ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆã‚¨ãƒ©ãƒ¼:",o),yt()}}function yt(){const o=oe.filter(S=>S.accuracy!=="notMeasured"),u=(le==null?void 0:le.averageAccuracy)||0;e(16,ze={totalScore:Math.round(u*.8),grade:u>=90?"A":u>=80?"B":u>=70?"C":"D",componentScores:{accuracy:u,speed:85,consistency:Math.max(60,u-10)}}),e(3,ke=Mt(oe)),e(17,Pe=ht()),e(18,Oe=pt(oe)),e(20,Fe={totalAttempts:oe.length,successRate:o.length/oe.length*100,averageScore:u,bestScore:u,sessionDuration:60,streakCount:0,fatigueLevel:"normal",mostDifficultInterval:"æœªåˆ†æ",mostSuccessfulInterval:"æœªåˆ†æ",averageResponseTime:2.5,sessionStart:Date.now()-6e4})}function ht(o){const u=(le==null?void 0:le.averageAccuracy)||70;return Array.from({length:8},(S,M)=>({score:Math.max(30,Math.min(100,u+(Math.random()-.5)*20)),timestamp:Date.now()-(8-M)*7500}))}function pt(o){const u=o.filter(et=>et.accuracy!=="notMeasured").length,S=(le==null?void 0:le.averageAccuracy)||0,M=8,z=y||[],O=z.length,ae={type:"info",categories:[{name:"éŸ³ç¨‹ç²¾åº¦",icon:"Target",score:S,message:`${S}%ã®ç²¾åº¦ã§éŸ³ç¨‹ã‚’æ‰ãˆã¦ã„ã¾ã™`},{name:"æ¸¬å®šæˆåŠŸç‡",icon:"Mic",score:Math.round(u/o.length*100),message:`${o.length}éŸ³ä¸­${u}éŸ³ã‚’æ­£å¸¸ã«æ¸¬å®š`}]};if(O<M)return ae;let ie,se,qe;const Be=(le==null?void 0:le.unifiedGrade)||"E",te=z.length;let Ne=0,he=0,pe=0;z.forEach(et=>{et.grade==="excellent"?Ne++:et.grade==="good"?he++:et.grade==="pass"&&pe++});const be=te>0?Math.round(Ne/te*100):0,$e=te>0?Math.round((Ne+he+pe)/te*100):0,De=te>0?Math.round((Ne+he+pe)/te*100):0;switch(Be){case"S":ie="excellent",se="éŸ³æ¥½å®¶ãƒ¬ãƒ™ãƒ«ã®ç›¸å¯¾éŸ³æ„Ÿã‚’é”æˆï¼",qe=`å„ªç§€ç‡${be}%è¶…ãˆã®å®ŸåŠ›ã‚’è¨¼æ˜ã•ã‚Œã¾ã—ãŸã€‚`;break;case"A":ie="excellent",se="ã‚¨ã‚­ã‚¹ãƒ‘ãƒ¼ãƒˆãƒ¬ãƒ™ãƒ«åˆ°é”ï¼",qe=`å„ªç§€ç‡${be}%ã®å®‰å®šã—ãŸéŸ³æ„Ÿèƒ½åŠ›ã§ã™ã€‚`;break;case"B":ie="improvement",se="ãƒ—ãƒ­ãƒ•ã‚£ã‚·ã‚¨ãƒ³ãƒˆç´šé”æˆï¼",qe=`è‰¯å¥½ç‡${$e}%ã®ç¢ºå®Ÿãªé€²æ­©ã‚’ç¤ºã—ã¦ã„ã¾ã™ã€‚`;break;case"C":ie="improvement",se="ã‚¢ãƒ‰ãƒãƒ³ã‚¹ç´šåˆ°é”ï¼",qe=`åˆæ ¼ç‡${De}%ã§ç€å®Ÿã«æˆé•·ä¸­ã§ã™ã€‚`;break;case"D":ie="practice",se="ç¶™ç¶šç·´ç¿’ã§å¿…ãšä¸Šé”ï¼",qe=`ç¾åœ¨ã®åˆæ ¼ç‡${De}%ã‹ã‚‰ç›®æ¨™70%ã¸å‘ã‘ã¦ç·´ç¿’ã‚’ç¶šã‘ã¾ã—ã‚‡ã†ã€‚`;break;case"E":default:ie="encouragement",se="Eç´šãƒ“ã‚®ãƒŠãƒ¼",qe="ç·´ç¿’é–‹å§‹æ®µéšã§ã™ã€‚ç¶™ç¶šçš„ãªç·´ç¿’ã§å¿…ãšä¸Šé”ã—ã¾ã™ã€‚";break}return{...ae,type:ie,primary:se,summary:qe}}function mn(o){var Be,te,Ne;if((y||[]).length<8||!o)return null;const z=o.improvements||[];(Be=o.detailed)!=null&&Be.statistics;const O=[];let ae=0,ie=0;if((te=o.detailed)!=null&&te.intervals){const he=o.detailed.intervals;if(he.totalAnalyses>0){let pe=0,be=0;for(const[$e,De]of Object.entries(he.masteryLevels))De.attempts>0&&(pe+=De.averageAccuracy*De.attempts,be+=De.attempts);ae=be>0?pe/be:0}}if((Ne=o.detailed)!=null&&Ne.directions){const he=o.detailed.directions;if(he.totalAnalyses>0){let pe=0,be=0;for(const[$e,De]of Object.entries(he.masteryData))De.attempts>0&&(pe+=De.averageAccuracy*De.attempts,be+=De.attempts);ie=be>0?pe/be:0}}O.push({category:"improvements",text:`éŸ³ç¨‹ç²¾åº¦: ${Math.round(ae)}%ã€€ï¼ˆéŸ³ã®é«˜ã•ã‚’æ‰ãˆã‚‹æ­£ç¢ºæ€§ã€€ç›®æ¨™åŸºæº–ï¼š70ã€œ85%ï¼‰`}),O.push({category:"improvements",text:`æ–¹å‘æ€§: ${Math.round(ie)}%ã€€ï¼ˆéŸ³ç¨‹ã®ä¸Šä¸‹åˆ¤æ–­ã®ç²¾åº¦ã€€ç›®æ¨™åŸºæº–ï¼š80ã€œ90%ï¼‰`});const se=z.map(he=>({category:"tips",text:he.message})),qe=z.flatMap(he=>(he.actions||[]).map(pe=>({category:"practice",text:pe})));return[...O,...se,...qe],{type:"info",primary:"è©³ç´°åˆ†æçµæœ",summary:"éŸ³ç¨‹ç²¾åº¦ãƒ»ä¸€è²«æ€§ãƒ»æ–¹å‘æ€§ã®ç·åˆåˆ†æ",details:O}}kn(async()=>{if(!(typeof localStorage<"u"?localStorage.getItem("mic-test-completed"):null)){console.log("ğŸš« [RandomTraining] ãƒã‚¤ã‚¯ãƒ†ã‚¹ãƒˆæœªå®Œäº† - æº–å‚™ç”»é¢è¡¨ç¤º"),st();return}console.log("ğŸ“Š [SessionStorage] ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†åˆæœŸåŒ–é–‹å§‹");try{if(await bt()){if(console.log("ğŸ“Š [SessionStorage] ã‚»ãƒƒã‚·ãƒ§ãƒ³é€²è¡ŒçŠ¶æ³ã®èª­ã¿è¾¼ã¿å®Œäº†"),console.log("ğŸ“Š [SessionStorage] ç¾åœ¨ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³:",n,"/ 8"),console.log("ğŸ“Š [SessionStorage] æ¬¡ã®åŸºéŸ³:",d,"(",m,")"),console.log("ğŸ“Š [SessionStorage] å®Œäº†çŠ¶æ³:",s?"8ã‚»ãƒƒã‚·ãƒ§ãƒ³å®Œäº†":`æ®‹ã‚Š${l}ã‚»ãƒƒã‚·ãƒ§ãƒ³`),s&&(console.log("ğŸ”„ [SessionStorage] 8ã‚»ãƒƒã‚·ãƒ§ãƒ³å®Œäº†æ¤œå‡º - æ–°ã‚µã‚¤ã‚¯ãƒ«é–‹å§‹å‡¦ç†"),await tt()?console.log("âœ… [SessionStorage] æ–°ã‚µã‚¤ã‚¯ãƒ«é–‹å§‹å®Œäº† - ã‚»ãƒƒã‚·ãƒ§ãƒ³1/8ã‹ã‚‰å†é–‹"):console.warn("âš ï¸ [SessionStorage] æ–°ã‚µã‚¤ã‚¯ãƒ«é–‹å§‹å‡¦ç†ãŒå¤±æ•—")),n>1&&!s){console.warn("ğŸ”„ [SessionStorage] ã‚»ãƒƒã‚·ãƒ§ãƒ³é€”ä¸­ã§ã®ãƒªãƒ­ãƒ¼ãƒ‰æ¤œå‡º - ã‚»ãƒƒã‚·ãƒ§ãƒ³1ã‹ã‚‰å†é–‹"),console.warn("ğŸ”„ [SessionStorage] ç¾åœ¨:",n,"ã‚»ãƒƒã‚·ãƒ§ãƒ³ç›® â†’ ãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã‚¢ã‚¯ã‚»ã‚¹èª˜å°");const{SessionStorageManager:S}=await wn(async()=>{const{SessionStorageManager:O}=await import("../chunks/Dc-to5eN.js").then(ae=>ae.y);return{SessionStorageManager:O}},__vite__mapDeps([0,1,2,3,4,5]),import.meta.url),M=S.getInstance();typeof localStorage<"u"&&(localStorage.removeItem("random-training-progress"),localStorage.removeItem("random-training-progress-backup"));const{resetProgress:z}=await wn(async()=>{const{resetProgress:O}=await import("../chunks/Dc-to5eN.js").then(ae=>ae.z);return{resetProgress:O}},__vite__mapDeps([0,1,2,3,4,5]),import.meta.url);await z(),console.log("ğŸ”„ [SessionStorage] localStorage + ã‚¹ãƒˆã‚¢çŠ¶æ…‹å®Œå…¨ãƒªã‚»ãƒƒãƒˆå®Œäº†"),st();return}}else console.log("ğŸ“Š [SessionStorage] æ–°è¦ã‚»ãƒƒã‚·ãƒ§ãƒ³é–‹å§‹")}catch(u){console.error("ğŸ“Š [SessionStorage] åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼:",u)}if(rn(),an(),f.url.searchParams.get("from")==="microphone-test"){console.log("ğŸ¤ [RandomTraining] ãƒã‚¤ã‚¯ãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸ã‹ã‚‰ã®é·ç§»ã‚’æ¤œå‡º");const u=new URL(window.location);if(u.searchParams.delete("from"),window.history.replaceState({},"",u),e(1,w="granted"),e(0,k="setup"),console.log('ğŸ¤ [RandomTraining] microphoneState="granted", trainingPhase="setup" ã«è¨­å®š'),!xe){console.log("ğŸ¤ [RandomTraining] AudioManagerãƒªã‚½ãƒ¼ã‚¹å–å¾—é–‹å§‹");try{const S=await Ue.initialize();rt=S.audioContext,xe=S.mediaStream,at=S.sourceNode,console.log("ğŸ¤ [RandomTraining] AudioManagerãƒªã‚½ãƒ¼ã‚¹å–å¾—å®Œäº†")}catch(S){console.warn("âš ï¸ AudioManagerãƒªã‚½ãƒ¼ã‚¹å–å¾—å¤±æ•—ï¼ˆå¾Œã§å†è©¦è¡Œï¼‰:",S)}}if(await new Promise(S=>setTimeout(S,300)),re&&re.getIsInitialized&&!re.getIsInitialized())try{console.log("ğŸ™ï¸ [RandomTraining] PitchDetectoråˆæœŸåŒ–é–‹å§‹");const S=Ue.getStatus();console.log("ğŸ” [RandomTraining] AudioManagerçŠ¶æ…‹:",S),(!S.isInitialized||!S.mediaStreamActive)&&(console.log("ğŸ”„ [RandomTraining] AudioManagerçŠ¶æ…‹ä¸è‰¯ - å†åˆæœŸåŒ–å®Ÿè¡Œ"),await Ue.initialize()),await re.initialize(),console.log("âœ… [RandomTraining] PitchDetectoråˆæœŸåŒ–å®Œäº†")}catch(S){console.warn("âš ï¸ PitchDetectoråˆæœŸåŒ–å¤±æ•—:",S)}}else await new Promise(u=>setTimeout(u,100)),st()});function gn(o){const{frequency:u,note:S,volume:M,rawVolume:z,clarity:O}=o.detail;let ae=u,ie=S;if(k==="guiding"&&D&&_>0&&u>0){const se=yn(u);se&&(ae=se.frequency,ie=se.note)}e(14,Ee=ae),e(15,Le=ie),e(13,Se=M),_>0&&ae>0?Ve=Math.round(1200*Math.log2(ae/_)):Ve=0,hn(u),we&&u>0&&_>0&&sn(u,S)}function yn(o){if(!o||o<=0||!D||!_||Se<25)return null;const S=T-1;if(S<0||S>=q.length)return null;const M=Ye(_,S);if(!M||M<=0)return null;const O=It(o,M).correctedFrequency,ae=Pn(O);return{frequency:Math.round(O),note:ae}}function hn(o,u){if(!o||o<=0||!D)return;if(!_||_<=0){console.error(`âŒ [æ¡ç‚¹ã‚¨ãƒ©ãƒ¼] åŸºéŸ³å‘¨æ³¢æ•°ãŒç„¡åŠ¹: ${_}Hz`),console.error(`âŒ [æ¡ç‚¹ã‚¨ãƒ©ãƒ¼] åŸºéŸ³å: ${C}`),console.error(`âŒ [æ¡ç‚¹ã‚¨ãƒ©ãƒ¼] activeStepIndex: ${T-1}`),console.error(`âŒ [æ¡ç‚¹ã‚¨ãƒ©ãƒ¼] trainingPhase: ${k}`),console.error(`âŒ [æ¡ç‚¹ã‚¨ãƒ©ãƒ¼] isGuideAnimationActive: ${D}`);return}if(Se<25)return;const M=T-1;if(M<0||M>=q.length)return;M>=4&&ce.debug(`[æ¡ç‚¹ãƒ‡ãƒãƒƒã‚°] activeStepIndex=${M} (${q[M].name}), currentBaseFrequency=${_}Hz`);const z=Ye(_,M);if(M>=0&&ce.debug(`[éŸ³ç¨‹è¨ˆç®—ä¿®æ­£ç‰ˆ] ${q[M].name}: æœŸå¾…å‘¨æ³¢æ•° ${z.toFixed(1)}Hz`),!z||z<=0||!isFinite(z)){console.error("âŒ [æ¡ç‚¹ã‚¨ãƒ©ãƒ¼] æœŸå¾…å‘¨æ³¢æ•°è¨ˆç®—ã‚¨ãƒ©ãƒ¼:"),console.error(`   åŸºéŸ³å‘¨æ³¢æ•°: ${_}Hz`),console.error(`   éŸ³éšã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹: ${M}`),console.error(`   æœŸå¾…å‘¨æ³¢æ•°: ${z}Hz`);return}const O=It(o,z),ae=O.correctedFrequency,ie=O.factor,se=Math.round(1200*Math.log2(ae/z));if((Math.abs(se)>200||ie!==1)&&(ce.debug(`[ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—å¼è£œæ­£] ${q[M].name}:`),console.warn(`   æ¤œå‡ºå‘¨æ³¢æ•°: ${o.toFixed(1)}Hz`),console.warn(`   è£œæ­£å¾Œå‘¨æ³¢æ•°: ${ae.toFixed(1)}Hz`),console.warn(`   æœŸå¾…å‘¨æ³¢æ•°: ${z.toFixed(1)}Hz`),console.warn(`   ã‚»ãƒ³ãƒˆå·®: ${se}Â¢`),console.warn(`   è£œæ­£ä¿‚æ•°: ${ie} (${O.description})`),console.warn(`   åŸºéŸ³: ${C} (${_.toFixed(1)}Hz)`)),!isFinite(se)){console.error("âŒ [æ¡ç‚¹ã‚¨ãƒ©ãƒ¼] ã‚»ãƒ³ãƒˆè¨ˆç®—ã‚¨ãƒ©ãƒ¼:"),console.error(`   æ¤œå‡ºå‘¨æ³¢æ•°: ${o}Hz`),console.error(`   æœŸå¾…å‘¨æ³¢æ•°: ${z}Hz`),console.error(`   ã‚»ãƒ³ãƒˆå·®: ${se}`);return}const Be=Math.abs(se)<=50;if(Se>=15){const he=Math.max(0,Math.round(100-Math.abs(se))),pe=ne.findIndex($e=>$e.stepIndex===M),be={stepIndex:M,stepName:q[M].name,expectedFrequency:Math.round(z),detectedFrequency:Math.round(o),adjustedFrequency:Math.round(ae),centDifference:se,accuracy:he,isCorrect:Be,correctionFactor:ie,correctionDescription:O.description,timestamp:Date.now()};pe>=0?ne[pe]=be:ne.push(be),ne.length%4===0&&ce.realtime(`æ¡ç‚¹é€²æ—: ${ne.length}/${q.length}ã‚¹ãƒ†ãƒƒãƒ—å®Œäº†`)}}function go(){e(0,k="results"),He.isCompleted=!0,He.averageAccuracy=Math.round(He.correctCount/He.totalCount*100),re&&re.stopDetection(),qn()}async function pn(){if(s){console.warn("ğŸš« [RestartSame] 8ã‚»ãƒƒã‚·ãƒ§ãƒ³å®Œäº†çŠ¶æ…‹ã§ã¯å†æŒ‘æˆ¦ä¸å¯ - æ–°ã‚µã‚¤ã‚¯ãƒ«é–‹å§‹ãŒå¿…è¦"),await tt()?(console.log("âœ… [RestartSame] æ–°ã‚µã‚¤ã‚¯ãƒ«é–‹å§‹å®Œäº† - ã‚»ãƒƒã‚·ãƒ§ãƒ³1/8ã‹ã‚‰å†é–‹"),window.location.reload()):console.error("âŒ [RestartSame] æ–°ã‚µã‚¤ã‚¯ãƒ«é–‹å§‹å¤±æ•—");return}ot(),e(0,k="setup"),B&&(clearTimeout(B),B=null),re&&re.resetDisplayState&&re.resetDisplayState(),ct(),console.log("ğŸ”„ [RestartSame] åŒã˜åŸºéŸ³ã§å†æŒ‘æˆ¦:",C,_+"Hz"),console.log("ğŸ”„ [RestartSame] åŸºéŸ³æƒ…å ±ä¿æŒå®Œäº† - ãƒ¦ãƒ¼ã‚¶ãƒ¼æ“ä½œå¾…æ©Ÿ")}async function vn(){if(s){console.warn("ğŸš« [RestartDifferent] 8ã‚»ãƒƒã‚·ãƒ§ãƒ³å®Œäº†çŠ¶æ…‹ã§ã¯å†æŒ‘æˆ¦ä¸å¯ - æ–°ã‚µã‚¤ã‚¯ãƒ«é–‹å§‹ãŒå¿…è¦"),await tt()?(console.log("âœ… [RestartDifferent] æ–°ã‚µã‚¤ã‚¯ãƒ«é–‹å§‹å®Œäº† - ã‚»ãƒƒã‚·ãƒ§ãƒ³1/8ã‹ã‚‰å†é–‹"),window.location.reload()):console.error("âŒ [RestartDifferent] æ–°ã‚µã‚¤ã‚¯ãƒ«é–‹å§‹å¤±æ•—");return}ot(),e(0,k="setup"),B&&(clearTimeout(B),B=null),e(7,C=""),e(8,_=0),console.log("ğŸ”„ [restartDifferentBaseNote] åŸºéŸ³æƒ…å ±ã‚’ãƒªã‚»ãƒƒãƒˆã—ã¾ã—ãŸ"),re&&re.resetDisplayState&&re.resetDisplayState(),ct()}function ct(){T=0,D=!1,ne=[],e(10,q=q.map(o=>({...o,state:"inactive",completed:!1})))}async function _n(){console.log("ğŸš€ [StartNewCycle] 8ã‚»ãƒƒã‚·ãƒ§ãƒ³å®Œäº†å¾Œã®æœ€åˆã‹ã‚‰æŒ‘æˆ¦é–‹å§‹");try{await tt()?(console.log("âœ… [StartNewCycle] æ–°ã‚µã‚¤ã‚¯ãƒ«é–‹å§‹å®Œäº†"),localStorage.getItem("mic-test-completed")?(console.log("âœ… [StartNewCycle] ãƒã‚¤ã‚¯ãƒ†ã‚¹ãƒˆå®Œäº†ãƒ•ãƒ©ã‚°ç¢ºèª - ãƒªãƒ­ãƒ¼ãƒ‰ãªã—ã§çŠ¶æ…‹ãƒªã‚»ãƒƒãƒˆ"),ot(),await bt(),e(0,k="setup"),ct(),dt(),console.log("âœ… [StartNewCycle] çŠ¶æ…‹ãƒªã‚»ãƒƒãƒˆå®Œäº† - ã‚»ãƒƒã‚·ãƒ§ãƒ³1/8ã‹ã‚‰å†é–‹")):window.location.reload()):(console.error("âŒ [StartNewCycle] æ–°ã‚µã‚¤ã‚¯ãƒ«é–‹å§‹å¤±æ•—"),Ze())}catch(o){console.error("âŒ [StartNewCycle] æ–°ã‚µã‚¤ã‚¯ãƒ«é–‹å§‹ã‚¨ãƒ©ãƒ¼:",o),Ze()}}function Sn(o){const{type:u}=o.detail;switch(u){case"same":pn();break;case"different":vn();break;case"restart":_n();break;case"home":Ze();break;default:console.warn("ğŸš« [ActionButtons] æœªçŸ¥ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚¿ã‚¤ãƒ—:",u)}}function bn(){console.log("âš¡ [ContinuousMode] 8ã‚»ãƒƒã‚·ãƒ§ãƒ³é€£ç¶šé–‹å§‹"),mt()}function qn(){console.log("âœ… [ContinuousMode] ã‚»ãƒƒã‚·ãƒ§ãƒ³å®Œäº†:",n),n<8?setTimeout(()=>{console.log("ğŸ”„ [ContinuousMode] æ¬¡ã‚»ãƒƒã‚·ãƒ§ãƒ³è‡ªå‹•é–‹å§‹æº–å‚™:",n+1),e(0,k="setup"),He={isCompleted:!1,correctCount:0,totalCount:0,averageAccuracy:0},e(9,J=!1),re&&(console.log("ğŸ¤ [ContinuousMode] éŸ³ç¨‹æ¤œå‡ºå†é–‹"),re.startDetection()),console.log("ğŸµ [ContinuousMode] æ¬¡ã®åŸºéŸ³è‡ªå‹•å†ç”Ÿé–‹å§‹"),mt()},5e3):(console.log("ğŸ‰ [ContinuousMode] 8ã‚»ãƒƒã‚·ãƒ§ãƒ³å®Œäº†ï¼"),setTimeout(()=>{console.log("ğŸ† [ContinuousMode] ç·åˆè©•ä¾¡ç”»é¢è¡¨ç¤ºå®Œäº†")},1e3))}function Dn(o){const{healthy:u,errors:S,details:M}=o.detail;e(2,H=u),e(6,E=S),u||(console.warn("âš ï¸ ãƒã‚¤ã‚¯ã®å¥åº·çŠ¶æ…‹ãŒæ‚ªåŒ–:",S),k==="guiding"&&(e(0,k="setup"),console.warn("ğŸ›‘ ãƒã‚¤ã‚¯å•é¡Œã«ã‚ˆã‚Šãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã‚’åœæ­¢")))}Cn(()=>{console.log("ğŸ”„ [RandomTraining] onDestroy - AudioManagerãƒªã‚½ãƒ¼ã‚¹ã¯ä¿æŒ"),ue&&(ue.dispose(),e(32,ue=null))});const yo=[];Oo.keys(t).forEach(o=>{!~yo.indexOf(o)&&o.slice(0,2)!=="$$"&&o!=="slot"&&Go.warn(`<Page> was created with unknown prop '${o}'`)});function ho(o){qo[o?"unshift":"push"](()=>{re=o,e(22,re)})}return r.$capture_state=()=>({onMount:kn,onDestroy:Cn,goto:vt,base:it,page:_t,ChevronRight:Ho,Music:zn,Card:Qe,Button:ut,VolumeBar:wo,PitchDisplay:Vo,PitchDetector:Hn,PitchDetectionDisplay:Vn,PageLayout:Bn,Tone:Bo,audioManager:Ue,harmonicCorrection:St,logger:ce,ScoreResultPanel:xo,IntervalProgressTracker:Po,ConsistencyGraph:Eo,FeedbackDisplay:Io,SessionStatistics:Mo,UnifiedScoreResultFixed:Xt,ActionButtons:Qt,EvaluationEngine:nt,EnhancedScoringEngine:Nn,trainingProgress:At,currentSessionId:Nt,nextBaseNote:Rt,nextBaseName:Ft,isLoading:Ct,storageError:To,isCompleted:kt,sessionHistory:wt,overallGrade:Ao,overallAccuracy:No,progressPercentage:Ro,remainingSessions:Dt,latestSessionResult:Fo,unifiedScoreData:qt,loadProgress:bt,saveSessionResult:Rn,resetProgress:Co,createNewProgress:ko,startNewCycleIfCompleted:tt,getVolumeForDevice:In,calculateUnifiedGrade:Y,generateTestUnifiedScoreData:Uo,trainingPhase:k,microphoneState:w,microphoneHealthy:H,microphoneErrors:E,buildVersion:Wt,buildTimestamp:Jt,updateStatus:Kt,SCALE_NAMES:K,currentBaseNote:C,currentBaseFrequency:_,isPlaying:J,currentScaleIndex:T,scaleSteps:q,guideAnimationTimer:B,isGuideAnimationActive:D,guideStartProgress:V,isGuideStartBarActive:I,guideStartTimer:Q,musicIconGlowing:ye,scaleEvaluations:ne,previousEvaluations:_e,currentVolume:Se,currentFrequency:Ee,detectedNote:Le,pitchDifference:Ve,sessionResults:He,scoringEngine:we,currentScoreData:ze,intervalData:ke,consistencyData:Pe,feedbackData:Oe,technicalFeedbackData:Xe,sessionStatistics:Fe,activeTab:ft,noteResultsForDisplay:oe,currentUnifiedScoreData:le,sampler:ue,isSamplerLoading:Re,pitchDetectorComponent:re,mediaStream:xe,audioContext:rt,sourceNode:at,sessionStartTime:We,baseNotes:Ge,checkMicrophonePermission:Je,selectRandomBaseNote:dt,playRandomBaseNote:Yt,playCurrentBaseNote:Zt,playBaseNoteOnly:io,playBaseNote:mt,startGuideStartBar:$t,cleanupGuideStartBar:lo,calculateExpectedFrequency:Ye,calculateTargetFrequency:en,startGuideAnimation:gt,finishGuideAnimation:tn,calculateFinalResults:nn,getStatusMessage:uo,getDisplayEvaluations:fo,goToMicrophoneTest:on,goHome:Ze,initializeSampler:rn,checkExistingMicrophonePermission:st,initializeScoringEngine:an,updateScoringEngine:sn,generateFinalScoring:cn,generateTestScoreData:ln,switchTab:mo,generateUnifiedScoreData:un,saveSessionToStorage:fn,generateEnhancedScoringData:dn,generateFallbackEnhancedData:yt,generateIntervalDataFromResults:Mt,generateIntervalDataFromSessionHistory:En,generateConsistencyDataFromResults:ht,generateFeedbackFromResults:pt,generateTechnicalFeedbackFromEnhancedEngine:mn,handlePitchUpdate:gn,getEvaluationCorrectedFrequency:yn,frequencyToNote:Pn,multiStageOctaveCorrection:It,evaluateScaleStep:hn,completeSession:go,restartSameBaseNote:pn,restartDifferentBaseNote:vn,scrollToTop:ot,resetSessionState:ct,startNewCycle:_n,handleActionButtonClick:Sn,startContinuousMode:bn,handleSessionComplete:qn,handlePitchDetectorStateChange:so,handlePitchDetectorError:co,handleMicrophoneHealthChange:Dn,canRestartSession:c,canStartTraining:i,$currentSessionId:n,$unifiedScoreData:a,$isCompleted:s,$page:f,$remainingSessions:l,$nextBaseName:m,$nextBaseNote:d,$sessionHistory:y,$trainingProgress:b,$isLoading:h}),r.$inject_state=o=>{"trainingPhase"in o&&e(0,k=o.trainingPhase),"microphoneState"in o&&e(1,w=o.microphoneState),"microphoneHealthy"in o&&e(2,H=o.microphoneHealthy),"microphoneErrors"in o&&e(6,E=o.microphoneErrors),"currentBaseNote"in o&&e(7,C=o.currentBaseNote),"currentBaseFrequency"in o&&e(8,_=o.currentBaseFrequency),"isPlaying"in o&&e(9,J=o.isPlaying),"currentScaleIndex"in o&&(T=o.currentScaleIndex),"scaleSteps"in o&&e(10,q=o.scaleSteps),"guideAnimationTimer"in o&&(B=o.guideAnimationTimer),"isGuideAnimationActive"in o&&(D=o.isGuideAnimationActive),"guideStartProgress"in o&&e(11,V=o.guideStartProgress),"isGuideStartBarActive"in o&&(I=o.isGuideStartBarActive),"guideStartTimer"in o&&(Q=o.guideStartTimer),"musicIconGlowing"in o&&e(12,ye=o.musicIconGlowing),"scaleEvaluations"in o&&(ne=o.scaleEvaluations),"previousEvaluations"in o&&(_e=o.previousEvaluations),"currentVolume"in o&&e(13,Se=o.currentVolume),"currentFrequency"in o&&e(14,Ee=o.currentFrequency),"detectedNote"in o&&e(15,Le=o.detectedNote),"pitchDifference"in o&&(Ve=o.pitchDifference),"sessionResults"in o&&(He=o.sessionResults),"scoringEngine"in o&&(we=o.scoringEngine),"currentScoreData"in o&&e(16,ze=o.currentScoreData),"intervalData"in o&&e(3,ke=o.intervalData),"consistencyData"in o&&e(17,Pe=o.consistencyData),"feedbackData"in o&&e(18,Oe=o.feedbackData),"technicalFeedbackData"in o&&e(19,Xe=o.technicalFeedbackData),"sessionStatistics"in o&&e(20,Fe=o.sessionStatistics),"activeTab"in o&&(ft=o.activeTab),"noteResultsForDisplay"in o&&(oe=o.noteResultsForDisplay),"currentUnifiedScoreData"in o&&e(21,le=o.currentUnifiedScoreData),"sampler"in o&&e(32,ue=o.sampler),"isSamplerLoading"in o&&e(33,Re=o.isSamplerLoading),"pitchDetectorComponent"in o&&e(22,re=o.pitchDetectorComponent),"mediaStream"in o&&(xe=o.mediaStream),"audioContext"in o&&(rt=o.audioContext),"sourceNode"in o&&(at=o.sourceNode),"sessionStartTime"in o&&(We=o.sessionStartTime),"canRestartSession"in o&&(c=o.canRestartSession),"canStartTraining"in o&&(i=o.canStartTraining)},t&&"$$inject"in t&&r.$inject_state(t.$$inject),r.$$.update=()=>{r.$$.dirty[0]&6|r.$$.dirty[1]&6&&(i=w==="granted"&&!Re&&ue&&H),r.$$.dirty[0]&1&&(c=k==="results"),r.$$.dirty[0]&56&&a&&s&&a.sessionHistory&&(e(3,ke=En(a.sessionHistory)),console.log("ğŸµ [RandomTraining] intervalDataç”Ÿæˆå®Œäº†:",ke.length,"ä»¶")),r.$$.dirty[0]&3&&k==="setup"&&w==="granted"&&ot()},[k,w,H,ke,a,s,E,C,_,J,q,V,ye,Se,Ee,Le,ze,Pe,Oe,Xe,Fe,le,re,n,y,h,on,Ze,gn,Sn,bn,Dn,ue,Re,ho]}class or extends po{constructor(t){super(t),vo(this,t,Wo,Ut,_o,{},null,[-1,-1,-1,-1]),ee("SvelteRegisterComponent",{component:this,tagName:"Page",options:t,id:Ut.name})}}export{or as component,nr as universal};
