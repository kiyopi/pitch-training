import{S as me,i as ve,d as O,s as _e,L as se,n as Q,a as ye,E as ie,D as ge,b as y,M as we,f as N,g as v,z as C,h as q,F as Ce,m as L,j as k,k as M,A as z,p as P,o as b,I as le,e as X,l as J,t as K,K as te,J as oe}from"../chunks/C8Utt7Cv.js";import"../chunks/Bo3Gy9_l.js";const D="src/routes/microphone-test-simple/+page.svelte";function ae(o,e,t){const l=o.slice();return l[14]=e[t],l}function ue(o){let e,t="‚ùå „Éû„Ç§„ÇØ„Ç¢„ÇØ„Çª„Çπ„ÅåÊãíÂê¶„Åï„Çå„Åæ„Åó„Åü",l,c,s="ÂÜçË©¶Ë°å",a,n;const u={c:function(){e=b("div"),e.textContent=t,l=P(),c=b("button"),c.textContent=s,this.h()},l:function(r){e=k(r,"DIV",{class:!0,"data-svelte-h":!0}),z(e)!=="svelte-s607mk"&&(e.textContent=t),l=L(r),c=k(r,"BUTTON",{class:!0,"data-svelte-h":!0}),z(c)!=="svelte-1y0f8ey"&&(c.textContent=s),this.h()},h:function(){C(e,"class","status error svelte-63wsq3"),q(e,D,231,6,6639),C(c,"class","test-button svelte-63wsq3"),q(c,D,232,6,6695)},m:function(r,p){N(r,e,p),N(r,l,p),N(r,c,p),a||(n=te(c,"click",o[6],!1),a=!0)},p:Q,d:function(r){r&&(y(e),y(l),y(c)),a=!1,n()}};return O("SvelteRegisterBlock",{block:u,id:ue.name,type:"if",source:"(231:41) ",ctx:o}),u}function fe(o){let e,t="‚úÖ „Éû„Ç§„ÇØ„Ç¢„ÇØ„Çª„ÇπË®±ÂèØÊ∏à„Åø",l,c,s=o[1]&&Y(o);const a={c:function(){e=b("div"),e.textContent=t,l=P(),s&&s.c(),c=oe(),this.h()},l:function(u){e=k(u,"DIV",{class:!0,"data-svelte-h":!0}),z(e)!=="svelte-62ayz1"&&(e.textContent=t),l=L(u),s&&s.l(u),c=oe(),this.h()},h:function(){C(e,"class","status svelte-63wsq3"),q(e,D,224,6,6416)},m:function(u,h){N(u,e,h),N(u,l,h),s&&s.m(u,h),N(u,c,h)},p:function(u,h){u[1]?s?s.p(u,h):(s=Y(u),s.c(),s.m(c.parentNode,c)):s&&(s.d(1),s=null)},d:function(u){u&&(y(e),y(l),y(c)),s&&s.d(u)}};return O("SvelteRegisterBlock",{block:a,id:fe.name,type:"if",source:"(224:42) ",ctx:o}),a}function de(o){let e,t="‚è≥ „Éû„Ç§„ÇØË®±ÂèØ„ÇíÁ¢∫Ë™ç‰∏≠...";const l={c:function(){e=b("div"),e.textContent=t,this.h()},l:function(s){e=k(s,"DIV",{class:!0,"data-svelte-h":!0}),z(e)!=="svelte-1bxnxy3"&&(e.textContent=t),this.h()},h:function(){C(e,"class","status svelte-63wsq3"),q(e,D,222,6,6326)},m:function(s,a){N(s,e,a)},p:Q,d:function(s){s&&y(e)}};return O("SvelteRegisterBlock",{block:l,id:de.name,type:"if",source:"(222:42) ",ctx:o}),l}function he(o){let e,t="üé§ „Éû„Ç§„ÇØ„ÉÜ„Çπ„ÉàÈñãÂßã",l,c;const s={c:function(){e=b("button"),e.textContent=t,this.h()},l:function(n){e=k(n,"BUTTON",{class:!0,"data-svelte-h":!0}),z(e)!=="svelte-1f5wvo1"&&(e.textContent=t),this.h()},h:function(){C(e,"class","test-button svelte-63wsq3"),q(e,D,218,6,6183)},m:function(n,u){N(n,e,u),l||(c=te(e,"click",o[6],!1),l=!0)},p:Q,d:function(n){n&&y(e),l=!1,c()}};return O("SvelteRegisterBlock",{block:s,id:he.name,type:"if",source:"(218:4) {#if micPermission === 'initial'}",ctx:o}),s}function Y(o){let e,t="‚èπÔ∏è „ÉÜ„Çπ„ÉàÂÅúÊ≠¢",l,c;const s={c:function(){e=b("button"),e.textContent=t,this.h()},l:function(n){e=k(n,"BUTTON",{class:!0,"data-svelte-h":!0}),z(e)!=="svelte-11zhjx8"&&(e.textContent=t),this.h()},h:function(){C(e,"class","test-button svelte-63wsq3"),q(e,D,226,8,6488)},m:function(n,u){N(n,e,u),l||(c=te(e,"click",o[7],!1),l=!0)},p:Q,d:function(n){n&&y(e),l=!1,c()}};return O("SvelteRegisterBlock",{block:s,id:Y.name,type:"if",source:"(226:6) {#if isListening}",ctx:o}),s}function Z(o){let e,t,l,c="Èü≥Èáè„É¨„Éô„É´",s,a,n,u,h,r=o[2].toFixed(1)+"",p,x,A,w,_,j="Âë®Ê≥¢Êï∞Ê§úÂá∫",V,I,T=o[3].toFixed(1)+"",i,d,S,g,R;const E={c:function(){e=b("div"),t=b("div"),l=b("h3"),l.textContent=c,s=P(),a=b("div"),n=b("div"),u=P(),h=b("div"),p=K(r),x=K("%"),A=P(),w=b("div"),_=b("h3"),_.textContent=j,V=P(),I=b("div"),i=K(T),d=K(" Hz"),S=P(),g=b("div"),R=K(o[4]),this.h()},l:function(F){e=k(F,"DIV",{class:!0});var f=M(e);t=k(f,"DIV",{class:!0});var B=M(t);l=k(B,"H3",{class:!0,"data-svelte-h":!0}),z(l)!=="svelte-etucpw"&&(l.textContent=c),s=L(B),a=k(B,"DIV",{class:!0});var W=M(a);n=k(W,"DIV",{class:!0,style:!0}),M(n).forEach(y),W.forEach(y),u=L(B),h=k(B,"DIV",{class:!0});var U=M(h);p=J(U,r),x=J(U,"%"),U.forEach(y),B.forEach(y),A=L(f),w=k(f,"DIV",{class:!0});var H=M(w);_=k(H,"H3",{class:!0,"data-svelte-h":!0}),z(_)!=="svelte-1yfwvfq"&&(_.textContent=j),V=L(H),I=k(H,"DIV",{class:!0});var G=M(I);i=J(G,T),d=J(G," Hz"),G.forEach(y),S=L(H),g=k(H,"DIV",{class:!0});var ne=M(g);R=J(ne,o[4]),ne.forEach(y),H.forEach(y),f.forEach(y),this.h()},h:function(){C(l,"class","svelte-63wsq3"),q(l,D,241,8,6892),C(n,"class","volume-bar svelte-63wsq3"),le(n,"width",o[2]+"%"),q(n,D,243,10,6960),C(a,"class","volume-bar-container svelte-63wsq3"),q(a,D,242,8,6915),C(h,"class","volume-text svelte-63wsq3"),q(h,D,245,8,7046),C(t,"class","volume-display svelte-63wsq3"),q(t,D,240,6,6855),C(_,"class","svelte-63wsq3"),q(_,D,249,8,7171),C(I,"class","frequency-text svelte-63wsq3"),q(I,D,250,8,7194),C(g,"class","note-text svelte-63wsq3"),q(g,D,251,8,7269),C(w,"class","frequency-display svelte-63wsq3"),q(w,D,248,6,7131),C(e,"class","results svelte-63wsq3"),q(e,D,239,4,6827)},m:function(F,f){N(F,e,f),v(e,t),v(t,l),v(t,s),v(t,a),v(a,n),v(t,u),v(t,h),v(h,p),v(h,x),v(e,A),v(e,w),v(w,_),v(w,V),v(w,I),v(I,i),v(I,d),v(w,S),v(w,g),v(g,R)},p:function(F,f){f&4&&le(n,"width",F[2]+"%"),f&4&&r!==(r=F[2].toFixed(1)+"")&&X(p,r),f&8&&T!==(T=F[3].toFixed(1)+"")&&X(i,T),f&16&&X(R,F[4])},d:function(F){F&&y(e)}};return O("SvelteRegisterBlock",{block:E,id:Z.name,type:"if",source:"(239:2) {#if isListening}",ctx:o}),E}function $(o){let e,t=o[14]+"",l;const c={c:function(){e=b("div"),l=K(t),this.h()},l:function(a){e=k(a,"DIV",{class:!0});var n=M(e);l=J(n,t),n.forEach(y),this.h()},h:function(){C(e,"class","log-entry svelte-63wsq3"),q(e,D,260,8,7457)},m:function(a,n){N(a,e,n),v(e,l)},p:function(a,n){n&32&&t!==(t=a[14]+"")&&X(l,t)},d:function(a){a&&y(e)}};return O("SvelteRegisterBlock",{block:c,id:$.name,type:"each",source:"(260:6) {#each logs as log}",ctx:o}),c}function ee(o){let e,t,l,c,s="„Ç∑„É≥„Éó„É´„Éû„Ç§„ÇØ„ÉÜ„Çπ„Éà",a,n,u="Ëá™‰Ωú„Ç≥„É≥„Éù„Éº„Éç„É≥„Éà‰∏ç‰ΩøÁî®„ÉªÊúÄÂ∞èÈôêÂÆüË£Ö„ÅÆ„ÉÜ„Çπ„Éà„Éö„Éº„Ç∏",h,r,p,x,A,w,_="„É≠„Ç∞ÔºàÊúÄÊñ∞20‰ª∂Ôºâ",j,V;function I(E,m){if(E[0]==="initial")return he;if(E[0]==="pending")return de;if(E[0]==="granted")return fe;if(E[0]==="denied")return ue}let T=I(o),i=T&&T(o),d=o[1]&&Z(o),S=se(o[5]),g=[];for(let E=0;E<S.length;E+=1)g[E]=$(ae(o,S,E));const R={c:function(){e=P(),t=b("div"),l=b("div"),c=b("h1"),c.textContent=s,a=P(),n=b("p"),n.textContent=u,h=P(),r=b("div"),i&&i.c(),p=P(),d&&d.c(),x=P(),A=b("div"),w=b("h3"),w.textContent=_,j=P(),V=b("div");for(let m=0;m<g.length;m+=1)g[m].c();this.h()},l:function(m){Ce("svelte-tme954",document.head).forEach(y),e=L(m),t=k(m,"DIV",{class:!0});var f=M(t);l=k(f,"DIV",{class:!0});var B=M(l);c=k(B,"H1",{class:!0,"data-svelte-h":!0}),z(c)!=="svelte-ruw81a"&&(c.textContent=s),a=L(B),n=k(B,"P",{class:!0,"data-svelte-h":!0}),z(n)!=="svelte-n2w7hi"&&(n.textContent=u),B.forEach(y),h=L(f),r=k(f,"DIV",{class:!0});var W=M(r);i&&i.l(W),W.forEach(y),p=L(f),d&&d.l(f),x=L(f),A=k(f,"DIV",{class:!0});var U=M(A);w=k(U,"H3",{class:!0,"data-svelte-h":!0}),z(w)!=="svelte-1w4c8w2"&&(w.textContent=_),j=L(U),V=k(U,"DIV",{class:!0});var H=M(V);for(let G=0;G<g.length;G+=1)g[G].l(H);H.forEach(y),U.forEach(y),f.forEach(y),this.h()},h:function(){document.title="„Ç∑„É≥„Éó„É´„Éû„Ç§„ÇØ„ÉÜ„Çπ„Éà - Áõ∏ÂØæÈü≥ÊÑü„Éà„É¨„Éº„Éã„É≥„Ç∞",C(c,"class","svelte-63wsq3"),q(c,D,212,4,6040),C(n,"class","svelte-63wsq3"),q(n,D,213,4,6064),C(l,"class","header svelte-63wsq3"),q(l,D,211,2,6015),C(r,"class","test-controls svelte-63wsq3"),q(r,D,216,2,6111),C(w,"class","svelte-63wsq3"),q(w,D,257,4,7372),C(V,"class","log-container svelte-63wsq3"),q(V,D,258,4,7395),C(A,"class","logs svelte-63wsq3"),q(A,D,256,2,7349),C(t,"class","simple-test svelte-63wsq3"),q(t,D,210,0,5987)},m:function(m,F){N(m,e,F),N(m,t,F),v(t,l),v(l,c),v(l,a),v(l,n),v(t,h),v(t,r),i&&i.m(r,null),v(t,p),d&&d.m(t,null),v(t,x),v(t,A),v(A,w),v(A,j),v(A,V);for(let f=0;f<g.length;f+=1)g[f]&&g[f].m(V,null)},p:function(m,[F]){if(T===(T=I(m))&&i?i.p(m,F):(i&&i.d(1),i=T&&T(m),i&&(i.c(),i.m(r,null))),m[1]?d?d.p(m,F):(d=Z(m),d.c(),d.m(t,x)):d&&(d.d(1),d=null),F&32){S=se(m[5]);let f;for(f=0;f<S.length;f+=1){const B=ae(m,S,f);g[f]?g[f].p(B,F):(g[f]=$(B),g[f].c(),g[f].m(V,null))}for(;f<g.length;f+=1)g[f].d(1);g.length=S.length}},i:Q,o:Q,d:function(m){m&&(y(e),y(t)),i&&i.d(),d&&d.d(),we(g,m)}};return O("SvelteRegisterBlock",{block:R,id:ee.name,type:"component",source:"",ctx:o}),R}function ce(o,e){let t=0;for(let n=0;n<o.length;n++)t+=o[n]*o[n];if(t=Math.sqrt(t/o.length),t<.005)return 0;const l=Math.floor(e/800),c=Math.floor(e/80);let s=0,a=0;for(let n=l;n<=c;n++){let u=0,h=0;for(let r=0;r<o.length-n;r++)u+=o[r]*o[r+n],h+=o[r]*o[r];h>0&&(u=u/Math.sqrt(h),u>s&&(s=u,a=n))}return s>.25?e/a:0}function re(o){const t=Math.round(12*Math.log2(o/440)),l=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],c=((t+9)%12+12)%12,s=Math.floor((t+9)/12)+4,a=l[c];return`${a}${s}Ôºà${{C:"„Éâ","C#":"„Éâ#",D:"„É¨","D#":"„É¨#",E:"„Éü",F:"„Éï„Ç°","F#":"„Éï„Ç°#",G:"„ÇΩ","G#":"„ÇΩ#",A:"„É©","A#":"„É©#",B:"„Ç∑"}[a]}${s}Ôºâ`}function qe(o,e,t){let{$$slots:l={},$$scope:c}=e;ye("Page",l,[]);let s="initial",a=!1,n=0,u=0,h="",r=null,p=null,x=null,A=null,w=[];function _(i){const d=new Date().toLocaleTimeString();t(5,w=[`[${d}] ${i}`,...w.slice(0,19)])}async function j(){_("„Éû„Ç§„ÇØË®±ÂèØ„É™„ÇØ„Ç®„Çπ„ÉàÈñãÂßã"),t(0,s="pending");try{p=await navigator.mediaDevices.getUserMedia({audio:!0}),_("„Éû„Ç§„ÇØË®±ÂèØÂèñÂæóÊàêÂäü"),t(0,s="granted"),r=new(window.AudioContext||window.webkitAudioContext),_(`AudioContext‰ΩúÊàêÂÆå‰∫Ü, state: ${r.state}`),r.state==="suspended"&&(await r.resume(),_(`AudioContextÂÜçÈñãÂÆå‰∫Ü, state: ${r.state}`)),x=r.createAnalyser(),x.fftSize=2048,x.smoothingTimeConstant=.8,x.minDecibels=-90,x.maxDecibels=-10,r.createMediaStreamSource(p).connect(x),_("„Ç¢„Éä„É©„Ç§„Ç∂„ÉºÊé•Á∂öÂÆå‰∫Ü"),p.getTracks().forEach((d,S)=>{_(`Track ${S}: ${d.kind}, ${d.label}, state: ${d.readyState}`),d.addEventListener("ended",()=>{_(`Track ${S} ended`)}),d.addEventListener("mute",()=>{_(`Track ${S} muted`)}),d.addEventListener("unmute",()=>{_(`Track ${S} unmuted`)})}),t(1,a=!0),_("„É™„Ç¢„É´„Çø„Ç§„É†Ëß£ÊûêÈñãÂßã"),V()}catch(i){_(`„Éû„Ç§„ÇØ„Ç¢„ÇØ„Çª„Çπ„Ç®„É©„Éº: ${i.name} - ${i.message}`),t(0,s="denied")}}function V(){if(!a||!x){_("Ëß£ÊûêÂÅúÊ≠¢");return}const i=x.frequencyBinCount,d=new Uint8Array(i);x.getByteFrequencyData(d);let S=0;for(let m=0;m<d.length;m++)S+=d[m]*d[m];const g=Math.sqrt(S/d.length);t(2,n=Math.min(100,g/64*100));const R=new Float32Array(x.fftSize);x.getFloatTimeDomainData(R);const E=ce(R,r.sampleRate);E>80&&E<800?(t(3,u=E),t(4,h=re(E))):(t(3,u=0),t(4,h="")),A=requestAnimationFrame(V)}function I(){t(1,a=!1),_("„É™„Çπ„Éã„É≥„Ç∞ÂÅúÊ≠¢ÈñãÂßã"),A&&(cancelAnimationFrame(A),A=null),p&&(p.getTracks().forEach(i=>i.stop()),p=null,_("MediaStreamÂÅúÊ≠¢ÂÆå‰∫Ü")),r&&r.state!=="closed"&&(r.close(),r=null,_("AudioContextÁµÇ‰∫ÜÂÆå‰∫Ü")),x=null}ie(()=>{I()});const T=[];return Object.keys(e).forEach(i=>{!~T.indexOf(i)&&i.slice(0,2)!=="$$"&&i!=="slot"&&console.warn(`<Page> was created with unknown prop '${i}'`)}),o.$capture_state=()=>({onMount:ge,onDestroy:ie,micPermission:s,isListening:a,currentVolume:n,currentFrequency:u,currentNote:h,audioContext:r,mediaStream:p,analyser:x,animationFrame:A,logs:w,addLog:_,requestMicrophone:j,analyzeAudio:V,detectPitch:ce,frequencyToNote:re,stopListening:I}),o.$inject_state=i=>{"micPermission"in i&&t(0,s=i.micPermission),"isListening"in i&&t(1,a=i.isListening),"currentVolume"in i&&t(2,n=i.currentVolume),"currentFrequency"in i&&t(3,u=i.currentFrequency),"currentNote"in i&&t(4,h=i.currentNote),"audioContext"in i&&(r=i.audioContext),"mediaStream"in i&&(p=i.mediaStream),"analyser"in i&&(x=i.analyser),"animationFrame"in i&&(A=i.animationFrame),"logs"in i&&t(5,w=i.logs)},e&&"$$inject"in e&&o.$inject_state(e.$$inject),[s,a,n,u,h,w,j,I]}class De extends me{constructor(e){super(e),ve(this,e,qe,ee,_e,{}),O("SvelteRegisterComponent",{component:this,tagName:"Page",options:e,id:ee.name})}}export{De as component};
