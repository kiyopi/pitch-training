const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["../chunks/BR4hDZrg.js","../chunks/DXfV3yLF.js","../chunks/BnpKoSs-.js","../chunks/D0QH3NT1.js","../chunks/ByknBuWU.js","../assets/sessionStorage.BuIFFaAl.css"])))=>i.map(i=>d[i]);
import{_ as wn}from"../chunks/C1FmrZbK.js";import{S as So,i as bo,d as $,s as Do,v as Ne,c as Ae,a as qo,H as kn,V as Cn,b as h,q as fe,r as Q,u as G,f as U,w as de,I as wo,m as Y,x as me,p as Z,y as ge,J as ko,K as Ie,L as Te,g,z as T,h as F,M as Xe,j as R,k as H,A as ve,l as W,N as je,o as M,t as J,e as Ce,Q as ut,n as Je,R as Pn}from"../chunks/DXfV3yLF.js";import{g as Co}from"../chunks/D0QH3NT1.js";import"../chunks/BnpKoSs-.js";import{b as lt,g as _t}from"../chunks/ByknBuWU.js";import{p as St}from"../chunks/Da6sorbO.js";import{P as Bn,B as ft,C as Ke}from"../chunks/CrwomGmF.js";import{l as ie,a as We,h as bt,P as xn,b as Vn,V as Fo}from"../chunks/BRZWrjh2.js";import{l as Dt,s as nt,c as Ro,r as Mo,a as Fn,u as qt,b as No,d as wt,p as Ao,o as Io,e as To,f as kt,i as Ct,g as Eo,h as Ft,n as Rt,j as Mt,k as Nt,t as At,E as Rn,m as ot,A as Jt,U as Kt,S as Po,F as Bo,C as xo,I as Vo,q as Ho,T as zo,P as jo,M as Hn,v as Lo,w as Oo,x as It}from"../chunks/BR4hDZrg.js";const Go=!1,Uo=!1,sr=Object.freeze(Object.defineProperty({__proto__:null,prerender:Uo,ssr:Go},Symbol.toStringTag,{value:"Module"})),{Object:Wo,console:Jo,document:Mn}=Co,N="src/routes/training/continuous/+page.svelte";function Nn(c,t,e){const i=c.slice();return i[99]=t[e],i[101]=e,i}function An(c,t,e){const i=c.slice();return i[102]=t[e],i}function Pt(c){var x,L;let t,e,i,r,n,a,s,u,f,d,m=(((x=c[24])==null?void 0:x.length)||0)+"",v,C,p,y,b,z,q,A,X=Math.round((((L=c[24])==null?void 0:L.length)||0)/8*100)+"",P,j,B,_,ee,D=c[0]==="results"&&c[5]&&Bt(c);const w={c:function(){t=M("div"),e=M("div"),i=M("div"),r=M("span"),n=J("ã‚»ãƒƒã‚·ãƒ§ãƒ³ "),a=J(c[23]),s=J("/8"),u=Z(),f=M("span"),d=J("å®Œäº†æ¸ˆã¿ "),v=J(m),C=J("ã‚»ãƒƒã‚·ãƒ§ãƒ³"),p=Z(),y=M("div"),b=M("div"),z=M("div"),q=Z(),A=M("span"),P=J(X),j=J("%"),B=Z(),D&&D.c(),_=je(),this.h()},l:function(E){t=R(E,"DIV",{class:!0});var I=H(t);e=R(I,"DIV",{class:!0});var te=H(e);i=R(te,"DIV",{class:!0});var K=H(i);r=R(K,"SPAN",{class:!0});var ye=H(r);n=W(ye,"ã‚»ãƒƒã‚·ãƒ§ãƒ³ "),a=W(ye,c[23]),s=W(ye,"/8"),ye.forEach(h),u=Y(K),f=R(K,"SPAN",{class:!0});var Se=H(f);d=W(Se,"å®Œäº†æ¸ˆã¿ "),v=W(Se,m),C=W(Se,"ã‚»ãƒƒã‚·ãƒ§ãƒ³"),Se.forEach(h),K.forEach(h),p=Y(te),y=R(te,"DIV",{class:!0});var Ee=H(y);b=R(Ee,"DIV",{class:!0});var Le=H(b);z=R(Le,"DIV",{class:!0,style:!0}),H(z).forEach(h),Le.forEach(h),q=Y(Ee),A=R(Ee,"SPAN",{class:!0});var Ve=H(A);P=W(Ve,X),j=W(Ve,"%"),Ve.forEach(h),Ee.forEach(h),te.forEach(h),I.forEach(h),B=Y(E),D&&D.l(E),_=je(),this.h()},h:function(){var E;T(r,"class","completed-count svelte-rt5px1"),F(r,N,2659,12,90388),T(f,"class","remaining-text svelte-rt5px1"),F(f,N,2660,12,90465),T(i,"class","session-info svelte-rt5px1"),F(i,N,2658,10,90349),T(z,"class","progress-fill svelte-rt5px1"),Xe(z,"width",(((E=c[24])==null?void 0:E.length)||0)/8*100+"%"),F(z,N,2664,14,90653),T(b,"class","progress-bar svelte-rt5px1"),F(b,N,2663,12,90612),T(A,"class","progress-text svelte-rt5px1"),F(A,N,2666,12,90779),T(y,"class","progress-section svelte-rt5px1"),F(y,N,2662,10,90569),T(e,"class","session-status svelte-rt5px1"),F(e,N,2657,8,90310),T(t,"class","session-progress svelte-rt5px1"),F(t,N,2656,6,90271)},m:function(E,I){U(E,t,I),g(t,e),g(e,i),g(i,r),g(r,n),g(r,a),g(r,s),g(i,u),g(i,f),g(f,d),g(f,v),g(f,C),g(e,p),g(e,y),g(y,b),g(b,z),g(y,q),g(y,A),g(A,P),g(A,j),U(E,B,I),D&&D.m(E,I),U(E,_,I),ee=!0},p:function(E,I){var te,K,ye;(!ee||I[0]&8388608)&&Ce(a,E[23]),(!ee||I[0]&16777216)&&m!==(m=(((te=E[24])==null?void 0:te.length)||0)+"")&&Ce(v,m),(!ee||I[0]&16777216)&&Xe(z,"width",(((K=E[24])==null?void 0:K.length)||0)/8*100+"%"),(!ee||I[0]&16777216)&&X!==(X=Math.round((((ye=E[24])==null?void 0:ye.length)||0)/8*100)+"")&&Ce(P,X),E[0]==="results"&&E[5]?D?(D.p(E,I),I[0]&33&&G(D,1)):(D=Bt(E),D.c(),G(D,1),D.m(_.parentNode,_)):D&&(Ie(),Q(D,1,1,()=>{D=null}),Te())},i:function(E){ee||(G(D),ee=!0)},o:function(E){Q(D),ee=!1},d:function(E){E&&(h(t),h(B),h(_)),D&&D.d(E)}};return $("SvelteRegisterBlock",{block:w,id:Pt.name,type:"if",source:"(2656:4) {#if microphoneState === 'granted' && !$isLoading}",ctx:c}),w}function Bt(c){let t,e,i;e=new Jt({props:{isCompleted:c[5],position:"top"},$$inline:!0}),e.$on("action",c[29]);const r={c:function(){t=M("div"),ge(e.$$.fragment),this.h()},l:function(a){t=R(a,"DIV",{class:!0});var s=H(t);me(e.$$.fragment,s),s.forEach(h),this.h()},h:function(){T(t,"class","top-action-buttons svelte-rt5px1"),F(t,N,2674,8,91036)},m:function(a,s){U(a,t,s),de(e,t,null),i=!0},p:function(a,s){const u={};s[0]&32&&(u.isCompleted=a[5]),e.$set(u)},i:function(a){i||(G(e.$$.fragment,a),i=!0)},o:function(a){Q(e.$$.fragment,a),i=!1},d:function(a){a&&h(t),fe(e)}};return $("SvelteRegisterBlock",{block:r,id:Bt.name,type:"if",source:"(2674:6) {#if trainingPhase === 'results' && $isCompleted}",ctx:c}),r}function zn(c){let t,e;t=new Ke({props:{class:"error-card",$$slots:{default:[Gn]},$$scope:{ctx:c}},$$inline:!0});const i={c:function(){ge(t.$$.fragment)},l:function(n){me(t.$$.fragment,n)},m:function(n,a){de(t,n,a),e=!0},p:function(n,a){const s={};a[3]&4096&&(s.$$scope={dirty:a,ctx:n}),t.$set(s)},i:function(n){e||(G(t.$$.fragment,n),e=!0)},o:function(n){Q(t.$$.fragment,n),e=!1},d:function(n){fe(t,n)}};return $("SvelteRegisterBlock",{block:i,id:zn.name,type:"else",source:"(2896:2) {:else}",ctx:c}),i}function jn(c){let t,e,i,r,n,a,s,u={isActive:c[1]==="granted",trainingPhase:c[0],className:"pitch-detector-content",debugMode:!0,disableHarmonicCorrection:!1};e=new Vn({props:u,$$inline:!0}),c[35](e),e.$on("pitchUpdate",c[28]),e.$on("stateChange",fo),e.$on("error",c[31]),e.$on("microphoneHealthChange",c[32]);let f=c[0]!=="results"&&xt(c),d=c[0]!=="results"&&jt(c),m=c[0]==="results"&&Gt(c);const v={c:function(){t=M("div"),ge(e.$$.fragment),i=Z(),f&&f.c(),r=Z(),d&&d.c(),n=Z(),m&&m.c(),a=je(),this.h()},l:function(p){t=R(p,"DIV",{style:!0});var y=H(t);me(e.$$.fragment,y),y.forEach(h),i=Y(p),f&&f.l(p),r=Y(p),d&&d.l(p),n=Y(p),m&&m.l(p),a=je(),this.h()},h:function(){Xe(t,"display","none"),F(t,N,2693,4,91534)},m:function(p,y){U(p,t,y),de(e,t,null),U(p,i,y),f&&f.m(p,y),U(p,r,y),d&&d.m(p,y),U(p,n,y),m&&m.m(p,y),U(p,a,y),s=!0},p:function(p,y){const b={};y[0]&2&&(b.isActive=p[1]==="granted"),y[0]&1&&(b.trainingPhase=p[0]),e.$set(b),p[0]!=="results"?f?(f.p(p,y),y[0]&1&&G(f,1)):(f=xt(p),f.c(),G(f,1),f.m(r.parentNode,r)):f&&(Ie(),Q(f,1,1,()=>{f=null}),Te()),p[0]!=="results"?d?(d.p(p,y),y[0]&1&&G(d,1)):(d=jt(p),d.c(),G(d,1),d.m(n.parentNode,n)):d&&(Ie(),Q(d,1,1,()=>{d=null}),Te()),p[0]==="results"?m?(m.p(p,y),y[0]&1&&G(m,1)):(m=Gt(p),m.c(),G(m,1),m.m(a.parentNode,a)):m&&(Ie(),Q(m,1,1,()=>{m=null}),Te())},i:function(p){s||(G(e.$$.fragment,p),G(f),G(d),G(m),s=!0)},o:function(p){Q(e.$$.fragment,p),Q(f),Q(d),Q(m),s=!1},d:function(p){p&&(h(t),h(i),h(r),h(n),h(a)),c[35](null),fe(e),f&&f.d(p),d&&d.d(p),m&&m.d(p)}};return $("SvelteRegisterBlock",{block:v,id:jn.name,type:"if",source:"(2692:2) {#if microphoneState === 'granted'}",ctx:c}),v}function Ln(c){let t;const e={c:function(){t=J("ğŸ¤ ãƒã‚¤ã‚¯ãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸ã¸ç§»å‹•")},l:function(r){t=W(r,"ğŸ¤ ãƒã‚¤ã‚¯ãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸ã¸ç§»å‹•")},m:function(r,n){U(r,t,n)},d:function(r){r&&h(t)}};return $("SvelteRegisterBlock",{block:e,id:Ln.name,type:"slot",source:'(2910:10) <Button variant=\\"primary\\" on:click={goToMicrophoneTest}>',ctx:c}),e}function On(c){let t;const e={c:function(){t=J("ğŸ  ãƒ›ãƒ¼ãƒ ã«æˆ»ã‚‹")},l:function(r){t=W(r,"ğŸ  ãƒ›ãƒ¼ãƒ ã«æˆ»ã‚‹")},m:function(r,n){U(r,t,n)},d:function(r){r&&h(t)}};return $("SvelteRegisterBlock",{block:e,id:On.name,type:"slot",source:'(2913:10) <Button variant=\\"secondary\\" on:click={goHome}>',ctx:c}),e}function Gn(c){let t,e,i="ğŸ¤",r,n,a="ãƒã‚¤ã‚¯ãƒ†ã‚¹ãƒˆãŒå¿…è¦ã§ã™",s,u,f="é€£ç¶šãƒãƒ£ãƒ¬ãƒ³ã‚¸ãƒ¢ãƒ¼ãƒ‰ã‚’é–‹å§‹ã™ã‚‹å‰ã«ã€ãƒã‚¤ã‚¯ãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸ã§éŸ³å£°å…¥åŠ›ã®ç¢ºèªã‚’ãŠé¡˜ã„ã—ã¾ã™ã€‚",d,m,v,C,p,y="ãƒã‚¤ã‚¯ãƒ†ã‚¹ãƒˆå®Œäº†å¾Œ",b,z,q,A="ã¾ãšã¯ãƒã‚¤ã‚¯ãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸ã§éŸ³å£°ç¢ºèªã‚’è¡Œã£ã¦ãã ã•ã„ã€‚",X,P,j,B,_,ee;j=new ft({props:{variant:"primary",$$slots:{default:[Ln]},$$scope:{ctx:c}},$$inline:!0}),j.$on("click",c[26]),_=new ft({props:{variant:"secondary",$$slots:{default:[On]},$$scope:{ctx:c}},$$inline:!0}),_.$on("click",c[27]);const D={c:function(){t=M("div"),e=M("div"),e.textContent=i,r=Z(),n=M("h3"),n.textContent=a,s=Z(),u=M("p"),u.textContent=f,d=Z(),m=M("div"),v=M("p"),C=J("ã“ã®ãƒšãƒ¼ã‚¸ã¯"),p=M("strong"),p.textContent=y,b=J("ã«ã”åˆ©ç”¨ã„ãŸã ã‘ã¾ã™ã€‚"),z=Z(),q=M("p"),q.textContent=A,X=Z(),P=M("div"),ge(j.$$.fragment),B=Z(),ge(_.$$.fragment),this.h()},l:function(x){t=R(x,"DIV",{class:!0});var L=H(t);e=R(L,"DIV",{class:!0,"data-svelte-h":!0}),ve(e)!=="svelte-15rbx8n"&&(e.textContent=i),r=Y(L),n=R(L,"H3",{class:!0,"data-svelte-h":!0}),ve(n)!=="svelte-17kvze2"&&(n.textContent=a),s=Y(L),u=R(L,"P",{class:!0,"data-svelte-h":!0}),ve(u)!=="svelte-1t09god"&&(u.textContent=f),d=Y(L),m=R(L,"DIV",{class:!0});var oe=H(m);v=R(oe,"P",{class:!0});var E=H(v);C=W(E,"ã“ã®ãƒšãƒ¼ã‚¸ã¯"),p=R(E,"STRONG",{"data-svelte-h":!0}),ve(p)!=="svelte-1n3qsr6"&&(p.textContent=y),b=W(E,"ã«ã”åˆ©ç”¨ã„ãŸã ã‘ã¾ã™ã€‚"),E.forEach(h),z=Y(oe),q=R(oe,"P",{class:!0,"data-svelte-h":!0}),ve(q)!=="svelte-v8nd09"&&(q.textContent=A),oe.forEach(h),X=Y(L),P=R(L,"DIV",{class:!0});var I=H(P);me(j.$$.fragment,I),B=Y(I),me(_.$$.fragment,I),I.forEach(h),L.forEach(h),this.h()},h:function(){T(e,"class","error-icon svelte-rt5px1"),F(e,N,2899,8,98520),T(n,"class","svelte-rt5px1"),F(n,N,2900,8,98561),T(u,"class","svelte-rt5px1"),F(u,N,2901,8,98590),F(p,N,2904,19,98706),T(v,"class","svelte-rt5px1"),F(v,N,2904,10,98697),T(q,"class","svelte-rt5px1"),F(q,N,2905,10,98758),T(m,"class","recommendation svelte-rt5px1"),F(m,N,2903,8,98658),T(P,"class","action-buttons"),F(P,N,2908,8,98824),T(t,"class","error-content svelte-rt5px1"),F(t,N,2898,6,98484)},m:function(x,L){U(x,t,L),g(t,e),g(t,r),g(t,n),g(t,s),g(t,u),g(t,d),g(t,m),g(m,v),g(v,C),g(v,p),g(v,b),g(m,z),g(m,q),g(t,X),g(t,P),de(j,P,null),g(P,B),de(_,P,null),ee=!0},p:function(x,L){const oe={};L[3]&4096&&(oe.$$scope={dirty:L,ctx:x}),j.$set(oe);const E={};L[3]&4096&&(E.$$scope={dirty:L,ctx:x}),_.$set(E)},i:function(x){ee||(G(j.$$.fragment,x),G(_.$$.fragment,x),ee=!0)},o:function(x){Q(j.$$.fragment,x),Q(_.$$.fragment,x),ee=!1},d:function(x){x&&h(t),fe(j),fe(_)}};return $("SvelteRegisterBlock",{block:D,id:Gn.name,type:"slot",source:'(2898:4) <Card class=\\"error-card\\">',ctx:c}),D}function xt(c){let t,e,i,r,n,a,s=!c[2]&&c[6].length>0&&Vt(c);i=new Ke({props:{class:"main-card half-width",$$slots:{default:[$n]},$$scope:{ctx:c}},$$inline:!0}),n=new xn({props:{frequency:c[14],note:c[15],volume:c[13],isMuted:c[0]!=="guiding",muteMessage:"åŸºéŸ³å†ç”Ÿå¾Œã«é–‹å§‹",className:"half-width",showGuidance:!1},$$inline:!0});const u={c:function(){s&&s.c(),t=Z(),e=M("div"),ge(i.$$.fragment),r=Z(),ge(n.$$.fragment),this.h()},l:function(d){s&&s.l(d),t=Y(d),e=R(d,"DIV",{class:!0});var m=H(e);me(i.$$.fragment,m),r=Y(m),me(n.$$.fragment,m),m.forEach(h),this.h()},h:function(){T(e,"class","side-by-side-container svelte-rt5px1"),F(e,N,2732,6,92871)},m:function(d,m){s&&s.m(d,m),U(d,t,m),U(d,e,m),de(i,e,null),g(e,r),de(n,e,null),a=!0},p:function(d,m){!d[2]&&d[6].length>0?s?(s.p(d,m),m[0]&68&&G(s,1)):(s=Vt(d),s.c(),G(s,1),s.m(t.parentNode,t)):s&&(Ie(),Q(s,1,1,()=>{s=null}),Te());const v={};m[0]&8395649|m[3]&4096&&(v.$$scope={dirty:m,ctx:d}),i.$set(v);const C={};m[0]&16384&&(C.frequency=d[14]),m[0]&32768&&(C.note=d[15]),m[0]&8192&&(C.volume=d[13]),m[0]&1&&(C.isMuted=d[0]!=="guiding"),n.$set(C)},i:function(d){a||(G(s),G(i.$$.fragment,d),G(n.$$.fragment,d),a=!0)},o:function(d){Q(s),Q(i.$$.fragment,d),Q(n.$$.fragment,d),a=!1},d:function(d){d&&(h(t),h(e)),s&&s.d(d),fe(i),fe(n)}};return $("SvelteRegisterBlock",{block:u,id:xt.name,type:"if",source:"(2711:4) {#if trainingPhase !== 'results'}",ctx:c}),u}function Vt(c){let t,e;t=new Ke({props:{class:"warning-card",$$slots:{default:[Un]},$$scope:{ctx:c}},$$inline:!0});const i={c:function(){ge(t.$$.fragment)},l:function(n){me(t.$$.fragment,n)},m:function(n,a){de(t,n,a),e=!0},p:function(n,a){const s={};a[0]&64|a[3]&4096&&(s.$$scope={dirty:a,ctx:n}),t.$set(s)},i:function(n){e||(G(t.$$.fragment,n),e=!0)},o:function(n){Q(t.$$.fragment,n),e=!1},d:function(n){fe(t,n)}};return $("SvelteRegisterBlock",{block:i,id:Vt.name,type:"if",source:"(2714:6) {#if !microphoneHealthy && microphoneErrors.length > 0}",ctx:c}),i}function Ht(c){let t,e=c[102]+"",i;const r={c:function(){t=M("li"),i=J(e),this.h()},l:function(a){t=R(a,"LI",{class:!0});var s=H(t);i=W(s,e),s.forEach(h),this.h()},h:function(){T(t,"class","svelte-rt5px1"),F(t,N,2722,16,92639)},m:function(a,s){U(a,t,s),g(t,i)},p:function(a,s){s[0]&64&&e!==(e=a[102]+"")&&Ce(i,e)},d:function(a){a&&h(t)}};return $("SvelteRegisterBlock",{block:r,id:Ht.name,type:"each",source:"(2722:14) {#each microphoneErrors as error}",ctx:c}),r}function Un(c){let t,e,i="âš ï¸ ãƒã‚¤ã‚¯æ¥ç¶šã«å•é¡ŒãŒã‚ã‚Šã¾ã™",r,n,a,s="ãƒã‚¤ã‚¯ãŒæ­£å¸¸ã«å‹•ä½œã—ã¦ã„ã¾ã›ã‚“ã€‚ä»¥ä¸‹ã®å•é¡ŒãŒæ¤œå‡ºã•ã‚Œã¾ã—ãŸï¼š",u,f,d,m,v,C="è§£æ±ºæ–¹æ³•:",p,y=ut(c[6]),b=[];for(let q=0;q<y.length;q+=1)b[q]=Ht(An(c,y,q));const z={c:function(){t=M("div"),e=M("h3"),e.textContent=i,r=Z(),n=M("div"),a=M("p"),a.textContent=s,u=Z(),f=M("ul");for(let A=0;A<b.length;A+=1)b[A].c();d=Z(),m=M("p"),v=M("strong"),v.textContent=C,p=J(" ãƒšãƒ¼ã‚¸ã‚’å†èª­ã¿è¾¼ã¿ã—ã¦ãƒã‚¤ã‚¯è¨±å¯ã‚’å†åº¦å–å¾—ã—ã¦ãã ã•ã„ã€‚"),this.h()},l:function(A){t=R(A,"DIV",{class:!0});var X=H(t);e=R(X,"H3",{class:!0,"data-svelte-h":!0}),ve(e)!=="svelte-15qec5x"&&(e.textContent=i),X.forEach(h),r=Y(A),n=R(A,"DIV",{class:!0});var P=H(n);a=R(P,"P",{class:!0,"data-svelte-h":!0}),ve(a)!=="svelte-171o2p0"&&(a.textContent=s),u=Y(P),f=R(P,"UL",{class:!0});var j=H(f);for(let _=0;_<b.length;_+=1)b[_].l(j);j.forEach(h),d=Y(P),m=R(P,"P",{class:!0});var B=H(m);v=R(B,"STRONG",{"data-svelte-h":!0}),ve(v)!=="svelte-79o66n"&&(v.textContent=C),p=W(B," ãƒšãƒ¼ã‚¸ã‚’å†èª­ã¿è¾¼ã¿ã—ã¦ãƒã‚¤ã‚¯è¨±å¯ã‚’å†åº¦å–å¾—ã—ã¦ãã ã•ã„ã€‚"),B.forEach(h),P.forEach(h),this.h()},h:function(){T(e,"class","section-title svelte-rt5px1"),F(e,N,2716,12,92363),T(t,"class","card-header svelte-rt5px1"),F(t,N,2715,10,92325),T(a,"class","warning-message svelte-rt5px1"),F(a,N,2719,12,92477),T(f,"class","error-list svelte-rt5px1"),F(f,N,2720,12,92551),F(v,N,2726,14,92750),T(m,"class","fix-instruction svelte-rt5px1"),F(m,N,2725,12,92708),T(n,"class","card-content svelte-rt5px1"),F(n,N,2718,10,92438)},m:function(A,X){U(A,t,X),g(t,e),U(A,r,X),U(A,n,X),g(n,a),g(n,u),g(n,f);for(let P=0;P<b.length;P+=1)b[P]&&b[P].m(f,null);g(n,d),g(n,m),g(m,v),g(m,p)},p:function(A,X){if(X[0]&64){y=ut(A[6]);let P;for(P=0;P<y.length;P+=1){const j=An(A,y,P);b[P]?b[P].p(j,X):(b[P]=Ht(j),b[P].c(),b[P].m(f,null))}for(;P<b.length;P+=1)b[P].d(1);b.length=y.length}},d:function(A){A&&(h(t),h(r),h(n)),Pn(b,A)}};return $("SvelteRegisterBlock",{block:z,id:Un.name,type:"slot",source:'(2715:8) <Card class=\\"warning-card\\">',ctx:c}),z}function Wn(c){let t;function e(a,s){return a[9]?Yn:a[0]==="guiding"?Xn:a[0]==="results"?Qn:Kn}let i=e(c),r=i(c);const n={c:function(){t=M("div"),r.c(),this.h()},l:function(s){t=R(s,"DIV",{class:!0});var u=H(t);r.l(u),u.forEach(h),this.h()},h:function(){T(t,"class","continuous-status svelte-rt5px1"),F(t,N,2749,14,93520)},m:function(s,u){U(s,t,u),r.m(t,null)},p:function(s,u){i===(i=e(s))&&r?r.p(s,u):(r.d(1),r=i(s),r&&(r.c(),r.m(t,null)))},i:Je,o:Je,d:function(s){s&&h(t),r.d()}};return $("SvelteRegisterBlock",{block:n,id:Wn.name,type:"else",source:"(2748:12) {:else}",ctx:c}),n}function Jn(c){let t,e;t=new ft({props:{variant:"primary",$$slots:{default:[Zn]},$$scope:{ctx:c}},$$inline:!0}),t.$on("click",c[30]);const i={c:function(){ge(t.$$.fragment)},l:function(n){me(t.$$.fragment,n)},m:function(n,a){de(t,n,a),e=!0},p:function(n,a){const s={};a[3]&4096&&(s.$$scope={dirty:a,ctx:n}),t.$set(s)},i:function(n){e||(G(t.$$.fragment,n),e=!0)},o:function(n){Q(t.$$.fragment,n),e=!1},d:function(n){fe(t,n)}};return $("SvelteRegisterBlock",{block:i,id:Jn.name,type:"if",source:"(2741:12) {#if trainingPhase === 'setup' && !isPlaying && !($currentSessionId > 1)}",ctx:c}),i}function Kn(c){let t,e,i,r;const n={c:function(){t=M("div"),e=J("âš¡ é€£ç¶šãƒ¢ãƒ¼ãƒ‰é€²è¡Œä¸­ ("),i=J(c[23]),r=J("/8)"),this.h()},l:function(s){t=R(s,"DIV",{class:!0});var u=H(t);e=W(u,"âš¡ é€£ç¶šãƒ¢ãƒ¼ãƒ‰é€²è¡Œä¸­ ("),i=W(u,c[23]),r=W(u,"/8)"),u.forEach(h),this.h()},h:function(){T(t,"class","status-text svelte-rt5px1"),F(t,N,2763,18,94110)},m:function(s,u){U(s,t,u),g(t,e),g(t,i),g(t,r)},p:function(s,u){u[0]&8388608&&Ce(i,s[23])},d:function(s){s&&h(t)}};return $("SvelteRegisterBlock",{block:n,id:Kn.name,type:"else",source:"(2763:16) {:else}",ctx:c}),n}function Qn(c){let t,e,i,r;const n={c:function(){t=M("div"),e=J("âœ… ã‚»ãƒƒã‚·ãƒ§ãƒ³ "),i=J(c[23]),r=J("/8 å®Œäº†"),this.h()},l:function(s){t=R(s,"DIV",{class:!0});var u=H(t);e=W(u,"âœ… ã‚»ãƒƒã‚·ãƒ§ãƒ³ "),i=W(u,c[23]),r=W(u,"/8 å®Œäº†"),u.forEach(h),this.h()},h:function(){T(t,"class","status-text svelte-rt5px1"),F(t,N,2759,18,93964)},m:function(s,u){U(s,t,u),g(t,e),g(t,i),g(t,r)},p:function(s,u){u[0]&8388608&&Ce(i,s[23])},d:function(s){s&&h(t)}};return $("SvelteRegisterBlock",{block:n,id:Qn.name,type:"if",source:"(2759:54) ",ctx:c}),n}function Xn(c){let t,e,i,r;const n={c:function(){t=M("div"),e=J("ğŸ¤ ã‚»ãƒƒã‚·ãƒ§ãƒ³ "),i=J(c[23]),r=J("/8: ãƒ‰ãƒ¬ãƒŸç™ºå£°ä¸­"),this.h()},l:function(s){t=R(s,"DIV",{class:!0});var u=H(t);e=W(u,"ğŸ¤ ã‚»ãƒƒã‚·ãƒ§ãƒ³ "),i=W(u,c[23]),r=W(u,"/8: ãƒ‰ãƒ¬ãƒŸç™ºå£°ä¸­"),u.forEach(h),this.h()},h:function(){T(t,"class","status-text svelte-rt5px1"),F(t,N,2755,18,93781)},m:function(s,u){U(s,t,u),g(t,e),g(t,i),g(t,r)},p:function(s,u){u[0]&8388608&&Ce(i,s[23])},d:function(s){s&&h(t)}};return $("SvelteRegisterBlock",{block:n,id:Xn.name,type:"if",source:"(2755:54) ",ctx:c}),n}function Yn(c){let t,e,i,r;const n={c:function(){t=M("div"),e=J("ğŸµ åŸºéŸ³ "),i=J(c[23]),r=J("/8 å†ç”Ÿä¸­..."),this.h()},l:function(s){t=R(s,"DIV",{class:!0});var u=H(t);e=W(u,"ğŸµ åŸºéŸ³ "),i=W(u,c[23]),r=W(u,"/8 å†ç”Ÿä¸­..."),u.forEach(h),this.h()},h:function(){T(t,"class","status-text svelte-rt5px1"),F(t,N,2751,18,93602)},m:function(s,u){U(s,t,u),g(t,e),g(t,i),g(t,r)},p:function(s,u){u[0]&8388608&&Ce(i,s[23])},d:function(s){s&&h(t)}};return $("SvelteRegisterBlock",{block:n,id:Yn.name,type:"if",source:"(2751:16) {#if isPlaying}",ctx:c}),n}function Zn(c){let t;const e={c:function(){t=J("âš¡ é€£ç¶šãƒãƒ£ãƒ¬ãƒ³ã‚¸é–‹å§‹ï¼ˆ8ã‚»ãƒƒã‚·ãƒ§ãƒ³ï¼‰")},l:function(r){t=W(r,"âš¡ é€£ç¶šãƒãƒ£ãƒ¬ãƒ³ã‚¸é–‹å§‹ï¼ˆ8ã‚»ãƒƒã‚·ãƒ§ãƒ³ï¼‰")},m:function(r,n){U(r,t,n)},d:function(r){r&&h(t)}};return $("SvelteRegisterBlock",{block:e,id:Zn.name,type:"slot",source:'(2742:14) <Button                  variant=\\"primary\\"                 on:click={startContinuousMode}               >',ctx:c}),e}function zt(c){let t,e,i,r,n,a=(c[8]||0).toFixed(1)+"",s,u;const f={c:function(){t=M("div"),e=J("ç¾åœ¨ã®åŸºéŸ³: "),i=M("strong"),r=J(c[7]),n=J(" ("),s=J(a),u=J("Hz)"),this.h()},l:function(m){t=R(m,"DIV",{class:!0});var v=H(t);e=W(v,"ç¾åœ¨ã®åŸºéŸ³: "),i=R(v,"STRONG",{});var C=H(i);r=W(C,c[7]),C.forEach(h),n=W(v," ("),s=W(v,a),u=W(v,"Hz)"),v.forEach(h),this.h()},h:function(){F(i,N,2772,23,94390),T(t,"class","base-note-info svelte-rt5px1"),F(t,N,2771,14,94338)},m:function(m,v){U(m,t,v),g(t,e),g(t,i),g(i,r),g(t,n),g(t,s),g(t,u)},p:function(m,v){v[0]&128&&Ce(r,m[7]),v[0]&256&&a!==(a=(m[8]||0).toFixed(1)+"")&&Ce(s,a)},d:function(m){m&&h(t)}};return $("SvelteRegisterBlock",{block:f,id:zt.name,type:"if",source:"(2771:12) {#if currentBaseNote}",ctx:c}),f}function $n(c){let t,e,i="ğŸ¹ åŸºéŸ³å†ç”Ÿ",r,n,a,s,u,f,d,m,v="ã‚¬ã‚¤ãƒ‰é–‹å§‹ã¾ã§",C,p,y,b,z,q,A,X;const P=[Jn,Wn],j=[];function B(D,w){return D[0]==="setup"&&!D[9]&&!(D[23]>1)?0:1}a=B(c),s=j[a]=P[a](c);let _=c[7]&&zt(c);q=new Hn({props:{size:"20"},$$inline:!0});const ee={c:function(){t=M("div"),e=M("h3"),e.textContent=i,r=Z(),n=M("div"),s.c(),u=Z(),_&&_.c(),f=Z(),d=M("div"),m=M("div"),m.textContent=v,C=Z(),p=M("div"),y=M("div"),b=Z(),z=M("div"),ge(q.$$.fragment),this.h()},l:function(w){t=R(w,"DIV",{class:!0});var x=H(t);e=R(x,"H3",{class:!0,"data-svelte-h":!0}),ve(e)!=="svelte-syc53b"&&(e.textContent=i),x.forEach(h),r=Y(w),n=R(w,"DIV",{class:!0});var L=H(n);s.l(L),u=Y(L),_&&_.l(L),f=Y(L),d=R(L,"DIV",{class:!0});var oe=H(d);m=R(oe,"DIV",{class:!0,"data-svelte-h":!0}),ve(m)!=="svelte-1dufnpv"&&(m.textContent=v),C=Y(oe),p=R(oe,"DIV",{class:!0});var E=H(p);y=R(E,"DIV",{class:!0,style:!0}),H(y).forEach(h),b=Y(E),z=R(E,"DIV",{class:!0});var I=H(z);me(q.$$.fragment,I),I.forEach(h),E.forEach(h),oe.forEach(h),L.forEach(h),this.h()},h:function(){T(e,"class","section-title svelte-rt5px1"),F(e,N,2736,12,93035),T(t,"class","card-header svelte-rt5px1"),F(t,N,2735,10,92997),T(m,"class","guide-start-label svelte-rt5px1"),F(m,N,2778,14,94622),T(y,"class","guide-progress-fill svelte-rt5px1"),Xe(y,"width",c[11]+"%"),F(y,N,2780,16,94727),T(z,"class",A="guide-music-icon "+(c[12]?"glowing":"")+" svelte-rt5px1"),F(z,N,2784,16,94875),T(p,"class","guide-start-bar svelte-rt5px1"),F(p,N,2779,14,94681),T(d,"class","guide-start-bar-container svelte-rt5px1"),F(d,N,2777,12,94568),T(n,"class","card-content svelte-rt5px1"),F(n,N,2738,10,93101)},m:function(w,x){U(w,t,x),g(t,e),U(w,r,x),U(w,n,x),j[a].m(n,null),g(n,u),_&&_.m(n,null),g(n,f),g(n,d),g(d,m),g(d,C),g(d,p),g(p,y),g(p,b),g(p,z),de(q,z,null),X=!0},p:function(w,x){let L=a;a=B(w),a===L?j[a].p(w,x):(Ie(),Q(j[L],1,1,()=>{j[L]=null}),Te(),s=j[a],s?s.p(w,x):(s=j[a]=P[a](w),s.c()),G(s,1),s.m(n,u)),w[7]?_?_.p(w,x):(_=zt(w),_.c(),_.m(n,f)):_&&(_.d(1),_=null),(!X||x[0]&2048)&&Xe(y,"width",w[11]+"%"),(!X||x[0]&4096&&A!==(A="guide-music-icon "+(w[12]?"glowing":"")+" svelte-rt5px1"))&&T(z,"class",A)},i:function(w){X||(G(s),G(q.$$.fragment,w),X=!0)},o:function(w){Q(s),Q(q.$$.fragment,w),X=!1},d:function(w){w&&(h(t),h(r),h(n)),j[a].d(),_&&_.d(),fe(q)}};return $("SvelteRegisterBlock",{block:ee,id:$n.name,type:"slot",source:'(2735:8) <Card class=\\"main-card half-width\\">',ctx:c}),ee}function jt(c){let t,e;t=new Ke({props:{class:"main-card",$$slots:{default:[eo]},$$scope:{ctx:c}},$$inline:!0});const i={c:function(){ge(t.$$.fragment)},l:function(n){me(t.$$.fragment,n)},m:function(n,a){de(t,n,a),e=!0},p:function(n,a){const s={};a[0]&1025|a[3]&4096&&(s.$$scope={dirty:a,ctx:n}),t.$set(s)},i:function(n){e||(G(t.$$.fragment,n),e=!0)},o:function(n){Q(t.$$.fragment,n),e=!1},d:function(n){fe(t,n)}};return $("SvelteRegisterBlock",{block:i,id:jt.name,type:"if",source:"(2806:4) {#if trainingPhase !== 'results'}",ctx:c}),i}function Lt(c){let t,e=(c[99].name||`éŸ³éš${c[101]+1}`)+"",i,r,n;const a={c:function(){t=M("div"),i=J(e),r=Z(),this.h()},l:function(u){t=R(u,"DIV",{class:!0});var f=H(t);i=W(f,e),r=Y(f),f.forEach(h),this.h()},h:function(){T(t,"class",n="scale-item "+(c[99].state||"inactive")+" svelte-rt5px1"),F(t,N,2814,14,95777)},m:function(u,f){U(u,t,f),g(t,i),g(t,r)},p:function(u,f){f[0]&1024&&e!==(e=(u[99].name||`éŸ³éš${u[101]+1}`)+"")&&Ce(i,e),f[0]&1024&&n!==(n="scale-item "+(u[99].state||"inactive")+" svelte-rt5px1")&&T(t,"class",n)},d:function(u){u&&h(t)}};return $("SvelteRegisterBlock",{block:a,id:Lt.name,type:"each",source:"(2814:12) {#each scaleSteps as step, index}",ctx:c}),a}function Ot(c){let t,e,i,r="ãƒ‰ãƒ¬ãƒŸãƒ•ã‚¡ã‚½ãƒ©ã‚·ãƒ‰",n;const a={c:function(){t=M("div"),e=J("ã‚¬ã‚¤ãƒ‰ã«åˆã‚ã›ã¦ "),i=M("strong"),i.textContent=r,n=J(" ã‚’æ­Œã£ã¦ãã ã•ã„"),this.h()},l:function(u){t=R(u,"DIV",{class:!0});var f=H(t);e=W(f,"ã‚¬ã‚¤ãƒ‰ã«åˆã‚ã›ã¦ "),i=R(f,"STRONG",{"data-svelte-h":!0}),ve(i)!=="svelte-1dipf74"&&(i.textContent=r),n=W(f," ã‚’æ­Œã£ã¦ãã ã•ã„"),f.forEach(h),this.h()},h:function(){F(i,N,2823,23,96078),T(t,"class","guide-instruction svelte-rt5px1"),F(t,N,2822,12,96023)},m:function(u,f){U(u,t,f),g(t,e),g(t,i),g(t,n)},d:function(u){u&&h(t)}};return $("SvelteRegisterBlock",{block:a,id:Ot.name,type:"if",source:"(2822:10) {#if trainingPhase === 'guiding'}",ctx:c}),a}function eo(c){let t,e,i="ğŸµ ãƒ‰ãƒ¬ãƒŸéŸ³éšã‚¬ã‚¤ãƒ‰",r,n,a,s,u=ut(c[10]),f=[];for(let v=0;v<u.length;v+=1)f[v]=Lt(Nn(c,u,v));let d=c[0]==="guiding"&&Ot(c);const m={c:function(){t=M("div"),e=M("h3"),e.textContent=i,r=Z(),n=M("div"),a=M("div");for(let C=0;C<f.length;C+=1)f[C].c();s=Z(),d&&d.c(),this.h()},l:function(C){t=R(C,"DIV",{class:!0});var p=H(t);e=R(p,"H3",{class:!0,"data-svelte-h":!0}),ve(e)!=="svelte-1mor0as"&&(e.textContent=i),p.forEach(h),r=Y(C),n=R(C,"DIV",{class:!0});var y=H(n);a=R(y,"DIV",{class:!0});var b=H(a);for(let z=0;z<f.length;z+=1)f[z].l(b);b.forEach(h),s=Y(y),d&&d.l(y),y.forEach(h),this.h()},h:function(){T(e,"class","section-title svelte-rt5px1"),F(e,N,2809,10,95588),T(t,"class","card-header svelte-rt5px1"),F(t,N,2808,8,95552),T(a,"class","scale-guide svelte-rt5px1"),F(a,N,2812,10,95691),T(n,"class","card-content svelte-rt5px1"),F(n,N,2811,8,95654)},m:function(C,p){U(C,t,p),g(t,e),U(C,r,p),U(C,n,p),g(n,a);for(let y=0;y<f.length;y+=1)f[y]&&f[y].m(a,null);g(n,s),d&&d.m(n,null)},p:function(C,p){if(p[0]&1024){u=ut(C[10]);let y;for(y=0;y<u.length;y+=1){const b=Nn(C,u,y);f[y]?f[y].p(b,p):(f[y]=Lt(b),f[y].c(),f[y].m(a,null))}for(;y<f.length;y+=1)f[y].d(1);f.length=u.length}C[0]==="guiding"?d||(d=Ot(C),d.c(),d.m(n,null)):d&&(d.d(1),d=null)},d:function(C){C&&(h(t),h(r),h(n)),Pn(f,C),d&&d.d()}};return $("SvelteRegisterBlock",{block:m,id:eo.name,type:"slot",source:'(2808:6) <Card class=\\"main-card\\">',ctx:c}),m}function Gt(c){let t,e,i,r,n,a,s;const u=[no,to],f=[];function d(y,b){return y[4]&&y[5]?0:y[21]?1:-1}~(t=d(c))&&(e=f[t]=u[t](c));const m=[ro,oo],v=[];function C(y,b){return y[0]==="results"&&y[5]?0:y[0]==="results"&&!y[5]?1:-1}~(r=C(c))&&(n=v[r]=m[r](c));const p={c:function(){e&&e.c(),i=Z(),n&&n.c(),a=je()},l:function(b){e&&e.l(b),i=Y(b),n&&n.l(b),a=je()},m:function(b,z){~t&&f[t].m(b,z),U(b,i,z),~r&&v[r].m(b,z),U(b,a,z),s=!0},p:function(b,z){let q=t;t=d(b),t===q?~t&&f[t].p(b,z):(e&&(Ie(),Q(f[q],1,1,()=>{f[q]=null}),Te()),~t?(e=f[t],e?e.p(b,z):(e=f[t]=u[t](b),e.c()),G(e,1),e.m(i.parentNode,i)):e=null);let A=r;r=C(b),r===A?~r&&v[r].p(b,z):(n&&(Ie(),Q(v[A],1,1,()=>{v[A]=null}),Te()),~r?(n=v[r],n?n.p(b,z):(n=v[r]=m[r](b),n.c()),G(n,1),n.m(a.parentNode,a)):n=null)},i:function(b){s||(G(e),G(n),s=!0)},o:function(b){Q(e),Q(n),s=!1},d:function(b){b&&(h(i),h(a)),~t&&f[t].d(b),~r&&v[r].d(b)}};return $("SvelteRegisterBlock",{block:p,id:Gt.name,type:"if",source:"(2833:4) {#if trainingPhase === 'results'}",ctx:c}),p}function to(c){let t,e;t=new Kt({props:{scoreData:c[21],showDetails:!1,className:"mb-6 iphone-no-margin",currentScoreData:c[16],intervalData:c[3],consistencyData:c[17],feedbackData:c[18],technicalFeedbackData:c[19],sessionStatistics:c[20]},$$inline:!0});const i={c:function(){ge(t.$$.fragment)},l:function(n){me(t.$$.fragment,n)},m:function(n,a){de(t,n,a),e=!0},p:function(n,a){const s={};a[0]&2097152&&(s.scoreData=n[21]),a[0]&65536&&(s.currentScoreData=n[16]),a[0]&8&&(s.intervalData=n[3]),a[0]&131072&&(s.consistencyData=n[17]),a[0]&262144&&(s.feedbackData=n[18]),a[0]&524288&&(s.technicalFeedbackData=n[19]),a[0]&1048576&&(s.sessionStatistics=n[20]),t.$set(s)},i:function(n){e||(G(t.$$.fragment,n),e=!0)},o:function(n){Q(t.$$.fragment,n),e=!1},d:function(n){fe(t,n)}};return $("SvelteRegisterBlock",{block:i,id:to.name,type:"if",source:"(2850:40) ",ctx:c}),i}function no(c){let t,e,i,r=c[4]&&Ut(c);e=new Kt({props:{scoreData:c[4],showDetails:!1,className:"mb-6 iphone-no-margin",currentScoreData:c[16],intervalData:c[3],consistencyData:c[17],feedbackData:c[18],technicalFeedbackData:c[19],sessionStatistics:c[20]},$$inline:!0});const n={c:function(){r&&r.c(),t=Z(),ge(e.$$.fragment)},l:function(s){r&&r.l(s),t=Y(s),me(e.$$.fragment,s)},m:function(s,u){r&&r.m(s,u),U(s,t,u),de(e,s,u),i=!0},p:function(s,u){s[4]?r||(r=Ut(s),r.c(),r.m(t.parentNode,t)):r&&(r.d(1),r=null);const f={};u[0]&16&&(f.scoreData=s[4]),u[0]&65536&&(f.currentScoreData=s[16]),u[0]&8&&(f.intervalData=s[3]),u[0]&131072&&(f.consistencyData=s[17]),u[0]&262144&&(f.feedbackData=s[18]),u[0]&524288&&(f.technicalFeedbackData=s[19]),u[0]&1048576&&(f.sessionStatistics=s[20]),e.$set(f)},i:function(s){i||(G(e.$$.fragment,s),i=!0)},o:function(s){Q(e.$$.fragment,s),i=!1},d:function(s){s&&h(t),r&&r.d(s),fe(e,s)}};return $("SvelteRegisterBlock",{block:n,id:no.name,type:"if",source:"(2835:6) {#if $unifiedScoreData && $isCompleted}",ctx:c}),n}function Ut(c){const t={c:Je,l:Je,m:Je,d:Je};return $("SvelteRegisterBlock",{block:t,id:Ut.name,type:"if",source:"(2837:8) {#if $unifiedScoreData}",ctx:c}),t}function oo(c){let t,e;t=new Ke({props:{class:"main-card bottom-action-card",$$slots:{default:[so]},$$scope:{ctx:c}},$$inline:!0});const i={c:function(){ge(t.$$.fragment)},l:function(n){me(t.$$.fragment,n)},m:function(n,a){de(t,n,a),e=!0},p:function(n,a){const s={};a[3]&4096&&(s.$$scope={dirty:a,ctx:n}),t.$set(s)},i:function(n){e||(G(t.$$.fragment,n),e=!0)},o:function(n){Q(t.$$.fragment,n),e=!1},d:function(n){fe(t,n)}};return $("SvelteRegisterBlock",{block:i,id:oo.name,type:"if",source:"(2879:61) ",ctx:c}),i}function ro(c){let t,e;t=new Ke({props:{class:"main-card bottom-action-card",$$slots:{default:[ao]},$$scope:{ctx:c}},$$inline:!0});const i={c:function(){ge(t.$$.fragment)},l:function(n){me(t.$$.fragment,n)},m:function(n,a){de(t,n,a),e=!0},p:function(n,a){const s={};a[0]&32|a[3]&4096&&(s.$$scope={dirty:a,ctx:n}),t.$set(s)},i:function(n){e||(G(t.$$.fragment,n),e=!0)},o:function(n){Q(t.$$.fragment,n),e=!1},d:function(n){fe(t,n)}};return $("SvelteRegisterBlock",{block:i,id:ro.name,type:"if",source:"(2868:6) {#if trainingPhase === 'results' && $isCompleted}",ctx:c}),i}function so(c){let t,e,i,r,n,a,s="æ¬¡ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’æº–å‚™ä¸­...";const u={c:function(){t=M("div"),e=M("div"),i=M("div"),r=M("div"),n=Z(),a=M("span"),a.textContent=s,this.h()},l:function(d){t=R(d,"DIV",{class:!0});var m=H(t);e=R(m,"DIV",{class:!0});var v=H(e);i=R(v,"DIV",{class:!0});var C=H(i);r=R(C,"DIV",{class:!0}),H(r).forEach(h),n=Y(C),a=R(C,"SPAN",{"data-svelte-h":!0}),ve(a)!=="svelte-11jhwau"&&(a.textContent=s),C.forEach(h),v.forEach(h),m.forEach(h),this.h()},h:function(){T(r,"class","spinner"),F(r,N,2884,16,98183),F(a,N,2885,16,98227),T(i,"class","auto-progress-indicator"),F(i,N,2883,14,98129),T(e,"class","continuous-mode-message"),F(e,N,2882,12,98077),T(t,"class","card-content svelte-rt5px1"),F(t,N,2881,10,98038)},m:function(d,m){U(d,t,m),g(t,e),g(e,i),g(i,r),g(i,n),g(i,a)},p:Je,d:function(d){d&&h(t)}};return $("SvelteRegisterBlock",{block:u,id:so.name,type:"slot",source:'(2881:8) <Card class=\\"main-card bottom-action-card\\">',ctx:c}),u}function ao(c){let t,e,i;e=new Jt({props:{isCompleted:c[5],position:"bottom"},$$inline:!0}),e.$on("action",c[29]);const r={c:function(){t=M("div"),ge(e.$$.fragment),this.h()},l:function(a){t=R(a,"DIV",{class:!0});var s=H(t);me(e.$$.fragment,s),s.forEach(h),this.h()},h:function(){T(t,"class","card-content svelte-rt5px1"),F(t,N,2869,10,97596)},m:function(a,s){U(a,t,s),de(e,t,null),i=!0},p:function(a,s){const u={};s[0]&32&&(u.isCompleted=a[5]),e.$set(u)},i:function(a){i||(G(e.$$.fragment,a),i=!0)},o:function(a){Q(e.$$.fragment,a),i=!1},d:function(a){a&&h(t),fe(e)}};return $("SvelteRegisterBlock",{block:r,id:ao.name,type:"slot",source:'(2869:8) <Card class=\\"main-card bottom-action-card\\">',ctx:c}),r}function co(c){let t,e,i="âš¡ é€£ç¶šãƒãƒ£ãƒ¬ãƒ³ã‚¸ãƒ¢ãƒ¼ãƒ‰",r,n,a="ä¸­ç´šè€…å‘ã‘ï¼š8ã‚»ãƒƒã‚·ãƒ§ãƒ³é€£ç¶šã§åŸºéŸ³ãŒè‡ªå‹•å†ç”Ÿã•ã‚Œã‚‹é›†ä¸­ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°",s,u,f,d,m=io+"",v,C,p=lo+"",y,b,z,q,A=uo+"",X,P,j,B,_,ee,D=c[1]==="granted"&&!c[25]&&Pt(c);const w=[jn,zn],x=[];function L(E,I){return E[1]==="granted"?0:1}j=L(c),B=x[j]=w[j](c);const oe={c:function(){t=M("div"),e=M("h1"),e.textContent=i,r=Z(),n=M("p"),n.textContent=a,s=Z(),D&&D.c(),u=Z(),f=M("div"),d=J("ğŸ“± "),v=J(m),C=J(" | "),y=J(p),b=M("br"),z=Z(),q=M("small"),X=J(A),P=Z(),B.c(),_=je(),this.h()},l:function(I){t=R(I,"DIV",{class:!0});var te=H(t);e=R(te,"H1",{class:!0,"data-svelte-h":!0}),ve(e)!=="svelte-1nub9gt"&&(e.textContent=i),r=Y(te),n=R(te,"P",{class:!0,"data-svelte-h":!0}),ve(n)!=="svelte-gneggn"&&(n.textContent=a),s=Y(te),D&&D.l(te),u=Y(te),f=R(te,"DIV",{class:!0});var K=H(f);d=W(K,"ğŸ“± "),v=W(K,m),C=W(K," | "),y=W(K,p),b=R(K,"BR",{}),z=Y(K),q=R(K,"SMALL",{style:!0});var ye=H(q);X=W(ye,A),ye.forEach(h),K.forEach(h),te.forEach(h),P=Y(I),B.l(I),_=je(),this.h()},h:function(){T(e,"class","page-title svelte-rt5px1"),F(e,N,2650,4,90066),T(n,"class","page-description svelte-rt5px1"),F(n,N,2651,4,90111),F(b,N,2685,54,91347),Xe(q,"font-size","0.6rem"),F(q,N,2686,6,91359),T(f,"class","debug-info svelte-rt5px1"),F(f,N,2684,4,91268),T(t,"class","header-section svelte-rt5px1"),F(t,N,2649,2,90033)},m:function(I,te){U(I,t,te),g(t,e),g(t,r),g(t,n),g(t,s),D&&D.m(t,null),g(t,u),g(t,f),g(f,d),g(f,v),g(f,C),g(f,y),g(f,b),g(f,z),g(f,q),g(q,X),U(I,P,te),x[j].m(I,te),U(I,_,te),ee=!0},p:function(I,te){I[1]==="granted"&&!I[25]?D?(D.p(I,te),te[0]&33554434&&G(D,1)):(D=Pt(I),D.c(),G(D,1),D.m(t,u)):D&&(Ie(),Q(D,1,1,()=>{D=null}),Te());let K=j;j=L(I),j===K?x[j].p(I,te):(Ie(),Q(x[K],1,1,()=>{x[K]=null}),Te(),B=x[j],B?B.p(I,te):(B=x[j]=w[j](I),B.c()),G(B,1),B.m(_.parentNode,_))},i:function(I){ee||(G(D),G(B),ee=!0)},o:function(I){Q(D),Q(B),ee=!1},d:function(I){I&&(h(t),h(P),h(_)),D&&D.d(),x[j].d(I)}};return $("SvelteRegisterBlock",{block:oe,id:co.name,type:"slot",source:"(2648:0) <PageLayout>",ctx:c}),oe}function Wt(c){let t,e,i;e=new Bn({props:{$$slots:{default:[co]},$$scope:{ctx:c}},$$inline:!0});const r={c:function(){t=Z(),ge(e.$$.fragment),this.h()},l:function(a){wo("svelte-13kpo59",Mn.head).forEach(h),t=Y(a),me(e.$$.fragment,a),this.h()},h:function(){Mn.title="é€£ç¶šãƒãƒ£ãƒ¬ãƒ³ã‚¸ãƒ¢ãƒ¼ãƒ‰ - ç›¸å¯¾éŸ³æ„Ÿãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°"},m:function(a,s){U(a,t,s),de(e,a,s),i=!0},p:function(a,s){const u={};s[0]&67108863|s[3]&4096&&(u.$$scope={dirty:s,ctx:a}),e.$set(u)},i:function(a){i||(G(e.$$.fragment,a),i=!0)},o:function(a){Q(e.$$.fragment,a),i=!1},d:function(a){a&&h(t),fe(e,a)}};return $("SvelteRegisterBlock",{block:r,id:Wt.name,type:"component",source:"",ctx:c}),r}const io="v2.3.1-ANIMATED",lo="07/29 04:15",uo="ğŸ¬ è©•ä¾¡åˆ†å¸ƒã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè£…ãƒ»UXå‘ä¸Š";function In(){const c=/iPhone/.test(navigator.userAgent),t=/iPad/.test(navigator.userAgent),e=/Macintosh/.test(navigator.userAgent)&&"ontouchend"in document;return c||t||e?(console.log("ğŸ”Š [RandomTraining] iOS/iPadOSæ¤œå‡º - éŸ³é‡35dBè¨­å®š"),35):(console.log("ğŸ”Š [RandomTraining] PCæ¤œå‡º - éŸ³é‡-6dBè¨­å®š"),-6)}function Ko(){return{mode:"continuous",timestamp:new Date,duration:480,totalNotes:64,measuredNotes:59,averageAccuracy:79,baseNote:"C5",baseFrequency:523.25,sessionHistory:[{grade:"excellent",accuracy:92,baseNote:"C4",baseFrequency:261.63,timestamp:new Date(Date.now()-7*6e4),measuredNotes:8,noteResults:[{name:"ãƒ‰",note:"ãƒ‰",frequency:262,detectedFrequency:264,cents:13,grade:"excellent"},{name:"ãƒ¬",note:"ãƒ¬",frequency:294,detectedFrequency:291,cents:-18,grade:"good"},{name:"ãƒŸ",note:"ãƒŸ",frequency:330,detectedFrequency:335,cents:26,grade:"pass"},{name:"ãƒ•ã‚¡",note:"ãƒ•ã‚¡",frequency:349,detectedFrequency:346,cents:-15,grade:"excellent"},{name:"ã‚½",note:"ã‚½",frequency:392,detectedFrequency:388,cents:-18,grade:"good"},{name:"ãƒ©",note:"ãƒ©",frequency:440,detectedFrequency:444,cents:16,grade:"good"},{name:"ã‚·",note:"ã‚·",frequency:494,detectedFrequency:499,cents:17,grade:"good"},{name:"ãƒ‰ï¼ˆé«˜ï¼‰",note:"ãƒ‰ï¼ˆé«˜ï¼‰",frequency:523,detectedFrequency:520,cents:-10,grade:"excellent"}]},{grade:"good",accuracy:78,baseNote:"D4",baseFrequency:293.66,timestamp:new Date(Date.now()-6*6e4),measuredNotes:7,noteResults:[{name:"ãƒ‰",note:"ãƒ‰",frequency:294,detectedFrequency:290,cents:-23,grade:"good"},{name:"ãƒ¬",note:"ãƒ¬",frequency:330,detectedFrequency:340,cents:53,grade:"needWork"},{name:"ãƒŸ",note:"ãƒŸ",frequency:370,detectedFrequency:375,cents:23,grade:"good"},{name:"ãƒ•ã‚¡",note:"ãƒ•ã‚¡",frequency:392,detectedFrequency:385,cents:-31,grade:"pass"},{name:"ã‚½",note:"ã‚½",frequency:440,detectedFrequency:432,cents:-31,grade:"pass"},{name:"ãƒ©",note:"ãƒ©",frequency:494,detectedFrequency:510,cents:56,grade:"needWork"},{name:"ã‚·",note:"ã‚·",frequency:554,detectedFrequency:null,cents:null,grade:"notMeasured"},{name:"ãƒ‰ï¼ˆé«˜ï¼‰",note:"ãƒ‰ï¼ˆé«˜ï¼‰",frequency:587,detectedFrequency:580,cents:-21,grade:"good"}]},{grade:"excellent",accuracy:95,baseNote:"E4",baseFrequency:329.63,timestamp:new Date(Date.now()-5*6e4),measuredNotes:8,noteResults:[{name:"ãƒ‰",note:"ãƒ‰",frequency:330,detectedFrequency:332,cents:10,grade:"excellent"},{name:"ãƒ¬",note:"ãƒ¬",frequency:370,detectedFrequency:368,cents:-9,grade:"excellent"},{name:"ãƒŸ",note:"ãƒŸ",frequency:415,detectedFrequency:418,cents:12,grade:"excellent"},{name:"ãƒ•ã‚¡",note:"ãƒ•ã‚¡",frequency:440,detectedFrequency:436,cents:-16,grade:"good"},{name:"ã‚½",note:"ã‚½",frequency:494,detectedFrequency:497,cents:11,grade:"excellent"},{name:"ãƒ©",note:"ãƒ©",frequency:554,detectedFrequency:551,cents:-9,grade:"excellent"},{name:"ã‚·",note:"ã‚·",frequency:622,detectedFrequency:625,cents:8,grade:"excellent"},{name:"ãƒ‰ï¼ˆé«˜ï¼‰",note:"ãƒ‰ï¼ˆé«˜ï¼‰",frequency:659,detectedFrequency:655,cents:-10,grade:"excellent"}]},{grade:"needWork",accuracy:45,baseNote:"F4",baseFrequency:349.23,timestamp:new Date(Date.now()-4*6e4),measuredNotes:6,noteResults:[{name:"ãƒ‰",note:"ãƒ‰",frequency:349,detectedFrequency:345,cents:-20,grade:"good"},{name:"ãƒ¬",note:"ãƒ¬",frequency:392,detectedFrequency:420,cents:124,grade:"needWork"},{name:"ãƒŸ",note:"ãƒŸ",frequency:440,detectedFrequency:435,cents:-20,grade:"good"},{name:"ãƒ•ã‚¡",note:"ãƒ•ã‚¡",frequency:466,detectedFrequency:520,cents:195,grade:"needWork"},{name:"ã‚½",note:"ã‚½",frequency:523,detectedFrequency:410,cents:-455,grade:"needWork"},{name:"ãƒ©",note:"ãƒ©",frequency:587,detectedFrequency:null,cents:null,grade:"notMeasured"},{name:"ã‚·",note:"ã‚·",frequency:659,detectedFrequency:650,cents:-24,grade:"good"},{name:"ãƒ‰ï¼ˆé«˜ï¼‰",note:"ãƒ‰ï¼ˆé«˜ï¼‰",frequency:698,detectedFrequency:null,cents:null,grade:"notMeasured"}]},{grade:"good",accuracy:85,baseNote:"G4",baseFrequency:392,timestamp:new Date(Date.now()-3*6e4),measuredNotes:8,noteResults:[{name:"ãƒ‰",note:"ãƒ‰",frequency:392,detectedFrequency:395,cents:13,grade:"excellent"},{name:"ãƒ¬",note:"ãƒ¬",frequency:440,detectedFrequency:438,cents:-8,grade:"excellent"},{name:"ãƒŸ",note:"ãƒŸ",frequency:494,detectedFrequency:500,cents:21,grade:"good"},{name:"ãƒ•ã‚¡",note:"ãƒ•ã‚¡",frequency:523,detectedFrequency:520,cents:-10,grade:"excellent"},{name:"ã‚½",note:"ã‚½",frequency:587,detectedFrequency:595,cents:24,grade:"good"},{name:"ãƒ©",note:"ãƒ©",frequency:659,detectedFrequency:665,cents:16,grade:"good"},{name:"ã‚·",note:"ã‚·",frequency:740,detectedFrequency:755,cents:35,grade:"pass"},{name:"ãƒ‰ï¼ˆé«˜ï¼‰",note:"ãƒ‰ï¼ˆé«˜ï¼‰",frequency:784,detectedFrequency:780,cents:-9,grade:"excellent"}]},{grade:"excellent",accuracy:94,baseNote:"A4",baseFrequency:440,timestamp:new Date(Date.now()-2*6e4),measuredNotes:8,noteResults:[{name:"ãƒ‰",note:"ãƒ‰",frequency:440,detectedFrequency:442,cents:8,grade:"excellent"},{name:"ãƒ¬",note:"ãƒ¬",frequency:494,detectedFrequency:492,cents:-7,grade:"excellent"},{name:"ãƒŸ",note:"ãƒŸ",frequency:554,detectedFrequency:558,cents:12,grade:"excellent"},{name:"ãƒ•ã‚¡",note:"ãƒ•ã‚¡",frequency:587,detectedFrequency:585,cents:-6,grade:"excellent"},{name:"ã‚½",note:"ã‚½",frequency:659,detectedFrequency:665,cents:16,grade:"good"},{name:"ãƒ©",note:"ãƒ©",frequency:740,detectedFrequency:738,cents:-5,grade:"excellent"},{name:"ã‚·",note:"ã‚·",frequency:831,detectedFrequency:840,cents:19,grade:"good"},{name:"ãƒ‰ï¼ˆé«˜ï¼‰",note:"ãƒ‰ï¼ˆé«˜ï¼‰",frequency:880,detectedFrequency:882,cents:4,grade:"excellent"}]},{grade:"pass",accuracy:68,baseNote:"Bb4",baseFrequency:466.16,timestamp:new Date(Date.now()-1*6e4),measuredNotes:7,noteResults:[{name:"ãƒ‰",note:"ãƒ‰",frequency:466,detectedFrequency:470,cents:15,grade:"excellent"},{name:"ãƒ¬",note:"ãƒ¬",frequency:523,detectedFrequency:535,cents:39,grade:"pass"},{name:"ãƒŸ",note:"ãƒŸ",frequency:587,detectedFrequency:600,cents:38,grade:"pass"},{name:"ãƒ•ã‚¡",note:"ãƒ•ã‚¡",frequency:622,detectedFrequency:615,cents:-19,grade:"good"},{name:"ã‚½",note:"ã‚½",frequency:698,detectedFrequency:720,cents:54,grade:"needWork"},{name:"ãƒ©",note:"ãƒ©",frequency:784,detectedFrequency:null,cents:null,grade:"notMeasured"},{name:"ã‚·",note:"ã‚·",frequency:880,detectedFrequency:895,cents:29,grade:"pass"},{name:"ãƒ‰ï¼ˆé«˜ï¼‰",note:"ãƒ‰ï¼ˆé«˜ï¼‰",frequency:932,detectedFrequency:925,cents:-13,grade:"excellent"}]},{grade:"good",accuracy:82,baseNote:"C5",baseFrequency:523.25,timestamp:new Date,measuredNotes:8,noteResults:[{name:"ãƒ‰",note:"ãƒ‰",frequency:523,detectedFrequency:526,cents:10,grade:"excellent"},{name:"ãƒ¬",note:"ãƒ¬",frequency:587,detectedFrequency:584,cents:-9,grade:"excellent"},{name:"ãƒŸ",note:"ãƒŸ",frequency:659,detectedFrequency:665,cents:16,grade:"good"},{name:"ãƒ•ã‚¡",note:"ãƒ•ã‚¡",frequency:698,detectedFrequency:692,cents:-15,grade:"excellent"},{name:"ã‚½",note:"ã‚½",frequency:784,detectedFrequency:795,cents:24,grade:"good"},{name:"ãƒ©",note:"ãƒ©",frequency:880,detectedFrequency:890,cents:19,grade:"good"},{name:"ã‚·",note:"ã‚·",frequency:988,detectedFrequency:1010,cents:38,grade:"pass"},{name:"ãƒ‰ï¼ˆé«˜ï¼‰",note:"ãƒ‰ï¼ˆé«˜ï¼‰",frequency:1047,detectedFrequency:1042,cents:-8,grade:"excellent"}]}]}}function Tt(c){return[{scale:"ãƒ‰",interval:"unison",intervalName:"ãƒ¦ãƒ‹ã‚¾ãƒ³"},{scale:"ãƒ¬",interval:"major_second",intervalName:"é•·2åº¦"},{scale:"ãƒŸ",interval:"major_third",intervalName:"é•·3åº¦"},{scale:"ãƒ•ã‚¡",interval:"perfect_fourth",intervalName:"å®Œå…¨4åº¦"},{scale:"ã‚½",interval:"perfect_fifth",intervalName:"å®Œå…¨5åº¦"},{scale:"ãƒ©",interval:"major_sixth",intervalName:"é•·6åº¦"},{scale:"ã‚·",interval:"major_seventh",intervalName:"é•·7åº¦"},{scale:"ãƒ‰ï¼ˆé«˜ï¼‰",interval:"octave",intervalName:"ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–"}].map((e,i)=>{const r=c.find(n=>n.targetNote&&n.targetNote.includes(e.scale))||c[i];if(r&&r.accuracy!=="notMeasured"){const n=parseFloat(r.accuracy)||0,a=Math.round((100-n)*.5);return{type:e.interval,scale:e.scale,intervalName:e.intervalName,attempts:1,averageError:a,accuracy:n}}else return{type:e.interval,scale:e.scale,intervalName:e.intervalName,attempts:0,averageError:null,accuracy:0}})}function Tn(c){if(!c||!Array.isArray(c))return console.warn("âš ï¸ [RandomTraining] sessionHistory ãŒç„¡åŠ¹ã§ã™"),[];const t=[{type:"unison",scale:"ãƒ‰",intervalName:"ãƒ¦ãƒ‹ã‚¾ãƒ³",noteIndex:0},{type:"major_second",scale:"ãƒ¬",intervalName:"é•·2åº¦",noteIndex:1},{type:"major_third",scale:"ãƒŸ",intervalName:"é•·3åº¦",noteIndex:2},{type:"perfect_fourth",scale:"ãƒ•ã‚¡",intervalName:"å®Œå…¨4åº¦",noteIndex:3},{type:"perfect_fifth",scale:"ã‚½",intervalName:"å®Œå…¨5åº¦",noteIndex:4},{type:"major_sixth",scale:"ãƒ©",intervalName:"é•·6åº¦",noteIndex:5},{type:"major_seventh",scale:"ã‚·",intervalName:"é•·7åº¦",noteIndex:6},{type:"octave",scale:"ãƒ‰ï¼ˆé«˜ï¼‰",intervalName:"ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–",noteIndex:7}],e={};return t.forEach(i=>{e[i.type]={type:i.type,scale:i.scale,intervalName:i.intervalName,attempts:0,successCount:0,accuracySum:0,accuracyValues:[],errorValues:[]}}),c.forEach(i=>{!i.noteResults||!Array.isArray(i.noteResults)||i.noteResults.forEach((r,n)=>{if(n>=t.length)return;const a=t[n].type,s=e[a];if(s.attempts++,r.accuracy!=="notMeasured"&&typeof r.accuracy=="number"){s.accuracyValues.push(r.accuracy),s.accuracySum+=r.accuracy;const u=Math.round((100-r.accuracy)*.5);s.errorValues.push(u),r.accuracy>=70&&s.successCount++}})}),t.map(i=>{const r=e[i.type];if(r.attempts===0)return{type:i.type,scale:i.scale,intervalName:i.intervalName,attempts:0,averageError:null,accuracy:0};const n=r.accuracyValues.length>0?Math.round(r.accuracySum/r.accuracyValues.length):0,a=r.errorValues.length>0?Math.round(r.errorValues.reduce((u,f)=>u+f,0)/r.errorValues.length):null,s=r.accuracyValues.length>0?Math.round(r.successCount/r.accuracyValues.length*100):0;return{type:i.type,scale:i.scale,intervalName:i.intervalName,mastery:s,attempts:r.attempts,averageError:a,accuracy:n}})}function En(c){const t=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];if(c<=0)return"ãƒ¼ãƒ¼";const i=Math.round(12*Math.log2(c/440)),r=(i+9+120)%12,n=Math.floor((i+9)/12)+4;return t[r]+n}function Et(c,t){const e=[{factor:4,freq:c*4,description:"2ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–ä¸Š"},{factor:3,freq:c*3,description:"1.5ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–ä¸Š"},{factor:2.5,freq:c*2.5,description:"1.3ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–ä¸Š"},{factor:2,freq:c*2,description:"1ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–ä¸Š"},{factor:1.5,freq:c*1.5,description:"0.5ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–ä¸Š"},{factor:1,freq:c,description:"è£œæ­£ãªã—"},{factor:.75,freq:c*.75,description:"0.33ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–ä¸‹"},{factor:.67,freq:c*.67,description:"0.5ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–ä¸‹"},{factor:.5,freq:c*.5,description:"1ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–ä¸‹"},{factor:.4,freq:c*.4,description:"1.3ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–ä¸‹"},{factor:.33,freq:c*.33,description:"1.5ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–ä¸‹"},{factor:.25,freq:c*.25,description:"2ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–ä¸‹"}];let i=null,r=1/0;const n=t*.5,a=t*1.5,s=e.filter(u=>u.freq>=n&&u.freq<=a);for(const u of s){const f=Math.abs(u.freq-t);f<r&&(r=f,i=u)}if(!i)for(const u of e){const f=Math.abs(u.freq-t);f<r&&(r=f,i=u)}return i?{correctedFrequency:i.freq,factor:i.factor,description:i.description,error:r}:{correctedFrequency:c,factor:1,description:"è£œæ­£ãªã—ï¼ˆãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼‰",error:Math.abs(c-t)}}function rt(){try{"scrollTo"in window&&"behavior"in document.documentElement.style?window.scrollTo({top:0,behavior:"smooth"}):window.scrollTo(0,0),document.body&&(document.body.scrollTop=0),document.documentElement&&(document.documentElement.scrollTop=0),document.querySelectorAll("[data-scroll-container], .scroll-container, main").forEach(t=>{t.scrollTo?t.scrollTo(0,0):t.scrollTop=0})}catch(c){console.warn("ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã‚¨ãƒ©ãƒ¼:",c);try{window.scroll(0,0)}catch(t){console.error("ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«å®Œå…¨å¤±æ•—:",t)}}}function fo(c){}function Qo(c,t,e){let i,r,n,a,s,u,f,d,m,v,C,p;Ne(Nt,"currentSessionId"),Ae(c,Nt,o=>e(23,n=o)),Ne(qt,"unifiedScoreData"),Ae(c,qt,o=>e(4,a=o)),Ne(Ct,"isCompleted"),Ae(c,Ct,o=>e(5,s=o)),Ne(St,"page"),Ae(c,St,o=>e(54,u=o)),Ne(wt,"remainingSessions"),Ae(c,wt,o=>e(55,f=o)),Ne(Rt,"nextBaseName"),Ae(c,Rt,o=>e(56,d=o)),Ne(Mt,"nextBaseNote"),Ae(c,Mt,o=>e(57,m=o)),Ne(kt,"sessionHistory"),Ae(c,kt,o=>e(24,v=o)),Ne(At,"trainingProgress"),Ae(c,At,o=>e(58,C=o)),Ne(Ft,"isLoading"),Ae(c,Ft,o=>e(25,p=o));let{$$slots:y={},$$scope:b}=t;qo("Page",y,[]);function z(o){return ot.evaluateOverall(o)}let q="setup",A=typeof window<"u"?new URLSearchParams(window.location.search).get("from")==="microphone-test"?(ie.info("[RandomTraining] ãƒã‚¤ã‚¯ãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸ã‹ã‚‰ã®é·ç§»ã‚’æ¤œå‡º"),"granted"):(ie.info("[RandomTraining] ãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã‚¢ã‚¯ã‚»ã‚¹ã‚’æ¤œå‡º"),"checking"):"checking",X=!0,P=[];const j=["ãƒ‰","ãƒ¬","ãƒŸ","ãƒ•ã‚¡","ã‚½","ãƒ©","ã‚·","ãƒ‰ï¼ˆé«˜ï¼‰"];let B="",_=0,ee=!1,D=0,w=j.map(o=>({name:o,state:"inactive",completed:!1})),x=null,L=!1,oe=0,E=!1,I=null,te=!1,K=[],ye=[],Se=0,Ee=0,Le="ãƒ¼ãƒ¼",Ve=0,He={correctCount:0,totalCount:8,averageAccuracy:0,averageTime:0,isCompleted:!1},we=null,ze={totalScore:0,grade:"C",componentScores:{pitchAccuracy:0,recognitionSpeed:0,intervalMastery:0,directionAccuracy:0,consistency:0}},ke=[],Pe=[],Oe={},Ye={},Fe={totalAttempts:0,successRate:0,averageScore:0,bestScore:0,sessionDuration:0,streakCount:0,fatigueLevel:"fresh",mostDifficultInterval:"-",mostSuccessfulInterval:"-",averageResponseTime:0,sessionStart:Date.now()},dt="intervals",ae=[],ue=null,he=null,Re=!0,ne=null,Be=null,st=null,at=null,Qe=null;const Ge=[{note:"C4",name:"ãƒ‰ï¼ˆä¸­ï¼‰",frequency:261.63,semitonesFromC:0},{note:"Db4",name:"ãƒ‰#ï¼ˆä¸­ï¼‰",frequency:277.18,semitonesFromC:1},{note:"D4",name:"ãƒ¬ï¼ˆä¸­ï¼‰",frequency:293.66,semitonesFromC:2},{note:"Eb4",name:"ãƒ¬#ï¼ˆä¸­ï¼‰",frequency:311.13,semitonesFromC:3},{note:"E4",name:"ãƒŸï¼ˆä¸­ï¼‰",frequency:329.63,semitonesFromC:4},{note:"F4",name:"ãƒ•ã‚¡ï¼ˆä¸­ï¼‰",frequency:349.23,semitonesFromC:5},{note:"Gb4",name:"ãƒ•ã‚¡#ï¼ˆä¸­ï¼‰",frequency:369.99,semitonesFromC:6},{note:"Ab4",name:"ãƒ©bï¼ˆä¸­ï¼‰",frequency:415.3,semitonesFromC:8},{note:"Bb3",name:"ã‚·bï¼ˆä½ï¼‰",frequency:233.08,semitonesFromC:-2},{note:"B3",name:"ã‚·ï¼ˆä½ï¼‰",frequency:246.94,semitonesFromC:-1}];async function Ue(){var o;e(1,A="checking");try{if(console.log("ğŸ¤ [RandomTraining] AudioManagerçµŒç”±ã§ãƒã‚¤ã‚¯è¨±å¯ç¢ºèªé–‹å§‹"),!((o=navigator.mediaDevices)!=null&&o.getUserMedia)){e(1,A="error");return}const l=await We.initialize();st=l.audioContext,Be=l.mediaStream,at=l.sourceNode,console.log("âœ… [RandomTraining] AudioManager ãƒªã‚½ãƒ¼ã‚¹å–å¾—å®Œäº†"),e(1,A="granted"),e(0,q="setup"),setTimeout(async()=>{if(ne){ie.audio("[RandomTraining] PitchDetectoråˆæœŸåŒ–é–‹å§‹");const S=/iPhone/.test(navigator.userAgent),k=/iPad/.test(navigator.userAgent),V=/Macintosh/.test(navigator.userAgent)&&"ontouchend"in document;(k||V)&&(console.log("ğŸ”§ [RandomTraining] iPadæ¤œå‡º - ãƒã‚¤ã‚¯æ„Ÿåº¦7.0xè‡ªå‹•è¨­å®šé–‹å§‹"),We.setSensitivity(7),console.log("âœ… [RandomTraining] iPad ãƒã‚¤ã‚¯æ„Ÿåº¦7.0xè‡ªå‹•è¨­å®šå®Œäº†"));try{console.log("ğŸ¤ [RandomTraining] AudioManagerå†åˆæœŸåŒ–é–‹å§‹ï¼ˆiPadå¯¾å¿œï¼‰"),await We.initialize(),console.log("âœ… [RandomTraining] AudioManagerå†åˆæœŸåŒ–å®Œäº†")}catch(O){console.warn("âš ï¸ AudioManagerå†åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼:",O)}await ne.initialize(),ie.audio("[RandomTraining] PitchDetectoråˆæœŸåŒ–å®Œäº†")}},200)}catch(l){ie.error("[RandomTraining] ãƒã‚¤ã‚¯è¨±å¯ã‚¨ãƒ©ãƒ¼:",l),e(1,A=(l==null?void 0:l.name)==="NotAllowedError"?"denied":"error")}}function mt(){const o=m,l=d,S=Ge.find(k=>k.note===o)||Ge.find(k=>k.name===l)||Ge[0];if(e(7,B=S.name),e(8,_=S.frequency),ie.info(`[BaseNote] åŸºéŸ³è¨­å®šï¼ˆlocalStorageé€£æºï¼‰: ${B} = ${_}Hz`),ie.info(`[BaseNote] localStorageåŸºéŸ³æƒ…å ±: note=${o}, name=${l}`),!_||_<=0)throw ie.error("[BaseNote] åŸºéŸ³å‘¨æ³¢æ•°è¨­å®šã‚¨ãƒ©ãƒ¼:",S),new Error(`Invalid base frequency: ${_}`)}async function Qt(){if(ee||!he||Re)return;if(A!=="granted"){console.log("ğŸ¤ [RandomTraining] ãƒã‚¤ã‚¯è¨±å¯ãŒå¿…è¦ã§ã™ã€‚è¨±å¯å–å¾—ã‚’é–‹å§‹...");try{await Ue(),console.log("ğŸ¤ [RandomTraining] ãƒã‚¤ã‚¯è¨±å¯å–å¾—å®Œäº†")}catch(l){console.error("âŒ ãƒã‚¤ã‚¯è¨±å¯ã‚¨ãƒ©ãƒ¼:",l);return}}if(!Be&&A==="granted"){console.log("ğŸ¤ [RandomTraining] AudioManagerãƒªã‚½ãƒ¼ã‚¹æœªåˆæœŸåŒ–ã®ãŸã‚å–å¾—ã—ã¾ã™");try{await Ue()}catch(l){console.error("âŒ AudioManagerãƒªã‚½ãƒ¼ã‚¹åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼:",l);return}}else Be&&console.log("ğŸ¤ [RandomTraining] AudioManagerãƒªã‚½ãƒ¼ã‚¹æ—¢å­˜ã®ãŸã‚å†åˆ©ç”¨");e(9,ee=!0),e(0,q="listening"),Qe=Date.now(),mt();const o=Ge.find(l=>l.name===B).note;he.triggerAttackRelease(o,2,It(),.7),setTimeout(()=>{e(9,ee=!1),e(0,q="waiting"),setTimeout(()=>yt(),500)},2e3)}async function Xt(){if(ee||!he||p||!B)return;if(A!=="granted"){console.log("ğŸ¤ [RandomTraining] ãƒã‚¤ã‚¯è¨±å¯ãŒå¿…è¦ã§ã™ã€‚è¨±å¯å–å¾—ã‚’é–‹å§‹...");try{await Ue(),console.log("ğŸ¤ [RandomTraining] ãƒã‚¤ã‚¯è¨±å¯å–å¾—å®Œäº†")}catch(l){console.error("âŒ ãƒã‚¤ã‚¯è¨±å¯ã‚¨ãƒ©ãƒ¼:",l);return}}if(!Be&&A==="granted"){console.log("ğŸ¤ [RandomTraining] AudioManagerãƒªã‚½ãƒ¼ã‚¹æœªåˆæœŸåŒ–ã®ãŸã‚å–å¾—ã—ã¾ã™");try{await Ue()}catch(l){console.error("âŒ AudioManagerãƒªã‚½ãƒ¼ã‚¹åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼:",l);return}}else Be&&console.log("ğŸ¤ [RandomTraining] AudioManagerãƒªã‚½ãƒ¼ã‚¹æ—¢å­˜ã®ãŸã‚å†åˆ©ç”¨");if(e(9,ee=!0),e(0,q="listening"),Qe=Date.now(),typeof window<"u"&&window.Tone){const l=window.Tone.context||window.Tone.getContext();l&&l.state==="suspended"&&(console.log("ğŸ”„ [RandomTraining] AudioContext suspendedæ¤œå‡º - å†é–‹ä¸­..."),await l.resume(),console.log("âœ… [RandomTraining] AudioContextå†é–‹å®Œäº†"))}const o=Ge.find(l=>l.name===B).note;he.triggerAttackRelease(o,2,It(),.7),setTimeout(()=>{e(9,ee=!1),e(0,q="waiting"),setTimeout(()=>yt(),500)},2e3)}async function mo(){if(ee||!he||p||!B){console.log("ğŸ”„ [BaseNoteOnly] å†ç”Ÿæ¡ä»¶æœªæº€: isPlaying:",ee,"sampler:",!!he,"isLoading:",p,"currentBaseNote:",B);return}if(console.log("ğŸµ [BaseNoteOnly] åŸºéŸ³ã®ã¿å†ç”Ÿé–‹å§‹:",B),typeof window<"u"&&window.Tone){const l=window.Tone.context||window.Tone.getContext();l&&l.state==="suspended"&&(console.log("ğŸ”„ [BaseNoteOnly] AudioContext suspendedæ¤œå‡º - å†é–‹ä¸­..."),await l.resume(),console.log("âœ… [BaseNoteOnly] AudioContextå†é–‹å®Œäº†"))}const o=Ge.find(l=>l.name===B).note;he.triggerAttackRelease(o,1.5,It(),.7),console.log("ğŸµ [BaseNoteOnly] åŸºéŸ³å†ç”Ÿå®Œäº†:",o)}function gt(){B&&_>0?Xt():Qt(),Yt()}function Yt(){I&&clearInterval(I),e(11,oe=0),E=!0,e(12,te=!1),console.log("ğŸµ [GuideStartBar] ã‚¬ã‚¤ãƒ‰ã‚¹ã‚¿ãƒ¼ãƒˆãƒãƒ¼é–‹å§‹"),I=setInterval(()=>{e(11,oe+=2.5),oe>=100&&(e(11,oe=100),e(12,te=!0),console.log("ğŸµ [GuideStartBar] ã‚¬ã‚¤ãƒ‰é–‹å§‹ã‚¿ã‚¤ãƒŸãƒ³ã‚°ï¼"),setTimeout(()=>{E=!1,e(12,te=!1),e(11,oe=0)},800),clearInterval(I),I=null)},50)}function go(){I&&(clearInterval(I),I=null),E=!1,e(12,te=!1),e(11,oe=0)}function Ze(o,l){const k=[0,2,4,5,7,9,11,12][l],V=o*Math.pow(2,k/12);return ie.debug(`[calculateExpectedFrequency] ${w[l].name}: åŸºéŸ³${o.toFixed(1)}Hz + ${k}åŠéŸ³ = ${V.toFixed(1)}Hz`),V}function Zt(o,l){return Ze(o,l)}function yt(){e(0,q="guiding"),D=0,L=!0,K=[],console.log(`ğŸ¬ ã‚¬ã‚¤ãƒ‰é–‹å§‹: ${B} (${_.toFixed(1)}Hz)`);function o(){if(D<w.length){D>0&&e(10,w[D-1].state="inactive",w),e(10,w[D].state="active",w);const l=Zt(_,D);bt.setScaleContext({baseFrequency:_,currentScale:w[D].name,targetFrequency:l}),console.log(`ğŸµ [Scale] åŸºéŸ³:${B}(${_.toFixed(0)}Hz) ç¾åœ¨:${w[D].name} ç›®æ¨™:${l.toFixed(0)}Hz`),D>=4&&console.log(`ğŸ” [ãƒ‡ãƒãƒƒã‚°] Step ${D}: currentBaseFrequency=${_}, currentBaseNote='${B}'`),D++,x=setTimeout(()=>{o()},600)}else $t()}o()}function $t(){L=!1,console.log(`ğŸ ã‚¬ã‚¤ãƒ‰å®Œäº†: ${K.length}/${w.length}ã‚¹ãƒ†ãƒƒãƒ—è©•ä¾¡`),w.length>0&&e(10,w[w.length-1].state="inactive",w),ne&&ne.stopDetection(),bt.clearContext(),en(),sn(),yn(),ae=j.map(o=>{const l=K.find(S=>S.stepName===o);return l?{name:l.stepName,cents:l.adjustedFrequency?Math.round(l.centDifference):null,targetFreq:l.expectedFrequency,detectedFreq:l.adjustedFrequency||null,diff:l.adjustedFrequency?l.adjustedFrequency-l.expectedFrequency:null,accuracy:l.accuracy}:{name:o,cents:null,targetFreq:null,detectedFreq:null,diff:null,accuracy:"notMeasured"}}),cn(),un(),e(0,q="results")}function en(){let o=0,l=0;K.forEach((V,O)=>{V.isCorrect&&o++,l+=V.accuracy});const S=K.length>0?Math.round(l/K.length):0,k=Math.round(o/w.length*100);He={correctCount:o,totalCount:w.length,averageAccuracy:S,averageTime:0,isCompleted:!0},console.log(`ğŸ¯ çµæœ: ${o}/${w.length}æ­£è§£ (${k}%) å¹³å‡ç²¾åº¦${S}%`),K.length>0&&(ye=[...K])}function yo(){switch(q){case"setup":return Re||!he?"ğŸµ éŸ³æºèª­ã¿è¾¼ã¿ä¸­...":"ğŸ¤ ãƒã‚¤ã‚¯æº–å‚™å®Œäº† - ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°é–‹å§‹å¯èƒ½";case"listening":return"ğŸµ åŸºéŸ³å†ç”Ÿä¸­...";case"waiting":return"â³ é–“ã‚‚ãªãé–‹å§‹...";case"guiding":return"ğŸ™ï¸ ã‚¬ã‚¤ãƒ‰ã«åˆã‚ã›ã¦ãƒ‰ãƒ¬ãƒŸãƒ•ã‚¡ã‚½ãƒ©ã‚·ãƒ‰ã‚’æ­Œã£ã¦ãã ã•ã„";case"results":return"ğŸ‰ æ¡ç‚¹çµæœ";default:return"ğŸ”„ æº–å‚™ä¸­..."}}function ho(){return K.length>0?K:ye.length>0?ye:[]}function tn(){_t(`${lt}/microphone-test`)}function $e(){_t(`${lt}/`)}async function nn(){try{e(34,Re=!0),e(33,he=new Oo({urls:{C4:"C4.mp3"},baseUrl:`${lt}/audio/piano/`,release:1.5,volume:In(),onload:()=>{e(34,Re=!1)},onerror:V=>{console.error("âŒ Salamander PianoéŸ³æºèª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:",V),e(34,Re=!1)}}).toDestination());const o=/iPhone/.test(navigator.userAgent),l=/iPad/.test(navigator.userAgent),S=/Macintosh/.test(navigator.userAgent)&&"ontouchend"in document,k=o||l||S;console.log(l?"ğŸ” [RandomTraining] iPadæ¤œå‡º:":S?"ğŸ” [RandomTraining] iPadOSæ¤œå‡º:":o?"ğŸ” [RandomTraining] iPhoneæ¤œå‡º:":"ğŸ” [RandomTraining] ãã®ä»–ãƒ‡ãƒã‚¤ã‚¹æ¤œå‡º:",navigator.userAgent),console.log("ğŸ”Š [RandomTraining] éŸ³é‡è¨­å®šç¶­æŒ: 35dB")}catch(o){console.error("ã‚µãƒ³ãƒ—ãƒ©ãƒ¼åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼:",o),e(34,Re=!1)}}async function ct(){try{(await navigator.permissions.query({name:"microphone"})).state==="granted"?await Ue():e(1,A="denied")}catch{e(1,A="denied")}}function on(){try{we=new Rn,ie.info("[RandomTraining] æ¡ç‚¹ã‚¨ãƒ³ã‚¸ãƒ³åˆæœŸåŒ–å®Œäº†")}catch(o){ie.error("[RandomTraining] æ¡ç‚¹ã‚¨ãƒ³ã‚¸ãƒ³åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼:",o)}}function rn(o,l){if(!we||!L)return;const S=D-1;if(S<0||S>=w.length)return;const k=Ze(_,S),V={baseFrequency:_,targetFrequency:k,detectedFrequency:o,detectedNote:l,volume:Se,timestamp:Date.now(),scaleIndex:S,scaleName:w[S].name};try{we.processAttempt(V)}catch(O){ie.error("[RandomTraining] æ¡ç‚¹ã‚¨ãƒ³ã‚¸ãƒ³ã‚¨ãƒ©ãƒ¼:",O)}}function sn(){if(!we){ie.error("[RandomTraining] æ¡ç‚¹ã‚¨ãƒ³ã‚¸ãƒ³ãŒåˆæœŸåŒ–ã•ã‚Œã¦ã„ã¾ã›ã‚“"),an();return}try{const o=we.generateDetailedReport();e(16,ze={totalScore:o.totalScore,grade:o.grade,componentScores:o.componentScores}),o.intervalAnalysis&&o.intervalAnalysis.masteryLevels?e(3,ke=Object.entries(o.intervalAnalysis.masteryLevels).map(([l,S])=>{var k,V;return{type:l,mastery:Math.round(S),attempts:((k=o.intervalAnalysis.attemptCounts)==null?void 0:k[l])||0,accuracy:((V=o.intervalAnalysis.accuracyRates)==null?void 0:V[l])||0}})):(console.warn("âš ï¸ [RandomTraining] intervalAnalysis.masteryLevels ãŒæœªå®šç¾©ã§ã™"),e(3,ke=[])),o.consistencyHistory&&Array.isArray(o.consistencyHistory)?e(17,Pe=o.consistencyHistory.map((l,S)=>({score:Math.round(l),timestamp:Date.now()-(o.consistencyHistory.length-S)*1e3}))):(console.warn("âš ï¸ [RandomTraining] consistencyHistory ãŒæœªå®šç¾©ã¾ãŸã¯é…åˆ—ã§ã¯ã‚ã‚Šã¾ã›ã‚“"),e(17,Pe=[])),e(18,Oe=o.feedback||{primary:"æ¡ç‚¹çµæœã‚’ç”Ÿæˆä¸­ã§ã™...",detailed:[],suggestions:[]}),e(20,Fe={totalAttempts:o.totalAttempts||0,successRate:o.successRate||0,averageScore:o.totalScore||0,bestScore:Math.max(o.totalScore||0,Fe.bestScore||0),sessionDuration:Math.round((Date.now()-Fe.sessionStart)/6e4)||0,streakCount:o.streak||0,fatigueLevel:o.fatigueLevel||"normal",mostDifficultInterval:o.mostDifficultInterval||"-",mostSuccessfulInterval:o.mostSuccessfulInterval||"-",averageResponseTime:o.averageResponseTime||0}),ie.info("[RandomTraining] æ¡ç‚¹çµæœç”Ÿæˆå®Œäº†:",ze)}catch(o){ie.error("[RandomTraining] æ¡ç‚¹çµæœç”Ÿæˆã‚¨ãƒ©ãƒ¼:",o)}}function an(){ie.info("[RandomTraining] ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã§æ¡ç‚¹çµæœã‚’ç”Ÿæˆ"),e(16,ze={totalScore:78,grade:"B+",componentScores:{pitchAccuracy:82,recognitionSpeed:75,intervalMastery:80,directionAccuracy:85,consistency:70}}),e(3,ke=[{type:"unison",mastery:95,attempts:8,accuracy:98},{type:"major_second",mastery:82,attempts:8,accuracy:85},{type:"major_third",mastery:78,attempts:8,accuracy:80},{type:"perfect_fourth",mastery:65,attempts:8,accuracy:68},{type:"perfect_fifth",mastery:88,attempts:8,accuracy:90},{type:"major_sixth",mastery:72,attempts:8,accuracy:75},{type:"major_seventh",mastery:58,attempts:8,accuracy:62},{type:"octave",mastery:92,attempts:8,accuracy:94}]),e(17,Pe=[{score:65,timestamp:Date.now()-42e4},{score:72,timestamp:Date.now()-36e4},{score:68,timestamp:Date.now()-3e5},{score:75,timestamp:Date.now()-24e4},{score:78,timestamp:Date.now()-18e4},{score:82,timestamp:Date.now()-12e4},{score:80,timestamp:Date.now()-6e4},{score:85,timestamp:Date.now()}]),e(18,Oe={type:"improvement",primary:"è‰¯ã„é€²æ­©ãŒè¦‹ã‚‰ã‚Œã¾ã™ï¼",summary:"éŸ³ç¨‹ã®èªè­˜ç²¾åº¦ãŒå‘ä¸Šã—ã¦ã„ã¾ã™ã€‚ç‰¹ã«å®Œå…¨5åº¦ã¨ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–ã®ç¿’å¾—åº¦ãŒé«˜ãã€åŸºæœ¬çš„ãªéŸ³æ„ŸãŒèº«ã«ã¤ã„ã¦ãã¦ã„ã¾ã™ã€‚",details:[{category:"strengths",text:"ãƒ¦ãƒ‹ã‚¾ãƒ³ã¨ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–ã®èªè­˜ãŒã»ã¼å®Œç’§ã§ã™"},{category:"strengths",text:"å®Œå…¨5åº¦ã®å®‰å®šæ€§ãŒå„ªç§€ã§ã™"},{category:"improvements",text:"å®Œå…¨4åº¦ã®ç·´ç¿’ã‚’ã‚‚ã†å°‘ã—å¢—ã‚„ã—ã¾ã—ã‚‡ã†"},{category:"improvements",text:"é•·7åº¦ã®èªè­˜ç²¾åº¦ã‚’å‘ä¸Šã•ã›ã¾ã—ã‚‡ã†"},{category:"tips",text:"4åº¦ã¯ã€Œã‚½ãƒ¼ãƒ•ã‚¡ãƒ¼ã€ã®éŸ³ç¨‹ã§ã™"},{category:"practice",text:"æ¯æ—¥15åˆ†ã®ç¶™ç¶šç·´ç¿’ã‚’å¿ƒãŒã‘ã¾ã—ã‚‡ã†"}],nextSteps:["å®Œå…¨4åº¦ã®é›†ä¸­ç·´ç¿’ã‚’è¡Œã„ã¾ã—ã‚‡ã†","é€£ç¶šãƒãƒ£ãƒ¬ãƒ³ã‚¸ãƒ¢ãƒ¼ãƒ‰ã§å®Ÿè·µç·´ç¿’ã‚’","1æ—¥15åˆ†ã®ç¶™ç¶šç·´ç¿’ã‚’å¿ƒãŒã‘ã¾ã—ã‚‡ã†"],motivation:"ç¶™ç¶šã¯åŠ›ãªã‚Šï¼ã‚ãªãŸã®ç›¸å¯¾éŸ³æ„Ÿã¯ç¢ºå®Ÿã«å‘ä¸Šã—ã¦ã„ã¾ã™ï¼"}),e(20,Fe={totalAttempts:32,successRate:68.8,averageScore:78,bestScore:85,sessionDuration:8,streakCount:4,fatigueLevel:"normal",mostDifficultInterval:"å®Œå…¨4åº¦",mostSuccessfulInterval:"ãƒ¦ãƒ‹ã‚¾ãƒ³",averageResponseTime:2.1,sessionStart:Date.now()-48e4}),ie.info("[RandomTraining] ãƒ†ã‚¹ãƒˆæ¡ç‚¹çµæœç”Ÿæˆå®Œäº†")}function po(o){dt=o}function cn(){if(!ae||ae.length===0){console.warn("[UnifiedScore] noteResultsForDisplay ãŒç©ºã§ã™");return}const o=ae.filter(re=>re.accuracy!=="notMeasured").length,l=ae.length,S=ae.filter(re=>re.accuracy!=="notMeasured"&&typeof re.accuracy=="number").map(re=>re.accuracy),k=S.length>0?Math.round(S.reduce((re,Me)=>re+Me,0)/S.length):0,V=B||"Unknown",O=_||0,ce=ae.map(re=>({name:re.name,note:re.note||re.name,frequency:re.targetFreq||re.expectedFrequency,detectedFrequency:re.detectedFreq,cents:re.cents,grade:ot.evaluateNote(re.cents),targetFreq:re.targetFreq,diff:re.diff})),le=C,se=(le==null?void 0:le.sessionHistory)||[],De={timestamp:new Date,baseNote:V,baseFrequency:O,noteResults:ce,measuredNotes:o,accuracy:k,grade:ot.evaluateSession(ae)},xe=[...se,De];e(21,ue={mode:"continuous",timestamp:new Date,duration:60,totalNotes:l,measuredNotes:o,averageAccuracy:k,baseNote:V,baseFrequency:O,noteResults:ce,distribution:ot.calculateDistribution(ae),sessionHistory:xe,unifiedGrade:z(xe)}),console.log("[UnifiedScore] çµ±åˆæ¡ç‚¹ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆå®Œäº†ï¼ˆå®Œå…¨ç‰ˆï¼‰:",ue),ln()}async function ln(){if(!ae||ae.length===0){console.warn("ğŸ“Š [SessionStorage] ä¿å­˜ãƒ‡ãƒ¼ã‚¿ãªã—");return}try{console.log("ğŸ“Š [SessionStorage] ã‚»ãƒƒã‚·ãƒ§ãƒ³çµæœä¿å­˜é–‹å§‹");const o=ae.map(O=>({name:O.name,cents:O.cents,targetFreq:O.targetFreq||O.expectedFrequency,detectedFreq:O.detectedFreq,diff:O.diff,accuracy:typeof O.accuracy=="number"?O.accuracy:0})),l=Qe?Math.round((Date.now()-Qe)/1e3):60;await Fn(o,l,m,d)?(console.log("ğŸ“Š [SessionStorage] ã‚»ãƒƒã‚·ãƒ§ãƒ³çµæœä¿å­˜å®Œäº†"),console.log("ğŸ“Š [SessionStorage] ä¿å­˜å¾Œã®çŠ¶æ³:",{currentSession:n,totalSessions:v.length,isCompleted:s,nextBaseNote:m,nextBaseName:d})):console.error("ğŸ“Š [SessionStorage] ã‚»ãƒƒã‚·ãƒ§ãƒ³çµæœä¿å­˜å¤±æ•—")}catch(o){console.error("ğŸ“Š [SessionStorage] ã‚»ãƒƒã‚·ãƒ§ãƒ³ä¿å­˜ã‚¨ãƒ©ãƒ¼:",o)}}async function un(){try{if(we){const o=v||[];for(const[S,k]of o.entries())if(k.noteResults&&k.noteResults.length>0){const V=k.baseFrequency||262;for(const O of k.noteResults)O.detectedFreq&&O.targetFreq&&await we.analyzePerformance({baseFreq:V,targetFreq:O.targetFreq,detectedFreq:O.detectedFreq,responseTime:2e3,volume:50,harmonicCorrection:null})}const l=we.generateDetailedReport();e(16,ze={totalScore:l.totalScore||0,grade:l.grade||"C",componentScores:l.componentScores||{accuracy:0,speed:0,consistency:0}}),l.intervalAnalysis&&l.intervalAnalysis.masteryLevels?e(3,ke=Object.entries(l.intervalAnalysis.masteryLevels).map(([S,k])=>{var V;return{type:S,mastery:Math.round(k),attempts:((V=l.intervalAnalysis.attemptCounts)==null?void 0:V[S])||0,accuracy:Math.round(k*.9)}})):e(3,ke=Tt(ae)),l.consistencyHistory&&Array.isArray(l.consistencyHistory)?e(17,Pe=l.consistencyHistory.map((S,k)=>({score:Math.round(S),timestamp:Date.now()-(l.consistencyHistory.length-k)*1e3}))):e(17,Pe=pt(ae)),e(18,Oe=vt(ae)||l.feedback),console.log("ğŸ¯ [generateEnhancedScoringData] æŠ€è¡“åˆ†æçµæœç”Ÿæˆã‚’é–‹å§‹"),console.log("ğŸ¯ [generateEnhancedScoringData] results:",l),e(19,Ye=fn(l)),console.log("ğŸ¯ [generateEnhancedScoringData] technicalFeedbackDataçµæœ:",Ye),e(20,Fe={totalAttempts:l.totalAttempts||ae.length,successRate:l.successRate||ae.filter(S=>S.accuracy!=="notMeasured").length/ae.length*100,averageScore:l.totalScore||(ue==null?void 0:ue.averageAccuracy)||0,bestScore:Math.max(l.totalScore||0,Fe.bestScore||0),sessionDuration:Math.round(60),streakCount:l.streak||0,fatigueLevel:l.fatigueLevel||"normal",mostDifficultInterval:l.mostDifficultInterval||"æœªç‰¹å®š",mostSuccessfulInterval:l.mostSuccessfulInterval||"æœªç‰¹å®š",averageResponseTime:l.averageResponseTime||2.5,sessionStart:Date.now()-6e4})}else ht();console.log("[EnhancedScoring] è¿½åŠ æ¡ç‚¹ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆå®Œäº†")}catch(o){console.error("[EnhancedScoring] ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆã‚¨ãƒ©ãƒ¼:",o),ht()}}function ht(){const o=ae.filter(S=>S.accuracy!=="notMeasured"),l=(ue==null?void 0:ue.averageAccuracy)||0;e(16,ze={totalScore:Math.round(l*.8),grade:l>=90?"A":l>=80?"B":l>=70?"C":"D",componentScores:{accuracy:l,speed:85,consistency:Math.max(60,l-10)}}),e(3,ke=Tt(ae)),e(17,Pe=pt()),e(18,Oe=vt(ae)),e(20,Fe={totalAttempts:ae.length,successRate:o.length/ae.length*100,averageScore:l,bestScore:l,sessionDuration:60,streakCount:0,fatigueLevel:"normal",mostDifficultInterval:"æœªåˆ†æ",mostSuccessfulInterval:"æœªåˆ†æ",averageResponseTime:2.5,sessionStart:Date.now()-6e4})}function pt(o){const l=(ue==null?void 0:ue.averageAccuracy)||70;return Array.from({length:8},(S,k)=>({score:Math.max(30,Math.min(100,l+(Math.random()-.5)*20)),timestamp:Date.now()-(8-k)*7500}))}function vt(o){const l=o.filter(tt=>tt.accuracy!=="notMeasured").length,S=(ue==null?void 0:ue.averageAccuracy)||0,k=8,V=v||[],O=V.length,ce={type:"info",categories:[{name:"éŸ³ç¨‹ç²¾åº¦",icon:"Target",score:S,message:`${S}%ã®ç²¾åº¦ã§éŸ³ç¨‹ã‚’æ‰ãˆã¦ã„ã¾ã™`},{name:"æ¸¬å®šæˆåŠŸç‡",icon:"Mic",score:Math.round(l/o.length*100),message:`${o.length}éŸ³ä¸­${l}éŸ³ã‚’æ­£å¸¸ã«æ¸¬å®š`}]};if(O<k)return ce;let le,se,De;const xe=(ue==null?void 0:ue.unifiedGrade)||"E",re=V.length;let Me=0,pe=0,_e=0;V.forEach(tt=>{tt.grade==="excellent"?Me++:tt.grade==="good"?pe++:tt.grade==="pass"&&_e++});const be=re>0?Math.round(Me/re*100):0,et=re>0?Math.round((Me+pe+_e)/re*100):0,qe=re>0?Math.round((Me+pe+_e)/re*100):0;switch(xe){case"S":le="excellent",se="éŸ³æ¥½å®¶ãƒ¬ãƒ™ãƒ«ã®ç›¸å¯¾éŸ³æ„Ÿã‚’é”æˆï¼",De=`å„ªç§€ç‡${be}%è¶…ãˆã®å®ŸåŠ›ã‚’è¨¼æ˜ã•ã‚Œã¾ã—ãŸã€‚`;break;case"A":le="excellent",se="ã‚¨ã‚­ã‚¹ãƒ‘ãƒ¼ãƒˆãƒ¬ãƒ™ãƒ«åˆ°é”ï¼",De=`å„ªç§€ç‡${be}%ã®å®‰å®šã—ãŸéŸ³æ„Ÿèƒ½åŠ›ã§ã™ã€‚`;break;case"B":le="improvement",se="ãƒ—ãƒ­ãƒ•ã‚£ã‚·ã‚¨ãƒ³ãƒˆç´šé”æˆï¼",De=`è‰¯å¥½ç‡${et}%ã®ç¢ºå®Ÿãªé€²æ­©ã‚’ç¤ºã—ã¦ã„ã¾ã™ã€‚`;break;case"C":le="improvement",se="ã‚¢ãƒ‰ãƒãƒ³ã‚¹ç´šåˆ°é”ï¼",De=`åˆæ ¼ç‡${qe}%ã§ç€å®Ÿã«æˆé•·ä¸­ã§ã™ã€‚`;break;case"D":le="practice",se="ç¶™ç¶šç·´ç¿’ã§å¿…ãšä¸Šé”ï¼",De=`ç¾åœ¨ã®åˆæ ¼ç‡${qe}%ã‹ã‚‰ç›®æ¨™70%ã¸å‘ã‘ã¦ç·´ç¿’ã‚’ç¶šã‘ã¾ã—ã‚‡ã†ã€‚`;break;case"E":default:le="encouragement",se="Eç´šãƒ“ã‚®ãƒŠãƒ¼",De="ç·´ç¿’é–‹å§‹æ®µéšã§ã™ã€‚ç¶™ç¶šçš„ãªç·´ç¿’ã§å¿…ãšä¸Šé”ã—ã¾ã™ã€‚";break}return{...ce,type:le,primary:se,summary:De}}function fn(o){var xe,re,Me;if((v||[]).length<8||!o)return null;const V=o.improvements||[];(xe=o.detailed)!=null&&xe.statistics;const O=[];let ce=0,le=0;if((re=o.detailed)!=null&&re.intervals){const pe=o.detailed.intervals;if(pe.totalAnalyses>0){let _e=0,be=0;for(const[et,qe]of Object.entries(pe.masteryLevels))qe.attempts>0&&(_e+=qe.averageAccuracy*qe.attempts,be+=qe.attempts);ce=be>0?_e/be:0}}if((Me=o.detailed)!=null&&Me.directions){const pe=o.detailed.directions;if(pe.totalAnalyses>0){let _e=0,be=0;for(const[et,qe]of Object.entries(pe.masteryData))qe.attempts>0&&(_e+=qe.averageAccuracy*qe.attempts,be+=qe.attempts);le=be>0?_e/be:0}}O.push({category:"improvements",text:`éŸ³ç¨‹ç²¾åº¦: ${Math.round(ce)}%ã€€ï¼ˆéŸ³ã®é«˜ã•ã‚’æ‰ãˆã‚‹æ­£ç¢ºæ€§ã€€ç›®æ¨™åŸºæº–ï¼š70ã€œ85%ï¼‰`}),O.push({category:"improvements",text:`æ–¹å‘æ€§: ${Math.round(le)}%ã€€ï¼ˆéŸ³ç¨‹ã®ä¸Šä¸‹åˆ¤æ–­ã®ç²¾åº¦ã€€ç›®æ¨™åŸºæº–ï¼š80ã€œ90%ï¼‰`});const se=V.map(pe=>({category:"tips",text:pe.message})),De=V.flatMap(pe=>(pe.actions||[]).map(_e=>({category:"practice",text:_e})));return[...O,...se,...De],{type:"info",primary:"è©³ç´°åˆ†æçµæœ",summary:"éŸ³ç¨‹ç²¾åº¦ãƒ»ä¸€è²«æ€§ãƒ»æ–¹å‘æ€§ã®ç·åˆåˆ†æ",details:O}}kn(async()=>{if(!(typeof localStorage<"u"?localStorage.getItem("mic-test-completed"):null)){console.log("ğŸš« [RandomTraining] ãƒã‚¤ã‚¯ãƒ†ã‚¹ãƒˆæœªå®Œäº† - æº–å‚™ç”»é¢è¡¨ç¤º"),ct();return}console.log("ğŸ“Š [SessionStorage] ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†åˆæœŸåŒ–é–‹å§‹");try{if(await Dt()){if(console.log("ğŸ“Š [SessionStorage] ã‚»ãƒƒã‚·ãƒ§ãƒ³é€²è¡ŒçŠ¶æ³ã®èª­ã¿è¾¼ã¿å®Œäº†"),console.log("ğŸ“Š [SessionStorage] ç¾åœ¨ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³:",n,"/ 8"),console.log("ğŸ“Š [SessionStorage] æ¬¡ã®åŸºéŸ³:",m,"(",d,")"),console.log("ğŸ“Š [SessionStorage] å®Œäº†çŠ¶æ³:",s?"8ã‚»ãƒƒã‚·ãƒ§ãƒ³å®Œäº†":`æ®‹ã‚Š${f}ã‚»ãƒƒã‚·ãƒ§ãƒ³`),s&&(console.log("ğŸ”„ [SessionStorage] 8ã‚»ãƒƒã‚·ãƒ§ãƒ³å®Œäº†æ¤œå‡º - æ–°ã‚µã‚¤ã‚¯ãƒ«é–‹å§‹å‡¦ç†"),await nt()?console.log("âœ… [SessionStorage] æ–°ã‚µã‚¤ã‚¯ãƒ«é–‹å§‹å®Œäº† - ã‚»ãƒƒã‚·ãƒ§ãƒ³1/8ã‹ã‚‰å†é–‹"):console.warn("âš ï¸ [SessionStorage] æ–°ã‚µã‚¤ã‚¯ãƒ«é–‹å§‹å‡¦ç†ãŒå¤±æ•—")),n>1&&!s){console.warn("ğŸ”„ [SessionStorage] ã‚»ãƒƒã‚·ãƒ§ãƒ³é€”ä¸­ã§ã®ãƒªãƒ­ãƒ¼ãƒ‰æ¤œå‡º - ã‚»ãƒƒã‚·ãƒ§ãƒ³1ã‹ã‚‰å†é–‹"),console.warn("ğŸ”„ [SessionStorage] ç¾åœ¨:",n,"ã‚»ãƒƒã‚·ãƒ§ãƒ³ç›® â†’ ãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã‚¢ã‚¯ã‚»ã‚¹èª˜å°");const{SessionStorageManager:S}=await wn(async()=>{const{SessionStorageManager:O}=await import("../chunks/BR4hDZrg.js").then(ce=>ce.y);return{SessionStorageManager:O}},__vite__mapDeps([0,1,2,3,4,5]),import.meta.url),k=S.getInstance();typeof localStorage<"u"&&(localStorage.removeItem("random-training-progress"),localStorage.removeItem("random-training-progress-backup"));const{resetProgress:V}=await wn(async()=>{const{resetProgress:O}=await import("../chunks/BR4hDZrg.js").then(ce=>ce.z);return{resetProgress:O}},__vite__mapDeps([0,1,2,3,4,5]),import.meta.url);await V(),console.log("ğŸ”„ [SessionStorage] localStorage + ã‚¹ãƒˆã‚¢çŠ¶æ…‹å®Œå…¨ãƒªã‚»ãƒƒãƒˆå®Œäº†"),ct();return}}else console.log("ğŸ“Š [SessionStorage] æ–°è¦ã‚»ãƒƒã‚·ãƒ§ãƒ³é–‹å§‹")}catch(l){console.error("ğŸ“Š [SessionStorage] åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼:",l)}if(nn(),on(),u.url.searchParams.get("from")==="microphone-test"){console.log("ğŸ¤ [RandomTraining] ãƒã‚¤ã‚¯ãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸ã‹ã‚‰ã®é·ç§»ã‚’æ¤œå‡º");const l=new URL(window.location);if(l.searchParams.delete("from"),window.history.replaceState({},"",l),e(1,A="granted"),e(0,q="setup"),console.log('ğŸ¤ [RandomTraining] microphoneState="granted", trainingPhase="setup" ã«è¨­å®š'),!Be){console.log("ğŸ¤ [RandomTraining] AudioManagerãƒªã‚½ãƒ¼ã‚¹å–å¾—é–‹å§‹");try{const S=await We.initialize();st=S.audioContext,Be=S.mediaStream,at=S.sourceNode,console.log("ğŸ¤ [RandomTraining] AudioManagerãƒªã‚½ãƒ¼ã‚¹å–å¾—å®Œäº†")}catch(S){console.warn("âš ï¸ AudioManagerãƒªã‚½ãƒ¼ã‚¹å–å¾—å¤±æ•—ï¼ˆå¾Œã§å†è©¦è¡Œï¼‰:",S)}}if(await new Promise(S=>setTimeout(S,500)),ne)try{if(console.log("ğŸ™ï¸ [ContinuousMode] PitchDetectoråˆæœŸåŒ–é–‹å§‹"),typeof ne.getIsInitialized=="function"){const S=ne.getIsInitialized();if(console.log("ğŸ” [ContinuousMode] PitchDetectoråˆæœŸåŒ–çŠ¶æ…‹:",S),S)console.log("âœ… [ContinuousMode] PitchDetectorã¯æ—¢ã«åˆæœŸåŒ–æ¸ˆã¿");else{const k=We.getStatus();console.log("ğŸ” [ContinuousMode] AudioManagerçŠ¶æ…‹:",k),(!k.isInitialized||!k.mediaStreamActive)&&(console.log("ğŸ”„ [ContinuousMode] AudioManagerå†åˆæœŸåŒ–å®Ÿè¡Œ"),await We.initialize()),await ne.initialize(),console.log("âœ… [ContinuousMode] PitchDetectoråˆæœŸåŒ–å®Œäº†")}}else console.error("âŒ [ContinuousMode] getIsInitializedãƒ¡ã‚½ãƒƒãƒ‰ãŒåˆ©ç”¨ã§ãã¾ã›ã‚“"),await ne.initialize()}catch(S){console.error("âŒ [ContinuousMode] PitchDetectoråˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼:",S),await new Promise(k=>setTimeout(k,1e3));try{await ne.initialize(),console.log("âœ… [ContinuousMode] PitchDetectoråˆæœŸåŒ–å†è©¦è¡ŒæˆåŠŸ")}catch(k){console.error("âŒ [ContinuousMode] PitchDetectoråˆæœŸåŒ–å†è©¦è¡Œã‚‚å¤±æ•—:",k)}}else console.warn("âš ï¸ [ContinuousMode] PitchDetectorã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒå­˜åœ¨ã—ã¾ã›ã‚“")}else await new Promise(l=>setTimeout(l,100)),ct()});function dn(o){try{if(!o||!o.detail){console.warn("âš ï¸ [ContinuousMode] handlePitchUpdate: event.detail ãŒ undefined");return}const{frequency:l,note:S,volume:k,rawVolume:V,clarity:O}=o.detail;let ce=l,le=S;if(q==="guiding"&&L&&_>0&&l>0){const se=mn(l);se&&(ce=se.frequency,le=se.note)}e(14,Ee=ce),e(15,Le=le),e(13,Se=k),_>0&&ce>0?Ve=Math.round(1200*Math.log2(ce/_)):Ve=0;try{gn(l,S)}catch(se){console.error("âŒ [ContinuousMode] evaluateScaleStep ã‚¨ãƒ©ãƒ¼:",se)}try{we&&l>0&&_>0&&rn(l,S)}catch(se){console.error("âŒ [ContinuousMode] updateScoringEngine ã‚¨ãƒ©ãƒ¼:",se)}}catch(l){console.error("âŒ [ContinuousMode] handlePitchUpdate ã‚¨ãƒ©ãƒ¼:",{error:l.message,stack:l.stack,eventDetail:o==null?void 0:o.detail,trainingPhase:q,currentSessionId:n})}}function mn(o){if(!o||o<=0||!L||!_||Se<25)return null;const S=D-1;if(S<0||S>=w.length)return null;const k=Ze(_,S);if(!k||k<=0)return null;const O=Et(o,k).correctedFrequency,ce=En(O);return{frequency:Math.round(O),note:ce}}function gn(o,l){if(!o||o<=0||!L)return;if(!_||_<=0){console.error(`âŒ [æ¡ç‚¹ã‚¨ãƒ©ãƒ¼] åŸºéŸ³å‘¨æ³¢æ•°ãŒç„¡åŠ¹: ${_}Hz`),console.error(`âŒ [æ¡ç‚¹ã‚¨ãƒ©ãƒ¼] åŸºéŸ³å: ${B}`),console.error(`âŒ [æ¡ç‚¹ã‚¨ãƒ©ãƒ¼] activeStepIndex: ${D-1}`),console.error(`âŒ [æ¡ç‚¹ã‚¨ãƒ©ãƒ¼] trainingPhase: ${q}`),console.error(`âŒ [æ¡ç‚¹ã‚¨ãƒ©ãƒ¼] isGuideAnimationActive: ${L}`);return}if(Se<25)return;const k=D-1;if(k<0||k>=w.length)return;k>=4&&ie.debug(`[æ¡ç‚¹ãƒ‡ãƒãƒƒã‚°] activeStepIndex=${k} (${w[k].name}), currentBaseFrequency=${_}Hz`);const V=Ze(_,k);if(k>=0&&ie.debug(`[éŸ³ç¨‹è¨ˆç®—ä¿®æ­£ç‰ˆ] ${w[k].name}: æœŸå¾…å‘¨æ³¢æ•° ${V.toFixed(1)}Hz`),!V||V<=0||!isFinite(V)){console.error("âŒ [æ¡ç‚¹ã‚¨ãƒ©ãƒ¼] æœŸå¾…å‘¨æ³¢æ•°è¨ˆç®—ã‚¨ãƒ©ãƒ¼:"),console.error(`   åŸºéŸ³å‘¨æ³¢æ•°: ${_}Hz`),console.error(`   éŸ³éšã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹: ${k}`),console.error(`   æœŸå¾…å‘¨æ³¢æ•°: ${V}Hz`);return}const O=Et(o,V),ce=O.correctedFrequency,le=O.factor,se=Math.round(1200*Math.log2(ce/V));if((Math.abs(se)>200||le!==1)&&(ie.debug(`[ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—å¼è£œæ­£] ${w[k].name}:`),console.warn(`   æ¤œå‡ºå‘¨æ³¢æ•°: ${o.toFixed(1)}Hz`),console.warn(`   è£œæ­£å¾Œå‘¨æ³¢æ•°: ${ce.toFixed(1)}Hz`),console.warn(`   æœŸå¾…å‘¨æ³¢æ•°: ${V.toFixed(1)}Hz`),console.warn(`   ã‚»ãƒ³ãƒˆå·®: ${se}Â¢`),console.warn(`   è£œæ­£ä¿‚æ•°: ${le} (${O.description})`),console.warn(`   åŸºéŸ³: ${B} (${_.toFixed(1)}Hz)`)),!isFinite(se)){console.error("âŒ [æ¡ç‚¹ã‚¨ãƒ©ãƒ¼] ã‚»ãƒ³ãƒˆè¨ˆç®—ã‚¨ãƒ©ãƒ¼:"),console.error(`   æ¤œå‡ºå‘¨æ³¢æ•°: ${o}Hz`),console.error(`   æœŸå¾…å‘¨æ³¢æ•°: ${V}Hz`),console.error(`   ã‚»ãƒ³ãƒˆå·®: ${se}`);return}const xe=Math.abs(se)<=50;if(Se>=15){const pe=Math.max(0,Math.round(100-Math.abs(se))),_e=K.findIndex(et=>et.stepIndex===k),be={stepIndex:k,stepName:w[k].name,expectedFrequency:Math.round(V),detectedFrequency:Math.round(o),adjustedFrequency:Math.round(ce),centDifference:se,accuracy:pe,isCorrect:xe,correctionFactor:le,correctionDescription:O.description,timestamp:Date.now()};_e>=0?K[_e]=be:K.push(be),K.length%4===0&&ie.realtime(`æ¡ç‚¹é€²æ—: ${K.length}/${w.length}ã‚¹ãƒ†ãƒƒãƒ—å®Œäº†`)}}function yn(){e(0,q="results"),He.isCompleted=!0,He.averageAccuracy=Math.round(He.correctCount/He.totalCount*100),ne&&ne.stopDetection(),bn()}async function hn(){if(s){console.warn("ğŸš« [RestartSame] 8ã‚»ãƒƒã‚·ãƒ§ãƒ³å®Œäº†çŠ¶æ…‹ã§ã¯å†æŒ‘æˆ¦ä¸å¯ - æ–°ã‚µã‚¤ã‚¯ãƒ«é–‹å§‹ãŒå¿…è¦"),await nt()?(console.log("âœ… [RestartSame] æ–°ã‚µã‚¤ã‚¯ãƒ«é–‹å§‹å®Œäº† - ã‚»ãƒƒã‚·ãƒ§ãƒ³1/8ã‹ã‚‰å†é–‹"),window.location.reload()):console.error("âŒ [RestartSame] æ–°ã‚µã‚¤ã‚¯ãƒ«é–‹å§‹å¤±æ•—");return}rt(),e(0,q="setup"),x&&(clearTimeout(x),x=null),ne&&ne.resetDisplayState&&ne.resetDisplayState(),it(),console.log("ğŸ”„ [RestartSame] åŒã˜åŸºéŸ³ã§å†æŒ‘æˆ¦:",B,_+"Hz"),console.log("ğŸ”„ [RestartSame] åŸºéŸ³æƒ…å ±ä¿æŒå®Œäº† - ãƒ¦ãƒ¼ã‚¶ãƒ¼æ“ä½œå¾…æ©Ÿ")}async function pn(){if(s){console.warn("ğŸš« [RestartDifferent] 8ã‚»ãƒƒã‚·ãƒ§ãƒ³å®Œäº†çŠ¶æ…‹ã§ã¯å†æŒ‘æˆ¦ä¸å¯ - æ–°ã‚µã‚¤ã‚¯ãƒ«é–‹å§‹ãŒå¿…è¦"),await nt()?(console.log("âœ… [RestartDifferent] æ–°ã‚µã‚¤ã‚¯ãƒ«é–‹å§‹å®Œäº† - ã‚»ãƒƒã‚·ãƒ§ãƒ³1/8ã‹ã‚‰å†é–‹"),window.location.reload()):console.error("âŒ [RestartDifferent] æ–°ã‚µã‚¤ã‚¯ãƒ«é–‹å§‹å¤±æ•—");return}rt(),e(0,q="setup"),x&&(clearTimeout(x),x=null),e(7,B=""),e(8,_=0),console.log("ğŸ”„ [restartDifferentBaseNote] åŸºéŸ³æƒ…å ±ã‚’ãƒªã‚»ãƒƒãƒˆã—ã¾ã—ãŸ"),ne&&ne.resetDisplayState&&ne.resetDisplayState(),it()}function it(){D=0,L=!1,K=[],e(10,w=w.map(o=>({...o,state:"inactive",completed:!1})))}async function vn(){console.log("ğŸš€ [StartNewCycle] 8ã‚»ãƒƒã‚·ãƒ§ãƒ³å®Œäº†å¾Œã®æœ€åˆã‹ã‚‰æŒ‘æˆ¦é–‹å§‹");try{await nt()?(console.log("âœ… [StartNewCycle] æ–°ã‚µã‚¤ã‚¯ãƒ«é–‹å§‹å®Œäº†"),localStorage.getItem("mic-test-completed")?(console.log("âœ… [StartNewCycle] ãƒã‚¤ã‚¯ãƒ†ã‚¹ãƒˆå®Œäº†ãƒ•ãƒ©ã‚°ç¢ºèª - ãƒªãƒ­ãƒ¼ãƒ‰ãªã—ã§çŠ¶æ…‹ãƒªã‚»ãƒƒãƒˆ"),rt(),await Dt(),e(0,q="setup"),it(),mt(),console.log("âœ… [StartNewCycle] çŠ¶æ…‹ãƒªã‚»ãƒƒãƒˆå®Œäº† - ã‚»ãƒƒã‚·ãƒ§ãƒ³1/8ã‹ã‚‰å†é–‹")):window.location.reload()):(console.error("âŒ [StartNewCycle] æ–°ã‚µã‚¤ã‚¯ãƒ«é–‹å§‹å¤±æ•—"),$e())}catch(o){console.error("âŒ [StartNewCycle] æ–°ã‚µã‚¤ã‚¯ãƒ«é–‹å§‹ã‚¨ãƒ©ãƒ¼:",o),$e()}}function _n(o){const{type:l}=o.detail;switch(l){case"same":hn();break;case"different":pn();break;case"restart":vn();break;case"home":$e();break;default:console.warn("ğŸš« [ActionButtons] æœªçŸ¥ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚¿ã‚¤ãƒ—:",l)}}function Sn(){console.log("âš¡ [ContinuousMode] 8ã‚»ãƒƒã‚·ãƒ§ãƒ³é€£ç¶šé–‹å§‹"),gt()}function bn(){console.log("âœ… [ContinuousMode] ã‚»ãƒƒã‚·ãƒ§ãƒ³å®Œäº†:",n),n<8?setTimeout(()=>{if(console.log("ğŸ”„ [ContinuousMode] æ¬¡ã‚»ãƒƒã‚·ãƒ§ãƒ³è‡ªå‹•é–‹å§‹æº–å‚™:",n+1),e(0,q="setup"),He={isCompleted:!1,correctCount:0,totalCount:0,averageAccuracy:0},e(9,ee=!1),ne)try{if(ne.getState){const o=ne.getState();console.log("ğŸ” [ContinuousMode] PitchDetectorçŠ¶æ…‹:",o),o.isInitialized&&o.componentState==="ready"?(console.log("ğŸ¤ [ContinuousMode] éŸ³ç¨‹æ¤œå‡ºå†é–‹"),ne.startDetection()):o.componentState==="detecting"?console.log("ğŸ”„ [ContinuousMode] éŸ³ç¨‹æ¤œå‡ºã¯æ—¢ã«ã‚¢ã‚¯ãƒ†ã‚£ãƒ–çŠ¶æ…‹ - ã‚¹ã‚­ãƒƒãƒ—"):console.log("âš ï¸ [ContinuousMode] PitchDetectorçŠ¶æ…‹ä¸æ­£ - éŸ³ç¨‹æ¤œå‡ºå†é–‹ã‚’ã‚¹ã‚­ãƒƒãƒ—:",o.componentState)}else console.log("âš ï¸ [ContinuousMode] getState()ãƒ¡ã‚½ãƒƒãƒ‰æœªå¯¾å¿œ - ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯å‡¦ç†"),ne.getIsInitialized&&ne.getIsInitialized()&&ne.startDetection()}catch(o){console.warn("âš ï¸ [ContinuousMode] éŸ³ç¨‹æ¤œå‡ºå†é–‹å¤±æ•—:",o.message)}console.log("ğŸµ [ContinuousMode] æ¬¡ã®åŸºéŸ³è‡ªå‹•å†ç”Ÿé–‹å§‹"),gt()},3e3):(console.log("ğŸ‰ [ContinuousMode] 8ã‚»ãƒƒã‚·ãƒ§ãƒ³å®Œäº†ï¼"),setTimeout(()=>{console.log("ğŸ† [ContinuousMode] ç·åˆè©•ä¾¡ç”»é¢è¡¨ç¤ºå®Œäº†")},1e3))}function Dn(o){var O;const{error:l,context:S,reason:k,recovery:V}=o.detail;if(S==="initialization"||l!=null&&l.message&&l.message.includes("getIsInitialized")){console.error("âŒ [ContinuousMode] PitchDetectoråˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼è©³ç´°:",{error:(l==null?void 0:l.message)||l,stack:l==null?void 0:l.stack,context:S,componentExists:!!ne,hasGetIsInitialized:typeof(ne==null?void 0:ne.getIsInitialized)=="function",trainingPhase:q,currentSessionId:n});return}if(console.error("âŒ [ContinuousMode] PitchDetectorã‚¨ãƒ©ãƒ¼è©³ç´°:",{error:(l==null?void 0:l.message)||l,stack:l==null?void 0:l.stack,context:S,reason:k,recovery:V,trainingPhase:q,currentSessionId:n}),k==="mediastream_ended"&&V==="restart_required"&&(console.log("âš¡ [ContinuousMode] MediaStreamçµ‚äº†æ¤œå‡º - è‡ªå‹•å¾©æ—§ã‚’è©¦è¡Œ"),setTimeout(async()=>{try{await Ue()}catch(ce){console.error("âŒ [ContinuousMode] è‡ªå‹•å¾©æ—§å¤±æ•—:",ce)}},1e3)),S==="start-detection"&&((O=l==null?void 0:l.message)!=null&&O.includes("component state is detecting"))){console.log("ğŸ”„ [ContinuousMode] éŸ³ç¨‹æ¤œå‡ºã¯æ—¢ã«ã‚¢ã‚¯ãƒ†ã‚£ãƒ–çŠ¶æ…‹ã§ã™ï¼ˆæ­£å¸¸ï¼‰");return}}function qn(o){const{healthy:l,errors:S,details:k}=o.detail;e(2,X=l),e(6,P=S),l||(console.warn("âš ï¸ ãƒã‚¤ã‚¯ã®å¥åº·çŠ¶æ…‹ãŒæ‚ªåŒ–:",S),q==="guiding"&&(e(0,q="setup"),console.warn("ğŸ›‘ ãƒã‚¤ã‚¯å•é¡Œã«ã‚ˆã‚Šãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã‚’åœæ­¢")))}Cn(()=>{console.log("ğŸ”„ [RandomTraining] onDestroy - AudioManagerãƒªã‚½ãƒ¼ã‚¹ã¯ä¿æŒ"),he&&(he.dispose(),e(33,he=null))});const vo=[];Wo.keys(t).forEach(o=>{!~vo.indexOf(o)&&o.slice(0,2)!=="$$"&&o!=="slot"&&Jo.warn(`<Page> was created with unknown prop '${o}'`)});function _o(o){ko[o?"unshift":"push"](()=>{ne=o,e(22,ne)})}return c.$capture_state=()=>({onMount:kn,onDestroy:Cn,goto:_t,base:lt,page:St,ChevronRight:Lo,Music:Hn,Card:Ke,Button:ft,VolumeBar:Fo,PitchDisplay:jo,PitchDetector:Vn,PitchDetectionDisplay:xn,PageLayout:Bn,Tone:zo,audioManager:We,harmonicCorrection:bt,logger:ie,ScoreResultPanel:Ho,IntervalProgressTracker:Vo,ConsistencyGraph:xo,FeedbackDisplay:Bo,SessionStatistics:Po,UnifiedScoreResultFixed:Kt,ActionButtons:Jt,EvaluationEngine:ot,EnhancedScoringEngine:Rn,trainingProgress:At,currentSessionId:Nt,nextBaseNote:Mt,nextBaseName:Rt,isLoading:Ft,storageError:Eo,isCompleted:Ct,sessionHistory:kt,overallGrade:To,overallAccuracy:Io,progressPercentage:Ao,remainingSessions:wt,latestSessionResult:No,unifiedScoreData:qt,loadProgress:Dt,saveSessionResult:Fn,resetProgress:Mo,createNewProgress:Ro,startNewCycleIfCompleted:nt,getVolumeForDevice:In,calculateUnifiedGrade:z,generateTestUnifiedScoreData:Ko,trainingPhase:q,microphoneState:A,microphoneHealthy:X,microphoneErrors:P,buildVersion:io,buildTimestamp:lo,updateStatus:uo,SCALE_NAMES:j,currentBaseNote:B,currentBaseFrequency:_,isPlaying:ee,currentScaleIndex:D,scaleSteps:w,guideAnimationTimer:x,isGuideAnimationActive:L,guideStartProgress:oe,isGuideStartBarActive:E,guideStartTimer:I,musicIconGlowing:te,scaleEvaluations:K,previousEvaluations:ye,currentVolume:Se,currentFrequency:Ee,detectedNote:Le,pitchDifference:Ve,sessionResults:He,scoringEngine:we,currentScoreData:ze,intervalData:ke,consistencyData:Pe,feedbackData:Oe,technicalFeedbackData:Ye,sessionStatistics:Fe,activeTab:dt,noteResultsForDisplay:ae,currentUnifiedScoreData:ue,sampler:he,isSamplerLoading:Re,pitchDetectorComponent:ne,mediaStream:Be,audioContext:st,sourceNode:at,sessionStartTime:Qe,baseNotes:Ge,checkMicrophonePermission:Ue,selectRandomBaseNote:mt,playRandomBaseNote:Qt,playCurrentBaseNote:Xt,playBaseNoteOnly:mo,playBaseNote:gt,startGuideStartBar:Yt,cleanupGuideStartBar:go,calculateExpectedFrequency:Ze,calculateTargetFrequency:Zt,startGuideAnimation:yt,finishGuideAnimation:$t,calculateFinalResults:en,getStatusMessage:yo,getDisplayEvaluations:ho,goToMicrophoneTest:tn,goHome:$e,initializeSampler:nn,checkExistingMicrophonePermission:ct,initializeScoringEngine:on,updateScoringEngine:rn,generateFinalScoring:sn,generateTestScoreData:an,switchTab:po,generateUnifiedScoreData:cn,saveSessionToStorage:ln,generateEnhancedScoringData:un,generateFallbackEnhancedData:ht,generateIntervalDataFromResults:Tt,generateIntervalDataFromSessionHistory:Tn,generateConsistencyDataFromResults:pt,generateFeedbackFromResults:vt,generateTechnicalFeedbackFromEnhancedEngine:fn,handlePitchUpdate:dn,getEvaluationCorrectedFrequency:mn,frequencyToNote:En,multiStageOctaveCorrection:Et,evaluateScaleStep:gn,completeSession:yn,restartSameBaseNote:hn,restartDifferentBaseNote:pn,scrollToTop:rt,resetSessionState:it,startNewCycle:vn,handleActionButtonClick:_n,startContinuousMode:Sn,handleSessionComplete:bn,handlePitchDetectorStateChange:fo,handlePitchDetectorError:Dn,handleMicrophoneHealthChange:qn,canRestartSession:r,canStartTraining:i,$currentSessionId:n,$unifiedScoreData:a,$isCompleted:s,$page:u,$remainingSessions:f,$nextBaseName:d,$nextBaseNote:m,$sessionHistory:v,$trainingProgress:C,$isLoading:p}),c.$inject_state=o=>{"trainingPhase"in o&&e(0,q=o.trainingPhase),"microphoneState"in o&&e(1,A=o.microphoneState),"microphoneHealthy"in o&&e(2,X=o.microphoneHealthy),"microphoneErrors"in o&&e(6,P=o.microphoneErrors),"currentBaseNote"in o&&e(7,B=o.currentBaseNote),"currentBaseFrequency"in o&&e(8,_=o.currentBaseFrequency),"isPlaying"in o&&e(9,ee=o.isPlaying),"currentScaleIndex"in o&&(D=o.currentScaleIndex),"scaleSteps"in o&&e(10,w=o.scaleSteps),"guideAnimationTimer"in o&&(x=o.guideAnimationTimer),"isGuideAnimationActive"in o&&(L=o.isGuideAnimationActive),"guideStartProgress"in o&&e(11,oe=o.guideStartProgress),"isGuideStartBarActive"in o&&(E=o.isGuideStartBarActive),"guideStartTimer"in o&&(I=o.guideStartTimer),"musicIconGlowing"in o&&e(12,te=o.musicIconGlowing),"scaleEvaluations"in o&&(K=o.scaleEvaluations),"previousEvaluations"in o&&(ye=o.previousEvaluations),"currentVolume"in o&&e(13,Se=o.currentVolume),"currentFrequency"in o&&e(14,Ee=o.currentFrequency),"detectedNote"in o&&e(15,Le=o.detectedNote),"pitchDifference"in o&&(Ve=o.pitchDifference),"sessionResults"in o&&(He=o.sessionResults),"scoringEngine"in o&&(we=o.scoringEngine),"currentScoreData"in o&&e(16,ze=o.currentScoreData),"intervalData"in o&&e(3,ke=o.intervalData),"consistencyData"in o&&e(17,Pe=o.consistencyData),"feedbackData"in o&&e(18,Oe=o.feedbackData),"technicalFeedbackData"in o&&e(19,Ye=o.technicalFeedbackData),"sessionStatistics"in o&&e(20,Fe=o.sessionStatistics),"activeTab"in o&&(dt=o.activeTab),"noteResultsForDisplay"in o&&(ae=o.noteResultsForDisplay),"currentUnifiedScoreData"in o&&e(21,ue=o.currentUnifiedScoreData),"sampler"in o&&e(33,he=o.sampler),"isSamplerLoading"in o&&e(34,Re=o.isSamplerLoading),"pitchDetectorComponent"in o&&e(22,ne=o.pitchDetectorComponent),"mediaStream"in o&&(Be=o.mediaStream),"audioContext"in o&&(st=o.audioContext),"sourceNode"in o&&(at=o.sourceNode),"sessionStartTime"in o&&(Qe=o.sessionStartTime),"canRestartSession"in o&&(r=o.canRestartSession),"canStartTraining"in o&&(i=o.canStartTraining)},t&&"$$inject"in t&&c.$inject_state(t.$$inject),c.$$.update=()=>{c.$$.dirty[0]&6|c.$$.dirty[1]&12&&(i=A==="granted"&&!Re&&he&&X),c.$$.dirty[0]&1&&(r=q==="results"),c.$$.dirty[0]&56&&a&&s&&a.sessionHistory&&(e(3,ke=Tn(a.sessionHistory)),console.log("ğŸµ [RandomTraining] intervalDataç”Ÿæˆå®Œäº†:",ke.length,"ä»¶")),c.$$.dirty[0]&3&&q==="setup"&&A==="granted"&&rt()},[q,A,X,ke,a,s,P,B,_,ee,w,oe,te,Se,Ee,Le,ze,Pe,Oe,Ye,Fe,ue,ne,n,v,p,tn,$e,dn,_n,Sn,Dn,qn,he,Re,_o]}class ar extends So{constructor(t){super(t),bo(this,t,Qo,Wt,Do,{},null,[-1,-1,-1,-1]),$("SvelteRegisterComponent",{component:this,tagName:"Page",options:t,id:Wt.name})}}export{ar as component,sr as universal};
