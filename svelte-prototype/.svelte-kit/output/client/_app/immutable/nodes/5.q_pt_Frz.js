const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["../chunks/ADnjuNQc.js","../chunks/DXfV3yLF.js","../chunks/BnpKoSs-.js","../chunks/D0QH3NT1.js","../chunks/BltEqEJK.js","../assets/sessionStorage.C1aMkHwk.css"])))=>i.map(i=>d[i]);
import{_ as Dn}from"../chunks/C1FmrZbK.js";import{S as qo,i as Do,d as Y,s as Co,v as Ne,c as Ae,a as wo,H as Cn,V as wn,b as h,q as fe,r as Q,u as O,f as U,w as de,I as ko,m as Z,x as me,p as $,y as ge,J as Fo,K as Ie,L as Te,g as m,z as A,h as k,M as Xe,j as F,k as z,A as pe,l as W,N as je,o as R,t as J,e as ke,Q as ut,R as Pn,n as Je}from"../chunks/DXfV3yLF.js";import{g as Ro}from"../chunks/D0QH3NT1.js";import"../chunks/BnpKoSs-.js";import{b as _t,g as St}from"../chunks/BltEqEJK.js";import{p as bt}from"../chunks/DN5jTSJf.js";import{P as Bn,B as ft,C as Ke}from"../chunks/CrwomGmF.js";import{l as ie,a as We,h as qt,P as xn,b as Vn,V as Mo}from"../chunks/BRZWrjh2.js";import{l as nt,s as ot,f as kn,e as No,c as Ao,r as Io,a as Fn,u as Dt,b as To,d as Ct,p as Eo,o as Po,g as Bo,h as wt,i as kt,j as xo,k as Ft,n as Rt,m as Mt,q as Nt,t as At,E as Rn,v as rt,A as Wt,U as Jt,S as Vo,F as Ho,C as zo,I as jo,w as Go,T as Lo,P as Oo,M as Hn,x as Uo,y as Wo,z as It}from"../chunks/ADnjuNQc.js";const Jo=!1,Ko=!1,ir=Object.freeze(Object.defineProperty({__proto__:null,prerender:Ko,ssr:Jo},Symbol.toStringTag,{value:"Module"})),{Object:Qo,console:Xo,document:Mn}=Ro,M="src/routes/training/continuous/+page.svelte";function Nn(a,e,t){const i=a.slice();return i[99]=e[t],i[101]=t,i}function An(a,e,t){const i=a.slice();return i[102]=e[t],i}function Pt(a){var V,G;let e,t,i,o,n,s,c,u,f,D,y=(((V=a[24])==null?void 0:V.length)||0)+"",g,I,E,_,d,p,v,N,X=Math.round((((G=a[24])==null?void 0:G.length)||0)/8*100)+"",B,j,x,S,ee,q=a[0]==="results"&&a[5]&&Bt(a);const C={c:function(){e=R("div"),t=R("div"),i=R("div"),o=R("span"),n=J("ã‚»ãƒƒã‚·ãƒ§ãƒ³ "),s=J(a[23]),c=J("/8"),u=$(),f=R("span"),D=J("å®Œäº†æ¸ˆã¿ "),g=J(y),I=J("ã‚»ãƒƒã‚·ãƒ§ãƒ³"),E=$(),_=R("div"),d=R("div"),p=R("div"),v=$(),N=R("span"),B=J(X),j=J("%"),x=$(),q&&q.c(),S=je(),this.h()},l:function(P){e=F(P,"DIV",{class:!0});var T=z(e);t=F(T,"DIV",{class:!0});var te=z(t);i=F(te,"DIV",{class:!0});var K=z(i);o=F(K,"SPAN",{class:!0});var ye=z(o);n=W(ye,"ã‚»ãƒƒã‚·ãƒ§ãƒ³ "),s=W(ye,a[23]),c=W(ye,"/8"),ye.forEach(h),u=Z(K),f=F(K,"SPAN",{class:!0});var Se=z(f);D=W(Se,"å®Œäº†æ¸ˆã¿ "),g=W(Se,y),I=W(Se,"ã‚»ãƒƒã‚·ãƒ§ãƒ³"),Se.forEach(h),K.forEach(h),E=Z(te),_=F(te,"DIV",{class:!0});var Ee=z(_);d=F(Ee,"DIV",{class:!0});var Ge=z(d);p=F(Ge,"DIV",{class:!0,style:!0}),z(p).forEach(h),Ge.forEach(h),v=Z(Ee),N=F(Ee,"SPAN",{class:!0});var Ve=z(N);B=W(Ve,X),j=W(Ve,"%"),Ve.forEach(h),Ee.forEach(h),te.forEach(h),T.forEach(h),x=Z(P),q&&q.l(P),S=je(),this.h()},h:function(){var P;A(o,"class","completed-count svelte-rt5px1"),k(o,M,2687,12,91735),A(f,"class","remaining-text svelte-rt5px1"),k(f,M,2688,12,91812),A(i,"class","session-info svelte-rt5px1"),k(i,M,2686,10,91696),A(p,"class","progress-fill svelte-rt5px1"),Xe(p,"width",(((P=a[24])==null?void 0:P.length)||0)/8*100+"%"),k(p,M,2692,14,92e3),A(d,"class","progress-bar svelte-rt5px1"),k(d,M,2691,12,91959),A(N,"class","progress-text svelte-rt5px1"),k(N,M,2694,12,92126),A(_,"class","progress-section svelte-rt5px1"),k(_,M,2690,10,91916),A(t,"class","session-status svelte-rt5px1"),k(t,M,2685,8,91657),A(e,"class","session-progress svelte-rt5px1"),k(e,M,2684,6,91618)},m:function(P,T){U(P,e,T),m(e,t),m(t,i),m(i,o),m(o,n),m(o,s),m(o,c),m(i,u),m(i,f),m(f,D),m(f,g),m(f,I),m(t,E),m(t,_),m(_,d),m(d,p),m(_,v),m(_,N),m(N,B),m(N,j),U(P,x,T),q&&q.m(P,T),U(P,S,T),ee=!0},p:function(P,T){var te,K,ye;(!ee||T[0]&8388608)&&ke(s,P[23]),(!ee||T[0]&16777216)&&y!==(y=(((te=P[24])==null?void 0:te.length)||0)+"")&&ke(g,y),(!ee||T[0]&16777216)&&Xe(p,"width",(((K=P[24])==null?void 0:K.length)||0)/8*100+"%"),(!ee||T[0]&16777216)&&X!==(X=Math.round((((ye=P[24])==null?void 0:ye.length)||0)/8*100)+"")&&ke(B,X),P[0]==="results"&&P[5]?q?(q.p(P,T),T[0]&33&&O(q,1)):(q=Bt(P),q.c(),O(q,1),q.m(S.parentNode,S)):q&&(Ie(),Q(q,1,1,()=>{q=null}),Te())},i:function(P){ee||(O(q),ee=!0)},o:function(P){Q(q),ee=!1},d:function(P){P&&(h(e),h(x),h(S)),q&&q.d(P)}};return Y("SvelteRegisterBlock",{block:C,id:Pt.name,type:"if",source:"(2684:4) {#if microphoneState === 'granted' && !$isLoading}",ctx:a}),C}function Bt(a){let e,t,i;t=new Wt({props:{isCompleted:a[5],position:"top"},$$inline:!0}),t.$on("action",a[29]);const o={c:function(){e=R("div"),ge(t.$$.fragment),this.h()},l:function(s){e=F(s,"DIV",{class:!0});var c=z(e);me(t.$$.fragment,c),c.forEach(h),this.h()},h:function(){A(e,"class","top-action-buttons svelte-rt5px1"),k(e,M,2702,8,92383)},m:function(s,c){U(s,e,c),de(t,e,null),i=!0},p:function(s,c){const u={};c[0]&32&&(u.isCompleted=s[5]),t.$set(u)},i:function(s){i||(O(t.$$.fragment,s),i=!0)},o:function(s){Q(t.$$.fragment,s),i=!1},d:function(s){s&&h(e),fe(t)}};return Y("SvelteRegisterBlock",{block:o,id:Bt.name,type:"if",source:"(2702:6) {#if trainingPhase === 'results' && $isCompleted}",ctx:a}),o}function zn(a){let e,t;e=new Ke({props:{class:"error-card",$$slots:{default:[On]},$$scope:{ctx:a}},$$inline:!0});const i={c:function(){ge(e.$$.fragment)},l:function(n){me(e.$$.fragment,n)},m:function(n,s){de(e,n,s),t=!0},p:function(n,s){const c={};s[3]&4096&&(c.$$scope={dirty:s,ctx:n}),e.$set(c)},i:function(n){t||(O(e.$$.fragment,n),t=!0)},o:function(n){Q(e.$$.fragment,n),t=!1},d:function(n){fe(e,n)}};return Y("SvelteRegisterBlock",{block:i,id:zn.name,type:"else",source:"(2929:2) {:else}",ctx:a}),i}function jn(a){let e,t,i,o,n,s,c,u,f={isActive:a[1]==="granted",trainingPhase:a[0],className:"pitch-detector-content",debugMode:!0,disableHarmonicCorrection:!1};t=new Vn({props:f,$$inline:!0}),a[35](t),t.$on("pitchUpdate",a[28]),t.$on("stateChange",go),t.$on("error",a[31]),t.$on("microphoneHealthChange",a[32]);let D=!a[2]&&a[6].length>0&&xt(a),y=!a[5]&&Ht(a),g=!a[5]&&jt(a),I=a[0]==="results"&&Lt(a);const E={c:function(){e=R("div"),ge(t.$$.fragment),i=$(),D&&D.c(),o=$(),y&&y.c(),n=$(),g&&g.c(),s=$(),I&&I.c(),c=je(),this.h()},l:function(d){e=F(d,"DIV",{style:!0});var p=z(e);me(t.$$.fragment,p),p.forEach(h),i=Z(d),D&&D.l(d),o=Z(d),y&&y.l(d),n=Z(d),g&&g.l(d),s=Z(d),I&&I.l(d),c=je(),this.h()},h:function(){Xe(e,"display","none"),k(e,M,2721,4,92881)},m:function(d,p){U(d,e,p),de(t,e,null),U(d,i,p),D&&D.m(d,p),U(d,o,p),y&&y.m(d,p),U(d,n,p),g&&g.m(d,p),U(d,s,p),I&&I.m(d,p),U(d,c,p),u=!0},p:function(d,p){const v={};p[0]&2&&(v.isActive=d[1]==="granted"),p[0]&1&&(v.trainingPhase=d[0]),t.$set(v),!d[2]&&d[6].length>0?D?(D.p(d,p),p[0]&68&&O(D,1)):(D=xt(d),D.c(),O(D,1),D.m(o.parentNode,o)):D&&(Ie(),Q(D,1,1,()=>{D=null}),Te()),d[5]?y&&(Ie(),Q(y,1,1,()=>{y=null}),Te()):y?(y.p(d,p),p[0]&32&&O(y,1)):(y=Ht(d),y.c(),O(y,1),y.m(n.parentNode,n)),d[5]?g&&(Ie(),Q(g,1,1,()=>{g=null}),Te()):g?(g.p(d,p),p[0]&32&&O(g,1)):(g=jt(d),g.c(),O(g,1),g.m(s.parentNode,s)),d[0]==="results"?I?(I.p(d,p),p[0]&1&&O(I,1)):(I=Lt(d),I.c(),O(I,1),I.m(c.parentNode,c)):I&&(Ie(),Q(I,1,1,()=>{I=null}),Te())},i:function(d){u||(O(t.$$.fragment,d),O(D),O(y),O(g),O(I),u=!0)},o:function(d){Q(t.$$.fragment,d),Q(D),Q(y),Q(g),Q(I),u=!1},d:function(d){d&&(h(e),h(i),h(o),h(n),h(s),h(c)),a[35](null),fe(t),D&&D.d(d),y&&y.d(d),g&&g.d(d),I&&I.d(d)}};return Y("SvelteRegisterBlock",{block:E,id:jn.name,type:"if",source:"(2720:2) {#if microphoneState === 'granted'}",ctx:a}),E}function Gn(a){let e;const t={c:function(){e=J("ğŸ¤ ãƒã‚¤ã‚¯ãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸ã¸ç§»å‹•")},l:function(o){e=W(o,"ğŸ¤ ãƒã‚¤ã‚¯ãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸ã¸ç§»å‹•")},m:function(o,n){U(o,e,n)},d:function(o){o&&h(e)}};return Y("SvelteRegisterBlock",{block:t,id:Gn.name,type:"slot",source:'(2943:10) <Button variant=\\"primary\\" on:click={goToMicrophoneTest}>',ctx:a}),t}function Ln(a){let e;const t={c:function(){e=J("ğŸ  ãƒ›ãƒ¼ãƒ ã«æˆ»ã‚‹")},l:function(o){e=W(o,"ğŸ  ãƒ›ãƒ¼ãƒ ã«æˆ»ã‚‹")},m:function(o,n){U(o,e,n)},d:function(o){o&&h(e)}};return Y("SvelteRegisterBlock",{block:t,id:Ln.name,type:"slot",source:'(2946:10) <Button variant=\\"secondary\\" on:click={goHome}>',ctx:a}),t}function On(a){let e,t,i="ğŸ¤",o,n,s="ãƒã‚¤ã‚¯ãƒ†ã‚¹ãƒˆãŒå¿…è¦ã§ã™",c,u,f="é€£ç¶šãƒãƒ£ãƒ¬ãƒ³ã‚¸ãƒ¢ãƒ¼ãƒ‰ã‚’é–‹å§‹ã™ã‚‹å‰ã«ã€ãƒã‚¤ã‚¯ãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸ã§éŸ³å£°å…¥åŠ›ã®ç¢ºèªã‚’ãŠé¡˜ã„ã—ã¾ã™ã€‚",D,y,g,I,E,_="ãƒã‚¤ã‚¯ãƒ†ã‚¹ãƒˆå®Œäº†å¾Œ",d,p,v,N="ã¾ãšã¯ãƒã‚¤ã‚¯ãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸ã§éŸ³å£°ç¢ºèªã‚’è¡Œã£ã¦ãã ã•ã„ã€‚",X,B,j,x,S,ee;j=new ft({props:{variant:"primary",$$slots:{default:[Gn]},$$scope:{ctx:a}},$$inline:!0}),j.$on("click",a[26]),S=new ft({props:{variant:"secondary",$$slots:{default:[Ln]},$$scope:{ctx:a}},$$inline:!0}),S.$on("click",a[27]);const q={c:function(){e=R("div"),t=R("div"),t.textContent=i,o=$(),n=R("h3"),n.textContent=s,c=$(),u=R("p"),u.textContent=f,D=$(),y=R("div"),g=R("p"),I=J("ã“ã®ãƒšãƒ¼ã‚¸ã¯"),E=R("strong"),E.textContent=_,d=J("ã«ã”åˆ©ç”¨ã„ãŸã ã‘ã¾ã™ã€‚"),p=$(),v=R("p"),v.textContent=N,X=$(),B=R("div"),ge(j.$$.fragment),x=$(),ge(S.$$.fragment),this.h()},l:function(V){e=F(V,"DIV",{class:!0});var G=z(e);t=F(G,"DIV",{class:!0,"data-svelte-h":!0}),pe(t)!=="svelte-15rbx8n"&&(t.textContent=i),o=Z(G),n=F(G,"H3",{class:!0,"data-svelte-h":!0}),pe(n)!=="svelte-17kvze2"&&(n.textContent=s),c=Z(G),u=F(G,"P",{class:!0,"data-svelte-h":!0}),pe(u)!=="svelte-1t09god"&&(u.textContent=f),D=Z(G),y=F(G,"DIV",{class:!0});var oe=z(y);g=F(oe,"P",{class:!0});var P=z(g);I=W(P,"ã“ã®ãƒšãƒ¼ã‚¸ã¯"),E=F(P,"STRONG",{"data-svelte-h":!0}),pe(E)!=="svelte-1n3qsr6"&&(E.textContent=_),d=W(P,"ã«ã”åˆ©ç”¨ã„ãŸã ã‘ã¾ã™ã€‚"),P.forEach(h),p=Z(oe),v=F(oe,"P",{class:!0,"data-svelte-h":!0}),pe(v)!=="svelte-v8nd09"&&(v.textContent=N),oe.forEach(h),X=Z(G),B=F(G,"DIV",{class:!0});var T=z(B);me(j.$$.fragment,T),x=Z(T),me(S.$$.fragment,T),T.forEach(h),G.forEach(h),this.h()},h:function(){A(t,"class","error-icon svelte-rt5px1"),k(t,M,2932,8,100003),A(n,"class","svelte-rt5px1"),k(n,M,2933,8,100044),A(u,"class","svelte-rt5px1"),k(u,M,2934,8,100073),k(E,M,2937,19,100189),A(g,"class","svelte-rt5px1"),k(g,M,2937,10,100180),A(v,"class","svelte-rt5px1"),k(v,M,2938,10,100241),A(y,"class","recommendation svelte-rt5px1"),k(y,M,2936,8,100141),A(B,"class","action-buttons"),k(B,M,2941,8,100307),A(e,"class","error-content svelte-rt5px1"),k(e,M,2931,6,99967)},m:function(V,G){U(V,e,G),m(e,t),m(e,o),m(e,n),m(e,c),m(e,u),m(e,D),m(e,y),m(y,g),m(g,I),m(g,E),m(g,d),m(y,p),m(y,v),m(e,X),m(e,B),de(j,B,null),m(B,x),de(S,B,null),ee=!0},p:function(V,G){const oe={};G[3]&4096&&(oe.$$scope={dirty:G,ctx:V}),j.$set(oe);const P={};G[3]&4096&&(P.$$scope={dirty:G,ctx:V}),S.$set(P)},i:function(V){ee||(O(j.$$.fragment,V),O(S.$$.fragment,V),ee=!0)},o:function(V){Q(j.$$.fragment,V),Q(S.$$.fragment,V),ee=!1},d:function(V){V&&h(e),fe(j),fe(S)}};return Y("SvelteRegisterBlock",{block:q,id:On.name,type:"slot",source:'(2931:4) <Card class=\\"error-card\\">',ctx:a}),q}function xt(a){let e,t;e=new Ke({props:{class:"warning-card",$$slots:{default:[Un]},$$scope:{ctx:a}},$$inline:!0});const i={c:function(){ge(e.$$.fragment)},l:function(n){me(e.$$.fragment,n)},m:function(n,s){de(e,n,s),t=!0},p:function(n,s){const c={};s[0]&64|s[3]&4096&&(c.$$scope={dirty:s,ctx:n}),e.$set(c)},i:function(n){t||(O(e.$$.fragment,n),t=!0)},o:function(n){Q(e.$$.fragment,n),t=!1},d:function(n){fe(e,n)}};return Y("SvelteRegisterBlock",{block:i,id:xt.name,type:"if",source:"(2741:6) {#if !microphoneHealthy && microphoneErrors.length > 0}",ctx:a}),i}function Vt(a){let e,t=a[102]+"",i;const o={c:function(){e=R("li"),i=J(t),this.h()},l:function(s){e=F(s,"LI",{class:!0});var c=z(e);i=W(c,t),c.forEach(h),this.h()},h:function(){A(e,"class","svelte-rt5px1"),k(e,M,2749,16,93953)},m:function(s,c){U(s,e,c),m(e,i)},p:function(s,c){c[0]&64&&t!==(t=s[102]+"")&&ke(i,t)},d:function(s){s&&h(e)}};return Y("SvelteRegisterBlock",{block:o,id:Vt.name,type:"each",source:"(2749:14) {#each microphoneErrors as error}",ctx:a}),o}function Un(a){let e,t,i="âš ï¸ ãƒã‚¤ã‚¯æ¥ç¶šã«å•é¡ŒãŒã‚ã‚Šã¾ã™",o,n,s,c="ãƒã‚¤ã‚¯ãŒæ­£å¸¸ã«å‹•ä½œã—ã¦ã„ã¾ã›ã‚“ã€‚ä»¥ä¸‹ã®å•é¡ŒãŒæ¤œå‡ºã•ã‚Œã¾ã—ãŸï¼š",u,f,D,y,g,I="è§£æ±ºæ–¹æ³•:",E,_=ut(a[6]),d=[];for(let v=0;v<_.length;v+=1)d[v]=Vt(An(a,_,v));const p={c:function(){e=R("div"),t=R("h3"),t.textContent=i,o=$(),n=R("div"),s=R("p"),s.textContent=c,u=$(),f=R("ul");for(let N=0;N<d.length;N+=1)d[N].c();D=$(),y=R("p"),g=R("strong"),g.textContent=I,E=J(" ãƒšãƒ¼ã‚¸ã‚’å†èª­ã¿è¾¼ã¿ã—ã¦ãƒã‚¤ã‚¯è¨±å¯ã‚’å†åº¦å–å¾—ã—ã¦ãã ã•ã„ã€‚"),this.h()},l:function(N){e=F(N,"DIV",{class:!0});var X=z(e);t=F(X,"H3",{class:!0,"data-svelte-h":!0}),pe(t)!=="svelte-15qec5x"&&(t.textContent=i),X.forEach(h),o=Z(N),n=F(N,"DIV",{class:!0});var B=z(n);s=F(B,"P",{class:!0,"data-svelte-h":!0}),pe(s)!=="svelte-171o2p0"&&(s.textContent=c),u=Z(B),f=F(B,"UL",{class:!0});var j=z(f);for(let S=0;S<d.length;S+=1)d[S].l(j);j.forEach(h),D=Z(B),y=F(B,"P",{class:!0});var x=z(y);g=F(x,"STRONG",{"data-svelte-h":!0}),pe(g)!=="svelte-79o66n"&&(g.textContent=I),E=W(x," ãƒšãƒ¼ã‚¸ã‚’å†èª­ã¿è¾¼ã¿ã—ã¦ãƒã‚¤ã‚¯è¨±å¯ã‚’å†åº¦å–å¾—ã—ã¦ãã ã•ã„ã€‚"),x.forEach(h),B.forEach(h),this.h()},h:function(){A(t,"class","section-title svelte-rt5px1"),k(t,M,2743,12,93677),A(e,"class","card-header svelte-rt5px1"),k(e,M,2742,10,93639),A(s,"class","warning-message svelte-rt5px1"),k(s,M,2746,12,93791),A(f,"class","error-list svelte-rt5px1"),k(f,M,2747,12,93865),k(g,M,2753,14,94064),A(y,"class","fix-instruction svelte-rt5px1"),k(y,M,2752,12,94022),A(n,"class","card-content svelte-rt5px1"),k(n,M,2745,10,93752)},m:function(N,X){U(N,e,X),m(e,t),U(N,o,X),U(N,n,X),m(n,s),m(n,u),m(n,f);for(let B=0;B<d.length;B+=1)d[B]&&d[B].m(f,null);m(n,D),m(n,y),m(y,g),m(y,E)},p:function(N,X){if(X[0]&64){_=ut(N[6]);let B;for(B=0;B<_.length;B+=1){const j=An(N,_,B);d[B]?d[B].p(j,X):(d[B]=Vt(j),d[B].c(),d[B].m(f,null))}for(;B<d.length;B+=1)d[B].d(1);d.length=_.length}},d:function(N){N&&(h(e),h(o),h(n)),Pn(d,N)}};return Y("SvelteRegisterBlock",{block:p,id:Un.name,type:"slot",source:'(2742:8) <Card class=\\"warning-card\\">',ctx:a}),p}function Ht(a){let e,t,i,o,n;t=new Ke({props:{class:"main-card half-width",$$slots:{default:[$n]},$$scope:{ctx:a}},$$inline:!0}),o=new xn({props:{frequency:a[14],note:a[15],volume:a[13],isMuted:a[0]!=="guiding",muteMessage:"åŸºéŸ³å†ç”Ÿå¾Œã«é–‹å§‹",className:"half-width",showGuidance:!1},$$inline:!0});const s={c:function(){e=R("div"),ge(t.$$.fragment),i=$(),ge(o.$$.fragment),this.h()},l:function(u){e=F(u,"DIV",{class:!0});var f=z(e);me(t.$$.fragment,f),i=Z(f),me(o.$$.fragment,f),f.forEach(h),this.h()},h:function(){A(e,"class","side-by-side-container svelte-rt5px1"),k(e,M,2761,6,94258)},m:function(u,f){U(u,e,f),de(t,e,null),m(e,i),de(o,e,null),n=!0},p:function(u,f){const D={};f[0]&8395649|f[3]&4096&&(D.$$scope={dirty:f,ctx:u}),t.$set(D);const y={};f[0]&16384&&(y.frequency=u[14]),f[0]&32768&&(y.note=u[15]),f[0]&8192&&(y.volume=u[13]),f[0]&1&&(y.isMuted=u[0]!=="guiding"),o.$set(y)},i:function(u){n||(O(t.$$.fragment,u),O(o.$$.fragment,u),n=!0)},o:function(u){Q(t.$$.fragment,u),Q(o.$$.fragment,u),n=!1},d:function(u){u&&h(e),fe(t),fe(o)}};return Y("SvelteRegisterBlock",{block:s,id:Ht.name,type:"if",source:"(2761:6) {#if !$isCompleted}",ctx:a}),s}function Wn(a){let e;function t(s,c){return s[9]?Yn:s[0]==="guiding"?Xn:s[0]==="results"?Qn:Kn}let i=t(a),o=i(a);const n={c:function(){e=R("div"),o.c(),this.h()},l:function(c){e=F(c,"DIV",{class:!0});var u=z(e);o.l(u),u.forEach(h),this.h()},h:function(){A(e,"class","continuous-status svelte-rt5px1"),k(e,M,2778,14,94907)},m:function(c,u){U(c,e,u),o.m(e,null)},p:function(c,u){i===(i=t(c))&&o?o.p(c,u):(o.d(1),o=i(c),o&&(o.c(),o.m(e,null)))},i:Je,o:Je,d:function(c){c&&h(e),o.d()}};return Y("SvelteRegisterBlock",{block:n,id:Wn.name,type:"else",source:"(2777:12) {:else}",ctx:a}),n}function Jn(a){let e,t;e=new ft({props:{variant:"primary",$$slots:{default:[Zn]},$$scope:{ctx:a}},$$inline:!0}),e.$on("click",a[30]);const i={c:function(){ge(e.$$.fragment)},l:function(n){me(e.$$.fragment,n)},m:function(n,s){de(e,n,s),t=!0},p:function(n,s){const c={};s[3]&4096&&(c.$$scope={dirty:s,ctx:n}),e.$set(c)},i:function(n){t||(O(e.$$.fragment,n),t=!0)},o:function(n){Q(e.$$.fragment,n),t=!1},d:function(n){fe(e,n)}};return Y("SvelteRegisterBlock",{block:i,id:Jn.name,type:"if",source:"(2770:12) {#if trainingPhase === 'setup' && !isPlaying && !($currentSessionId > 1)}",ctx:a}),i}function Kn(a){let e,t,i,o;const n={c:function(){e=R("div"),t=J("âš¡ é€£ç¶šãƒ¢ãƒ¼ãƒ‰é€²è¡Œä¸­ ("),i=J(a[23]),o=J("/8)"),this.h()},l:function(c){e=F(c,"DIV",{class:!0});var u=z(e);t=W(u,"âš¡ é€£ç¶šãƒ¢ãƒ¼ãƒ‰é€²è¡Œä¸­ ("),i=W(u,a[23]),o=W(u,"/8)"),u.forEach(h),this.h()},h:function(){A(e,"class","status-text svelte-rt5px1"),k(e,M,2792,18,95497)},m:function(c,u){U(c,e,u),m(e,t),m(e,i),m(e,o)},p:function(c,u){u[0]&8388608&&ke(i,c[23])},d:function(c){c&&h(e)}};return Y("SvelteRegisterBlock",{block:n,id:Kn.name,type:"else",source:"(2792:16) {:else}",ctx:a}),n}function Qn(a){let e,t,i,o;const n={c:function(){e=R("div"),t=J("âœ… ã‚»ãƒƒã‚·ãƒ§ãƒ³ "),i=J(a[23]),o=J("/8 å®Œäº†"),this.h()},l:function(c){e=F(c,"DIV",{class:!0});var u=z(e);t=W(u,"âœ… ã‚»ãƒƒã‚·ãƒ§ãƒ³ "),i=W(u,a[23]),o=W(u,"/8 å®Œäº†"),u.forEach(h),this.h()},h:function(){A(e,"class","status-text svelte-rt5px1"),k(e,M,2788,18,95351)},m:function(c,u){U(c,e,u),m(e,t),m(e,i),m(e,o)},p:function(c,u){u[0]&8388608&&ke(i,c[23])},d:function(c){c&&h(e)}};return Y("SvelteRegisterBlock",{block:n,id:Qn.name,type:"if",source:"(2788:54) ",ctx:a}),n}function Xn(a){let e,t,i,o;const n={c:function(){e=R("div"),t=J("ğŸ¤ ã‚»ãƒƒã‚·ãƒ§ãƒ³ "),i=J(a[23]),o=J("/8: ãƒ‰ãƒ¬ãƒŸç™ºå£°ä¸­"),this.h()},l:function(c){e=F(c,"DIV",{class:!0});var u=z(e);t=W(u,"ğŸ¤ ã‚»ãƒƒã‚·ãƒ§ãƒ³ "),i=W(u,a[23]),o=W(u,"/8: ãƒ‰ãƒ¬ãƒŸç™ºå£°ä¸­"),u.forEach(h),this.h()},h:function(){A(e,"class","status-text svelte-rt5px1"),k(e,M,2784,18,95168)},m:function(c,u){U(c,e,u),m(e,t),m(e,i),m(e,o)},p:function(c,u){u[0]&8388608&&ke(i,c[23])},d:function(c){c&&h(e)}};return Y("SvelteRegisterBlock",{block:n,id:Xn.name,type:"if",source:"(2784:54) ",ctx:a}),n}function Yn(a){let e,t,i,o;const n={c:function(){e=R("div"),t=J("ğŸµ åŸºéŸ³ "),i=J(a[23]),o=J("/8 å†ç”Ÿä¸­..."),this.h()},l:function(c){e=F(c,"DIV",{class:!0});var u=z(e);t=W(u,"ğŸµ åŸºéŸ³ "),i=W(u,a[23]),o=W(u,"/8 å†ç”Ÿä¸­..."),u.forEach(h),this.h()},h:function(){A(e,"class","status-text svelte-rt5px1"),k(e,M,2780,18,94989)},m:function(c,u){U(c,e,u),m(e,t),m(e,i),m(e,o)},p:function(c,u){u[0]&8388608&&ke(i,c[23])},d:function(c){c&&h(e)}};return Y("SvelteRegisterBlock",{block:n,id:Yn.name,type:"if",source:"(2780:16) {#if isPlaying}",ctx:a}),n}function Zn(a){let e;const t={c:function(){e=J("âš¡ é€£ç¶šãƒãƒ£ãƒ¬ãƒ³ã‚¸é–‹å§‹ï¼ˆ8ã‚»ãƒƒã‚·ãƒ§ãƒ³ï¼‰")},l:function(o){e=W(o,"âš¡ é€£ç¶šãƒãƒ£ãƒ¬ãƒ³ã‚¸é–‹å§‹ï¼ˆ8ã‚»ãƒƒã‚·ãƒ§ãƒ³ï¼‰")},m:function(o,n){U(o,e,n)},d:function(o){o&&h(e)}};return Y("SvelteRegisterBlock",{block:t,id:Zn.name,type:"slot",source:'(2771:14) <Button                  variant=\\"primary\\"                 on:click={startContinuousMode}               >',ctx:a}),t}function zt(a){let e,t,i,o,n,s=(a[8]||0).toFixed(1)+"",c,u;const f={c:function(){e=R("div"),t=J("ç¾åœ¨ã®åŸºéŸ³: "),i=R("strong"),o=J(a[7]),n=J(" ("),c=J(s),u=J("Hz)"),this.h()},l:function(y){e=F(y,"DIV",{class:!0});var g=z(e);t=W(g,"ç¾åœ¨ã®åŸºéŸ³: "),i=F(g,"STRONG",{});var I=z(i);o=W(I,a[7]),I.forEach(h),n=W(g," ("),c=W(g,s),u=W(g,"Hz)"),g.forEach(h),this.h()},h:function(){k(i,M,2801,23,95777),A(e,"class","base-note-info svelte-rt5px1"),k(e,M,2800,14,95725)},m:function(y,g){U(y,e,g),m(e,t),m(e,i),m(i,o),m(e,n),m(e,c),m(e,u)},p:function(y,g){g[0]&128&&ke(o,y[7]),g[0]&256&&s!==(s=(y[8]||0).toFixed(1)+"")&&ke(c,s)},d:function(y){y&&h(e)}};return Y("SvelteRegisterBlock",{block:f,id:zt.name,type:"if",source:"(2800:12) {#if currentBaseNote}",ctx:a}),f}function $n(a){let e,t,i="ğŸ¹ åŸºéŸ³å†ç”Ÿ",o,n,s,c,u,f,D,y,g="ã‚¬ã‚¤ãƒ‰é–‹å§‹ã¾ã§",I,E,_,d,p,v,N,X;const B=[Jn,Wn],j=[];function x(q,C){return q[0]==="setup"&&!q[9]&&!(q[23]>1)?0:1}s=x(a),c=j[s]=B[s](a);let S=a[7]&&zt(a);v=new Hn({props:{size:"20"},$$inline:!0});const ee={c:function(){e=R("div"),t=R("h3"),t.textContent=i,o=$(),n=R("div"),c.c(),u=$(),S&&S.c(),f=$(),D=R("div"),y=R("div"),y.textContent=g,I=$(),E=R("div"),_=R("div"),d=$(),p=R("div"),ge(v.$$.fragment),this.h()},l:function(C){e=F(C,"DIV",{class:!0});var V=z(e);t=F(V,"H3",{class:!0,"data-svelte-h":!0}),pe(t)!=="svelte-syc53b"&&(t.textContent=i),V.forEach(h),o=Z(C),n=F(C,"DIV",{class:!0});var G=z(n);c.l(G),u=Z(G),S&&S.l(G),f=Z(G),D=F(G,"DIV",{class:!0});var oe=z(D);y=F(oe,"DIV",{class:!0,"data-svelte-h":!0}),pe(y)!=="svelte-1dufnpv"&&(y.textContent=g),I=Z(oe),E=F(oe,"DIV",{class:!0});var P=z(E);_=F(P,"DIV",{class:!0,style:!0}),z(_).forEach(h),d=Z(P),p=F(P,"DIV",{class:!0});var T=z(p);me(v.$$.fragment,T),T.forEach(h),P.forEach(h),oe.forEach(h),G.forEach(h),this.h()},h:function(){A(t,"class","section-title svelte-rt5px1"),k(t,M,2765,12,94422),A(e,"class","card-header svelte-rt5px1"),k(e,M,2764,10,94384),A(y,"class","guide-start-label svelte-rt5px1"),k(y,M,2807,14,96009),A(_,"class","guide-progress-fill svelte-rt5px1"),Xe(_,"width",a[11]+"%"),k(_,M,2809,16,96114),A(p,"class",N="guide-music-icon "+(a[12]?"glowing":"")+" svelte-rt5px1"),k(p,M,2813,16,96262),A(E,"class","guide-start-bar svelte-rt5px1"),k(E,M,2808,14,96068),A(D,"class","guide-start-bar-container svelte-rt5px1"),k(D,M,2806,12,95955),A(n,"class","card-content svelte-rt5px1"),k(n,M,2767,10,94488)},m:function(C,V){U(C,e,V),m(e,t),U(C,o,V),U(C,n,V),j[s].m(n,null),m(n,u),S&&S.m(n,null),m(n,f),m(n,D),m(D,y),m(D,I),m(D,E),m(E,_),m(E,d),m(E,p),de(v,p,null),X=!0},p:function(C,V){let G=s;s=x(C),s===G?j[s].p(C,V):(Ie(),Q(j[G],1,1,()=>{j[G]=null}),Te(),c=j[s],c?c.p(C,V):(c=j[s]=B[s](C),c.c()),O(c,1),c.m(n,u)),C[7]?S?S.p(C,V):(S=zt(C),S.c(),S.m(n,f)):S&&(S.d(1),S=null),(!X||V[0]&2048)&&Xe(_,"width",C[11]+"%"),(!X||V[0]&4096&&N!==(N="guide-music-icon "+(C[12]?"glowing":"")+" svelte-rt5px1"))&&A(p,"class",N)},i:function(C){X||(O(c),O(v.$$.fragment,C),X=!0)},o:function(C){Q(c),Q(v.$$.fragment,C),X=!1},d:function(C){C&&(h(e),h(o),h(n)),j[s].d(),S&&S.d(),fe(v)}};return Y("SvelteRegisterBlock",{block:ee,id:$n.name,type:"slot",source:'(2764:8) <Card class=\\"main-card half-width\\">',ctx:a}),ee}function jt(a){let e,t;e=new Ke({props:{class:"main-card",$$slots:{default:[no]},$$scope:{ctx:a}},$$inline:!0});const i={c:function(){ge(e.$$.fragment)},l:function(n){me(e.$$.fragment,n)},m:function(n,s){de(e,n,s),t=!0},p:function(n,s){const c={};s[0]&1025|s[3]&4096&&(c.$$scope={dirty:s,ctx:n}),e.$set(c)},i:function(n){t||(O(e.$$.fragment,n),t=!0)},o:function(n){Q(e.$$.fragment,n),t=!1},d:function(n){fe(e,n)}};return Y("SvelteRegisterBlock",{block:i,id:jt.name,type:"if",source:"(2836:4) {#if !$isCompleted}",ctx:a}),i}function Gt(a){let e,t=(a[99].name||`éŸ³éš${a[101]+1}`)+"",i,o,n;const s={c:function(){e=R("div"),i=J(t),o=$(),this.h()},l:function(u){e=F(u,"DIV",{class:!0});var f=z(e);i=W(f,t),o=Z(f),f.forEach(h),this.h()},h:function(){A(e,"class",n="scale-item "+(a[99].state||"inactive")+" svelte-rt5px1"),k(e,M,2843,12,97139)},m:function(u,f){U(u,e,f),m(e,i),m(e,o)},p:function(u,f){f[0]&1024&&t!==(t=(u[99].name||`éŸ³éš${u[101]+1}`)+"")&&ke(i,t),f[0]&1024&&n!==(n="scale-item "+(u[99].state||"inactive")+" svelte-rt5px1")&&A(e,"class",n)},d:function(u){u&&h(e)}};return Y("SvelteRegisterBlock",{block:s,id:Gt.name,type:"each",source:"(2843:10) {#each scaleSteps as step, index}",ctx:a}),s}function eo(a){let e,t="åŸºéŸ³ã‚„ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ å‘¨æ³¢æ•°è¡¨ç¤ºã¯ç·åˆè©•ä¾¡ä¸­ã§ã‚‚åˆ©ç”¨ã§ãã¾ã™";const i={c:function(){e=R("div"),e.textContent=t,this.h()},l:function(n){e=F(n,"DIV",{class:!0,"data-svelte-h":!0}),pe(e)!=="svelte-1e5qmlp"&&(e.textContent=t),this.h()},h:function(){A(e,"class","guide-instruction svelte-rt5px1"),k(e,M,2855,10,97532)},m:function(n,s){U(n,e,s)},d:function(n){n&&h(e)}};return Y("SvelteRegisterBlock",{block:i,id:eo.name,type:"if",source:"(2855:46) ",ctx:a}),i}function to(a){let e,t,i,o="ãƒ‰ãƒ¬ãƒŸãƒ•ã‚¡ã‚½ãƒ©ã‚·ãƒ‰",n;const s={c:function(){e=R("div"),t=J("ã‚¬ã‚¤ãƒ‰ã«åˆã‚ã›ã¦ "),i=R("strong"),i.textContent=o,n=J(" ã‚’æ­Œã£ã¦ãã ã•ã„"),this.h()},l:function(u){e=F(u,"DIV",{class:!0});var f=z(e);t=W(f,"ã‚¬ã‚¤ãƒ‰ã«åˆã‚ã›ã¦ "),i=F(f,"STRONG",{"data-svelte-h":!0}),pe(i)!=="svelte-1dipf74"&&(i.textContent=o),n=W(f," ã‚’æ­Œã£ã¦ãã ã•ã„"),f.forEach(h),this.h()},h:function(){k(i,M,2852,21,97422),A(e,"class","guide-instruction svelte-rt5px1"),k(e,M,2851,10,97369)},m:function(u,f){U(u,e,f),m(e,t),m(e,i),m(e,n)},d:function(u){u&&h(e)}};return Y("SvelteRegisterBlock",{block:s,id:to.name,type:"if",source:"(2851:8) {#if trainingPhase === 'guiding'}",ctx:a}),s}function no(a){let e,t,i="ğŸµ ãƒ‰ãƒ¬ãƒŸéŸ³éšã‚¬ã‚¤ãƒ‰",o,n,s,c,u=ut(a[10]),f=[];for(let E=0;E<u.length;E+=1)f[E]=Gt(Nn(a,u,E));function D(E,_){if(E[0]==="guiding")return to;if(E[0]==="results")return eo}let y=D(a),g=y&&y(a);const I={c:function(){e=R("div"),t=R("h3"),t.textContent=i,o=$(),n=R("div"),s=R("div");for(let _=0;_<f.length;_+=1)f[_].c();c=$(),g&&g.c(),this.h()},l:function(_){e=F(_,"DIV",{class:!0});var d=z(e);t=F(d,"H3",{class:!0,"data-svelte-h":!0}),pe(t)!=="svelte-1mor0as"&&(t.textContent=i),d.forEach(h),o=Z(_),n=F(_,"DIV",{class:!0});var p=z(n);s=F(p,"DIV",{class:!0});var v=z(s);for(let N=0;N<f.length;N+=1)f[N].l(v);v.forEach(h),c=Z(p),g&&g.l(p),p.forEach(h),this.h()},h:function(){A(t,"class","section-title svelte-rt5px1"),k(t,M,2838,8,96960),A(e,"class","card-header svelte-rt5px1"),k(e,M,2837,6,96926),A(s,"class","scale-guide svelte-rt5px1"),k(s,M,2841,8,97057),A(n,"class","card-content svelte-rt5px1"),k(n,M,2840,6,97022)},m:function(_,d){U(_,e,d),m(e,t),U(_,o,d),U(_,n,d),m(n,s);for(let p=0;p<f.length;p+=1)f[p]&&f[p].m(s,null);m(n,c),g&&g.m(n,null)},p:function(_,d){if(d[0]&1024){u=ut(_[10]);let p;for(p=0;p<u.length;p+=1){const v=Nn(_,u,p);f[p]?f[p].p(v,d):(f[p]=Gt(v),f[p].c(),f[p].m(s,null))}for(;p<f.length;p+=1)f[p].d(1);f.length=u.length}y!==(y=D(_))&&(g&&g.d(1),g=y&&y(_),g&&(g.c(),g.m(n,null)))},d:function(_){_&&(h(e),h(o),h(n)),Pn(f,_),g&&g.d()}};return Y("SvelteRegisterBlock",{block:I,id:no.name,type:"slot",source:'(2837:4) <Card class=\\"main-card\\">',ctx:a}),I}function Lt(a){let e,t,i,o,n,s,c;const u=[ro,oo],f=[];function D(_,d){return _[4]&&_[5]?0:_[21]?1:-1}~(e=D(a))&&(t=f[e]=u[e](a));const y=[ao,so],g=[];function I(_,d){return _[0]==="results"&&_[5]?0:_[0]==="results"&&!_[5]?1:-1}~(o=I(a))&&(n=g[o]=y[o](a));const E={c:function(){t&&t.c(),i=$(),n&&n.c(),s=je()},l:function(d){t&&t.l(d),i=Z(d),n&&n.l(d),s=je()},m:function(d,p){~e&&f[e].m(d,p),U(d,i,p),~o&&g[o].m(d,p),U(d,s,p),c=!0},p:function(d,p){let v=e;e=D(d),e===v?~e&&f[e].p(d,p):(t&&(Ie(),Q(f[v],1,1,()=>{f[v]=null}),Te()),~e?(t=f[e],t?t.p(d,p):(t=f[e]=u[e](d),t.c()),O(t,1),t.m(i.parentNode,i)):t=null);let N=o;o=I(d),o===N?~o&&g[o].p(d,p):(n&&(Ie(),Q(g[N],1,1,()=>{g[N]=null}),Te()),~o?(n=g[o],n?n.p(d,p):(n=g[o]=y[o](d),n.c()),O(n,1),n.m(s.parentNode,s)):n=null)},i:function(d){c||(O(t),O(n),c=!0)},o:function(d){Q(t),Q(n),c=!1},d:function(d){d&&(h(i),h(s)),~e&&f[e].d(d),~o&&g[o].d(d)}};return Y("SvelteRegisterBlock",{block:E,id:Lt.name,type:"if",source:"(2866:4) {#if trainingPhase === 'results'}",ctx:a}),E}function oo(a){let e,t;e=new Jt({props:{scoreData:a[21],showDetails:!1,className:"mb-6 iphone-no-margin",currentScoreData:a[16],intervalData:a[3],consistencyData:a[17],feedbackData:a[18],technicalFeedbackData:a[19],sessionStatistics:a[20]},$$inline:!0});const i={c:function(){ge(e.$$.fragment)},l:function(n){me(e.$$.fragment,n)},m:function(n,s){de(e,n,s),t=!0},p:function(n,s){const c={};s[0]&2097152&&(c.scoreData=n[21]),s[0]&65536&&(c.currentScoreData=n[16]),s[0]&8&&(c.intervalData=n[3]),s[0]&131072&&(c.consistencyData=n[17]),s[0]&262144&&(c.feedbackData=n[18]),s[0]&524288&&(c.technicalFeedbackData=n[19]),s[0]&1048576&&(c.sessionStatistics=n[20]),e.$set(c)},i:function(n){t||(O(e.$$.fragment,n),t=!0)},o:function(n){Q(e.$$.fragment,n),t=!1},d:function(n){fe(e,n)}};return Y("SvelteRegisterBlock",{block:i,id:oo.name,type:"if",source:"(2883:40) ",ctx:a}),i}function ro(a){let e,t,i,o=a[4]&&Ot(a);t=new Jt({props:{scoreData:a[4],showDetails:!1,className:"mb-6 iphone-no-margin",currentScoreData:a[16],intervalData:a[3],consistencyData:a[17],feedbackData:a[18],technicalFeedbackData:a[19],sessionStatistics:a[20]},$$inline:!0});const n={c:function(){o&&o.c(),e=$(),ge(t.$$.fragment)},l:function(c){o&&o.l(c),e=Z(c),me(t.$$.fragment,c)},m:function(c,u){o&&o.m(c,u),U(c,e,u),de(t,c,u),i=!0},p:function(c,u){c[4]?o||(o=Ot(c),o.c(),o.m(e.parentNode,e)):o&&(o.d(1),o=null);const f={};u[0]&16&&(f.scoreData=c[4]),u[0]&65536&&(f.currentScoreData=c[16]),u[0]&8&&(f.intervalData=c[3]),u[0]&131072&&(f.consistencyData=c[17]),u[0]&262144&&(f.feedbackData=c[18]),u[0]&524288&&(f.technicalFeedbackData=c[19]),u[0]&1048576&&(f.sessionStatistics=c[20]),t.$set(f)},i:function(c){i||(O(t.$$.fragment,c),i=!0)},o:function(c){Q(t.$$.fragment,c),i=!1},d:function(c){c&&h(e),o&&o.d(c),fe(t,c)}};return Y("SvelteRegisterBlock",{block:n,id:ro.name,type:"if",source:"(2868:6) {#if $unifiedScoreData && $isCompleted}",ctx:a}),n}function Ot(a){const e={c:Je,l:Je,m:Je,d:Je};return Y("SvelteRegisterBlock",{block:e,id:Ot.name,type:"if",source:"(2870:8) {#if $unifiedScoreData}",ctx:a}),e}function so(a){let e,t;e=new Ke({props:{class:"main-card bottom-action-card",$$slots:{default:[co]},$$scope:{ctx:a}},$$inline:!0});const i={c:function(){ge(e.$$.fragment)},l:function(n){me(e.$$.fragment,n)},m:function(n,s){de(e,n,s),t=!0},p:function(n,s){const c={};s[3]&4096&&(c.$$scope={dirty:s,ctx:n}),e.$set(c)},i:function(n){t||(O(e.$$.fragment,n),t=!0)},o:function(n){Q(e.$$.fragment,n),t=!1},d:function(n){fe(e,n)}};return Y("SvelteRegisterBlock",{block:i,id:so.name,type:"if",source:"(2912:61) ",ctx:a}),i}function ao(a){let e,t;e=new Ke({props:{class:"main-card bottom-action-card",$$slots:{default:[io]},$$scope:{ctx:a}},$$inline:!0});const i={c:function(){ge(e.$$.fragment)},l:function(n){me(e.$$.fragment,n)},m:function(n,s){de(e,n,s),t=!0},p:function(n,s){const c={};s[0]&32|s[3]&4096&&(c.$$scope={dirty:s,ctx:n}),e.$set(c)},i:function(n){t||(O(e.$$.fragment,n),t=!0)},o:function(n){Q(e.$$.fragment,n),t=!1},d:function(n){fe(e,n)}};return Y("SvelteRegisterBlock",{block:i,id:ao.name,type:"if",source:"(2901:6) {#if trainingPhase === 'results' && $isCompleted}",ctx:a}),i}function co(a){let e,t,i,o,n,s,c="æ¬¡ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’æº–å‚™ä¸­...";const u={c:function(){e=R("div"),t=R("div"),i=R("div"),o=R("div"),n=$(),s=R("span"),s.textContent=c,this.h()},l:function(D){e=F(D,"DIV",{class:!0});var y=z(e);t=F(y,"DIV",{class:!0});var g=z(t);i=F(g,"DIV",{class:!0});var I=z(i);o=F(I,"DIV",{class:!0}),z(o).forEach(h),n=Z(I),s=F(I,"SPAN",{"data-svelte-h":!0}),pe(s)!=="svelte-11jhwau"&&(s.textContent=c),I.forEach(h),g.forEach(h),y.forEach(h),this.h()},h:function(){A(o,"class","spinner"),k(o,M,2917,16,99666),k(s,M,2918,16,99710),A(i,"class","auto-progress-indicator"),k(i,M,2916,14,99612),A(t,"class","continuous-mode-message"),k(t,M,2915,12,99560),A(e,"class","card-content svelte-rt5px1"),k(e,M,2914,10,99521)},m:function(D,y){U(D,e,y),m(e,t),m(t,i),m(i,o),m(i,n),m(i,s)},p:Je,d:function(D){D&&h(e)}};return Y("SvelteRegisterBlock",{block:u,id:co.name,type:"slot",source:'(2914:8) <Card class=\\"main-card bottom-action-card\\">',ctx:a}),u}function io(a){let e,t,i;t=new Wt({props:{isCompleted:a[5],position:"bottom"},$$inline:!0}),t.$on("action",a[29]);const o={c:function(){e=R("div"),ge(t.$$.fragment),this.h()},l:function(s){e=F(s,"DIV",{class:!0});var c=z(e);me(t.$$.fragment,c),c.forEach(h),this.h()},h:function(){A(e,"class","card-content svelte-rt5px1"),k(e,M,2902,10,99079)},m:function(s,c){U(s,e,c),de(t,e,null),i=!0},p:function(s,c){const u={};c[0]&32&&(u.isCompleted=s[5]),t.$set(u)},i:function(s){i||(O(t.$$.fragment,s),i=!0)},o:function(s){Q(t.$$.fragment,s),i=!1},d:function(s){s&&h(e),fe(t)}};return Y("SvelteRegisterBlock",{block:o,id:io.name,type:"slot",source:'(2902:8) <Card class=\\"main-card bottom-action-card\\">',ctx:a}),o}function lo(a){let e,t,i="âš¡ é€£ç¶šãƒãƒ£ãƒ¬ãƒ³ã‚¸ãƒ¢ãƒ¼ãƒ‰",o,n,s="ä¸­ç´šè€…å‘ã‘ï¼š8ã‚»ãƒƒã‚·ãƒ§ãƒ³é€£ç¶šã§åŸºéŸ³ãŒè‡ªå‹•å†ç”Ÿã•ã‚Œã‚‹é›†ä¸­ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°",c,u,f,D,y=uo+"",g,I,E=fo+"",_,d,p,v,N=mo+"",X,B,j,x,S,ee,q=a[1]==="granted"&&!a[25]&&Pt(a);const C=[jn,zn],V=[];function G(P,T){return P[1]==="granted"?0:1}j=G(a),x=V[j]=C[j](a);const oe={c:function(){e=R("div"),t=R("h1"),t.textContent=i,o=$(),n=R("p"),n.textContent=s,c=$(),q&&q.c(),u=$(),f=R("div"),D=J("ğŸ“± "),g=J(y),I=J(" | "),_=J(E),d=R("br"),p=$(),v=R("small"),X=J(N),B=$(),x.c(),S=je(),this.h()},l:function(T){e=F(T,"DIV",{class:!0});var te=z(e);t=F(te,"H1",{class:!0,"data-svelte-h":!0}),pe(t)!=="svelte-1nub9gt"&&(t.textContent=i),o=Z(te),n=F(te,"P",{class:!0,"data-svelte-h":!0}),pe(n)!=="svelte-gneggn"&&(n.textContent=s),c=Z(te),q&&q.l(te),u=Z(te),f=F(te,"DIV",{class:!0});var K=z(f);D=W(K,"ğŸ“± "),g=W(K,y),I=W(K," | "),_=W(K,E),d=F(K,"BR",{}),p=Z(K),v=F(K,"SMALL",{style:!0});var ye=z(v);X=W(ye,N),ye.forEach(h),K.forEach(h),te.forEach(h),B=Z(T),x.l(T),S=je(),this.h()},h:function(){A(t,"class","page-title svelte-rt5px1"),k(t,M,2678,4,91413),A(n,"class","page-description svelte-rt5px1"),k(n,M,2679,4,91458),k(d,M,2713,54,92694),Xe(v,"font-size","0.6rem"),k(v,M,2714,6,92706),A(f,"class","debug-info svelte-rt5px1"),k(f,M,2712,4,92615),A(e,"class","header-section svelte-rt5px1"),k(e,M,2677,2,91380)},m:function(T,te){U(T,e,te),m(e,t),m(e,o),m(e,n),m(e,c),q&&q.m(e,null),m(e,u),m(e,f),m(f,D),m(f,g),m(f,I),m(f,_),m(f,d),m(f,p),m(f,v),m(v,X),U(T,B,te),V[j].m(T,te),U(T,S,te),ee=!0},p:function(T,te){T[1]==="granted"&&!T[25]?q?(q.p(T,te),te[0]&33554434&&O(q,1)):(q=Pt(T),q.c(),O(q,1),q.m(e,u)):q&&(Ie(),Q(q,1,1,()=>{q=null}),Te());let K=j;j=G(T),j===K?V[j].p(T,te):(Ie(),Q(V[K],1,1,()=>{V[K]=null}),Te(),x=V[j],x?x.p(T,te):(x=V[j]=C[j](T),x.c()),O(x,1),x.m(S.parentNode,S))},i:function(T){ee||(O(q),O(x),ee=!0)},o:function(T){Q(q),Q(x),ee=!1},d:function(T){T&&(h(e),h(B),h(S)),q&&q.d(),V[j].d(T)}};return Y("SvelteRegisterBlock",{block:oe,id:lo.name,type:"slot",source:"(2676:0) <PageLayout>",ctx:a}),oe}function Ut(a){let e,t,i;t=new Bn({props:{$$slots:{default:[lo]},$$scope:{ctx:a}},$$inline:!0});const o={c:function(){e=$(),ge(t.$$.fragment),this.h()},l:function(s){ko("svelte-13kpo59",Mn.head).forEach(h),e=Z(s),me(t.$$.fragment,s),this.h()},h:function(){Mn.title="é€£ç¶šãƒãƒ£ãƒ¬ãƒ³ã‚¸ãƒ¢ãƒ¼ãƒ‰ - ç›¸å¯¾éŸ³æ„Ÿãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°"},m:function(s,c){U(s,e,c),de(t,s,c),i=!0},p:function(s,c){const u={};c[0]&67108863|c[3]&4096&&(u.$$scope={dirty:c,ctx:s}),t.$set(u)},i:function(s){i||(O(t.$$.fragment,s),i=!0)},o:function(s){Q(t.$$.fragment,s),i=!1},d:function(s){s&&h(e),fe(t,s)}};return Y("SvelteRegisterBlock",{block:o,id:Ut.name,type:"component",source:"",ctx:a}),o}const uo="v2.3.1-ANIMATED",fo="07/29 04:15",mo="ğŸ¬ è©•ä¾¡åˆ†å¸ƒã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè£…ãƒ»UXå‘ä¸Š";function In(){const a=/iPhone/.test(navigator.userAgent),e=/iPad/.test(navigator.userAgent),t=/Macintosh/.test(navigator.userAgent)&&"ontouchend"in document;return a||e||t?(console.log("ğŸ”Š [RandomTraining] iOS/iPadOSæ¤œå‡º - éŸ³é‡35dBè¨­å®š"),35):(console.log("ğŸ”Š [RandomTraining] PCæ¤œå‡º - éŸ³é‡-6dBè¨­å®š"),-6)}function Yo(){return{mode:"continuous",timestamp:new Date,duration:480,totalNotes:64,measuredNotes:59,averageAccuracy:79,baseNote:"C5",baseFrequency:523.25,sessionHistory:[{grade:"excellent",accuracy:92,baseNote:"C4",baseFrequency:261.63,timestamp:new Date(Date.now()-7*6e4),measuredNotes:8,noteResults:[{name:"ãƒ‰",note:"ãƒ‰",frequency:262,detectedFrequency:264,cents:13,grade:"excellent"},{name:"ãƒ¬",note:"ãƒ¬",frequency:294,detectedFrequency:291,cents:-18,grade:"good"},{name:"ãƒŸ",note:"ãƒŸ",frequency:330,detectedFrequency:335,cents:26,grade:"pass"},{name:"ãƒ•ã‚¡",note:"ãƒ•ã‚¡",frequency:349,detectedFrequency:346,cents:-15,grade:"excellent"},{name:"ã‚½",note:"ã‚½",frequency:392,detectedFrequency:388,cents:-18,grade:"good"},{name:"ãƒ©",note:"ãƒ©",frequency:440,detectedFrequency:444,cents:16,grade:"good"},{name:"ã‚·",note:"ã‚·",frequency:494,detectedFrequency:499,cents:17,grade:"good"},{name:"ãƒ‰ï¼ˆé«˜ï¼‰",note:"ãƒ‰ï¼ˆé«˜ï¼‰",frequency:523,detectedFrequency:520,cents:-10,grade:"excellent"}]},{grade:"good",accuracy:78,baseNote:"D4",baseFrequency:293.66,timestamp:new Date(Date.now()-6*6e4),measuredNotes:7,noteResults:[{name:"ãƒ‰",note:"ãƒ‰",frequency:294,detectedFrequency:290,cents:-23,grade:"good"},{name:"ãƒ¬",note:"ãƒ¬",frequency:330,detectedFrequency:340,cents:53,grade:"needWork"},{name:"ãƒŸ",note:"ãƒŸ",frequency:370,detectedFrequency:375,cents:23,grade:"good"},{name:"ãƒ•ã‚¡",note:"ãƒ•ã‚¡",frequency:392,detectedFrequency:385,cents:-31,grade:"pass"},{name:"ã‚½",note:"ã‚½",frequency:440,detectedFrequency:432,cents:-31,grade:"pass"},{name:"ãƒ©",note:"ãƒ©",frequency:494,detectedFrequency:510,cents:56,grade:"needWork"},{name:"ã‚·",note:"ã‚·",frequency:554,detectedFrequency:null,cents:null,grade:"notMeasured"},{name:"ãƒ‰ï¼ˆé«˜ï¼‰",note:"ãƒ‰ï¼ˆé«˜ï¼‰",frequency:587,detectedFrequency:580,cents:-21,grade:"good"}]},{grade:"excellent",accuracy:95,baseNote:"E4",baseFrequency:329.63,timestamp:new Date(Date.now()-5*6e4),measuredNotes:8,noteResults:[{name:"ãƒ‰",note:"ãƒ‰",frequency:330,detectedFrequency:332,cents:10,grade:"excellent"},{name:"ãƒ¬",note:"ãƒ¬",frequency:370,detectedFrequency:368,cents:-9,grade:"excellent"},{name:"ãƒŸ",note:"ãƒŸ",frequency:415,detectedFrequency:418,cents:12,grade:"excellent"},{name:"ãƒ•ã‚¡",note:"ãƒ•ã‚¡",frequency:440,detectedFrequency:436,cents:-16,grade:"good"},{name:"ã‚½",note:"ã‚½",frequency:494,detectedFrequency:497,cents:11,grade:"excellent"},{name:"ãƒ©",note:"ãƒ©",frequency:554,detectedFrequency:551,cents:-9,grade:"excellent"},{name:"ã‚·",note:"ã‚·",frequency:622,detectedFrequency:625,cents:8,grade:"excellent"},{name:"ãƒ‰ï¼ˆé«˜ï¼‰",note:"ãƒ‰ï¼ˆé«˜ï¼‰",frequency:659,detectedFrequency:655,cents:-10,grade:"excellent"}]},{grade:"needWork",accuracy:45,baseNote:"F4",baseFrequency:349.23,timestamp:new Date(Date.now()-4*6e4),measuredNotes:6,noteResults:[{name:"ãƒ‰",note:"ãƒ‰",frequency:349,detectedFrequency:345,cents:-20,grade:"good"},{name:"ãƒ¬",note:"ãƒ¬",frequency:392,detectedFrequency:420,cents:124,grade:"needWork"},{name:"ãƒŸ",note:"ãƒŸ",frequency:440,detectedFrequency:435,cents:-20,grade:"good"},{name:"ãƒ•ã‚¡",note:"ãƒ•ã‚¡",frequency:466,detectedFrequency:520,cents:195,grade:"needWork"},{name:"ã‚½",note:"ã‚½",frequency:523,detectedFrequency:410,cents:-455,grade:"needWork"},{name:"ãƒ©",note:"ãƒ©",frequency:587,detectedFrequency:null,cents:null,grade:"notMeasured"},{name:"ã‚·",note:"ã‚·",frequency:659,detectedFrequency:650,cents:-24,grade:"good"},{name:"ãƒ‰ï¼ˆé«˜ï¼‰",note:"ãƒ‰ï¼ˆé«˜ï¼‰",frequency:698,detectedFrequency:null,cents:null,grade:"notMeasured"}]},{grade:"good",accuracy:85,baseNote:"G4",baseFrequency:392,timestamp:new Date(Date.now()-3*6e4),measuredNotes:8,noteResults:[{name:"ãƒ‰",note:"ãƒ‰",frequency:392,detectedFrequency:395,cents:13,grade:"excellent"},{name:"ãƒ¬",note:"ãƒ¬",frequency:440,detectedFrequency:438,cents:-8,grade:"excellent"},{name:"ãƒŸ",note:"ãƒŸ",frequency:494,detectedFrequency:500,cents:21,grade:"good"},{name:"ãƒ•ã‚¡",note:"ãƒ•ã‚¡",frequency:523,detectedFrequency:520,cents:-10,grade:"excellent"},{name:"ã‚½",note:"ã‚½",frequency:587,detectedFrequency:595,cents:24,grade:"good"},{name:"ãƒ©",note:"ãƒ©",frequency:659,detectedFrequency:665,cents:16,grade:"good"},{name:"ã‚·",note:"ã‚·",frequency:740,detectedFrequency:755,cents:35,grade:"pass"},{name:"ãƒ‰ï¼ˆé«˜ï¼‰",note:"ãƒ‰ï¼ˆé«˜ï¼‰",frequency:784,detectedFrequency:780,cents:-9,grade:"excellent"}]},{grade:"excellent",accuracy:94,baseNote:"A4",baseFrequency:440,timestamp:new Date(Date.now()-2*6e4),measuredNotes:8,noteResults:[{name:"ãƒ‰",note:"ãƒ‰",frequency:440,detectedFrequency:442,cents:8,grade:"excellent"},{name:"ãƒ¬",note:"ãƒ¬",frequency:494,detectedFrequency:492,cents:-7,grade:"excellent"},{name:"ãƒŸ",note:"ãƒŸ",frequency:554,detectedFrequency:558,cents:12,grade:"excellent"},{name:"ãƒ•ã‚¡",note:"ãƒ•ã‚¡",frequency:587,detectedFrequency:585,cents:-6,grade:"excellent"},{name:"ã‚½",note:"ã‚½",frequency:659,detectedFrequency:665,cents:16,grade:"good"},{name:"ãƒ©",note:"ãƒ©",frequency:740,detectedFrequency:738,cents:-5,grade:"excellent"},{name:"ã‚·",note:"ã‚·",frequency:831,detectedFrequency:840,cents:19,grade:"good"},{name:"ãƒ‰ï¼ˆé«˜ï¼‰",note:"ãƒ‰ï¼ˆé«˜ï¼‰",frequency:880,detectedFrequency:882,cents:4,grade:"excellent"}]},{grade:"pass",accuracy:68,baseNote:"Bb4",baseFrequency:466.16,timestamp:new Date(Date.now()-1*6e4),measuredNotes:7,noteResults:[{name:"ãƒ‰",note:"ãƒ‰",frequency:466,detectedFrequency:470,cents:15,grade:"excellent"},{name:"ãƒ¬",note:"ãƒ¬",frequency:523,detectedFrequency:535,cents:39,grade:"pass"},{name:"ãƒŸ",note:"ãƒŸ",frequency:587,detectedFrequency:600,cents:38,grade:"pass"},{name:"ãƒ•ã‚¡",note:"ãƒ•ã‚¡",frequency:622,detectedFrequency:615,cents:-19,grade:"good"},{name:"ã‚½",note:"ã‚½",frequency:698,detectedFrequency:720,cents:54,grade:"needWork"},{name:"ãƒ©",note:"ãƒ©",frequency:784,detectedFrequency:null,cents:null,grade:"notMeasured"},{name:"ã‚·",note:"ã‚·",frequency:880,detectedFrequency:895,cents:29,grade:"pass"},{name:"ãƒ‰ï¼ˆé«˜ï¼‰",note:"ãƒ‰ï¼ˆé«˜ï¼‰",frequency:932,detectedFrequency:925,cents:-13,grade:"excellent"}]},{grade:"good",accuracy:82,baseNote:"C5",baseFrequency:523.25,timestamp:new Date,measuredNotes:8,noteResults:[{name:"ãƒ‰",note:"ãƒ‰",frequency:523,detectedFrequency:526,cents:10,grade:"excellent"},{name:"ãƒ¬",note:"ãƒ¬",frequency:587,detectedFrequency:584,cents:-9,grade:"excellent"},{name:"ãƒŸ",note:"ãƒŸ",frequency:659,detectedFrequency:665,cents:16,grade:"good"},{name:"ãƒ•ã‚¡",note:"ãƒ•ã‚¡",frequency:698,detectedFrequency:692,cents:-15,grade:"excellent"},{name:"ã‚½",note:"ã‚½",frequency:784,detectedFrequency:795,cents:24,grade:"good"},{name:"ãƒ©",note:"ãƒ©",frequency:880,detectedFrequency:890,cents:19,grade:"good"},{name:"ã‚·",note:"ã‚·",frequency:988,detectedFrequency:1010,cents:38,grade:"pass"},{name:"ãƒ‰ï¼ˆé«˜ï¼‰",note:"ãƒ‰ï¼ˆé«˜ï¼‰",frequency:1047,detectedFrequency:1042,cents:-8,grade:"excellent"}]}]}}function Tt(a){return[{scale:"ãƒ‰",interval:"unison",intervalName:"ãƒ¦ãƒ‹ã‚¾ãƒ³"},{scale:"ãƒ¬",interval:"major_second",intervalName:"é•·2åº¦"},{scale:"ãƒŸ",interval:"major_third",intervalName:"é•·3åº¦"},{scale:"ãƒ•ã‚¡",interval:"perfect_fourth",intervalName:"å®Œå…¨4åº¦"},{scale:"ã‚½",interval:"perfect_fifth",intervalName:"å®Œå…¨5åº¦"},{scale:"ãƒ©",interval:"major_sixth",intervalName:"é•·6åº¦"},{scale:"ã‚·",interval:"major_seventh",intervalName:"é•·7åº¦"},{scale:"ãƒ‰ï¼ˆé«˜ï¼‰",interval:"octave",intervalName:"ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–"}].map((t,i)=>{const o=a.find(n=>n.targetNote&&n.targetNote.includes(t.scale))||a[i];if(o&&o.accuracy!=="notMeasured"){const n=parseFloat(o.accuracy)||0,s=Math.round((100-n)*.5);return{type:t.interval,scale:t.scale,intervalName:t.intervalName,attempts:1,averageError:s,accuracy:n}}else return{type:t.interval,scale:t.scale,intervalName:t.intervalName,attempts:0,averageError:null,accuracy:0}})}function Tn(a){if(!a||!Array.isArray(a))return console.warn("âš ï¸ [RandomTraining] sessionHistory ãŒç„¡åŠ¹ã§ã™"),[];const e=[{type:"unison",scale:"ãƒ‰",intervalName:"ãƒ¦ãƒ‹ã‚¾ãƒ³",noteIndex:0},{type:"major_second",scale:"ãƒ¬",intervalName:"é•·2åº¦",noteIndex:1},{type:"major_third",scale:"ãƒŸ",intervalName:"é•·3åº¦",noteIndex:2},{type:"perfect_fourth",scale:"ãƒ•ã‚¡",intervalName:"å®Œå…¨4åº¦",noteIndex:3},{type:"perfect_fifth",scale:"ã‚½",intervalName:"å®Œå…¨5åº¦",noteIndex:4},{type:"major_sixth",scale:"ãƒ©",intervalName:"é•·6åº¦",noteIndex:5},{type:"major_seventh",scale:"ã‚·",intervalName:"é•·7åº¦",noteIndex:6},{type:"octave",scale:"ãƒ‰ï¼ˆé«˜ï¼‰",intervalName:"ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–",noteIndex:7}],t={};return e.forEach(i=>{t[i.type]={type:i.type,scale:i.scale,intervalName:i.intervalName,attempts:0,successCount:0,accuracySum:0,accuracyValues:[],errorValues:[]}}),a.forEach(i=>{!i.noteResults||!Array.isArray(i.noteResults)||i.noteResults.forEach((o,n)=>{if(n>=e.length)return;const s=e[n].type,c=t[s];if(c.attempts++,o.accuracy!=="notMeasured"&&typeof o.accuracy=="number"){c.accuracyValues.push(o.accuracy),c.accuracySum+=o.accuracy;const u=Math.round((100-o.accuracy)*.5);c.errorValues.push(u),o.accuracy>=70&&c.successCount++}})}),e.map(i=>{const o=t[i.type];if(o.attempts===0)return{type:i.type,scale:i.scale,intervalName:i.intervalName,attempts:0,averageError:null,accuracy:0};const n=o.accuracyValues.length>0?Math.round(o.accuracySum/o.accuracyValues.length):0,s=o.errorValues.length>0?Math.round(o.errorValues.reduce((u,f)=>u+f,0)/o.errorValues.length):null,c=o.accuracyValues.length>0?Math.round(o.successCount/o.accuracyValues.length*100):0;return{type:i.type,scale:i.scale,intervalName:i.intervalName,mastery:c,attempts:o.attempts,averageError:s,accuracy:n}})}function En(a){const e=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];if(a<=0)return"ãƒ¼ãƒ¼";const i=Math.round(12*Math.log2(a/440)),o=(i+9+120)%12,n=Math.floor((i+9)/12)+4;return e[o]+n}function Et(a,e){const t=[{factor:4,freq:a*4,description:"2ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–ä¸Š"},{factor:3,freq:a*3,description:"1.5ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–ä¸Š"},{factor:2.5,freq:a*2.5,description:"1.3ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–ä¸Š"},{factor:2,freq:a*2,description:"1ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–ä¸Š"},{factor:1.5,freq:a*1.5,description:"0.5ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–ä¸Š"},{factor:1,freq:a,description:"è£œæ­£ãªã—"},{factor:.75,freq:a*.75,description:"0.33ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–ä¸‹"},{factor:.67,freq:a*.67,description:"0.5ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–ä¸‹"},{factor:.5,freq:a*.5,description:"1ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–ä¸‹"},{factor:.4,freq:a*.4,description:"1.3ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–ä¸‹"},{factor:.33,freq:a*.33,description:"1.5ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–ä¸‹"},{factor:.25,freq:a*.25,description:"2ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–ä¸‹"}];let i=null,o=1/0;const n=e*.5,s=e*1.5,c=t.filter(u=>u.freq>=n&&u.freq<=s);for(const u of c){const f=Math.abs(u.freq-e);f<o&&(o=f,i=u)}if(!i)for(const u of t){const f=Math.abs(u.freq-e);f<o&&(o=f,i=u)}return i?{correctedFrequency:i.freq,factor:i.factor,description:i.description,error:o}:{correctedFrequency:a,factor:1,description:"è£œæ­£ãªã—ï¼ˆãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼‰",error:Math.abs(a-e)}}function st(){try{"scrollTo"in window&&"behavior"in document.documentElement.style?window.scrollTo({top:0,behavior:"smooth"}):window.scrollTo(0,0),document.body&&(document.body.scrollTop=0),document.documentElement&&(document.documentElement.scrollTop=0),document.querySelectorAll("[data-scroll-container], .scroll-container, main").forEach(e=>{e.scrollTo?e.scrollTo(0,0):e.scrollTop=0})}catch(a){console.warn("ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã‚¨ãƒ©ãƒ¼:",a);try{window.scroll(0,0)}catch(e){console.error("ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«å®Œå…¨å¤±æ•—:",e)}}}function go(a){}function Zo(a,e,t){let i,o,n,s,c,u,f,D,y,g,I,E;Ne(Nt,"currentSessionId"),Ae(a,Nt,r=>t(23,n=r)),Ne(Rt,"nextBaseName"),Ae(a,Rt,r=>t(54,s=r)),Ne(Mt,"nextBaseNote"),Ae(a,Mt,r=>t(55,c=r)),Ne(Dt,"unifiedScoreData"),Ae(a,Dt,r=>t(4,u=r)),Ne(kt,"isCompleted"),Ae(a,kt,r=>t(5,f=r)),Ne(bt,"page"),Ae(a,bt,r=>t(56,D=r)),Ne(Ct,"remainingSessions"),Ae(a,Ct,r=>t(57,y=r)),Ne(wt,"sessionHistory"),Ae(a,wt,r=>t(24,g=r)),Ne(At,"trainingProgress"),Ae(a,At,r=>t(58,I=r)),Ne(Ft,"isLoading"),Ae(a,Ft,r=>t(25,E=r));let{$$slots:_={},$$scope:d}=e;wo("Page",_,[]);function p(r){return rt.evaluateOverall(r)}let v="setup",N=typeof window<"u"?new URLSearchParams(window.location.search).get("from")==="microphone-test"?(ie.info("[RandomTraining] ãƒã‚¤ã‚¯ãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸ã‹ã‚‰ã®é·ç§»ã‚’æ¤œå‡º"),"granted"):(ie.info("[RandomTraining] ãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã‚¢ã‚¯ã‚»ã‚¹ã‚’æ¤œå‡º"),"checking"):"checking",X=!0,B=[];const j=["ãƒ‰","ãƒ¬","ãƒŸ","ãƒ•ã‚¡","ã‚½","ãƒ©","ã‚·","ãƒ‰ï¼ˆé«˜ï¼‰"];let x="",S=0,ee=!1,q=0,C=j.map(r=>({name:r,state:"inactive",completed:!1})),V=null,G=!1,oe=0,P=!1,T=null,te=!1,K=[],ye=[],Se=0,Ee=0,Ge="ãƒ¼ãƒ¼",Ve=0,He={correctCount:0,totalCount:8,averageAccuracy:0,averageTime:0,isCompleted:!1},Ce=null,ze={totalScore:0,grade:"C",componentScores:{pitchAccuracy:0,recognitionSpeed:0,intervalMastery:0,directionAccuracy:0,consistency:0}},we=[],Pe=[],Le={},Ye={},Fe={totalAttempts:0,successRate:0,averageScore:0,bestScore:0,sessionDuration:0,streakCount:0,fatigueLevel:"fresh",mostDifficultInterval:"-",mostSuccessfulInterval:"-",averageResponseTime:0,sessionStart:Date.now()},dt="intervals",ae=[],ue=null,he=null,Re=!0,ne=null,Be=null,at=null,ct=null,Qe=null;const Oe=[{note:"C4",name:"ãƒ‰ï¼ˆä¸­ï¼‰",frequency:261.63,semitonesFromC:0},{note:"Db4",name:"ãƒ‰#ï¼ˆä¸­ï¼‰",frequency:277.18,semitonesFromC:1},{note:"D4",name:"ãƒ¬ï¼ˆä¸­ï¼‰",frequency:293.66,semitonesFromC:2},{note:"Eb4",name:"ãƒ¬#ï¼ˆä¸­ï¼‰",frequency:311.13,semitonesFromC:3},{note:"E4",name:"ãƒŸï¼ˆä¸­ï¼‰",frequency:329.63,semitonesFromC:4},{note:"F4",name:"ãƒ•ã‚¡ï¼ˆä¸­ï¼‰",frequency:349.23,semitonesFromC:5},{note:"Gb4",name:"ãƒ•ã‚¡#ï¼ˆä¸­ï¼‰",frequency:369.99,semitonesFromC:6},{note:"G4",name:"ã‚½ï¼ˆä¸­ï¼‰",frequency:392,semitonesFromC:7},{note:"Ab4",name:"ãƒ©bï¼ˆä¸­ï¼‰",frequency:415.3,semitonesFromC:8},{note:"A4",name:"ãƒ©ï¼ˆä¸­ï¼‰",frequency:440,semitonesFromC:9},{note:"Bb3",name:"ã‚·bï¼ˆä½ï¼‰",frequency:233.08,semitonesFromC:-2},{note:"B3",name:"ã‚·ï¼ˆä½ï¼‰",frequency:246.94,semitonesFromC:-1},{note:"C5",name:"ãƒ‰ï¼ˆé«˜ï¼‰",frequency:523.25,semitonesFromC:12},{note:"D5",name:"ãƒ¬ï¼ˆé«˜ï¼‰",frequency:587.33,semitonesFromC:14},{note:"F3",name:"ãƒ•ã‚¡ï¼ˆä½ï¼‰",frequency:174.61,semitonesFromC:-7},{note:"G3",name:"ã‚½ï¼ˆä½ï¼‰",frequency:196,semitonesFromC:-5}];async function Ue(){var r;t(1,N="checking");try{if(console.log("ğŸ¤ [RandomTraining] AudioManagerçµŒç”±ã§ãƒã‚¤ã‚¯è¨±å¯ç¢ºèªé–‹å§‹"),!((r=navigator.mediaDevices)!=null&&r.getUserMedia)){t(1,N="error");return}const l=await We.initialize();at=l.audioContext,Be=l.mediaStream,ct=l.sourceNode,console.log("âœ… [RandomTraining] AudioManager ãƒªã‚½ãƒ¼ã‚¹å–å¾—å®Œäº†"),t(1,N="granted"),t(0,v="setup"),setTimeout(async()=>{if(ne){ie.audio("[RandomTraining] PitchDetectoråˆæœŸåŒ–é–‹å§‹");const b=/iPhone/.test(navigator.userAgent),w=/iPad/.test(navigator.userAgent),H=/Macintosh/.test(navigator.userAgent)&&"ontouchend"in document;(w||H)&&(console.log("ğŸ”§ [RandomTraining] iPadæ¤œå‡º - ãƒã‚¤ã‚¯æ„Ÿåº¦7.0xè‡ªå‹•è¨­å®šé–‹å§‹"),We.setSensitivity(7),console.log("âœ… [RandomTraining] iPad ãƒã‚¤ã‚¯æ„Ÿåº¦7.0xè‡ªå‹•è¨­å®šå®Œäº†"));try{console.log("ğŸ¤ [RandomTraining] AudioManagerå†åˆæœŸåŒ–é–‹å§‹ï¼ˆiPadå¯¾å¿œï¼‰"),await We.initialize(),console.log("âœ… [RandomTraining] AudioManagerå†åˆæœŸåŒ–å®Œäº†")}catch(L){console.warn("âš ï¸ AudioManagerå†åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼:",L)}await ne.initialize(),ie.audio("[RandomTraining] PitchDetectoråˆæœŸåŒ–å®Œäº†")}},200)}catch(l){ie.error("[RandomTraining] ãƒã‚¤ã‚¯è¨±å¯ã‚¨ãƒ©ãƒ¼:",l),t(1,N=(l==null?void 0:l.name)==="NotAllowedError"?"denied":"error")}}function mt(){const r=c,l=s,b=Oe.find(w=>w.note===r)||Oe.find(w=>w.name===l)||Oe[0];if(t(7,x=b.name),t(8,S=b.frequency),ie.info(`[BaseNote] åŸºéŸ³è¨­å®šï¼ˆlocalStorageé€£æºï¼‰: ${x} = ${S}Hz`),ie.info(`[BaseNote] localStorageåŸºéŸ³æƒ…å ±: note=${r}, name=${l}`),!S||S<=0)throw ie.error("[BaseNote] åŸºéŸ³å‘¨æ³¢æ•°è¨­å®šã‚¨ãƒ©ãƒ¼:",b),new Error(`Invalid base frequency: ${S}`)}async function Kt(){if(ee||!he||Re)return;if(N!=="granted"){console.log("ğŸ¤ [RandomTraining] ãƒã‚¤ã‚¯è¨±å¯ãŒå¿…è¦ã§ã™ã€‚è¨±å¯å–å¾—ã‚’é–‹å§‹...");try{await Ue(),console.log("ğŸ¤ [RandomTraining] ãƒã‚¤ã‚¯è¨±å¯å–å¾—å®Œäº†")}catch(l){console.error("âŒ ãƒã‚¤ã‚¯è¨±å¯ã‚¨ãƒ©ãƒ¼:",l);return}}if(!Be&&N==="granted"){console.log("ğŸ¤ [RandomTraining] AudioManagerãƒªã‚½ãƒ¼ã‚¹æœªåˆæœŸåŒ–ã®ãŸã‚å–å¾—ã—ã¾ã™");try{await Ue()}catch(l){console.error("âŒ AudioManagerãƒªã‚½ãƒ¼ã‚¹åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼:",l);return}}else Be&&console.log("ğŸ¤ [RandomTraining] AudioManagerãƒªã‚½ãƒ¼ã‚¹æ—¢å­˜ã®ãŸã‚å†åˆ©ç”¨");t(9,ee=!0),t(0,v="listening"),Qe=Date.now(),mt();const r=Oe.find(l=>l.name===x).note;he.triggerAttackRelease(r,2,It(),.7),setTimeout(()=>{t(9,ee=!1),t(0,v="waiting"),setTimeout(()=>yt(),500)},2e3)}async function Qt(){if(ee||!he||E||!x)return;if(N!=="granted"){console.log("ğŸ¤ [RandomTraining] ãƒã‚¤ã‚¯è¨±å¯ãŒå¿…è¦ã§ã™ã€‚è¨±å¯å–å¾—ã‚’é–‹å§‹...");try{await Ue(),console.log("ğŸ¤ [RandomTraining] ãƒã‚¤ã‚¯è¨±å¯å–å¾—å®Œäº†")}catch(l){console.error("âŒ ãƒã‚¤ã‚¯è¨±å¯ã‚¨ãƒ©ãƒ¼:",l);return}}if(!Be&&N==="granted"){console.log("ğŸ¤ [RandomTraining] AudioManagerãƒªã‚½ãƒ¼ã‚¹æœªåˆæœŸåŒ–ã®ãŸã‚å–å¾—ã—ã¾ã™");try{await Ue()}catch(l){console.error("âŒ AudioManagerãƒªã‚½ãƒ¼ã‚¹åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼:",l);return}}else Be&&console.log("ğŸ¤ [RandomTraining] AudioManagerãƒªã‚½ãƒ¼ã‚¹æ—¢å­˜ã®ãŸã‚å†åˆ©ç”¨");if(t(9,ee=!0),t(0,v="listening"),Qe=Date.now(),typeof window<"u"&&window.Tone){const l=window.Tone.context||window.Tone.getContext();l&&l.state==="suspended"&&(console.log("ğŸ”„ [RandomTraining] AudioContext suspendedæ¤œå‡º - å†é–‹ä¸­..."),await l.resume(),console.log("âœ… [RandomTraining] AudioContextå†é–‹å®Œäº†"))}const r=Oe.find(l=>l.name===x).note;he.triggerAttackRelease(r,2,It(),.7),setTimeout(()=>{t(9,ee=!1),t(0,v="waiting"),setTimeout(()=>yt(),500)},2e3)}async function yo(){if(ee||!he||E||!x){console.log("ğŸ”„ [BaseNoteOnly] å†ç”Ÿæ¡ä»¶æœªæº€: isPlaying:",ee,"sampler:",!!he,"isLoading:",E,"currentBaseNote:",x);return}if(console.log("ğŸµ [BaseNoteOnly] åŸºéŸ³ã®ã¿å†ç”Ÿé–‹å§‹:",x),typeof window<"u"&&window.Tone){const l=window.Tone.context||window.Tone.getContext();l&&l.state==="suspended"&&(console.log("ğŸ”„ [BaseNoteOnly] AudioContext suspendedæ¤œå‡º - å†é–‹ä¸­..."),await l.resume(),console.log("âœ… [BaseNoteOnly] AudioContextå†é–‹å®Œäº†"))}const r=Oe.find(l=>l.name===x).note;he.triggerAttackRelease(r,1.5,It(),.7),console.log("ğŸµ [BaseNoteOnly] åŸºéŸ³å†ç”Ÿå®Œäº†:",r)}function gt(){x&&S>0?Qt():Kt(),Xt()}function Xt(){T&&clearInterval(T),t(11,oe=0),P=!0,t(12,te=!1),console.log("ğŸµ [GuideStartBar] ã‚¬ã‚¤ãƒ‰ã‚¹ã‚¿ãƒ¼ãƒˆãƒãƒ¼é–‹å§‹"),T=setInterval(()=>{t(11,oe+=2.5),oe>=100&&(t(11,oe=100),t(12,te=!0),console.log("ğŸµ [GuideStartBar] ã‚¬ã‚¤ãƒ‰é–‹å§‹ã‚¿ã‚¤ãƒŸãƒ³ã‚°ï¼"),setTimeout(()=>{P=!1,t(12,te=!1),t(11,oe=0)},800),clearInterval(T),T=null)},50)}function ho(){T&&(clearInterval(T),T=null),P=!1,t(12,te=!1),t(11,oe=0)}function Ze(r,l){const w=[0,2,4,5,7,9,11,12][l],H=r*Math.pow(2,w/12);return ie.debug(`[calculateExpectedFrequency] ${C[l].name}: åŸºéŸ³${r.toFixed(1)}Hz + ${w}åŠéŸ³ = ${H.toFixed(1)}Hz`),H}function Yt(r,l){return Ze(r,l)}function yt(){t(0,v="guiding"),q=0,G=!0,K=[],console.log(`ğŸ¬ ã‚¬ã‚¤ãƒ‰é–‹å§‹: ${x} (${S.toFixed(1)}Hz)`);function r(){if(q<C.length){q>0&&t(10,C[q-1].state="inactive",C),t(10,C[q].state="active",C);const l=Yt(S,q);qt.setScaleContext({baseFrequency:S,currentScale:C[q].name,targetFrequency:l}),console.log(`ğŸµ [Scale] åŸºéŸ³:${x}(${S.toFixed(0)}Hz) ç¾åœ¨:${C[q].name} ç›®æ¨™:${l.toFixed(0)}Hz`),q>=4&&console.log(`ğŸ” [ãƒ‡ãƒãƒƒã‚°] Step ${q}: currentBaseFrequency=${S}, currentBaseNote='${x}'`),q++,V=setTimeout(()=>{r()},600)}else Zt()}r()}function Zt(){G=!1,console.log(`ğŸ ã‚¬ã‚¤ãƒ‰å®Œäº†: ${K.length}/${C.length}ã‚¹ãƒ†ãƒƒãƒ—è©•ä¾¡`),C.length>0&&t(10,C[C.length-1].state="inactive",C),ne&&ne.stopDetection(),qt.clearContext(),$t(),rn(),gn(),ae=j.map(r=>{const l=K.find(b=>b.stepName===r);return l?{name:l.stepName,cents:l.adjustedFrequency?Math.round(l.centDifference):null,targetFreq:l.expectedFrequency,detectedFreq:l.adjustedFrequency||null,diff:l.adjustedFrequency?l.adjustedFrequency-l.expectedFrequency:null,accuracy:l.accuracy}:{name:r,cents:null,targetFreq:null,detectedFreq:null,diff:null,accuracy:"notMeasured"}}),an(),ln(),t(0,v="results")}function $t(){let r=0,l=0;K.forEach((H,L)=>{H.isCorrect&&r++,l+=H.accuracy});const b=K.length>0?Math.round(l/K.length):0,w=Math.round(r/C.length*100);He={correctCount:r,totalCount:C.length,averageAccuracy:b,averageTime:0,isCompleted:!0},console.log(`ğŸ¯ çµæœ: ${r}/${C.length}æ­£è§£ (${w}%) å¹³å‡ç²¾åº¦${b}%`),K.length>0&&(ye=[...K])}function po(){switch(v){case"setup":return Re||!he?"ğŸµ éŸ³æºèª­ã¿è¾¼ã¿ä¸­...":"ğŸ¤ ãƒã‚¤ã‚¯æº–å‚™å®Œäº† - ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°é–‹å§‹å¯èƒ½";case"listening":return"ğŸµ åŸºéŸ³å†ç”Ÿä¸­...";case"waiting":return"â³ é–“ã‚‚ãªãé–‹å§‹...";case"guiding":return"ğŸ™ï¸ ã‚¬ã‚¤ãƒ‰ã«åˆã‚ã›ã¦ãƒ‰ãƒ¬ãƒŸãƒ•ã‚¡ã‚½ãƒ©ã‚·ãƒ‰ã‚’æ­Œã£ã¦ãã ã•ã„";case"results":return"ğŸ‰ æ¡ç‚¹çµæœ";default:return"ğŸ”„ æº–å‚™ä¸­..."}}function vo(){return K.length>0?K:ye.length>0?ye:[]}function en(){St(`${_t}/microphone-test`)}function $e(){St(`${_t}/`)}async function tn(){try{t(34,Re=!0),t(33,he=new Wo({urls:{C4:"C4.mp3"},baseUrl:"https://tonejs.github.io/audio/salamander/",release:1.5,volume:In(),onload:()=>{t(34,Re=!1)},onerror:H=>{console.error("âŒ Salamander PianoéŸ³æºèª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:",H),t(34,Re=!1)}}).toDestination());const r=/iPhone/.test(navigator.userAgent),l=/iPad/.test(navigator.userAgent),b=/Macintosh/.test(navigator.userAgent)&&"ontouchend"in document,w=r||l||b;console.log(l?"ğŸ” [RandomTraining] iPadæ¤œå‡º:":b?"ğŸ” [RandomTraining] iPadOSæ¤œå‡º:":r?"ğŸ” [RandomTraining] iPhoneæ¤œå‡º:":"ğŸ” [RandomTraining] ãã®ä»–ãƒ‡ãƒã‚¤ã‚¹æ¤œå‡º:",navigator.userAgent),console.log("ğŸ”Š [RandomTraining] éŸ³é‡è¨­å®šç¶­æŒ: 35dB")}catch(r){console.error("ã‚µãƒ³ãƒ—ãƒ©ãƒ¼åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼:",r),t(34,Re=!1)}}async function it(){try{(await navigator.permissions.query({name:"microphone"})).state==="granted"?await Ue():t(1,N="denied")}catch{t(1,N="denied")}}function nn(){try{Ce=new Rn,ie.info("[RandomTraining] æ¡ç‚¹ã‚¨ãƒ³ã‚¸ãƒ³åˆæœŸåŒ–å®Œäº†")}catch(r){ie.error("[RandomTraining] æ¡ç‚¹ã‚¨ãƒ³ã‚¸ãƒ³åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼:",r)}}function on(r,l){if(!Ce||!G)return;const b=q-1;if(b<0||b>=C.length)return;const w=Ze(S,b),H={baseFrequency:S,targetFrequency:w,detectedFrequency:r,detectedNote:l,volume:Se,timestamp:Date.now(),scaleIndex:b,scaleName:C[b].name};try{Ce.processAttempt(H)}catch(L){ie.error("[RandomTraining] æ¡ç‚¹ã‚¨ãƒ³ã‚¸ãƒ³ã‚¨ãƒ©ãƒ¼:",L)}}function rn(){if(!Ce){ie.error("[RandomTraining] æ¡ç‚¹ã‚¨ãƒ³ã‚¸ãƒ³ãŒåˆæœŸåŒ–ã•ã‚Œã¦ã„ã¾ã›ã‚“"),sn();return}try{const r=Ce.generateDetailedReport();t(16,ze={totalScore:r.totalScore,grade:r.grade,componentScores:r.componentScores}),r.intervalAnalysis&&r.intervalAnalysis.masteryLevels?t(3,we=Object.entries(r.intervalAnalysis.masteryLevels).map(([l,b])=>{var w,H;return{type:l,mastery:Math.round(b),attempts:((w=r.intervalAnalysis.attemptCounts)==null?void 0:w[l])||0,accuracy:((H=r.intervalAnalysis.accuracyRates)==null?void 0:H[l])||0}})):(console.warn("âš ï¸ [RandomTraining] intervalAnalysis.masteryLevels ãŒæœªå®šç¾©ã§ã™"),t(3,we=[])),r.consistencyHistory&&Array.isArray(r.consistencyHistory)?t(17,Pe=r.consistencyHistory.map((l,b)=>({score:Math.round(l),timestamp:Date.now()-(r.consistencyHistory.length-b)*1e3}))):(console.warn("âš ï¸ [RandomTraining] consistencyHistory ãŒæœªå®šç¾©ã¾ãŸã¯é…åˆ—ã§ã¯ã‚ã‚Šã¾ã›ã‚“"),t(17,Pe=[])),t(18,Le=r.feedback||{primary:"æ¡ç‚¹çµæœã‚’ç”Ÿæˆä¸­ã§ã™...",detailed:[],suggestions:[]}),t(20,Fe={totalAttempts:r.totalAttempts||0,successRate:r.successRate||0,averageScore:r.totalScore||0,bestScore:Math.max(r.totalScore||0,Fe.bestScore||0),sessionDuration:Math.round((Date.now()-Fe.sessionStart)/6e4)||0,streakCount:r.streak||0,fatigueLevel:r.fatigueLevel||"normal",mostDifficultInterval:r.mostDifficultInterval||"-",mostSuccessfulInterval:r.mostSuccessfulInterval||"-",averageResponseTime:r.averageResponseTime||0}),ie.info("[RandomTraining] æ¡ç‚¹çµæœç”Ÿæˆå®Œäº†:",ze)}catch(r){ie.error("[RandomTraining] æ¡ç‚¹çµæœç”Ÿæˆã‚¨ãƒ©ãƒ¼:",r)}}function sn(){ie.info("[RandomTraining] ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã§æ¡ç‚¹çµæœã‚’ç”Ÿæˆ"),t(16,ze={totalScore:78,grade:"B+",componentScores:{pitchAccuracy:82,recognitionSpeed:75,intervalMastery:80,directionAccuracy:85,consistency:70}}),t(3,we=[{type:"unison",mastery:95,attempts:8,accuracy:98},{type:"major_second",mastery:82,attempts:8,accuracy:85},{type:"major_third",mastery:78,attempts:8,accuracy:80},{type:"perfect_fourth",mastery:65,attempts:8,accuracy:68},{type:"perfect_fifth",mastery:88,attempts:8,accuracy:90},{type:"major_sixth",mastery:72,attempts:8,accuracy:75},{type:"major_seventh",mastery:58,attempts:8,accuracy:62},{type:"octave",mastery:92,attempts:8,accuracy:94}]),t(17,Pe=[{score:65,timestamp:Date.now()-42e4},{score:72,timestamp:Date.now()-36e4},{score:68,timestamp:Date.now()-3e5},{score:75,timestamp:Date.now()-24e4},{score:78,timestamp:Date.now()-18e4},{score:82,timestamp:Date.now()-12e4},{score:80,timestamp:Date.now()-6e4},{score:85,timestamp:Date.now()}]),t(18,Le={type:"improvement",primary:"è‰¯ã„é€²æ­©ãŒè¦‹ã‚‰ã‚Œã¾ã™ï¼",summary:"éŸ³ç¨‹ã®èªè­˜ç²¾åº¦ãŒå‘ä¸Šã—ã¦ã„ã¾ã™ã€‚ç‰¹ã«å®Œå…¨5åº¦ã¨ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–ã®ç¿’å¾—åº¦ãŒé«˜ãã€åŸºæœ¬çš„ãªéŸ³æ„ŸãŒèº«ã«ã¤ã„ã¦ãã¦ã„ã¾ã™ã€‚",details:[{category:"strengths",text:"ãƒ¦ãƒ‹ã‚¾ãƒ³ã¨ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–ã®èªè­˜ãŒã»ã¼å®Œç’§ã§ã™"},{category:"strengths",text:"å®Œå…¨5åº¦ã®å®‰å®šæ€§ãŒå„ªç§€ã§ã™"},{category:"improvements",text:"å®Œå…¨4åº¦ã®ç·´ç¿’ã‚’ã‚‚ã†å°‘ã—å¢—ã‚„ã—ã¾ã—ã‚‡ã†"},{category:"improvements",text:"é•·7åº¦ã®èªè­˜ç²¾åº¦ã‚’å‘ä¸Šã•ã›ã¾ã—ã‚‡ã†"},{category:"tips",text:"4åº¦ã¯ã€Œã‚½ãƒ¼ãƒ•ã‚¡ãƒ¼ã€ã®éŸ³ç¨‹ã§ã™"},{category:"practice",text:"æ¯æ—¥15åˆ†ã®ç¶™ç¶šç·´ç¿’ã‚’å¿ƒãŒã‘ã¾ã—ã‚‡ã†"}],nextSteps:["å®Œå…¨4åº¦ã®é›†ä¸­ç·´ç¿’ã‚’è¡Œã„ã¾ã—ã‚‡ã†","é€£ç¶šãƒãƒ£ãƒ¬ãƒ³ã‚¸ãƒ¢ãƒ¼ãƒ‰ã§å®Ÿè·µç·´ç¿’ã‚’","1æ—¥15åˆ†ã®ç¶™ç¶šç·´ç¿’ã‚’å¿ƒãŒã‘ã¾ã—ã‚‡ã†"],motivation:"ç¶™ç¶šã¯åŠ›ãªã‚Šï¼ã‚ãªãŸã®ç›¸å¯¾éŸ³æ„Ÿã¯ç¢ºå®Ÿã«å‘ä¸Šã—ã¦ã„ã¾ã™ï¼"}),t(20,Fe={totalAttempts:32,successRate:68.8,averageScore:78,bestScore:85,sessionDuration:8,streakCount:4,fatigueLevel:"normal",mostDifficultInterval:"å®Œå…¨4åº¦",mostSuccessfulInterval:"ãƒ¦ãƒ‹ã‚¾ãƒ³",averageResponseTime:2.1,sessionStart:Date.now()-48e4}),ie.info("[RandomTraining] ãƒ†ã‚¹ãƒˆæ¡ç‚¹çµæœç”Ÿæˆå®Œäº†")}function _o(r){dt=r}function an(){if(!ae||ae.length===0){console.warn("[UnifiedScore] noteResultsForDisplay ãŒç©ºã§ã™");return}const r=ae.filter(re=>re.accuracy!=="notMeasured").length,l=ae.length,b=ae.filter(re=>re.accuracy!=="notMeasured"&&typeof re.accuracy=="number").map(re=>re.accuracy),w=b.length>0?Math.round(b.reduce((re,Me)=>re+Me,0)/b.length):0,H=x||"Unknown",L=S||0,ce=ae.map(re=>({name:re.name,note:re.note||re.name,frequency:re.targetFreq||re.expectedFrequency,detectedFrequency:re.detectedFreq,cents:re.cents,grade:rt.evaluateNote(re.cents),targetFreq:re.targetFreq,diff:re.diff})),le=I,se=(le==null?void 0:le.sessionHistory)||[],qe={timestamp:new Date,baseNote:H,baseFrequency:L,noteResults:ce,measuredNotes:r,accuracy:w,grade:rt.evaluateSession(ae)},xe=[...se,qe];t(21,ue={mode:"continuous",timestamp:new Date,duration:60,totalNotes:l,measuredNotes:r,averageAccuracy:w,baseNote:H,baseFrequency:L,noteResults:ce,distribution:rt.calculateDistribution(ae),sessionHistory:xe,unifiedGrade:p(xe)}),console.log("[UnifiedScore] çµ±åˆæ¡ç‚¹ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆå®Œäº†ï¼ˆå®Œå…¨ç‰ˆï¼‰:",ue),cn()}async function cn(){if(!ae||ae.length===0){console.warn("ğŸ“Š [SessionStorage] ä¿å­˜ãƒ‡ãƒ¼ã‚¿ãªã—");return}try{console.log("ğŸ“Š [SessionStorage] ã‚»ãƒƒã‚·ãƒ§ãƒ³çµæœä¿å­˜é–‹å§‹");const r=ae.map(L=>({name:L.name,cents:L.cents,targetFreq:L.targetFreq||L.expectedFrequency,detectedFreq:L.detectedFreq,diff:L.diff,accuracy:typeof L.accuracy=="number"?L.accuracy:0})),l=Qe?Math.round((Date.now()-Qe)/1e3):60;await Fn(r,l,c,s)?(console.log("ğŸ“Š [SessionStorage] ã‚»ãƒƒã‚·ãƒ§ãƒ³çµæœä¿å­˜å®Œäº†"),console.log("ğŸ“Š [SessionStorage] ä¿å­˜å¾Œã®çŠ¶æ³:",{currentSession:n,totalSessions:g.length,isCompleted:f,nextBaseNote:c,nextBaseName:s})):console.error("ğŸ“Š [SessionStorage] ã‚»ãƒƒã‚·ãƒ§ãƒ³çµæœä¿å­˜å¤±æ•—")}catch(r){console.error("ğŸ“Š [SessionStorage] ã‚»ãƒƒã‚·ãƒ§ãƒ³ä¿å­˜ã‚¨ãƒ©ãƒ¼:",r)}}async function ln(){try{if(Ce){const r=g||[];for(const[b,w]of r.entries())if(w.noteResults&&w.noteResults.length>0){const H=w.baseFrequency||262;for(const L of w.noteResults)L.detectedFreq&&L.targetFreq&&await Ce.analyzePerformance({baseFreq:H,targetFreq:L.targetFreq,detectedFreq:L.detectedFreq,responseTime:2e3,volume:50,harmonicCorrection:null})}const l=Ce.generateDetailedReport();t(16,ze={totalScore:l.totalScore||0,grade:l.grade||"C",componentScores:l.componentScores||{accuracy:0,speed:0,consistency:0}}),l.intervalAnalysis&&l.intervalAnalysis.masteryLevels?t(3,we=Object.entries(l.intervalAnalysis.masteryLevels).map(([b,w])=>{var H;return{type:b,mastery:Math.round(w),attempts:((H=l.intervalAnalysis.attemptCounts)==null?void 0:H[b])||0,accuracy:Math.round(w*.9)}})):t(3,we=Tt(ae)),l.consistencyHistory&&Array.isArray(l.consistencyHistory)?t(17,Pe=l.consistencyHistory.map((b,w)=>({score:Math.round(b),timestamp:Date.now()-(l.consistencyHistory.length-w)*1e3}))):t(17,Pe=pt(ae)),t(18,Le=vt(ae)||l.feedback),console.log("ğŸ¯ [generateEnhancedScoringData] æŠ€è¡“åˆ†æçµæœç”Ÿæˆã‚’é–‹å§‹"),console.log("ğŸ¯ [generateEnhancedScoringData] results:",l),t(19,Ye=un(l)),console.log("ğŸ¯ [generateEnhancedScoringData] technicalFeedbackDataçµæœ:",Ye),t(20,Fe={totalAttempts:l.totalAttempts||ae.length,successRate:l.successRate||ae.filter(b=>b.accuracy!=="notMeasured").length/ae.length*100,averageScore:l.totalScore||(ue==null?void 0:ue.averageAccuracy)||0,bestScore:Math.max(l.totalScore||0,Fe.bestScore||0),sessionDuration:Math.round(60),streakCount:l.streak||0,fatigueLevel:l.fatigueLevel||"normal",mostDifficultInterval:l.mostDifficultInterval||"æœªç‰¹å®š",mostSuccessfulInterval:l.mostSuccessfulInterval||"æœªç‰¹å®š",averageResponseTime:l.averageResponseTime||2.5,sessionStart:Date.now()-6e4})}else ht();console.log("[EnhancedScoring] è¿½åŠ æ¡ç‚¹ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆå®Œäº†")}catch(r){console.error("[EnhancedScoring] ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆã‚¨ãƒ©ãƒ¼:",r),ht()}}function ht(){const r=ae.filter(b=>b.accuracy!=="notMeasured"),l=(ue==null?void 0:ue.averageAccuracy)||0;t(16,ze={totalScore:Math.round(l*.8),grade:l>=90?"A":l>=80?"B":l>=70?"C":"D",componentScores:{accuracy:l,speed:85,consistency:Math.max(60,l-10)}}),t(3,we=Tt(ae)),t(17,Pe=pt()),t(18,Le=vt(ae)),t(20,Fe={totalAttempts:ae.length,successRate:r.length/ae.length*100,averageScore:l,bestScore:l,sessionDuration:60,streakCount:0,fatigueLevel:"normal",mostDifficultInterval:"æœªåˆ†æ",mostSuccessfulInterval:"æœªåˆ†æ",averageResponseTime:2.5,sessionStart:Date.now()-6e4})}function pt(r){const l=(ue==null?void 0:ue.averageAccuracy)||70;return Array.from({length:8},(b,w)=>({score:Math.max(30,Math.min(100,l+(Math.random()-.5)*20)),timestamp:Date.now()-(8-w)*7500}))}function vt(r){const l=r.filter(tt=>tt.accuracy!=="notMeasured").length,b=(ue==null?void 0:ue.averageAccuracy)||0,w=8,H=g||[],L=H.length,ce={type:"info",categories:[{name:"éŸ³ç¨‹ç²¾åº¦",icon:"Target",score:b,message:`${b}%ã®ç²¾åº¦ã§éŸ³ç¨‹ã‚’æ‰ãˆã¦ã„ã¾ã™`},{name:"æ¸¬å®šæˆåŠŸç‡",icon:"Mic",score:Math.round(l/r.length*100),message:`${r.length}éŸ³ä¸­${l}éŸ³ã‚’æ­£å¸¸ã«æ¸¬å®š`}]};if(L<w)return ce;let le,se,qe;const xe=(ue==null?void 0:ue.unifiedGrade)||"E",re=H.length;let Me=0,ve=0,_e=0;H.forEach(tt=>{tt.grade==="excellent"?Me++:tt.grade==="good"?ve++:tt.grade==="pass"&&_e++});const be=re>0?Math.round(Me/re*100):0,et=re>0?Math.round((Me+ve+_e)/re*100):0,De=re>0?Math.round((Me+ve+_e)/re*100):0;switch(xe){case"S":le="excellent",se="éŸ³æ¥½å®¶ãƒ¬ãƒ™ãƒ«ã®ç›¸å¯¾éŸ³æ„Ÿã‚’é”æˆï¼",qe=`å„ªç§€ç‡${be}%è¶…ãˆã®å®ŸåŠ›ã‚’è¨¼æ˜ã•ã‚Œã¾ã—ãŸã€‚`;break;case"A":le="excellent",se="ã‚¨ã‚­ã‚¹ãƒ‘ãƒ¼ãƒˆãƒ¬ãƒ™ãƒ«åˆ°é”ï¼",qe=`å„ªç§€ç‡${be}%ã®å®‰å®šã—ãŸéŸ³æ„Ÿèƒ½åŠ›ã§ã™ã€‚`;break;case"B":le="improvement",se="ãƒ—ãƒ­ãƒ•ã‚£ã‚·ã‚¨ãƒ³ãƒˆç´šé”æˆï¼",qe=`è‰¯å¥½ç‡${et}%ã®ç¢ºå®Ÿãªé€²æ­©ã‚’ç¤ºã—ã¦ã„ã¾ã™ã€‚`;break;case"C":le="improvement",se="ã‚¢ãƒ‰ãƒãƒ³ã‚¹ç´šåˆ°é”ï¼",qe=`åˆæ ¼ç‡${De}%ã§ç€å®Ÿã«æˆé•·ä¸­ã§ã™ã€‚`;break;case"D":le="practice",se="ç¶™ç¶šç·´ç¿’ã§å¿…ãšä¸Šé”ï¼",qe=`ç¾åœ¨ã®åˆæ ¼ç‡${De}%ã‹ã‚‰ç›®æ¨™70%ã¸å‘ã‘ã¦ç·´ç¿’ã‚’ç¶šã‘ã¾ã—ã‚‡ã†ã€‚`;break;case"E":default:le="encouragement",se="Eç´šãƒ“ã‚®ãƒŠãƒ¼",qe="ç·´ç¿’é–‹å§‹æ®µéšã§ã™ã€‚ç¶™ç¶šçš„ãªç·´ç¿’ã§å¿…ãšä¸Šé”ã—ã¾ã™ã€‚";break}return{...ce,type:le,primary:se,summary:qe}}function un(r){var xe,re,Me;if((g||[]).length<8||!r)return null;const H=r.improvements||[];(xe=r.detailed)!=null&&xe.statistics;const L=[];let ce=0,le=0;if((re=r.detailed)!=null&&re.intervals){const ve=r.detailed.intervals;if(ve.totalAnalyses>0){let _e=0,be=0;for(const[et,De]of Object.entries(ve.masteryLevels))De.attempts>0&&(_e+=De.averageAccuracy*De.attempts,be+=De.attempts);ce=be>0?_e/be:0}}if((Me=r.detailed)!=null&&Me.directions){const ve=r.detailed.directions;if(ve.totalAnalyses>0){let _e=0,be=0;for(const[et,De]of Object.entries(ve.masteryData))De.attempts>0&&(_e+=De.averageAccuracy*De.attempts,be+=De.attempts);le=be>0?_e/be:0}}L.push({category:"improvements",text:`éŸ³ç¨‹ç²¾åº¦: ${Math.round(ce)}%ã€€ï¼ˆéŸ³ã®é«˜ã•ã‚’æ‰ãˆã‚‹æ­£ç¢ºæ€§ã€€ç›®æ¨™åŸºæº–ï¼š70ã€œ85%ï¼‰`}),L.push({category:"improvements",text:`æ–¹å‘æ€§: ${Math.round(le)}%ã€€ï¼ˆéŸ³ç¨‹ã®ä¸Šä¸‹åˆ¤æ–­ã®ç²¾åº¦ã€€ç›®æ¨™åŸºæº–ï¼š80ã€œ90%ï¼‰`});const se=H.map(ve=>({category:"tips",text:ve.message})),qe=H.flatMap(ve=>(ve.actions||[]).map(_e=>({category:"practice",text:_e})));return[...L,...se,...qe],{type:"info",primary:"è©³ç´°åˆ†æçµæœ",summary:"éŸ³ç¨‹ç²¾åº¦ãƒ»ä¸€è²«æ€§ãƒ»æ–¹å‘æ€§ã®ç·åˆåˆ†æ",details:L}}Cn(async()=>{if(!(typeof localStorage<"u"?localStorage.getItem("mic-test-completed"):null)){console.log("ğŸš« [RandomTraining] ãƒã‚¤ã‚¯ãƒ†ã‚¹ãƒˆæœªå®Œäº† - æº–å‚™ç”»é¢è¡¨ç¤º"),it();return}console.log("ğŸ“Š [SessionStorage] ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†åˆæœŸåŒ–é–‹å§‹");try{if(await nt()){if(console.log("ğŸ“Š [SessionStorage] ã‚»ãƒƒã‚·ãƒ§ãƒ³é€²è¡ŒçŠ¶æ³ã®èª­ã¿è¾¼ã¿å®Œäº†"),console.log("ğŸ“Š [SessionStorage] ç¾åœ¨ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³:",n,"/ 8"),console.log("ğŸ“Š [SessionStorage] æ¬¡ã®åŸºéŸ³:",c,"(",s,")"),console.log("ğŸ“Š [SessionStorage] å®Œäº†çŠ¶æ³:",f?"8ã‚»ãƒƒã‚·ãƒ§ãƒ³å®Œäº†":`æ®‹ã‚Š${y}ã‚»ãƒƒã‚·ãƒ§ãƒ³`),f&&(console.log("ğŸ”„ [SessionStorage] 8ã‚»ãƒƒã‚·ãƒ§ãƒ³å®Œäº†æ¤œå‡º - æ–°ã‚µã‚¤ã‚¯ãƒ«é–‹å§‹å‡¦ç†"),await ot()?console.log("âœ… [SessionStorage] æ–°ã‚µã‚¤ã‚¯ãƒ«é–‹å§‹å®Œäº† - ã‚»ãƒƒã‚·ãƒ§ãƒ³1/8ã‹ã‚‰å†é–‹"):console.warn("âš ï¸ [SessionStorage] æ–°ã‚µã‚¤ã‚¯ãƒ«é–‹å§‹å‡¦ç†ãŒå¤±æ•—")),n>1&&!f){console.warn("ğŸ”„ [SessionStorage] ã‚»ãƒƒã‚·ãƒ§ãƒ³é€”ä¸­ã§ã®ãƒªãƒ­ãƒ¼ãƒ‰æ¤œå‡º - ã‚»ãƒƒã‚·ãƒ§ãƒ³1ã‹ã‚‰å†é–‹"),console.warn("ğŸ”„ [SessionStorage] ç¾åœ¨:",n,"ã‚»ãƒƒã‚·ãƒ§ãƒ³ç›® â†’ ãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã‚¢ã‚¯ã‚»ã‚¹èª˜å°");const{SessionStorageManager:b}=await Dn(async()=>{const{SessionStorageManager:L}=await import("../chunks/ADnjuNQc.js").then(ce=>ce.B);return{SessionStorageManager:L}},__vite__mapDeps([0,1,2,3,4,5]),import.meta.url),w=b.getInstance();typeof localStorage<"u"&&(localStorage.removeItem("random-training-progress"),localStorage.removeItem("random-training-progress-backup"));const{resetProgress:H}=await Dn(async()=>{const{resetProgress:L}=await import("../chunks/ADnjuNQc.js").then(ce=>ce.D);return{resetProgress:L}},__vite__mapDeps([0,1,2,3,4,5]),import.meta.url);await H(),console.log("ğŸ”„ [SessionStorage] localStorage + ã‚¹ãƒˆã‚¢çŠ¶æ…‹å®Œå…¨ãƒªã‚»ãƒƒãƒˆå®Œäº†"),it();return}}else console.log("ğŸ“Š [SessionStorage] æ–°è¦ã‚»ãƒƒã‚·ãƒ§ãƒ³é–‹å§‹")}catch(l){console.error("ğŸ“Š [SessionStorage] åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼:",l)}if(tn(),nn(),D.url.searchParams.get("from")==="microphone-test"){console.log("ğŸ¤ [RandomTraining] ãƒã‚¤ã‚¯ãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸ã‹ã‚‰ã®é·ç§»ã‚’æ¤œå‡º");const l=new URL(window.location);if(l.searchParams.delete("from"),window.history.replaceState({},"",l),t(1,N="granted"),t(0,v="setup"),console.log('ğŸ¤ [RandomTraining] microphoneState="granted", trainingPhase="setup" ã«è¨­å®š'),!Be){console.log("ğŸ¤ [RandomTraining] AudioManagerãƒªã‚½ãƒ¼ã‚¹å–å¾—é–‹å§‹");try{const b=await We.initialize();at=b.audioContext,Be=b.mediaStream,ct=b.sourceNode,console.log("ğŸ¤ [RandomTraining] AudioManagerãƒªã‚½ãƒ¼ã‚¹å–å¾—å®Œäº†")}catch(b){console.warn("âš ï¸ AudioManagerãƒªã‚½ãƒ¼ã‚¹å–å¾—å¤±æ•—ï¼ˆå¾Œã§å†è©¦è¡Œï¼‰:",b)}}if(await new Promise(b=>setTimeout(b,500)),ne)try{if(console.log("ğŸ™ï¸ [ContinuousMode] PitchDetectoråˆæœŸåŒ–é–‹å§‹"),typeof ne.getIsInitialized=="function"){const b=ne.getIsInitialized();if(console.log("ğŸ” [ContinuousMode] PitchDetectoråˆæœŸåŒ–çŠ¶æ…‹:",b),b)console.log("âœ… [ContinuousMode] PitchDetectorã¯æ—¢ã«åˆæœŸåŒ–æ¸ˆã¿");else{const w=We.getStatus();console.log("ğŸ” [ContinuousMode] AudioManagerçŠ¶æ…‹:",w),(!w.isInitialized||!w.mediaStreamActive)&&(console.log("ğŸ”„ [ContinuousMode] AudioManagerå†åˆæœŸåŒ–å®Ÿè¡Œ"),await We.initialize()),await ne.initialize(),console.log("âœ… [ContinuousMode] PitchDetectoråˆæœŸåŒ–å®Œäº†")}}else console.error("âŒ [ContinuousMode] getIsInitializedãƒ¡ã‚½ãƒƒãƒ‰ãŒåˆ©ç”¨ã§ãã¾ã›ã‚“"),await ne.initialize()}catch(b){console.error("âŒ [ContinuousMode] PitchDetectoråˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼:",b),await new Promise(w=>setTimeout(w,1e3));try{await ne.initialize(),console.log("âœ… [ContinuousMode] PitchDetectoråˆæœŸåŒ–å†è©¦è¡ŒæˆåŠŸ")}catch(w){console.error("âŒ [ContinuousMode] PitchDetectoråˆæœŸåŒ–å†è©¦è¡Œã‚‚å¤±æ•—:",w)}}else console.warn("âš ï¸ [ContinuousMode] PitchDetectorã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒå­˜åœ¨ã—ã¾ã›ã‚“")}else await new Promise(l=>setTimeout(l,100)),it()});function fn(r){try{if(!r||!r.detail){console.warn("âš ï¸ [ContinuousMode] handlePitchUpdate: event.detail ãŒ undefined");return}const{frequency:l,note:b,volume:w,rawVolume:H,clarity:L}=r.detail;let ce=l,le=b;if(v==="guiding"&&G&&S>0&&l>0){const se=dn(l);se&&(ce=se.frequency,le=se.note)}t(14,Ee=ce),t(15,Ge=le),t(13,Se=w),S>0&&ce>0?Ve=Math.round(1200*Math.log2(ce/S)):Ve=0;try{mn(l,b)}catch(se){console.error("âŒ [ContinuousMode] evaluateScaleStep ã‚¨ãƒ©ãƒ¼:",se)}try{Ce&&l>0&&S>0&&on(l,b)}catch(se){console.error("âŒ [ContinuousMode] updateScoringEngine ã‚¨ãƒ©ãƒ¼:",se)}}catch(l){console.error("âŒ [ContinuousMode] handlePitchUpdate ã‚¨ãƒ©ãƒ¼:",{error:l.message,stack:l.stack,eventDetail:r==null?void 0:r.detail,trainingPhase:v,currentSessionId:n})}}function dn(r){if(!r||r<=0||!G||!S||Se<25)return null;const b=q-1;if(b<0||b>=C.length)return null;const w=Ze(S,b);if(!w||w<=0)return null;const L=Et(r,w).correctedFrequency,ce=En(L);return{frequency:Math.round(L),note:ce}}function mn(r,l){if(!r||r<=0||!G)return;if(!S||S<=0){console.error(`âŒ [æ¡ç‚¹ã‚¨ãƒ©ãƒ¼] åŸºéŸ³å‘¨æ³¢æ•°ãŒç„¡åŠ¹: ${S}Hz`),console.error(`âŒ [æ¡ç‚¹ã‚¨ãƒ©ãƒ¼] åŸºéŸ³å: ${x}`),console.error(`âŒ [æ¡ç‚¹ã‚¨ãƒ©ãƒ¼] activeStepIndex: ${q-1}`),console.error(`âŒ [æ¡ç‚¹ã‚¨ãƒ©ãƒ¼] trainingPhase: ${v}`),console.error(`âŒ [æ¡ç‚¹ã‚¨ãƒ©ãƒ¼] isGuideAnimationActive: ${G}`);return}if(Se<25)return;const w=q-1;if(w<0||w>=C.length)return;w>=4&&ie.debug(`[æ¡ç‚¹ãƒ‡ãƒãƒƒã‚°] activeStepIndex=${w} (${C[w].name}), currentBaseFrequency=${S}Hz`);const H=Ze(S,w);if(w>=0&&ie.debug(`[éŸ³ç¨‹è¨ˆç®—ä¿®æ­£ç‰ˆ] ${C[w].name}: æœŸå¾…å‘¨æ³¢æ•° ${H.toFixed(1)}Hz`),!H||H<=0||!isFinite(H)){console.error("âŒ [æ¡ç‚¹ã‚¨ãƒ©ãƒ¼] æœŸå¾…å‘¨æ³¢æ•°è¨ˆç®—ã‚¨ãƒ©ãƒ¼:"),console.error(`   åŸºéŸ³å‘¨æ³¢æ•°: ${S}Hz`),console.error(`   éŸ³éšã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹: ${w}`),console.error(`   æœŸå¾…å‘¨æ³¢æ•°: ${H}Hz`);return}const L=Et(r,H),ce=L.correctedFrequency,le=L.factor,se=Math.round(1200*Math.log2(ce/H));if((Math.abs(se)>200||le!==1)&&(ie.debug(`[ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—å¼è£œæ­£] ${C[w].name}:`),console.warn(`   æ¤œå‡ºå‘¨æ³¢æ•°: ${r.toFixed(1)}Hz`),console.warn(`   è£œæ­£å¾Œå‘¨æ³¢æ•°: ${ce.toFixed(1)}Hz`),console.warn(`   æœŸå¾…å‘¨æ³¢æ•°: ${H.toFixed(1)}Hz`),console.warn(`   ã‚»ãƒ³ãƒˆå·®: ${se}Â¢`),console.warn(`   è£œæ­£ä¿‚æ•°: ${le} (${L.description})`),console.warn(`   åŸºéŸ³: ${x} (${S.toFixed(1)}Hz)`)),!isFinite(se)){console.error("âŒ [æ¡ç‚¹ã‚¨ãƒ©ãƒ¼] ã‚»ãƒ³ãƒˆè¨ˆç®—ã‚¨ãƒ©ãƒ¼:"),console.error(`   æ¤œå‡ºå‘¨æ³¢æ•°: ${r}Hz`),console.error(`   æœŸå¾…å‘¨æ³¢æ•°: ${H}Hz`),console.error(`   ã‚»ãƒ³ãƒˆå·®: ${se}`);return}const xe=Math.abs(se)<=50;if(Se>=15){const ve=Math.max(0,Math.round(100-Math.abs(se))),_e=K.findIndex(et=>et.stepIndex===w),be={stepIndex:w,stepName:C[w].name,expectedFrequency:Math.round(H),detectedFrequency:Math.round(r),adjustedFrequency:Math.round(ce),centDifference:se,accuracy:ve,isCorrect:xe,correctionFactor:le,correctionDescription:L.description,timestamp:Date.now()};_e>=0?K[_e]=be:K.push(be),K.length%4===0&&ie.realtime(`æ¡ç‚¹é€²æ—: ${K.length}/${C.length}ã‚¹ãƒ†ãƒƒãƒ—å®Œäº†`)}}function gn(){t(0,v="results"),He.isCompleted=!0,He.averageAccuracy=Math.round(He.correctCount/He.totalCount*100),ne&&ne.stopDetection(),Sn()}async function yn(){if(f){console.warn("ğŸš« [RestartSame] 8ã‚»ãƒƒã‚·ãƒ§ãƒ³å®Œäº†çŠ¶æ…‹ã§ã¯å†æŒ‘æˆ¦ä¸å¯ - æ–°ã‚µã‚¤ã‚¯ãƒ«é–‹å§‹ãŒå¿…è¦"),await ot()?(console.log("âœ… [RestartSame] æ–°ã‚µã‚¤ã‚¯ãƒ«é–‹å§‹å®Œäº† - ã‚»ãƒƒã‚·ãƒ§ãƒ³1/8ã‹ã‚‰å†é–‹"),window.location.reload()):console.error("âŒ [RestartSame] æ–°ã‚µã‚¤ã‚¯ãƒ«é–‹å§‹å¤±æ•—");return}st(),t(0,v="setup"),V&&(clearTimeout(V),V=null),ne&&ne.resetDisplayState&&ne.resetDisplayState(),lt(),console.log("ğŸ”„ [RestartSame] åŒã˜åŸºéŸ³ã§å†æŒ‘æˆ¦:",x,S+"Hz"),console.log("ğŸ”„ [RestartSame] åŸºéŸ³æƒ…å ±ä¿æŒå®Œäº† - ãƒ¦ãƒ¼ã‚¶ãƒ¼æ“ä½œå¾…æ©Ÿ")}async function hn(){if(f){console.warn("ğŸš« [RestartDifferent] 8ã‚»ãƒƒã‚·ãƒ§ãƒ³å®Œäº†çŠ¶æ…‹ã§ã¯å†æŒ‘æˆ¦ä¸å¯ - æ–°ã‚µã‚¤ã‚¯ãƒ«é–‹å§‹ãŒå¿…è¦"),await ot()?(console.log("âœ… [RestartDifferent] æ–°ã‚µã‚¤ã‚¯ãƒ«é–‹å§‹å®Œäº† - ã‚»ãƒƒã‚·ãƒ§ãƒ³1/8ã‹ã‚‰å†é–‹"),window.location.reload()):console.error("âŒ [RestartDifferent] æ–°ã‚µã‚¤ã‚¯ãƒ«é–‹å§‹å¤±æ•—");return}st(),t(0,v="setup"),V&&(clearTimeout(V),V=null),t(7,x=""),t(8,S=0),console.log("ğŸ”„ [restartDifferentBaseNote] åŸºéŸ³æƒ…å ±ã‚’ãƒªã‚»ãƒƒãƒˆã—ã¾ã—ãŸ");try{await nt(),console.log("ğŸ¯ [restartDifferentBaseNote] æ–°ã—ã„åŸºéŸ³å–å¾—å®Œäº†:",c,s)}catch(r){console.error("âŒ [restartDifferentBaseNote] æ–°ã—ã„åŸºéŸ³å–å¾—ã‚¨ãƒ©ãƒ¼:",r)}ne&&ne.resetDisplayState&&ne.resetDisplayState(),lt()}function lt(){q=0,G=!1,K=[],t(10,C=C.map(r=>({...r,state:"inactive",completed:!1})))}async function pn(){console.log("ğŸš€ [StartNewCycle] 8ã‚»ãƒƒã‚·ãƒ§ãƒ³å®Œäº†å¾Œã®æœ€åˆã‹ã‚‰æŒ‘æˆ¦é–‹å§‹");try{await ot()?(console.log("âœ… [StartNewCycle] æ–°ã‚µã‚¤ã‚¯ãƒ«é–‹å§‹å®Œäº†"),localStorage.getItem("mic-test-completed")?(console.log("âœ… [StartNewCycle] ãƒã‚¤ã‚¯ãƒ†ã‚¹ãƒˆå®Œäº†ãƒ•ãƒ©ã‚°ç¢ºèª - ãƒªãƒ­ãƒ¼ãƒ‰ãªã—ã§çŠ¶æ…‹ãƒªã‚»ãƒƒãƒˆ"),st(),await nt(),t(0,v="setup"),lt(),mt(),console.log("âœ… [StartNewCycle] çŠ¶æ…‹ãƒªã‚»ãƒƒãƒˆå®Œäº† - ã‚»ãƒƒã‚·ãƒ§ãƒ³1/8ã‹ã‚‰å†é–‹")):window.location.reload()):(console.error("âŒ [StartNewCycle] æ–°ã‚µã‚¤ã‚¯ãƒ«é–‹å§‹å¤±æ•—"),$e())}catch(r){console.error("âŒ [StartNewCycle] æ–°ã‚µã‚¤ã‚¯ãƒ«é–‹å§‹ã‚¨ãƒ©ãƒ¼:",r),$e()}}function vn(r){const{type:l}=r.detail;switch(l){case"same":yn();break;case"different":hn();break;case"restart":pn();break;case"home":$e();break;default:console.warn("ğŸš« [ActionButtons] æœªçŸ¥ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚¿ã‚¤ãƒ—:",l)}}function _n(){console.log("âš¡ [ContinuousMode] 8ã‚»ãƒƒã‚·ãƒ§ãƒ³é€£ç¶šé–‹å§‹"),gt()}function Sn(){console.log("âœ… [ContinuousMode] ã‚»ãƒƒã‚·ãƒ§ãƒ³å®Œäº†:",n),n<8?setTimeout(async()=>{if(console.log("ğŸ”„ [ContinuousMode] æ¬¡ã‚»ãƒƒã‚·ãƒ§ãƒ³è‡ªå‹•é–‹å§‹æº–å‚™:",n+1),t(0,v="setup"),He={isCompleted:!1,correctCount:0,totalCount:0,averageAccuracy:0},t(9,ee=!1),ne)try{if(ne.getState){const l=ne.getState();console.log("ğŸ” [ContinuousMode] PitchDetectorçŠ¶æ…‹:",l),l.isInitialized&&l.componentState==="ready"?(console.log("ğŸ¤ [ContinuousMode] éŸ³ç¨‹æ¤œå‡ºå†é–‹"),ne.startDetection()):l.componentState==="detecting"?console.log("ğŸ”„ [ContinuousMode] éŸ³ç¨‹æ¤œå‡ºã¯æ—¢ã«ã‚¢ã‚¯ãƒ†ã‚£ãƒ–çŠ¶æ…‹ - ã‚¹ã‚­ãƒƒãƒ—"):console.log("âš ï¸ [ContinuousMode] PitchDetectorçŠ¶æ…‹ä¸æ­£ - éŸ³ç¨‹æ¤œå‡ºå†é–‹ã‚’ã‚¹ã‚­ãƒƒãƒ—:",l.componentState)}else console.log("âš ï¸ [ContinuousMode] getState()ãƒ¡ã‚½ãƒƒãƒ‰æœªå¯¾å¿œ - ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯å‡¦ç†"),ne.getIsInitialized&&ne.getIsInitialized()&&ne.startDetection()}catch(l){console.warn("âš ï¸ [ContinuousMode] éŸ³ç¨‹æ¤œå‡ºå†é–‹å¤±æ•—:",l.message)}console.log("ğŸ”„ [ContinuousMode] ç¾åœ¨ã®åŸºéŸ³ã‚’é™¤å¤–ã—ã¦æ–°ã—ã„åŸºéŸ³ã‚’å–å¾—ä¸­...");const r=c;try{await kn(),console.log("ğŸ¯ [ContinuousMode] æ–°ã—ã„åŸºéŸ³å–å¾—å®Œäº†:",`${r} â†’ ${c} (${s})`)}catch(l){console.error("âŒ [ContinuousMode] æ–°ã—ã„åŸºéŸ³å–å¾—ã‚¨ãƒ©ãƒ¼:",l),await nt()}console.log("ğŸµ [ContinuousMode] æ¬¡ã®åŸºéŸ³è‡ªå‹•å†ç”Ÿé–‹å§‹"),gt()},2e3):(console.log("ğŸ‰ [ContinuousMode] 8ã‚»ãƒƒã‚·ãƒ§ãƒ³å®Œäº†ï¼"),setTimeout(()=>{console.log("ğŸ† [ContinuousMode] ç·åˆè©•ä¾¡ç”»é¢è¡¨ç¤ºå®Œäº†")},1e3))}function bn(r){var L;const{error:l,context:b,reason:w,recovery:H}=r.detail;if(b==="initialization"||l!=null&&l.message&&l.message.includes("getIsInitialized")){console.error("âŒ [ContinuousMode] PitchDetectoråˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼è©³ç´°:",{error:(l==null?void 0:l.message)||l,stack:l==null?void 0:l.stack,context:b,componentExists:!!ne,hasGetIsInitialized:typeof(ne==null?void 0:ne.getIsInitialized)=="function",trainingPhase:v,currentSessionId:n});return}if(console.error("âŒ [ContinuousMode] PitchDetectorã‚¨ãƒ©ãƒ¼è©³ç´°:",{error:(l==null?void 0:l.message)||l,stack:l==null?void 0:l.stack,context:b,reason:w,recovery:H,trainingPhase:v,currentSessionId:n}),w==="mediastream_ended"&&H==="restart_required"&&(console.log("âš¡ [ContinuousMode] MediaStreamçµ‚äº†æ¤œå‡º - è‡ªå‹•å¾©æ—§ã‚’è©¦è¡Œ"),setTimeout(async()=>{try{await Ue()}catch(ce){console.error("âŒ [ContinuousMode] è‡ªå‹•å¾©æ—§å¤±æ•—:",ce)}},1e3)),b==="start-detection"&&((L=l==null?void 0:l.message)!=null&&L.includes("component state is detecting"))){console.log("ğŸ”„ [ContinuousMode] éŸ³ç¨‹æ¤œå‡ºã¯æ—¢ã«ã‚¢ã‚¯ãƒ†ã‚£ãƒ–çŠ¶æ…‹ã§ã™ï¼ˆæ­£å¸¸ï¼‰");return}}function qn(r){const{healthy:l,errors:b,details:w}=r.detail;t(2,X=l),t(6,B=b),l||(console.warn("âš ï¸ ãƒã‚¤ã‚¯ã®å¥åº·çŠ¶æ…‹ãŒæ‚ªåŒ–:",b),v==="guiding"&&(t(0,v="setup"),console.warn("ğŸ›‘ ãƒã‚¤ã‚¯å•é¡Œã«ã‚ˆã‚Šãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã‚’åœæ­¢")))}wn(()=>{console.log("ğŸ”„ [RandomTraining] onDestroy - AudioManagerãƒªã‚½ãƒ¼ã‚¹ã¯ä¿æŒ"),he&&(he.dispose(),t(33,he=null))});const So=[];Qo.keys(e).forEach(r=>{!~So.indexOf(r)&&r.slice(0,2)!=="$$"&&r!=="slot"&&Xo.warn(`<Page> was created with unknown prop '${r}'`)});function bo(r){Fo[r?"unshift":"push"](()=>{ne=r,t(22,ne)})}return a.$capture_state=()=>({onMount:Cn,onDestroy:wn,goto:St,base:_t,page:bt,ChevronRight:Uo,Music:Hn,Card:Ke,Button:ft,VolumeBar:Mo,PitchDisplay:Oo,PitchDetector:Vn,PitchDetectionDisplay:xn,PageLayout:Bn,Tone:Lo,audioManager:We,harmonicCorrection:qt,logger:ie,ScoreResultPanel:Go,IntervalProgressTracker:jo,ConsistencyGraph:zo,FeedbackDisplay:Ho,SessionStatistics:Vo,UnifiedScoreResultFixed:Jt,ActionButtons:Wt,EvaluationEngine:rt,EnhancedScoringEngine:Rn,trainingProgress:At,currentSessionId:Nt,nextBaseNote:Mt,nextBaseName:Rt,isLoading:Ft,storageError:xo,isCompleted:kt,sessionHistory:wt,overallGrade:Bo,overallAccuracy:Po,progressPercentage:Eo,remainingSessions:Ct,latestSessionResult:To,unifiedScoreData:Dt,loadProgress:nt,saveSessionResult:Fn,resetProgress:Io,createNewProgress:Ao,startNewCycleIfCompleted:ot,emergencyResetForDuplication:No,forceNewBaseNoteExcludingCurrent:kn,getVolumeForDevice:In,calculateUnifiedGrade:p,generateTestUnifiedScoreData:Yo,trainingPhase:v,microphoneState:N,microphoneHealthy:X,microphoneErrors:B,buildVersion:uo,buildTimestamp:fo,updateStatus:mo,SCALE_NAMES:j,currentBaseNote:x,currentBaseFrequency:S,isPlaying:ee,currentScaleIndex:q,scaleSteps:C,guideAnimationTimer:V,isGuideAnimationActive:G,guideStartProgress:oe,isGuideStartBarActive:P,guideStartTimer:T,musicIconGlowing:te,scaleEvaluations:K,previousEvaluations:ye,currentVolume:Se,currentFrequency:Ee,detectedNote:Ge,pitchDifference:Ve,sessionResults:He,scoringEngine:Ce,currentScoreData:ze,intervalData:we,consistencyData:Pe,feedbackData:Le,technicalFeedbackData:Ye,sessionStatistics:Fe,activeTab:dt,noteResultsForDisplay:ae,currentUnifiedScoreData:ue,sampler:he,isSamplerLoading:Re,pitchDetectorComponent:ne,mediaStream:Be,audioContext:at,sourceNode:ct,sessionStartTime:Qe,baseNotes:Oe,checkMicrophonePermission:Ue,selectRandomBaseNote:mt,playRandomBaseNote:Kt,playCurrentBaseNote:Qt,playBaseNoteOnly:yo,playBaseNote:gt,startGuideStartBar:Xt,cleanupGuideStartBar:ho,calculateExpectedFrequency:Ze,calculateTargetFrequency:Yt,startGuideAnimation:yt,finishGuideAnimation:Zt,calculateFinalResults:$t,getStatusMessage:po,getDisplayEvaluations:vo,goToMicrophoneTest:en,goHome:$e,initializeSampler:tn,checkExistingMicrophonePermission:it,initializeScoringEngine:nn,updateScoringEngine:on,generateFinalScoring:rn,generateTestScoreData:sn,switchTab:_o,generateUnifiedScoreData:an,saveSessionToStorage:cn,generateEnhancedScoringData:ln,generateFallbackEnhancedData:ht,generateIntervalDataFromResults:Tt,generateIntervalDataFromSessionHistory:Tn,generateConsistencyDataFromResults:pt,generateFeedbackFromResults:vt,generateTechnicalFeedbackFromEnhancedEngine:un,handlePitchUpdate:fn,getEvaluationCorrectedFrequency:dn,frequencyToNote:En,multiStageOctaveCorrection:Et,evaluateScaleStep:mn,completeSession:gn,restartSameBaseNote:yn,restartDifferentBaseNote:hn,scrollToTop:st,resetSessionState:lt,startNewCycle:pn,handleActionButtonClick:vn,startContinuousMode:_n,handleSessionComplete:Sn,handlePitchDetectorStateChange:go,handlePitchDetectorError:bn,handleMicrophoneHealthChange:qn,canRestartSession:o,canStartTraining:i,$currentSessionId:n,$nextBaseName:s,$nextBaseNote:c,$unifiedScoreData:u,$isCompleted:f,$page:D,$remainingSessions:y,$sessionHistory:g,$trainingProgress:I,$isLoading:E}),a.$inject_state=r=>{"trainingPhase"in r&&t(0,v=r.trainingPhase),"microphoneState"in r&&t(1,N=r.microphoneState),"microphoneHealthy"in r&&t(2,X=r.microphoneHealthy),"microphoneErrors"in r&&t(6,B=r.microphoneErrors),"currentBaseNote"in r&&t(7,x=r.currentBaseNote),"currentBaseFrequency"in r&&t(8,S=r.currentBaseFrequency),"isPlaying"in r&&t(9,ee=r.isPlaying),"currentScaleIndex"in r&&(q=r.currentScaleIndex),"scaleSteps"in r&&t(10,C=r.scaleSteps),"guideAnimationTimer"in r&&(V=r.guideAnimationTimer),"isGuideAnimationActive"in r&&(G=r.isGuideAnimationActive),"guideStartProgress"in r&&t(11,oe=r.guideStartProgress),"isGuideStartBarActive"in r&&(P=r.isGuideStartBarActive),"guideStartTimer"in r&&(T=r.guideStartTimer),"musicIconGlowing"in r&&t(12,te=r.musicIconGlowing),"scaleEvaluations"in r&&(K=r.scaleEvaluations),"previousEvaluations"in r&&(ye=r.previousEvaluations),"currentVolume"in r&&t(13,Se=r.currentVolume),"currentFrequency"in r&&t(14,Ee=r.currentFrequency),"detectedNote"in r&&t(15,Ge=r.detectedNote),"pitchDifference"in r&&(Ve=r.pitchDifference),"sessionResults"in r&&(He=r.sessionResults),"scoringEngine"in r&&(Ce=r.scoringEngine),"currentScoreData"in r&&t(16,ze=r.currentScoreData),"intervalData"in r&&t(3,we=r.intervalData),"consistencyData"in r&&t(17,Pe=r.consistencyData),"feedbackData"in r&&t(18,Le=r.feedbackData),"technicalFeedbackData"in r&&t(19,Ye=r.technicalFeedbackData),"sessionStatistics"in r&&t(20,Fe=r.sessionStatistics),"activeTab"in r&&(dt=r.activeTab),"noteResultsForDisplay"in r&&(ae=r.noteResultsForDisplay),"currentUnifiedScoreData"in r&&t(21,ue=r.currentUnifiedScoreData),"sampler"in r&&t(33,he=r.sampler),"isSamplerLoading"in r&&t(34,Re=r.isSamplerLoading),"pitchDetectorComponent"in r&&t(22,ne=r.pitchDetectorComponent),"mediaStream"in r&&(Be=r.mediaStream),"audioContext"in r&&(at=r.audioContext),"sourceNode"in r&&(ct=r.sourceNode),"sessionStartTime"in r&&(Qe=r.sessionStartTime),"canRestartSession"in r&&(o=r.canRestartSession),"canStartTraining"in r&&(i=r.canStartTraining)},e&&"$$inject"in e&&a.$inject_state(e.$$inject),a.$$.update=()=>{a.$$.dirty[0]&6|a.$$.dirty[1]&12&&(i=N==="granted"&&!Re&&he&&X),a.$$.dirty[0]&1&&(o=v==="results"),a.$$.dirty[0]&56&&u&&f&&u.sessionHistory&&(t(3,we=Tn(u.sessionHistory)),console.log("ğŸµ [RandomTraining] intervalDataç”Ÿæˆå®Œäº†:",we.length,"ä»¶")),a.$$.dirty[0]&3&&v==="setup"&&N==="granted"&&st()},[v,N,X,we,u,f,B,x,S,ee,C,oe,te,Se,Ee,Ge,ze,Pe,Le,Ye,Fe,ue,ne,n,g,E,en,$e,fn,vn,_n,bn,qn,he,Re,bo]}class lr extends qo{constructor(e){super(e),Do(this,e,Zo,Ut,Co,{},null,[-1,-1,-1,-1]),Y("SvelteRegisterComponent",{component:this,tagName:"Page",options:e,id:Ut.name})}}export{lr as component,ir as universal};
