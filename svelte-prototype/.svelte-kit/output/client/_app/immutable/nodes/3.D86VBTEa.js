import{S as $t,i as te,d as F,s as ee,v as ne,c as ie,a as oe,D as Vt,E as It,b as u,q as mt,r as vt,u as ht,f as q,w as _t,F as se,m as L,x as yt,p as T,y as pt,g as d,z as f,h as _,j as b,k,B as it,A as O,o as g,C as ot,G as Pt,e as ft,l as U,t as J,n as at,H as Ft,I as kt}from"../chunks/Dujr-1LT.js";import"../chunks/B_rl9Jj9.js";import{p as dt}from"../chunks/CTevXF5G.js";import{P as Rt,B as le,C as bt}from"../chunks/BlOhcc-l.js";const y="src/routes/microphone-test/+page.svelte";function Nt(c){let t,e="マイク準備完了",i,n,s="トレーニング開始ボタンを押してランダム基音モードへ進んでください",a,l,o,v="トレーニング開始",h,m;const w={c:function(){t=g("h3"),t.textContent=e,i=T(),n=g("p"),n.textContent=s,a=T(),l=g("div"),o=g("button"),o.textContent=v,this.h()},l:function(C){t=b(C,"H3",{class:!0,"data-svelte-h":!0}),O(t)!=="svelte-11dam81"&&(t.textContent=e),i=L(C),n=b(C,"P",{class:!0,"data-svelte-h":!0}),O(n)!=="svelte-5idwhi"&&(n.textContent=s),a=L(C),l=b(C,"DIV",{class:!0});var p=k(l);o=b(p,"BUTTON",{class:!0,"data-svelte-h":!0}),O(o)!=="svelte-1oiqs6i"&&(o.textContent=v),p.forEach(u),this.h()},h:function(){f(t,"class","ready-title svelte-1byxpqw"),_(t,y,276,12,8113),f(n,"class","ready-description svelte-1byxpqw"),_(n,y,277,12,8162),f(o,"class","training-start-button enabled svelte-1byxpqw"),_(o,y,280,14,8308),f(l,"class","training-start-button-area svelte-1byxpqw"),_(l,y,279,12,8253)},m:function(C,p){q(C,t,p),q(C,i,p),q(C,n,p),q(C,a,p),q(C,l,p),d(l,o),h||(m=kt(o,"click",c[10],!1),h=!0)},p:at,d:function(C){C&&(u(t),u(i),u(n),u(a),u(l)),h=!1,m()}};return F("SvelteRegisterBlock",{block:w,id:Nt.name,type:"else",source:"(275:10) {:else}",ctx:c}),w}function Lt(c){let t,e;function i(h,m){return h[3]==="granted"&&h[4]&&(!h[0]||!h[1])?zt:Tt}let n=i(c),s=n(c);function a(h,m){if(h[3]==="pending")return Gt;if(h[3]==="denied")return jt;if(h[3]==="initial")return Ht}let l=a(c),o=l&&l(c);const v={c:function(){s.c(),t=T(),o&&o.c(),e=Ft()},l:function(m){s.l(m),t=L(m),o&&o.l(m),e=Ft()},m:function(m,w){s.m(m,w),q(m,t,w),o&&o.m(m,w),q(m,e,w)},p:function(m,w){n!==(n=i(m))&&(s.d(1),s=n(m),s&&(s.c(),s.m(t.parentNode,t))),l===(l=a(m))&&o?o.p(m,w):(o&&o.d(1),o=l&&l(m),o&&(o.c(),o.m(e.parentNode,e)))},d:function(m){m&&(u(t),u(e)),s.d(m),o&&o.d(m)}};return F("SvelteRegisterBlock",{block:v,id:Lt.name,type:"if",source:"(249:10) {#if !audioConfirmationComplete}",ctx:c}),v}function Tt(c){let t,e="マイクのテストを開始します",i,n,s="マイクテスト開始ボタンを押してマイクの使用を許可してください";const a={c:function(){t=g("h3"),t.textContent=e,i=T(),n=g("p"),n.textContent=s,this.h()},l:function(o){t=b(o,"H3",{class:!0,"data-svelte-h":!0}),O(t)!=="svelte-gfi16f"&&(t.textContent=e),i=L(o),n=b(o,"P",{class:!0,"data-svelte-h":!0}),O(n)!=="svelte-1w19y1h"&&(n.textContent=s),this.h()},h:function(){f(t,"class","instructions-title svelte-1byxpqw"),_(t,y,255,14,7250),f(n,"class","instructions-description svelte-1byxpqw"),_(n,y,256,14,7314)},m:function(o,v){q(o,t,v),q(o,i,v),q(o,n,v)},d:function(o){o&&(u(t),u(i),u(n))}};return F("SvelteRegisterBlock",{block:a,id:Tt.name,type:"else",source:"(254:12) {:else}",ctx:c}),a}function zt(c){let t,e="「ドー」と発声してください";const i={c:function(){t=g("p"),t.textContent=e,this.h()},l:function(s){t=b(s,"P",{class:!0,"data-svelte-h":!0}),O(t)!=="svelte-15d2sx7"&&(t.textContent=e),this.h()},h:function(){f(t,"class","status-text voice-instruction svelte-1byxpqw"),_(t,y,252,14,7122)},m:function(s,a){q(s,t,a)},d:function(s){s&&u(t)}};return F("SvelteRegisterBlock",{block:i,id:zt.name,type:"if",source:"(251:12) {#if micPermission === 'granted' && isListening && (!volumeDetected || !frequencyDetected)}",ctx:c}),i}function Ht(c){let t,e,i="マイクテストを開始",n,s;const a={c:function(){t=g("div"),e=g("button"),e.textContent=i,this.h()},l:function(o){t=b(o,"DIV",{class:!0});var v=k(t);e=b(v,"BUTTON",{class:!0,"data-svelte-h":!0}),O(e)!=="svelte-caex95"&&(e.textContent=i),v.forEach(u),this.h()},h:function(){f(e,"class","mic-test-button start svelte-1byxpqw"),_(e,y,269,16,7887),f(t,"class","mic-test-button-area svelte-1byxpqw"),_(t,y,268,14,7836)},m:function(o,v){q(o,t,v),d(t,e),n||(s=kt(e,"click",c[9],!1),n=!0)},p:at,d:function(o){o&&u(t),n=!1,s()}};return F("SvelteRegisterBlock",{block:a,id:Ht.name,type:"if",source:"(268:50) ",ctx:c}),a}function jt(c){let t,e,i="マイク許可を再試行",n,s;const a={c:function(){t=g("div"),e=g("button"),e.textContent=i,this.h()},l:function(o){t=b(o,"DIV",{class:!0});var v=k(t);e=b(v,"BUTTON",{class:!0,"data-svelte-h":!0}),O(e)!=="svelte-1p3n8nt"&&(e.textContent=i),v.forEach(u),this.h()},h:function(){f(e,"class","mic-test-button retry svelte-1byxpqw"),_(e,y,263,16,7628),f(t,"class","mic-test-button-area svelte-1byxpqw"),_(t,y,262,14,7577)},m:function(o,v){q(o,t,v),d(t,e),n||(s=kt(e,"click",c[9],!1),n=!0)},p:at,d:function(o){o&&u(t),n=!1,s()}};return F("SvelteRegisterBlock",{block:a,id:jt.name,type:"if",source:"(262:49) ",ctx:c}),a}function Gt(c){let t,e="マイク準備中...";const i={c:function(){t=g("p"),t.textContent=e,this.h()},l:function(s){t=b(s,"P",{class:!0,"data-svelte-h":!0}),O(t)!=="svelte-1vb5g92"&&(t.textContent=e),this.h()},h:function(){f(t,"class","status-text svelte-1byxpqw"),_(t,y,260,14,7476)},m:function(s,a){q(s,t,a)},p:at,d:function(s){s&&u(t)}};return F("SvelteRegisterBlock",{block:i,id:Gt.name,type:"if",source:"(260:12) {#if micPermission === 'pending'}",ctx:c}),i}function Ot(c){let t;function e(a,l){return a[2]?Nt:Lt}let i=e(c),n=i(c);const s={c:function(){t=g("div"),n.c(),this.h()},l:function(l){t=b(l,"DIV",{class:!0});var o=k(t);n.l(o),o.forEach(u),this.h()},h:function(){f(t,"class","training-mode-content svelte-1byxpqw"),_(t,y,247,8,6857)},m:function(l,o){q(l,t,o),n.m(t,null)},p:function(l,o){i===(i=e(l))&&n?n.p(l,o):(n.d(1),n=i(l),n&&(n.c(),n.m(t,null)))},d:function(l){l&&u(t),n.d()}};return F("SvelteRegisterBlock",{block:s,id:Ot.name,type:"slot",source:'(247:6) <Card variant=\\"default\\" padding=\\"lg\\">',ctx:c}),s}function Ut(c){let t;const e={c:function(){t=J(" ")},l:function(n){t=U(n," ")},m:function(n,s){q(n,t,s)},d:function(n){n&&u(t)}};return F("SvelteRegisterBlock",{block:e,id:Ut.name,type:"else",source:"(311:18) {:else}",ctx:c}),e}function Jt(c){let t;const e={c:function(){t=J("マイクテスト開始後に表示されます")},l:function(n){t=U(n,"マイクテスト開始後に表示されます")},m:function(n,s){q(n,t,s)},d:function(n){n&&u(t)}};return F("SvelteRegisterBlock",{block:e,id:Jt.name,type:"if",source:"(309:41) ",ctx:c}),e}function Zt(c){let t;const e={c:function(){t=J("⏳ 声を出して音量を確認してください")},l:function(n){t=U(n,"⏳ 声を出して音量を確認してください")},m:function(n,s){q(n,t,s)},d:function(n){n&&u(t)}};return F("SvelteRegisterBlock",{block:e,id:Zt.name,type:"if",source:"(307:18) {#if !volumeDetected && isListening}",ctx:c}),e}function Kt(c){let t;const e={c:function(){t=J(" ")},l:function(n){t=U(n," ")},m:function(n,s){q(n,t,s)},d:function(n){n&&u(t)}};return F("SvelteRegisterBlock",{block:e,id:Kt.name,type:"else",source:"(331:18) {:else}",ctx:c}),e}function Qt(c){let t;const e={c:function(){t=J("マイクテスト開始後に表示されます")},l:function(n){t=U(n,"マイクテスト開始後に表示されます")},m:function(n,s){q(n,t,s)},d:function(n){n&&u(t)}};return F("SvelteRegisterBlock",{block:e,id:Qt.name,type:"if",source:"(329:41) ",ctx:c}),e}function Wt(c){let t;const e={c:function(){t=J("⏳ 「ド」を発声して音程を確認してください")},l:function(n){t=U(n,"⏳ 「ド」を発声して音程を確認してください")},m:function(n,s){q(n,t,s)},d:function(n){n&&u(t)}};return F("SvelteRegisterBlock",{block:e,id:Wt.name,type:"if",source:"(327:18) {#if !frequencyDetected && isListening}",ctx:c}),e}function Xt(c){let t,e,i,n,s="音量レベル",a,l,o,v,h,m=c[5].toFixed(1)+"",w,A,C,p,V,E,x,S,Z="音程検出",z,B,M,K=c[6].toFixed(1)+"",H,r,D,R,j,Q,I,P;function nt(G,N){return!G[0]&&G[4]?Zt:G[4]?Ut:Jt}let tt=nt(c),W=tt(c);function wt(G,N){return!G[1]&&G[4]?Wt:G[4]?Kt:Qt}let st=wt(c),X=st(c);const Ct={c:function(){t=g("div"),e=g("div"),i=g("div"),n=g("h3"),n.textContent=s,a=T(),l=g("div"),o=g("div"),v=T(),h=g("div"),w=J(m),A=J("%"),C=T(),p=g("div"),V=g("span"),W.c(),E=T(),x=g("div"),S=g("h3"),S.textContent=Z,z=T(),B=g("div"),M=g("div"),H=J(K),r=J(" Hz"),D=T(),R=g("div"),j=J(c[7]),Q=T(),I=g("div"),P=g("span"),X.c(),this.h()},l:function(N){t=b(N,"DIV",{class:!0});var Y=k(t);e=b(Y,"DIV",{class:!0});var lt=k(e);i=b(lt,"DIV",{class:!0});var $=k(i);n=b($,"H3",{class:!0,"data-svelte-h":!0}),O(n)!=="svelte-1nc8gri"&&(n.textContent=s),a=L($),l=b($,"DIV",{class:!0});var xt=k(l);o=b(xt,"DIV",{class:!0,style:!0}),k(o).forEach(u),xt.forEach(u),v=L($),h=b($,"DIV",{class:!0});var rt=k(h);w=U(rt,m),A=U(rt,"%"),rt.forEach(u),C=L($),p=b($,"DIV",{class:!0});var qt=k(p);V=b(qt,"SPAN",{class:!0});var Dt=k(V);W.l(Dt),Dt.forEach(u),qt.forEach(u),$.forEach(u),E=L(lt),x=b(lt,"DIV",{class:!0});var et=k(x);S=b(et,"H3",{class:!0,"data-svelte-h":!0}),O(S)!=="svelte-1ofzoy2"&&(S.textContent=Z),z=L(et),B=b(et,"DIV",{class:!0});var ct=k(B);M=b(ct,"DIV",{class:!0});var ut=k(M);H=U(ut,K),r=U(ut," Hz"),ut.forEach(u),D=L(ct),R=b(ct,"DIV",{class:!0});var Et=k(R);j=U(Et,c[7]),Et.forEach(u),ct.forEach(u),Q=L(et),I=b(et,"DIV",{class:!0});var Bt=k(I);P=b(Bt,"SPAN",{class:!0});var St=k(P);X.l(St),St.forEach(u),Bt.forEach(u),et.forEach(u),lt.forEach(u),Y.forEach(u),this.h()},h:function(){f(n,"class","display-title svelte-1byxpqw"),_(n,y,299,14,8846),f(o,"class","volume-bar svelte-1byxpqw"),Pt(o,"width",c[5]+"%"),_(o,y,301,16,8948),f(l,"class","volume-bar-container svelte-1byxpqw"),_(l,y,300,14,8897),f(h,"class","volume-text svelte-1byxpqw"),_(h,y,303,14,9046),f(V,"class","status-pending svelte-1byxpqw"),_(V,y,305,16,9163),f(p,"class","volume-status svelte-1byxpqw"),_(p,y,304,14,9119),f(i,"class","volume-section svelte-1byxpqw"),_(i,y,298,12,8803),f(S,"class","display-title svelte-1byxpqw"),_(S,y,319,14,9596),f(M,"class","frequency-value svelte-1byxpqw"),_(M,y,321,16,9694),f(R,"class","note-value svelte-1byxpqw"),_(R,y,322,16,9778),f(B,"class","frequency-display svelte-1byxpqw"),_(B,y,320,14,9646),f(P,"class","status-pending svelte-1byxpqw"),_(P,y,325,16,9904),f(I,"class","frequency-status svelte-1byxpqw"),_(I,y,324,14,9857),f(x,"class","frequency-section"),_(x,y,318,12,9550),f(e,"class","realtime-display svelte-1byxpqw"),_(e,y,296,10,8733),f(t,"class","mic-test-content svelte-1byxpqw"),_(t,y,292,8,8646)},m:function(N,Y){q(N,t,Y),d(t,e),d(e,i),d(i,n),d(i,a),d(i,l),d(l,o),d(i,v),d(i,h),d(h,w),d(h,A),d(i,C),d(i,p),d(p,V),W.m(V,null),d(e,E),d(e,x),d(x,S),d(x,z),d(x,B),d(B,M),d(M,H),d(M,r),d(B,D),d(B,R),d(R,j),d(x,Q),d(x,I),d(I,P),X.m(P,null)},p:function(N,Y){Y&32&&Pt(o,"width",N[5]+"%"),Y&32&&m!==(m=N[5].toFixed(1)+"")&&ft(w,m),tt!==(tt=nt(N))&&(W.d(1),W=tt(N),W&&(W.c(),W.m(V,null))),Y&64&&K!==(K=N[6].toFixed(1)+"")&&ft(H,K),Y&128&&ft(j,N[7]),st!==(st=wt(N))&&(X.d(1),X=st(N),X&&(X.c(),X.m(P,null)))},d:function(N){N&&u(t),W.d(),X.d()}};return F("SvelteRegisterBlock",{block:Ct,id:Xt.name,type:"slot",source:'(292:6) <Card variant=\\"default\\" padding=\\"lg\\">',ctx:c}),Ct}function Yt(c){let t,e,i,n,s,a,l,o,v,h,m,w,A="マイクテスト",C,p,V="音感トレーニングを始める前に、マイクの動作を確認します",E,x,S,Z,z,B,M;S=new bt({props:{variant:"default",padding:"lg",$$slots:{default:[Ot]},$$scope:{ctx:c}},$$inline:!0}),B=new bt({props:{variant:"default",padding:"lg",$$slots:{default:[Xt]},$$scope:{ctx:c}},$$inline:!0});const K={c:function(){t=g("div"),e=g("div"),i=g("div"),n=g("div"),s=ot("svg"),a=ot("path"),l=ot("path"),o=ot("line"),v=ot("line"),h=T(),m=g("div"),w=g("h1"),w.textContent=A,C=T(),p=g("p"),p.textContent=V,E=T(),x=g("div"),pt(S.$$.fragment),Z=T(),z=g("div"),pt(B.$$.fragment),this.h()},l:function(r){t=b(r,"DIV",{class:!0});var D=k(t);e=b(D,"DIV",{class:!0});var R=k(e);i=b(R,"DIV",{class:!0});var j=k(i);n=b(j,"DIV",{class:!0});var Q=k(n);s=it(Q,"svg",{width:!0,height:!0,viewBox:!0,fill:!0,stroke:!0,"stroke-width":!0});var I=k(s);a=it(I,"path",{d:!0}),k(a).forEach(u),l=it(I,"path",{d:!0}),k(l).forEach(u),o=it(I,"line",{x1:!0,x2:!0,y1:!0,y2:!0}),k(o).forEach(u),v=it(I,"line",{x1:!0,x2:!0,y1:!0,y2:!0}),k(v).forEach(u),I.forEach(u),Q.forEach(u),h=L(j),m=b(j,"DIV",{});var P=k(m);w=b(P,"H1",{class:!0,"data-svelte-h":!0}),O(w)!=="svelte-z7m4lk"&&(w.textContent=A),C=L(P),p=b(P,"P",{class:!0,"data-svelte-h":!0}),O(p)!=="svelte-1vtv92f"&&(p.textContent=V),P.forEach(u),j.forEach(u),R.forEach(u),E=L(D),x=b(D,"DIV",{class:!0});var nt=k(x);yt(S.$$.fragment,nt),nt.forEach(u),Z=L(D),z=b(D,"DIV",{class:!0});var tt=k(z);yt(B.$$.fragment,tt),tt.forEach(u),D.forEach(u),this.h()},h:function(){f(a,"d","M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z"),_(a,y,231,12,6315),f(l,"d","M19 10v2a7 7 0 0 1-14 0v-2"),_(l,y,232,12,6392),f(o,"x1","12"),f(o,"x2","12"),f(o,"y1","19"),f(o,"y2","22"),_(o,y,233,12,6443),f(v,"x1","8"),f(v,"x2","16"),f(v,"y1","22"),f(v,"y2","22"),_(v,y,234,12,6495),f(s,"width","48"),f(s,"height","48"),f(s,"viewBox","0 0 24 24"),f(s,"fill","none"),f(s,"stroke","currentColor"),f(s,"stroke-width","2"),_(s,y,230,10,6203),f(n,"class","mic-icon svelte-1byxpqw"),_(n,y,229,8,6170),f(w,"class","mic-test-title svelte-1byxpqw"),_(w,y,238,10,6590),f(p,"class","mic-test-description svelte-1byxpqw"),_(p,y,239,10,6639),_(m,y,237,8,6574),f(i,"class","mic-test-header svelte-1byxpqw"),_(i,y,228,6,6132),f(e,"class","header svelte-1byxpqw"),_(e,y,227,4,6105),f(x,"class","training-mode-info svelte-1byxpqw"),_(x,y,245,4,6772),f(z,"class","test-section"),_(z,y,290,4,8567),f(t,"class","microphone-test svelte-1byxpqw"),_(t,y,225,2,6053)},m:function(r,D){q(r,t,D),d(t,e),d(e,i),d(i,n),d(n,s),d(s,a),d(s,l),d(s,o),d(s,v),d(i,h),d(i,m),d(m,w),d(m,C),d(m,p),d(t,E),d(t,x),_t(S,x,null),d(t,Z),d(t,z),_t(B,z,null),M=!0},p:function(r,D){const R={};D&1048607&&(R.$$scope={dirty:D,ctx:r}),S.$set(R);const j={};D&1048819&&(j.$$scope={dirty:D,ctx:r}),B.$set(j)},i:function(r){M||(ht(S.$$.fragment,r),ht(B.$$.fragment,r),M=!0)},o:function(r){vt(S.$$.fragment,r),vt(B.$$.fragment,r),M=!1},d:function(r){r&&u(t),mt(S),mt(B)}};return F("SvelteRegisterBlock",{block:K,id:Yt.name,type:"slot",source:"(225:0) <PageLayout showBackButton={true}>",ctx:c}),K}function gt(c){let t,e,i;e=new Rt({props:{showBackButton:!0,$$slots:{default:[Yt]},$$scope:{ctx:c}},$$inline:!0});const n={c:function(){t=T(),pt(e.$$.fragment),this.h()},l:function(a){se("svelte-8st1fo",document.head).forEach(u),t=L(a),yt(e.$$.fragment,a),this.h()},h:function(){document.title="マイクテスト - 相対音感トレーニング"},m:function(a,l){q(a,t,l),_t(e,a,l),i=!0},p:function(a,[l]){const o={};l&1048831&&(o.$$scope={dirty:l,ctx:a}),e.$set(o)},i:function(a){i||(ht(e.$$.fragment,a),i=!0)},o:function(a){vt(e.$$.fragment,a),i=!1},d:function(a){a&&u(t),mt(e,a)}};return F("SvelteRegisterBlock",{block:n,id:gt.name,type:"component",source:"",ctx:c}),n}function At(c,t){let e=0;for(let l=0;l<c.length;l++)e+=c[l]*c[l];if(e=Math.sqrt(e/c.length),e<.005)return 0;const i=Math.floor(t/800),n=Math.floor(t/80);let s=0,a=0;for(let l=i;l<=n;l++){let o=0,v=0;for(let h=0;h<c.length-l;h++)o+=c[h]*c[h+l],v+=c[h]*c[h];v>0&&(o=o/Math.sqrt(v),o>s&&(s=o,a=l))}return s>.25?t/a:0}function Mt(c){const e=Math.round(12*Math.log2(c/440)),i=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],n=((e+9)%12+12)%12,s=Math.floor((e+9)/12)+4,a=i[n];return`${a}${s}（${{C:"ド","C#":"ド#",D:"レ","D#":"レ#",E:"ミ",F:"ファ","F#":"ファ#",G:"ソ","G#":"ソ#",A:"ラ","A#":"ラ#",B:"シ"}[a]}${s}）`}function ce(c,t,e){let i;ne(dt,"page"),ie(c,dt,r=>e(16,i=r));let{$$slots:n={},$$scope:s}=t;oe("Page",n,[]);let a="random";Vt(()=>{i.url.searchParams.has("mode")&&(a=i.url.searchParams.get("mode")||"random")});let l="initial",o=!1,v=!1,h=!1,m=!1,w=0,A=0,C="",p=null,V=null,E=null,x=null;const S={random:{name:"ランダム基音モード",description:"10種類の基音からランダムに選択してトレーニング",color:"green",path:"./training/random"},continuous:{name:"連続チャレンジモード",description:"選択した回数だけ連続で実行し、総合評価を確認",color:"orange",path:"./training/continuous"},chromatic:{name:"12音階モード",description:"クロマチックスケールの上行・下行で完全制覇",color:"purple",path:"./training/chromatic"}},Z=S[a]||S.random;async function z(){e(3,l="pending");try{V=await navigator.mediaDevices.getUserMedia({audio:!0}),e(3,l="granted"),p=new(window.AudioContext||window.webkitAudioContext),p.state==="suspended"&&await p.resume(),E=p.createAnalyser(),E.fftSize=2048,E.smoothingTimeConstant=.8,E.minDecibels=-90,E.maxDecibels=-10,p.createMediaStreamSource(V).connect(E),e(4,o=!0),B()}catch{e(3,l="denied")}}function B(){if(!o||!E)return;const r=E.frequencyBinCount,D=new Uint8Array(r);E.getByteFrequencyData(D);let R=0;for(let P=0;P<D.length;P++)R+=D[P]*D[P];const j=Math.sqrt(R/D.length);e(5,w=Math.min(100,j/64*100)),w>15&&e(0,v=!0);const Q=new Float32Array(E.fftSize);E.getFloatTimeDomainData(Q);const I=At(Q,p.sampleRate);I>80&&I<800?(e(6,A=I),e(7,C=Mt(I)),e(1,h=!0)):(e(6,A=0),e(7,C="")),x=requestAnimationFrame(B)}function M(){e(4,o=!1),x&&(cancelAnimationFrame(x),x=null),V&&(V.getTracks().forEach(r=>r.stop()),V=null),p&&p.state!=="closed"&&(p.close(),p=null),E=null}It(()=>{M()});const K=[];Object.keys(t).forEach(r=>{!~K.indexOf(r)&&r.slice(0,2)!=="$$"&&r!=="slot"&&console.warn(`<Page> was created with unknown prop '${r}'`)});const H=()=>window.location.href=Z.path;return c.$capture_state=()=>({onMount:Vt,onDestroy:It,page:dt,Card:bt,Button:le,PageLayout:Rt,mode:a,micPermission:l,isListening:o,volumeDetected:v,frequencyDetected:h,audioConfirmationComplete:m,currentVolume:w,currentFrequency:A,currentNote:C,audioContext:p,mediaStream:V,analyser:E,animationFrame:x,trainingModes:S,selectedMode:Z,requestMicrophone:z,analyzeAudio:B,detectPitch:At,frequencyToNote:Mt,stopListening:M,$page:i}),c.$inject_state=r=>{"mode"in r&&(a=r.mode),"micPermission"in r&&e(3,l=r.micPermission),"isListening"in r&&e(4,o=r.isListening),"volumeDetected"in r&&e(0,v=r.volumeDetected),"frequencyDetected"in r&&e(1,h=r.frequencyDetected),"audioConfirmationComplete"in r&&e(2,m=r.audioConfirmationComplete),"currentVolume"in r&&e(5,w=r.currentVolume),"currentFrequency"in r&&e(6,A=r.currentFrequency),"currentNote"in r&&e(7,C=r.currentNote),"audioContext"in r&&(p=r.audioContext),"mediaStream"in r&&(V=r.mediaStream),"analyser"in r&&(E=r.analyser),"animationFrame"in r&&(x=r.animationFrame)},t&&"$$inject"in t&&c.$inject_state(t.$$inject),c.$$.update=()=>{c.$$.dirty&7&&v&&h&&!m&&e(2,m=!0)},[v,h,m,l,o,w,A,C,Z,z,H]}class de extends $t{constructor(t){super(t),te(this,t,ce,gt,ee,{}),F("SvelteRegisterComponent",{component:this,tagName:"Page",options:t,id:gt.name})}}export{de as component};
