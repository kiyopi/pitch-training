import{S as ne,i as oe,d as M,s as ie,v as le,c as se,a as ce,D as ht,E as Et,b as v,q as lt,r as X,u as K,f as b,w as st,F as re,m as R,x as ct,p as L,y as rt,g as h,z as m,h as g,j as y,k as w,B as at,A as N,o as p,C as ut,G as It,H as Pt,l as Y,t as Q,n as nt,e as _t,I as vt,J as ft,K as dt}from"../chunks/EvMzC0aQ.js";import{g as ae}from"../chunks/D0QH3NT1.js";import"../chunks/DrEUfQCr.js";import{p as gt}from"../chunks/B_eoGFHy.js";import{P as Mt,B as zt,C as yt}from"../chunks/yXPAb40O.js";import{P as ue,V as Ft}from"../chunks/sE10pGVB.js";const{console:fe}=ae,_="src/routes/microphone-test/+page.svelte";function Rt(c){let t,n="üé§ „Éû„Ç§„ÇØ„ÉÜ„Çπ„Éà„ÇíÈñãÂßã„Åó„Å¶„Åè„Å†„Åï„ÅÑ",s,e,i="„Éû„Ç§„ÇØË®±ÂèØ„ÇíÂèñÂæó",l,r;const u={c:function(){t=p("div"),t.textContent=n,s=L(),e=p("button"),e.textContent=i,this.h()},l:function(o){t=y(o,"DIV",{class:!0,"data-svelte-h":!0}),N(t)!=="svelte-1trsgl3"&&(t.textContent=n),s=R(o),e=y(o,"BUTTON",{class:!0,"data-svelte-h":!0}),N(e)!=="svelte-1m6icav"&&(e.textContent=i),this.h()},h:function(){m(t,"class","status-indicator pending svelte-ztuqv4"),g(t,_,485,14,14792),m(e,"class","retry-button svelte-ztuqv4"),g(e,_,486,14,14869)},m:function(o,a){b(o,t,a),b(o,s,a),b(o,e,a),l||(r=ft(e,"click",c[11],!1),l=!0)},p:nt,d:function(o){o&&(v(t),v(s),v(e)),l=!1,r()}};return M("SvelteRegisterBlock",{block:u,id:Rt.name,type:"else",source:"(485:12) {:else}",ctx:c}),u}function Lt(c){let t,n="‚ùå „Éû„Ç§„ÇØ„Ç¢„ÇØ„Çª„Çπ„Ç®„É©„Éº„ÅåÁô∫Áîü„Åó„Åæ„Åó„Åü",s,e,i="„Éû„Ç§„ÇØË®±ÂèØ„ÇíÂÜçË©¶Ë°å",l,r;const u={c:function(){t=p("div"),t.textContent=n,s=L(),e=p("button"),e.textContent=i,this.h()},l:function(o){t=y(o,"DIV",{class:!0,"data-svelte-h":!0}),N(t)!=="svelte-11p6bhs"&&(t.textContent=n),s=R(o),e=y(o,"BUTTON",{class:!0,"data-svelte-h":!0}),N(e)!=="svelte-1co4n23"&&(e.textContent=i),this.h()},h:function(){m(t,"class","status-indicator error svelte-ztuqv4"),g(t,_,480,14,14573),m(e,"class","retry-button svelte-ztuqv4"),g(e,_,481,14,14649)},m:function(o,a){b(o,t,a),b(o,s,a),b(o,e,a),l||(r=ft(e,"click",c[11],!1),l=!0)},p:nt,d:function(o){o&&(v(t),v(s),v(e)),l=!1,r()}};return M("SvelteRegisterBlock",{block:u,id:Lt.name,type:"if",source:"(480:48) ",ctx:c}),u}function Nt(c){let t,n="‚ùå „Éû„Ç§„ÇØ„Ç¢„ÇØ„Çª„Çπ„ÅåÊãíÂê¶„Åï„Çå„Åæ„Åó„Åü",s,e,i="„Éû„Ç§„ÇØË®±ÂèØ„ÇíÂÜçË©¶Ë°å",l,r;const u={c:function(){t=p("div"),t.textContent=n,s=L(),e=p("button"),e.textContent=i,this.h()},l:function(o){t=y(o,"DIV",{class:!0,"data-svelte-h":!0}),N(t)!=="svelte-4rewx4"&&(t.textContent=n),s=R(o),e=y(o,"BUTTON",{class:!0,"data-svelte-h":!0}),N(e)!=="svelte-1co4n23"&&(e.textContent=i),this.h()},h:function(){m(t,"class","status-indicator error svelte-ztuqv4"),g(t,_,475,14,14327),m(e,"class","retry-button svelte-ztuqv4"),g(e,_,476,14,14401)},m:function(o,a){b(o,t,a),b(o,s,a),b(o,e,a),l||(r=ft(e,"click",c[11],!1),l=!0)},p:nt,d:function(o){o&&(v(t),v(s),v(e)),l=!1,r()}};return M("SvelteRegisterBlock",{block:u,id:Nt.name,type:"if",source:"(475:49) ",ctx:c}),u}function Tt(c){let t,n="‚úÖ „Éû„Ç§„ÇØ„Ç¢„ÇØ„Çª„ÇπË®±ÂèØÊ∏à„Åø",s,e;function i(f,o){if(!f[3]&&!f[4])return Ut;if(!f[3]&&f[4])return Ot;if(f[3])return jt}let l=i(c),r=l&&l(c);const u={c:function(){t=p("div"),t.textContent=n,s=L(),r&&r.c(),e=vt(),this.h()},l:function(o){t=y(o,"DIV",{class:!0,"data-svelte-h":!0}),N(t)!=="svelte-96x1w2"&&(t.textContent=n),s=R(o),r&&r.l(o),e=vt(),this.h()},h:function(){m(t,"class","status-indicator granted svelte-ztuqv4"),g(t,_,460,14,13521)},m:function(o,a){b(o,t,a),b(o,s,a),r&&r.m(o,a),b(o,e,a)},p:function(o,a){l===(l=i(o))&&r?r.p(o,a):(r&&r.d(1),r=l&&l(o),r&&(r.c(),r.m(e.parentNode,e)))},d:function(o){o&&(v(t),v(s),v(e)),r&&r.d(o)}};return M("SvelteRegisterBlock",{block:u,id:Tt.name,type:"if",source:"(460:50) ",ctx:c}),u}function Ht(c){let t,n="‚è≥ „Éû„Ç§„ÇØË®±ÂèØ„ÇíÁ¢∫Ë™ç‰∏≠...";const s={c:function(){t=p("div"),t.textContent=n,this.h()},l:function(i){t=y(i,"DIV",{class:!0,"data-svelte-h":!0}),N(t)!=="svelte-qiomfc"&&(t.textContent=n),this.h()},h:function(){m(t,"class","status-indicator pending svelte-ztuqv4"),g(t,_,458,14,13397)},m:function(i,l){b(i,t,l)},p:nt,d:function(i){i&&v(t)}};return M("SvelteRegisterBlock",{block:s,id:Ht.name,type:"if",source:"(458:12) {#if micPermission === 'pending'}",ctx:c}),s}function jt(c){let t,n="üé§ „É™„Ç¢„É´„Çø„Ç§„É†Ëß£Êûê‰∏≠";const s={c:function(){t=p("div"),t.textContent=n,this.h()},l:function(i){t=y(i,"DIV",{class:!0,"data-svelte-h":!0}),N(t)!=="svelte-bm11qy"&&(t.textContent=n),this.h()},h:function(){m(t,"class","status-indicator success svelte-ztuqv4"),g(t,_,472,16,14186)},m:function(i,l){b(i,t,l)},p:nt,d:function(i){i&&v(t)}};return M("SvelteRegisterBlock",{block:s,id:jt.name,type:"if",source:"(472:36) ",ctx:c}),s}function Ot(c){let t,n="‚ö†Ô∏è Èü≥Â£∞„Ç≥„É≥„ÉÜ„Ç≠„Çπ„Éà„Åå„Éñ„É≠„ÉÉ„ÇØ„Åï„Çå„Å¶„ÅÑ„Åæ„Åô",s,e,i="Èü≥Â£∞Ê©üËÉΩ„ÇíÂÜçË©¶Ë°å",l,r;const u={c:function(){t=p("div"),t.textContent=n,s=L(),e=p("button"),e.textContent=i,this.h()},l:function(o){t=y(o,"DIV",{class:!0,"data-svelte-h":!0}),N(t)!=="svelte-rn7aam"&&(t.textContent=n),s=R(o),e=y(o,"BUTTON",{class:!0,"data-svelte-h":!0}),N(e)!=="svelte-hrmonq"&&(e.textContent=i),this.h()},h:function(){m(t,"class","status-indicator warning svelte-ztuqv4"),g(t,_,467,16,13930),m(e,"class","retry-button svelte-ztuqv4"),g(e,_,468,16,14013)},m:function(o,a){b(o,t,a),b(o,s,a),b(o,e,a),l||(r=ft(e,"click",c[12],!1),l=!0)},p:nt,d:function(o){o&&(v(t),v(s),v(e)),l=!1,r()}};return M("SvelteRegisterBlock",{block:u,id:Ot.name,type:"if",source:"(467:60) ",ctx:c}),u}function Ut(c){let t,n="üéµ Èü≥Â£∞Ê©üËÉΩ„ÇíÈñãÂßã„Åó„Å¶„Åè„Å†„Åï„ÅÑ",s,e,i="üé§ „Éû„Ç§„ÇØ„ÉÜ„Çπ„Éà„ÇíÈñãÂßã",l,r;const u={c:function(){t=p("div"),t.textContent=n,s=L(),e=p("button"),e.textContent=i,this.h()},l:function(o){t=y(o,"DIV",{class:!0,"data-svelte-h":!0}),N(t)!=="svelte-13wnluo"&&(t.textContent=n),s=R(o),e=y(o,"BUTTON",{class:!0,"data-svelte-h":!0}),N(e)!=="svelte-4juur8"&&(e.textContent=i),this.h()},h:function(){m(t,"class","status-indicator warning svelte-ztuqv4"),g(t,_,462,16,13652),m(e,"class","retry-button svelte-ztuqv4"),g(e,_,463,16,13729)},m:function(o,a){b(o,t,a),b(o,s,a),b(o,e,a),l||(r=ft(e,"click",c[12],!1),l=!0)},p:nt,d:function(o){o&&(v(t),v(s),v(e)),l=!1,r()}};return M("SvelteRegisterBlock",{block:u,id:Ut.name,type:"if",source:"(462:14) {#if !isListening && !audioContextBlocked}",ctx:c}),u}function pt(c){let t,n,s,e="Èü≥Èáè„É¨„Éô„É´",i,l,r,u,f,o,a,C="Èü≥Á®ãÊ§úÂá∫",x,k,S,j=c[6].toFixed(1)+"",A,B,D,O,q,U,T,G,W,I,P;l=new Ft({props:{volume:c[5],height:"16px",className:"volume-bar-wrapper"},$$inline:!0});let V=!c[1]&&Ct(c),E=c[8]>0&&kt(c);function et(J,z){return J[2]?J[8]<50?Wt:Gt:Jt}let d=et(c),H=d(c),F=c[1]&&!c[2]&&bt(c);const $={c:function(){t=p("div"),n=p("div"),s=p("h3"),s.textContent=e,i=L(),rt(l.$$.fragment),r=L(),u=p("div"),V&&V.c(),f=L(),o=p("div"),a=p("h3"),a.textContent=C,x=L(),k=p("div"),S=p("div"),A=Q(j),B=Q(" Hz"),D=L(),O=p("div"),q=Q(c[7]),U=L(),E&&E.c(),T=L(),G=p("div"),H.c(),W=L(),F&&F.c(),I=vt(),this.h()},l:function(z){t=y(z,"DIV",{class:!0});var Z=w(t);n=y(Z,"DIV",{class:!0});var tt=w(n);s=y(tt,"H3",{class:!0,"data-svelte-h":!0}),N(s)!=="svelte-1nc8gri"&&(s.textContent=e),i=R(tt),ct(l.$$.fragment,tt),r=R(tt),u=y(tt,"DIV",{class:!0});var wt=w(u);V&&V.l(wt),wt.forEach(v),tt.forEach(v),f=R(Z),o=y(Z,"DIV",{class:!0});var ot=w(o);a=y(ot,"H3",{class:!0,"data-svelte-h":!0}),N(a)!=="svelte-1ofzoy2"&&(a.textContent=C),x=R(ot),k=y(ot,"DIV",{class:!0});var it=w(k);S=y(it,"DIV",{class:!0});var mt=w(S);A=Y(mt,j),B=Y(mt," Hz"),mt.forEach(v),D=R(it),O=y(it,"DIV",{class:!0});var Bt=w(O);q=Y(Bt,c[7]),Bt.forEach(v),U=R(it),E&&E.l(it),it.forEach(v),T=R(ot),G=y(ot,"DIV",{class:!0});var Dt=w(G);H.l(Dt),Dt.forEach(v),ot.forEach(v),Z.forEach(v),W=R(z),F&&F.l(z),I=vt(),this.h()},h:function(){m(s,"class","display-title svelte-ztuqv4"),g(s,_,497,16,15231),m(u,"class","volume-status svelte-ztuqv4"),g(u,_,499,16,15382),m(n,"class","volume-section svelte-ztuqv4"),g(n,_,496,14,15186),m(a,"class","display-title svelte-ztuqv4"),g(a,_,508,16,15688),m(S,"class","frequency-value svelte-ztuqv4"),g(S,_,510,18,15790),m(O,"class","note-value svelte-ztuqv4"),g(O,_,511,18,15876),m(k,"class","frequency-display svelte-ztuqv4"),g(k,_,509,16,15740),m(G,"class","frequency-status svelte-ztuqv4"),g(G,_,524,16,16527),m(o,"class","frequency-section"),g(o,_,507,14,15640),m(t,"class","realtime-display svelte-ztuqv4"),g(t,_,494,12,15112)},m:function(z,Z){b(z,t,Z),h(t,n),h(n,s),h(n,i),st(l,n,null),h(n,r),h(n,u),V&&V.m(u,null),h(t,f),h(t,o),h(o,a),h(o,x),h(o,k),h(k,S),h(S,A),h(S,B),h(k,D),h(k,O),h(O,q),h(k,U),E&&E.m(k,null),h(o,T),h(o,G),H.m(G,null),b(z,W,Z),F&&F.m(z,Z),b(z,I,Z),P=!0},p:function(z,Z){const tt={};Z&32&&(tt.volume=z[5]),l.$set(tt),z[1]?V&&(V.d(1),V=null):V||(V=Ct(z),V.c(),V.m(u,null)),(!P||Z&64)&&j!==(j=z[6].toFixed(1)+"")&&_t(A,j),(!P||Z&128)&&_t(q,z[7]),z[8]>0?E?E.p(z,Z):(E=kt(z),E.c(),E.m(k,null)):E&&(E.d(1),E=null),d!==(d=et(z))&&(H.d(1),H=d(z),H&&(H.c(),H.m(G,null))),z[1]&&!z[2]?F||(F=bt(z),F.c(),F.m(I.parentNode,I)):F&&(F.d(1),F=null)},i:function(z){P||(K(l.$$.fragment,z),P=!0)},o:function(z){X(l.$$.fragment,z),P=!1},d:function(z){z&&(v(t),v(W),v(I)),lt(l),V&&V.d(),E&&E.d(),H.d(),F&&F.d(z)}};return M("SvelteRegisterBlock",{block:$,id:pt.name,type:"if",source:"(494:10) {#if micPermission === 'granted' && isListening}",ctx:c}),$}function Ct(c){let t,n="‚è≥ Â£∞„ÇíÂá∫„Åó„Å¶Èü≥Èáè„ÇíÁ¢∫Ë™ç„Åó„Å¶„Åè„Å†„Åï„ÅÑ";const s={c:function(){t=p("span"),t.textContent=n,this.h()},l:function(i){t=y(i,"SPAN",{class:!0,"data-svelte-h":!0}),N(t)!=="svelte-7eexnn"&&(t.textContent=n),this.h()},h:function(){m(t,"class","status-pending svelte-ztuqv4"),g(t,_,501,20,15470)},m:function(i,l){b(i,t,l)},d:function(i){i&&v(t)}};return M("SvelteRegisterBlock",{block:s,id:Ct.name,type:"if",source:"(501:18) {#if !volumeDetected}",ctx:c}),s}function kt(c){let t,n,s,e,i,l;const r={c:function(){t=p("div"),n=Q("‰ø°È†ºÂ∫¶: "),s=Q(c[8]),e=Q(`%
                      `),i=p("div"),l=p("div"),this.h()},l:function(f){t=y(f,"DIV",{class:!0});var o=w(t);n=Y(o,"‰ø°È†ºÂ∫¶: "),s=Y(o,c[8]),e=Y(o,`%
                      `),i=y(o,"DIV",{class:!0});var a=w(i);l=y(a,"DIV",{class:!0,style:!0}),w(l).forEach(v),a.forEach(v),o.forEach(v),this.h()},h:function(){m(l,"class","confidence-fill svelte-ztuqv4"),dt(l,"width",c[8]+"%"),dt(l,"background-color",c[8]>70?"#10b981":c[8]>40?"#f59e0b":"#ef4444"),g(l,_,516,24,16146),m(i,"class","confidence-bar svelte-ztuqv4"),g(i,_,515,22,16093),m(t,"class","confidence-display svelte-ztuqv4"),g(t,_,513,20,15988)},m:function(f,o){b(f,t,o),h(t,n),h(t,s),h(t,e),h(t,i),h(i,l)},p:function(f,o){o&256&&_t(s,f[8]),o&256&&dt(l,"width",f[8]+"%"),o&256&&dt(l,"background-color",f[8]>70?"#10b981":f[8]>40?"#f59e0b":"#ef4444")},d:function(f){f&&v(t)}};return M("SvelteRegisterBlock",{block:r,id:kt.name,type:"if",source:"(513:18) {#if detectionConfidence > 0}",ctx:c}),r}function Gt(c){let t,n="‚úÖ Èü≥Á®ãÊ§úÂá∫‰∏≠";const s={c:function(){t=p("span"),t.textContent=n,this.h()},l:function(i){t=y(i,"SPAN",{class:!0,"data-svelte-h":!0}),N(t)!=="svelte-acahk5"&&(t.textContent=n),this.h()},h:function(){m(t,"class","status-success svelte-ztuqv4"),g(t,_,530,20,16852)},m:function(i,l){b(i,t,l)},d:function(i){i&&v(t)}};return M("SvelteRegisterBlock",{block:s,id:Gt.name,type:"else",source:"(530:18) {:else}",ctx:c}),s}function Wt(c){let t,n="‚ö†Ô∏è „Çà„ÇäÊòéÁ¢∫„Å´Áô∫Â£∞„Åó„Å¶„Åè„Å†„Åï„ÅÑ";const s={c:function(){t=p("span"),t.textContent=n,this.h()},l:function(i){t=y(i,"SPAN",{class:!0,"data-svelte-h":!0}),N(t)!=="svelte-lq2kpp"&&(t.textContent=n),this.h()},h:function(){m(t,"class","status-warning svelte-ztuqv4"),g(t,_,528,20,16753)},m:function(i,l){b(i,t,l)},d:function(i){i&&v(t)}};return M("SvelteRegisterBlock",{block:s,id:Wt.name,type:"if",source:"(528:53) ",ctx:c}),s}function Jt(c){let t,n="‚è≥ „Äå„Éâ„Äç„ÇíÁô∫Â£∞„Åó„Å¶Èü≥Á®ã„ÇíÁ¢∫Ë™ç„Åó„Å¶„Åè„Å†„Åï„ÅÑ";const s={c:function(){t=p("span"),t.textContent=n,this.h()},l:function(i){t=y(i,"SPAN",{class:!0,"data-svelte-h":!0}),N(t)!=="svelte-lvftl7"&&(t.textContent=n),this.h()},h:function(){m(t,"class","status-pending svelte-ztuqv4"),g(t,_,526,20,16621)},m:function(i,l){b(i,t,l)},d:function(i){i&&v(t)}};return M("SvelteRegisterBlock",{block:s,id:Jt.name,type:"if",source:"(526:18) {#if !frequencyDetected}",ctx:c}),s}function bt(c){let t,n,s,e="„Äå„Éâ„Äç„ÇíÁô∫Â£∞„Åó„Å¶„Åè„Å†„Åï„ÅÑ",i,l,r="‰ªªÊÑè„ÅÆÈ´ò„Åï„Åß„Äå„Éâ„Éº„Äç„Å®Ê≠å„ÅÜ„Çà„ÅÜ„Å´Áô∫Â£∞„Åó„Å¶„Åè„Å†„Åï„ÅÑ";const u={c:function(){t=p("div"),n=p("div"),s=p("h3"),s.textContent=e,i=L(),l=p("p"),l.textContent=r,this.h()},l:function(o){t=y(o,"DIV",{class:!0});var a=w(t);n=y(a,"DIV",{class:!0});var C=w(n);s=y(C,"H3",{class:!0,"data-svelte-h":!0}),N(s)!=="svelte-xe90gt"&&(s.textContent=e),i=R(C),l=y(C,"P",{class:!0,"data-svelte-h":!0}),N(l)!=="svelte-1rtajtc"&&(l.textContent=r),C.forEach(v),a.forEach(v),this.h()},h:function(){m(s,"class","svelte-ztuqv4"),g(s,_,540,18,17168),m(l,"class","svelte-ztuqv4"),g(l,_,541,18,17208),m(n,"class","guidance-content svelte-ztuqv4"),g(n,_,539,16,17119),m(t,"class","guidance svelte-ztuqv4"),g(t,_,538,14,17080)},m:function(o,a){b(o,t,a),h(t,n),h(n,s),h(n,i),h(n,l)},d:function(o){o&&v(t)}};return M("SvelteRegisterBlock",{block:u,id:bt.name,type:"if",source:"(538:12) {#if volumeDetected && !frequencyDetected}",ctx:c}),u}function Zt(c){let t,n,s,e;function i(o,a){return o[0]==="pending"?Ht:o[0]==="granted"?Tt:o[0]==="denied"?Nt:o[0]==="error"?Lt:Rt}let l=i(c),r=l(c),u=c[0]==="granted"&&c[3]&&pt(c);const f={c:function(){t=p("div"),n=p("div"),r.c(),s=L(),u&&u.c(),this.h()},l:function(a){t=y(a,"DIV",{class:!0});var C=w(t);n=y(C,"DIV",{class:!0});var x=w(n);r.l(x),x.forEach(v),s=R(C),u&&u.l(C),C.forEach(v),this.h()},h:function(){m(n,"class","mic-status svelte-ztuqv4"),g(n,_,456,10,13312),m(t,"class","mic-test-content svelte-ztuqv4"),g(t,_,453,8,13233)},m:function(a,C){b(a,t,C),h(t,n),r.m(n,null),h(t,s),u&&u.m(t,null),e=!0},p:function(a,C){l===(l=i(a))&&r?r.p(a,C):(r.d(1),r=l(a),r&&(r.c(),r.m(n,null))),a[0]==="granted"&&a[3]?u?(u.p(a,C),C&9&&K(u,1)):(u=pt(a),u.c(),K(u,1),u.m(t,null)):u&&(It(),X(u,1,1,()=>{u=null}),Pt())},i:function(a){e||(K(u),e=!0)},o:function(a){X(u),e=!1},d:function(a){a&&v(t),r.d(),u&&u.d()}};return M("SvelteRegisterBlock",{block:f,id:Zt.name,type:"slot",source:'(453:6) <Card variant=\\"default\\" padding=\\"lg\\">',ctx:c}),f}function Kt(c){let t,n;t=new zt({props:{variant:"disabled",size:"lg",fullWidth:!0,disabled:!0,$$slots:{default:[Qt]},$$scope:{ctx:c}},$$inline:!0});const s={c:function(){rt(t.$$.fragment)},l:function(i){ct(t.$$.fragment,i)},m:function(i,l){st(t,i,l),n=!0},p:function(i,l){const r={};l&33554432&&(r.$$scope={dirty:l,ctx:i}),t.$set(r)},i:function(i){n||(K(t.$$.fragment,i),n=!0)},o:function(i){X(t.$$.fragment,i),n=!1},d:function(i){lt(t,i)}};return M("SvelteRegisterBlock",{block:s,id:Kt.name,type:"else",source:"(569:10) {:else}",ctx:c}),s}function Yt(c){let t,n;t=new zt({props:{href:c[10].path,variant:"primary",size:"lg",fullWidth:!0,$$slots:{default:[Xt]},$$scope:{ctx:c}},$$inline:!0});const s={c:function(){rt(t.$$.fragment)},l:function(i){ct(t.$$.fragment,i)},m:function(i,l){st(t,i,l),n=!0},p:function(i,l){const r={};l&33554432&&(r.$$scope={dirty:l,ctx:i}),t.$set(r)},i:function(i){n||(K(t.$$.fragment,i),n=!0)},o:function(i){X(t.$$.fragment,i),n=!1},d:function(i){lt(t,i)}};return M("SvelteRegisterBlock",{block:s,id:Yt.name,type:"if",source:"(560:10) {#if startButtonEnabled}",ctx:c}),s}function Qt(c){let t;const n={c:function(){t=Q("„Éû„Ç§„ÇØ„ÉÜ„Çπ„ÉàÂÆå‰∫ÜÂæå„Å´ÈñãÂßã")},l:function(e){t=Y(e,"„Éû„Ç§„ÇØ„ÉÜ„Çπ„ÉàÂÆå‰∫ÜÂæå„Å´ÈñãÂßã")},m:function(e,i){b(e,t,i)},d:function(e){e&&v(t)}};return M("SvelteRegisterBlock",{block:n,id:Qt.name,type:"slot",source:'(570:12) <Button                variant=\\"disabled\\"                size=\\"lg\\"                fullWidth                disabled             >',ctx:c}),n}function Xt(c){let t;const n={c:function(){t=Q("„Éà„É¨„Éº„Éã„É≥„Ç∞ÈñãÂßã")},l:function(e){t=Y(e,"„Éà„É¨„Éº„Éã„É≥„Ç∞ÈñãÂßã")},m:function(e,i){b(e,t,i)},d:function(e){e&&v(t)}};return M("SvelteRegisterBlock",{block:n,id:Xt.name,type:"slot",source:'(561:12) <Button                href={selectedMode.path}                variant=\\"primary\\"                size=\\"lg\\"                fullWidth             >',ctx:c}),n}function $t(c){let t,n,s=c[10].name+"",e,i,l,r=c[10].description+"",u,f,o,a,C;const x=[Yt,Kt],k=[];function S(A,B){return A[9]?0:1}o=S(c),a=k[o]=x[o](c);const j={c:function(){t=p("div"),n=p("h3"),e=Q(s),i=L(),l=p("p"),u=Q(r),f=L(),a.c(),this.h()},l:function(B){t=y(B,"DIV",{class:!0});var D=w(t);n=y(D,"H3",{class:!0});var O=w(n);e=Y(O,s),O.forEach(v),i=R(D),l=y(D,"P",{class:!0});var q=w(l);u=Y(q,r),q.forEach(v),f=R(D),a.l(D),D.forEach(v),this.h()},h:function(){m(n,"class","start-title svelte-ztuqv4"),g(n,_,554,10,17502),m(l,"class","start-description svelte-ztuqv4"),g(l,_,555,10,17561),m(t,"class","start-content svelte-ztuqv4"),g(t,_,553,8,17464)},m:function(B,D){b(B,t,D),h(t,n),h(n,e),h(t,i),h(t,l),h(l,u),h(t,f),k[o].m(t,null),C=!0},p:function(B,D){let O=o;o=S(B),o===O?k[o].p(B,D):(It(),X(k[O],1,1,()=>{k[O]=null}),Pt(),a=k[o],a?a.p(B,D):(a=k[o]=x[o](B),a.c()),K(a,1),a.m(t,null))},i:function(B){C||(K(a),C=!0)},o:function(B){X(a),C=!1},d:function(B){B&&v(t),k[o].d()}};return M("SvelteRegisterBlock",{block:j,id:$t.name,type:"slot",source:'(553:6) <Card variant=\\"default\\" padding=\\"lg\\">',ctx:c}),j}function te(c){let t,n,s,e,i,l,r,u,f,o,a,C,x="„Éû„Ç§„ÇØ„ÉÜ„Çπ„Éà",k,S,j="Èü≥ÊÑü„Éà„É¨„Éº„Éã„É≥„Ç∞„ÇíÂßã„ÇÅ„ÇãÂâç„Å´„ÄÅ„Éû„Ç§„ÇØ„ÅÆÂãï‰Ωú„ÇíÁ¢∫Ë™ç„Åó„Åæ„Åô",A,B,D,O,q,U,T;D=new yt({props:{variant:"default",padding:"lg",$$slots:{default:[Zt]},$$scope:{ctx:c}},$$inline:!0}),U=new yt({props:{variant:"default",padding:"lg",$$slots:{default:[$t]},$$scope:{ctx:c}},$$inline:!0});const G={c:function(){t=p("div"),n=p("div"),s=p("div"),e=p("div"),i=ut("svg"),l=ut("path"),r=ut("path"),u=ut("line"),f=ut("line"),o=L(),a=p("div"),C=p("h1"),C.textContent=x,k=L(),S=p("p"),S.textContent=j,A=L(),B=p("div"),rt(D.$$.fragment),O=L(),q=p("div"),rt(U.$$.fragment),this.h()},l:function(I){t=y(I,"DIV",{class:!0});var P=w(t);n=y(P,"DIV",{class:!0});var V=w(n);s=y(V,"DIV",{class:!0});var E=w(s);e=y(E,"DIV",{class:!0});var et=w(e);i=at(et,"svg",{width:!0,height:!0,viewBox:!0,fill:!0,stroke:!0,"stroke-width":!0});var d=w(i);l=at(d,"path",{d:!0}),w(l).forEach(v),r=at(d,"path",{d:!0}),w(r).forEach(v),u=at(d,"line",{x1:!0,x2:!0,y1:!0,y2:!0}),w(u).forEach(v),f=at(d,"line",{x1:!0,x2:!0,y1:!0,y2:!0}),w(f).forEach(v),d.forEach(v),et.forEach(v),o=R(E),a=y(E,"DIV",{});var H=w(a);C=y(H,"H1",{class:!0,"data-svelte-h":!0}),N(C)!=="svelte-z7m4lk"&&(C.textContent=x),k=R(H),S=y(H,"P",{class:!0,"data-svelte-h":!0}),N(S)!=="svelte-1vtv92f"&&(S.textContent=j),H.forEach(v),E.forEach(v),V.forEach(v),A=R(P),B=y(P,"DIV",{class:!0});var F=w(B);ct(D.$$.fragment,F),F.forEach(v),O=R(P),q=y(P,"DIV",{class:!0});var $=w(q);ct(U.$$.fragment,$),$.forEach(v),P.forEach(v),this.h()},h:function(){m(l,"d","M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z"),g(l,_,437,12,12697),m(r,"d","M19 10v2a7 7 0 0 1-14 0v-2"),g(r,_,438,12,12774),m(u,"x1","12"),m(u,"x2","12"),m(u,"y1","19"),m(u,"y2","22"),g(u,_,439,12,12825),m(f,"x1","8"),m(f,"x2","16"),m(f,"y1","22"),m(f,"y2","22"),g(f,_,440,12,12877),m(i,"width","48"),m(i,"height","48"),m(i,"viewBox","0 0 24 24"),m(i,"fill","none"),m(i,"stroke","currentColor"),m(i,"stroke-width","2"),g(i,_,436,10,12585),m(e,"class","mic-icon svelte-ztuqv4"),g(e,_,435,8,12552),m(C,"class","mic-test-title svelte-ztuqv4"),g(C,_,444,10,12972),m(S,"class","mic-test-description svelte-ztuqv4"),g(S,_,445,10,13021),g(a,_,443,8,12956),m(s,"class","mic-test-header svelte-ztuqv4"),g(s,_,434,6,12514),m(n,"class","header svelte-ztuqv4"),g(n,_,433,4,12487),m(B,"class","test-section"),g(B,_,451,4,13154),m(q,"class","start-section"),g(q,_,551,4,17384),m(t,"class","microphone-test svelte-ztuqv4"),g(t,_,431,2,12435)},m:function(I,P){b(I,t,P),h(t,n),h(n,s),h(s,e),h(e,i),h(i,l),h(i,r),h(i,u),h(i,f),h(s,o),h(s,a),h(a,C),h(a,k),h(a,S),h(t,A),h(t,B),st(D,B,null),h(t,O),h(t,q),st(U,q,null),T=!0},p:function(I,P){const V={};P&33554943&&(V.$$scope={dirty:P,ctx:I}),D.$set(V);const E={};P&33554944&&(E.$$scope={dirty:P,ctx:I}),U.$set(E)},i:function(I){T||(K(D.$$.fragment,I),K(U.$$.fragment,I),T=!0)},o:function(I){X(D.$$.fragment,I),X(U.$$.fragment,I),T=!1},d:function(I){I&&v(t),lt(D),lt(U)}};return M("SvelteRegisterBlock",{block:G,id:te.name,type:"slot",source:"(431:0) <PageLayout showBackButton={true}>",ctx:c}),G}function qt(c){let t,n,s;n=new Mt({props:{showBackButton:!0,$$slots:{default:[te]},$$scope:{ctx:c}},$$inline:!0});const e={c:function(){t=L(),rt(n.$$.fragment),this.h()},l:function(l){re("svelte-8st1fo",document.head).forEach(v),t=R(l),ct(n.$$.fragment,l),this.h()},h:function(){document.title="„Éû„Ç§„ÇØ„ÉÜ„Çπ„Éà - Áõ∏ÂØæÈü≥ÊÑü„Éà„É¨„Éº„Éã„É≥„Ç∞"},m:function(l,r){b(l,t,r),st(n,l,r),s=!0},p:function(l,[r]){const u={};r&33555455&&(u.$$scope={dirty:r,ctx:l}),n.$set(u)},i:function(l){s||(K(n.$$.fragment,l),s=!0)},o:function(l){X(n.$$.fragment,l),s=!1},d:function(l){l&&v(t),lt(n,l)}};return M("SvelteRegisterBlock",{block:e,id:qt.name,type:"component",source:"",ctx:c}),e}const xt=5;function St(c){if(c<=0)return"C4Ôºà„Éâ4Ôºâ";const n=Math.round(12*Math.log2(c/440)),s=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],e=((n+9)%12+12)%12,i=Math.floor((n+9)/12)+4,l=s[e];return`${l}${i}Ôºà${{C:"„Éâ","C#":"„Éâ#",D:"„É¨","D#":"„É¨#",E:"„Éü",F:"„Éï„Ç°","F#":"„Éï„Ç°#",G:"„ÇΩ","G#":"„ÇΩ#",A:"„É©","A#":"„É©#",B:"„Ç∑"}[l]}${i}Ôºâ`}function At(c,t){let n=0;for(let o=0;o<c.length;o++)n+=c[o]*c[o];if(n=Math.sqrt(n/c.length),n<.01)return 0;const s=ee(c,t,70),e=Math.floor(t/800),i=Math.floor(t/70);let l=0,r=0,u=0;for(let o=e;o<=i;o++){let a=0,C=0;for(let x=0;x<s.length-o;x++)a+=s[x]*s[x+o],C+=s[x]*s[x];C>0&&(a=a/Math.sqrt(C),a>l?(u=l,l=a,r=o):a>u&&(u=a))}const f=l-u;if(l>.3&&f>.05&&r>0){const o=Math.min(1,l*f*2);return{frequency:t/r,confidence:o}}return{frequency:0,confidence:0}}function ee(c,t,n){const s=1/t,e=1/(n*2*Math.PI),i=e/(e+s),l=new Float32Array(c.length);l[0]=c[0];for(let r=1;r<c.length;r++)l[r]=i*(l[r-1]+c[r]-c[r-1]);return l}function Vt(c){if(c.length===0)return 0;if(c.length===1)return c[0];const t=[...c].sort((l,r)=>l-r),n=t[Math.floor(t.length/2)],s=c.filter(l=>Math.abs(l-n)/n<.1);if(s.length===0)return n;let e=0,i=0;for(let l=0;l<s.length;l++){const r=l+1;e+=s[l]*r,i+=r}return e/i}function de(c,t,n){let s,e;le(gt,"page"),se(c,gt,d=>n(20,e=d));let{$$slots:i={},$$scope:l}=t;ce("Page",i,[]);let r="random";ht(()=>{e.url.searchParams.has("mode")&&(r=e.url.searchParams.get("mode")||"random")});let u="initial",f=!1,o=!1,a=0,C=0,x="",k=!1,S=0,j=!1,A=[];const B={random:{name:"„É©„É≥„ÉÄ„É†Âü∫Èü≥„É¢„Éº„Éâ",description:"10Á®ÆÈ°û„ÅÆÂü∫Èü≥„Åã„Çâ„É©„É≥„ÉÄ„É†„Å´ÈÅ∏Êäû„Åó„Å¶„Éà„É¨„Éº„Éã„É≥„Ç∞",color:"green",path:"./training/random"},continuous:{name:"ÈÄ£Á∂ö„ÉÅ„É£„É¨„É≥„Ç∏„É¢„Éº„Éâ",description:"ÈÅ∏Êäû„Åó„ÅüÂõûÊï∞„Å†„ÅëÈÄ£Á∂ö„ÅßÂÆüË°å„Åó„ÄÅÁ∑èÂêàË©ï‰æ°„ÇíÁ¢∫Ë™ç",color:"orange",path:"./training/continuous"},chromatic:{name:"12Èü≥Èöé„É¢„Éº„Éâ",description:"„ÇØ„É≠„Éû„ÉÅ„ÉÉ„ÇØ„Çπ„Ç±„Éº„É´„ÅÆ‰∏äË°å„Éª‰∏ãË°å„ÅßÂÆåÂÖ®Âà∂Ë¶á",color:"purple",path:"./training/chromatic"}},D=B[r]||B.random;async function O(){console.log("„Éû„Ç§„ÇØË®±ÂèØ„É™„ÇØ„Ç®„Çπ„ÉàÈñãÂßã"),n(0,u="pending");try{const d=await navigator.mediaDevices.getUserMedia({audio:!0});console.log("„Éû„Ç§„ÇØË®±ÂèØÂèñÂæóÊàêÂäü"),n(0,u="granted"),d.getTracks().forEach(H=>H.stop()),console.log("„Éû„Ç§„ÇØË®±ÂèØÂÆå‰∫Ü - „É¶„Éº„Ç∂„Éº„ÇØ„É™„ÉÉ„ÇØ„ÅßAudioContextÈñãÂßã„ÇíÂæÖÊ©ü")}catch(d){console.error("„Éû„Ç§„ÇØË®±ÂèØ„Ç®„É©„Éº:",d),n(0,u="denied")}}let q=null,U=null,T=null,G=null,W=null;async function I(){if(console.log("startListening ÈñãÂßã, micPermission:",u),u!=="granted"){console.log("„Éû„Ç§„ÇØË®±ÂèØ„Åå„ÅÇ„Çä„Åæ„Åõ„Çì");return}if(!q){console.log("AudioContext„Åå‰ΩúÊàê„Åï„Çå„Å¶„ÅÑ„Åæ„Åõ„Çì"),n(4,j=!0);return}try{console.log("AudioContext state:",q.state),q.state==="suspended"&&(console.log("AudioContext suspended - attempting resume..."),await q.resume(),console.log("AudioContext resumed, new state:",q.state)),console.log("„Éû„Ç§„ÇØ„Ç¢„ÇØ„Çª„ÇπÈñãÂßã..."),U=await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!1,noiseSuppression:!1,autoGainControl:!1}}),U.getTracks().forEach(F=>{F.addEventListener("ended",()=>{console.log("MediaStreamTrack ended - stopping analysis"),V(),n(0,u="error")})}),console.log("„Ç¢„Éä„É©„Ç§„Ç∂„ÉºË®≠ÂÆö‰∏≠..."),T=q.createAnalyser(),T.fftSize=2048,T.smoothingTimeConstant=.8,q.createMediaStreamSource(U).connect(T),console.log("„É°„Éá„Ç£„Ç¢„Çπ„Éà„É™„Éº„É†„ÇΩ„Éº„ÇπÊé•Á∂öÂÆå‰∫Ü");const H=T.frequencyBinCount;G=new Uint8Array(H),console.log("„Éá„Éº„ÇøÈÖçÂàóÊ∫ñÂÇôÂÆå‰∫Ü, bufferLength:",H),n(3,k=!0),console.log("„É™„Ç¢„É´„Çø„Ç§„É†Ëß£ÊûêÈñãÂßã"),P()}catch(d){console.error("„Éû„Ç§„ÇØ„Ç¢„ÇØ„Çª„Çπ„Ç®„É©„Éº:",d),console.error("„Ç®„É©„ÉºË©≥Á¥∞:",{name:d.name,message:d.message,code:d.code}),n(0,u="error"),n(4,j=!0)}}function P(){if(!k||!T){console.log("Ëß£ÊûêÂÅúÊ≠¢: isListening=",k,"analyser=",!!T);return}window.firstAnalysisLogged||(console.log("ÂàùÂõûÈü≥Â£∞Ëß£ÊûêÂÆüË°å‰∏≠..."),window.firstAnalysisLogged=!0),T.getByteFrequencyData(G);let d=0;for(let J=0;J<G.length;J++)d+=G[J]*G[J];const H=Math.sqrt(d/G.length);n(5,a=Math.min(100,H/128*100)),window.volumeLogCount||(window.volumeLogCount=0),window.volumeLogCount++,window.volumeLogCount%60===0&&console.log("Èü≥ÈáèÂÄ§:",a.toFixed(1),"RMS:",H.toFixed(3)),a>20&&(f||console.log("Èü≥ÈáèÊ§úÂá∫ÊàêÂäü:",a),n(1,f=!0));const F=new Float32Array(T.fftSize);T.getFloatTimeDomainData(F);const $=At(F,q.sampleRate);if($.frequency>0){A.push($.frequency),A.length>xt&&A.shift();const J=Vt(A);n(6,C=J),n(7,x=St(C)),n(8,S=Math.round($.confidence*100)),C>80&&C<800&&(o||console.log("Âë®Ê≥¢Êï∞Ê§úÂá∫ÊàêÂäü:",C,"Hz",x),n(2,o=!0))}else A=[],n(6,C=0),n(7,x=""),n(8,S=0);W=requestAnimationFrame(P)}function V(){n(3,k=!1),W&&(cancelAnimationFrame(W),W=null),U&&(U.getTracks().forEach(d=>d.stop()),U=null),q&&q.state!=="closed"&&(q.close(),q=null),T=null,G=null}Et(()=>{V()});async function E(){if(console.log("„É¶„Éº„Ç∂„Éº„ÇØ„É™„ÉÉ„ÇØ„ÅßAudioContextÈñãÂßã..."),u!=="granted"){console.log("„Éû„Ç§„ÇØË®±ÂèØ„ÅåÂøÖË¶Å„Åß„Åô");return}try{q=new(window.AudioContext||window.webkitAudioContext),console.log("AudioContext‰ΩúÊàêÂÆå‰∫Ü, state:",q.state),n(4,j=!1),await I()}catch(d){console.error("AudioContextÈñãÂßãÂ§±Êïó:",d),n(4,j=!0)}}ht(()=>{console.log("„Éö„Éº„Ç∏Ë™≠„ÅøËæº„ÅøÂÆå‰∫Ü - „É¶„Éº„Ç∂„ÉºÊìç‰Ωú„ÇíÂæÖÊ©ü‰∏≠"),console.log("ÂàùÊúüÁä∂ÊÖã - micPermission:",u,"isListening:",k,"audioContextBlocked:",j)});const et=[];return Object.keys(t).forEach(d=>{!~et.indexOf(d)&&d.slice(0,2)!=="$$"&&d!=="slot"&&fe.warn(`<Page> was created with unknown prop '${d}'`)}),c.$capture_state=()=>({onMount:ht,onDestroy:Et,page:gt,Card:yt,Button:zt,PageLayout:Mt,VolumeBar:Ft,PitchDisplay:ue,mode:r,micPermission:u,volumeDetected:f,frequencyDetected:o,currentVolume:a,currentFrequency:C,currentNote:x,isListening:k,detectionConfidence:S,audioContextBlocked:j,frequencyHistory:A,HISTORY_SIZE:xt,trainingModes:B,selectedMode:D,frequencyToNote:St,requestMicrophone:O,audioContext:q,mediaStream:U,analyser:T,dataArray:G,animationFrame:W,startListening:I,analyzeAudio:P,detectPitchWithAutocorrelation:At,applyHighPassFilter:ee,smoothFrequency:Vt,stopListening:V,startAudioContextManually:E,startButtonEnabled:s,$page:e}),c.$inject_state=d=>{"mode"in d&&(r=d.mode),"micPermission"in d&&n(0,u=d.micPermission),"volumeDetected"in d&&n(1,f=d.volumeDetected),"frequencyDetected"in d&&n(2,o=d.frequencyDetected),"currentVolume"in d&&n(5,a=d.currentVolume),"currentFrequency"in d&&n(6,C=d.currentFrequency),"currentNote"in d&&n(7,x=d.currentNote),"isListening"in d&&n(3,k=d.isListening),"detectionConfidence"in d&&n(8,S=d.detectionConfidence),"audioContextBlocked"in d&&n(4,j=d.audioContextBlocked),"frequencyHistory"in d&&(A=d.frequencyHistory),"audioContext"in d&&(q=d.audioContext),"mediaStream"in d&&(U=d.mediaStream),"analyser"in d&&(T=d.analyser),"dataArray"in d&&(G=d.dataArray),"animationFrame"in d&&(W=d.animationFrame),"startButtonEnabled"in d&&n(9,s=d.startButtonEnabled)},t&&"$$inject"in t&&c.$inject_state(t.$$inject),c.$$.update=()=>{c.$$.dirty&25&&console.log("Áä∂ÊÖãÂ§âÊõ¥ - micPermission:",u,"isListening:",k,"audioContextBlocked:",j),c.$$.dirty&7&&n(9,s=u==="granted"&&f&&o)},[u,f,o,k,j,a,C,x,S,s,D,O,E]}class pe extends ne{constructor(t){super(t),oe(this,t,de,qt,ie,{}),M("SvelteRegisterComponent",{component:this,tagName:"Page",options:t,id:qt.name})}}export{pe as component};
