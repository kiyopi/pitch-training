import{S as je,i as ze,d as z,s as Ue,v as Oe,c as Ge,a as Je,D as ye,E as be,b as u,q as se,r as ie,u as oe,f as q,w as le,F as Ze,m as F,x as ce,p as A,y as re,G as Ke,g as a,H as he,h,z as f,j as p,k as D,B as te,A as O,o as g,C as ne,e as ee,l as Z,t as K,n as de,I as Ce,J as pe}from"../chunks/Ci2ptbdh.js";import{g as Qe}from"../chunks/D0QH3NT1.js";import"../chunks/CDirIs2-.js";import{p as me}from"../chunks/TG4HBQk_.js";import{b as ke,g as De}from"../chunks/8FpYXmgO.js";import{P as Ee,B as We,C as fe}from"../chunks/D0uqYblX.js";import{a as Xe,P as Ve}from"../chunks/BoF4eHT7.js";const{console:Ye}=Qe,v="src/routes/microphone-test/+page.svelte";function we(c){let e,t="マイク準備完了",o,n,r="トレーニング開始ボタンを押してランダム基音モードへ進んでください",l,i,s,_="トレーニング開始",y,d;const b={c:function(){e=g("h3"),e.textContent=t,o=A(),n=g("p"),n.textContent=r,l=A(),i=g("div"),s=g("button"),s.textContent=_,this.h()},l:function(C){e=p(C,"H3",{class:!0,"data-svelte-h":!0}),O(e)!=="svelte-11dam81"&&(e.textContent=t),o=F(C),n=p(C,"P",{class:!0,"data-svelte-h":!0}),O(n)!=="svelte-5idwhi"&&(n.textContent=r),l=F(C),i=p(C,"DIV",{class:!0});var k=D(i);s=p(k,"BUTTON",{class:!0,"data-svelte-h":!0}),O(s)!=="svelte-kae9rs"&&(s.textContent=_),k.forEach(u),this.h()},h:function(){f(e,"class","ready-title svelte-19mrh3"),h(e,v,231,12,6862),f(n,"class","ready-description svelte-19mrh3"),h(n,v,232,12,6911),f(s,"class","training-start-button enabled svelte-19mrh3"),h(s,v,235,14,7057),f(i,"class","training-start-button-area svelte-19mrh3"),h(i,v,234,12,7002)},m:function(C,k){q(C,e,k),q(C,o,k),q(C,n,k),q(C,l,k),q(C,i,k),a(i,s),y||(d=pe(s,"click",c[14],!1),y=!0)},p:de,d:function(C){C&&(u(e),u(o),u(n),u(l),u(i)),y=!1,d()}};return z("SvelteRegisterBlock",{block:b,id:we.name,type:"else",source:"(230:10) {:else}",ctx:c}),b}function Pe(c){let e,t;function o(y,d){return y[3]==="granted"&&y[4]&&(!y[0]||!y[1])?Be:Ie}let n=o(c),r=n(c);function l(y,d){if(y[3]==="pending")return Te;if(y[3]==="denied")return Re;if(y[3]==="initial")return Se}let i=l(c),s=i&&i(c);const _={c:function(){r.c(),e=A(),s&&s.c(),t=Ce()},l:function(d){r.l(d),e=F(d),s&&s.l(d),t=Ce()},m:function(d,b){r.m(d,b),q(d,e,b),s&&s.m(d,b),q(d,t,b)},p:function(d,b){n!==(n=o(d))&&(r.d(1),r=n(d),r&&(r.c(),r.m(e.parentNode,e))),i===(i=l(d))&&s?s.p(d,b):(s&&s.d(1),s=i&&i(d),s&&(s.c(),s.m(t.parentNode,t)))},d:function(d){d&&(u(e),u(t)),r.d(d),s&&s.d(d)}};return z("SvelteRegisterBlock",{block:_,id:Pe.name,type:"if",source:"(204:10) {#if !audioConfirmationComplete}",ctx:c}),_}function Ie(c){let e,t="マイクのテストを開始します",o,n,r="マイクテスト開始ボタンを押してマイクの使用を許可してください";const l={c:function(){e=g("h3"),e.textContent=t,o=A(),n=g("p"),n.textContent=r,this.h()},l:function(s){e=p(s,"H3",{class:!0,"data-svelte-h":!0}),O(e)!=="svelte-gfi16f"&&(e.textContent=t),o=F(s),n=p(s,"P",{class:!0,"data-svelte-h":!0}),O(n)!=="svelte-1w19y1h"&&(n.textContent=r),this.h()},h:function(){f(e,"class","instructions-title svelte-19mrh3"),h(e,v,210,14,5999),f(n,"class","instructions-description svelte-19mrh3"),h(n,v,211,14,6063)},m:function(s,_){q(s,e,_),q(s,o,_),q(s,n,_)},d:function(s){s&&(u(e),u(o),u(n))}};return z("SvelteRegisterBlock",{block:l,id:Ie.name,type:"else",source:"(209:12) {:else}",ctx:c}),l}function Be(c){let e,t="「ドー」と発声してください";const o={c:function(){e=g("p"),e.textContent=t,this.h()},l:function(r){e=p(r,"P",{class:!0,"data-svelte-h":!0}),O(e)!=="svelte-15d2sx7"&&(e.textContent=t),this.h()},h:function(){f(e,"class","status-text voice-instruction svelte-19mrh3"),h(e,v,207,14,5871)},m:function(r,l){q(r,e,l)},d:function(r){r&&u(e)}};return z("SvelteRegisterBlock",{block:o,id:Be.name,type:"if",source:"(206:12) {#if micPermission === 'granted' && isListening && (!volumeDetected || !frequencyDetected)}",ctx:c}),o}function Se(c){let e,t,o="マイクテストを開始",n,r;const l={c:function(){e=g("div"),t=g("button"),t.textContent=o,this.h()},l:function(s){e=p(s,"DIV",{class:!0});var _=D(e);t=p(_,"BUTTON",{class:!0,"data-svelte-h":!0}),O(t)!=="svelte-caex95"&&(t.textContent=o),_.forEach(u),this.h()},h:function(){f(t,"class","mic-test-button start svelte-19mrh3"),h(t,v,224,16,6636),f(e,"class","mic-test-button-area svelte-19mrh3"),h(e,v,223,14,6585)},m:function(s,_){q(s,e,_),a(e,t),n||(r=pe(t,"click",c[12],!1),n=!0)},p:de,d:function(s){s&&u(e),n=!1,r()}};return z("SvelteRegisterBlock",{block:l,id:Se.name,type:"if",source:"(223:50) ",ctx:c}),l}function Re(c){let e,t,o="マイク許可を再試行",n,r;const l={c:function(){e=g("div"),t=g("button"),t.textContent=o,this.h()},l:function(s){e=p(s,"DIV",{class:!0});var _=D(e);t=p(_,"BUTTON",{class:!0,"data-svelte-h":!0}),O(t)!=="svelte-1p3n8nt"&&(t.textContent=o),_.forEach(u),this.h()},h:function(){f(t,"class","mic-test-button retry svelte-19mrh3"),h(t,v,218,16,6377),f(e,"class","mic-test-button-area svelte-19mrh3"),h(e,v,217,14,6326)},m:function(s,_){q(s,e,_),a(e,t),n||(r=pe(t,"click",c[12],!1),n=!0)},p:de,d:function(s){s&&u(e),n=!1,r()}};return z("SvelteRegisterBlock",{block:l,id:Re.name,type:"if",source:"(217:49) ",ctx:c}),l}function Te(c){let e,t="マイク準備中...";const o={c:function(){e=g("p"),e.textContent=t,this.h()},l:function(r){e=p(r,"P",{class:!0,"data-svelte-h":!0}),O(e)!=="svelte-1vb5g92"&&(e.textContent=t),this.h()},h:function(){f(e,"class","status-text svelte-19mrh3"),h(e,v,215,14,6225)},m:function(r,l){q(r,e,l)},p:de,d:function(r){r&&u(e)}};return z("SvelteRegisterBlock",{block:o,id:Te.name,type:"if",source:"(215:12) {#if micPermission === 'pending'}",ctx:c}),o}function xe(c){let e;function t(l,i){return l[2]?we:Pe}let o=t(c),n=o(c);const r={c:function(){e=g("div"),n.c(),this.h()},l:function(i){e=p(i,"DIV",{class:!0});var s=D(e);n.l(s),s.forEach(u),this.h()},h:function(){f(e,"class","training-mode-content svelte-19mrh3"),h(e,v,202,8,5606)},m:function(i,s){q(i,e,s),n.m(e,null)},p:function(i,s){o===(o=t(i))&&n?n.p(i,s):(n.d(1),n=o(i),n&&(n.c(),n.m(e,null)))},d:function(i){i&&u(e),n.d()}};return z("SvelteRegisterBlock",{block:r,id:xe.name,type:"slot",source:'(202:6) <Card variant=\\"default\\" padding=\\"lg\\">',ctx:c}),r}function ve(c){let e,t,o,n,r="フィルター前:",l,i,s=c[8].toFixed(1)+"",_,y,d,b,T,C="フィルター後:",k,S,E=c[9].toFixed(1)+"",B,N,x,w,V,R="ノイズ削減:",M,P,U,L;const m={c:function(){e=g("div"),t=g("div"),o=g("div"),n=g("span"),n.textContent=r,l=A(),i=g("span"),_=K(s),y=K("%"),d=A(),b=g("div"),T=g("span"),T.textContent=C,k=A(),S=g("span"),B=K(E),N=K("%"),x=A(),w=g("div"),V=g("span"),V.textContent=R,M=A(),P=g("span"),U=K(c[10]),L=K("%"),this.h()},l:function(J){e=p(J,"DIV",{class:!0});var j=D(e);t=p(j,"DIV",{class:!0});var I=D(t);o=p(I,"DIV",{class:!0});var H=D(o);n=p(H,"SPAN",{class:!0,"data-svelte-h":!0}),O(n)!=="svelte-1nh45c7"&&(n.textContent=r),l=F(H),i=p(H,"SPAN",{class:!0});var Q=D(i);_=Z(Q,s),y=Z(Q,"%"),Q.forEach(u),H.forEach(u),d=F(I),b=p(I,"DIV",{class:!0});var X=D(b);T=p(X,"SPAN",{class:!0,"data-svelte-h":!0}),O(T)!=="svelte-fz1u1y"&&(T.textContent=C),k=F(X),S=p(X,"SPAN",{class:!0});var W=D(S);B=Z(W,E),N=Z(W,"%"),W.forEach(u),X.forEach(u),x=F(I),w=p(I,"DIV",{class:!0});var Y=D(w);V=p(Y,"SPAN",{class:!0,"data-svelte-h":!0}),O(V)!=="svelte-3jbm0v"&&(V.textContent=R),M=F(Y),P=p(Y,"SPAN",{class:!0});var $=D(P);U=Z($,c[10]),L=Z($,"%"),$.forEach(u),Y.forEach(u),I.forEach(u),j.forEach(u),this.h()},h:function(){f(n,"class","stat-label svelte-19mrh3"),h(n,v,261,20,7944),f(i,"class","stat-value raw svelte-19mrh3"),h(i,v,262,20,8004),f(o,"class","stat-item svelte-19mrh3"),h(o,v,260,18,7900),f(T,"class","stat-label svelte-19mrh3"),h(T,v,265,20,8151),f(S,"class","stat-value filtered svelte-19mrh3"),h(S,v,266,20,8211),f(b,"class","stat-item svelte-19mrh3"),h(b,v,264,18,8107),f(V,"class","stat-label svelte-19mrh3"),h(V,v,269,20,8368),f(P,"class","stat-value reduction svelte-19mrh3"),h(P,v,270,20,8427),f(w,"class","stat-item svelte-19mrh3"),h(w,v,268,18,8324),f(t,"class","noise-stats svelte-19mrh3"),h(t,v,259,16,7856),f(e,"class","noise-reduction-info svelte-19mrh3"),h(e,v,258,14,7805)},m:function(J,j){q(J,e,j),a(e,t),a(t,o),a(o,n),a(o,l),a(o,i),a(i,_),a(i,y),a(t,d),a(t,b),a(b,T),a(b,k),a(b,S),a(S,B),a(S,N),a(t,x),a(t,w),a(w,V),a(w,M),a(w,P),a(P,U),a(P,L)},p:function(J,j){j&256&&s!==(s=J[8].toFixed(1)+"")&&ee(_,s),j&512&&E!==(E=J[9].toFixed(1)+"")&&ee(B,E),j&1024&&ee(U,J[10])},d:function(J){J&&u(e)}};return z("SvelteRegisterBlock",{block:m,id:ve.name,type:"if",source:"(258:12) {#if isListening}",ctx:c}),m}function Me(c){let e;const t={c:function(){e=K(" ")},l:function(n){e=Z(n," ")},m:function(n,r){q(n,e,r)},d:function(n){n&&u(e)}};return z("SvelteRegisterBlock",{block:t,id:Me.name,type:"else",source:"(281:16) {:else}",ctx:c}),t}function qe(c){let e;const t={c:function(){e=K("⏳ 声を出して音量を確認してください")},l:function(n){e=Z(n,"⏳ 声を出して音量を確認してください")},m:function(n,r){q(n,e,r)},d:function(n){n&&u(e)}};return z("SvelteRegisterBlock",{block:t,id:qe.name,type:"if",source:"(279:16) {#if !volumeDetected && isListening}",ctx:c}),t}function Ne(c){let e,t,o,n="音量レベル",r,l,i,s,_,y=c[5].toFixed(1)+"",d,b,T,C,k,S,E=c[4]&&ve(c);function B(V,R){return!V[0]&&V[4]?qe:Me}let N=B(c),x=N(c);const w={c:function(){e=g("div"),t=g("div"),o=g("h3"),o.textContent=n,r=A(),l=g("div"),i=g("div"),s=A(),_=g("div"),d=K(y),b=K("%"),T=A(),E&&E.c(),C=A(),k=g("div"),S=g("span"),x.c(),this.h()},l:function(R){e=p(R,"DIV",{class:!0});var M=D(e);t=p(M,"DIV",{class:!0});var P=D(t);o=p(P,"H3",{class:!0,"data-svelte-h":!0}),O(o)!=="svelte-1nc8gri"&&(o.textContent=n),r=F(P),l=p(P,"DIV",{class:!0});var U=D(l);i=p(U,"DIV",{class:!0,style:!0}),D(i).forEach(u),U.forEach(u),s=F(P),_=p(P,"DIV",{class:!0});var L=D(_);d=Z(L,y),b=Z(L,"%"),L.forEach(u),T=F(P),E&&E.l(P),C=F(P),k=p(P,"DIV",{class:!0});var m=D(k);S=p(m,"SPAN",{class:!0});var G=D(S);x.l(G),G.forEach(u),m.forEach(u),P.forEach(u),M.forEach(u),this.h()},h:function(){f(o,"class","display-title svelte-19mrh3"),h(o,v,250,12,7462),f(i,"class","volume-bar svelte-19mrh3"),he(i,"width",c[5]+"%"),h(i,v,252,14,7560),f(l,"class","volume-bar-container svelte-19mrh3"),h(l,v,251,12,7511),f(_,"class","volume-text svelte-19mrh3"),h(_,v,254,12,7654),f(S,"class","status-pending svelte-19mrh3"),h(S,v,277,14,8641),f(k,"class","volume-status svelte-19mrh3"),h(k,v,276,12,8599),f(t,"class","volume-section svelte-19mrh3"),h(t,v,249,10,7421),f(e,"class","card-inner svelte-19mrh3"),h(e,v,248,8,7386)},m:function(R,M){q(R,e,M),a(e,t),a(t,o),a(t,r),a(t,l),a(l,i),a(t,s),a(t,_),a(_,d),a(_,b),a(t,T),E&&E.m(t,null),a(t,C),a(t,k),a(k,S),x.m(S,null)},p:function(R,M){M&32&&he(i,"width",R[5]+"%"),M&32&&y!==(y=R[5].toFixed(1)+"")&&ee(d,y),R[4]?E?E.p(R,M):(E=ve(R),E.c(),E.m(t,C)):E&&(E.d(1),E=null),N!==(N=B(R))&&(x.d(1),x=N(R),x&&(x.c(),x.m(S,null)))},d:function(R){R&&u(e),E&&E.d(),x.d()}};return z("SvelteRegisterBlock",{block:w,id:Ne.name,type:"slot",source:'(248:6) <Card variant=\\"default\\" padding=\\"lg\\">',ctx:c}),w}function Fe(c){let e;const t={c:function(){e=K(" ")},l:function(n){e=Z(n," ")},m:function(n,r){q(n,e,r)},d:function(n){n&&u(e)}};return z("SvelteRegisterBlock",{block:t,id:Fe.name,type:"else",source:"(303:16) {:else}",ctx:c}),t}function Ae(c){let e;const t={c:function(){e=K("⏳ 「ド」を発声して音程を確認してください")},l:function(n){e=Z(n,"⏳ 「ド」を発声して音程を確認してください")},m:function(n,r){q(n,e,r)},d:function(n){n&&u(e)}};return z("SvelteRegisterBlock",{block:t,id:Ae.name,type:"if",source:"(301:16) {#if !frequencyDetected && isListening}",ctx:c}),t}function Le(c){let e,t,o,n="音程検出",r,l,i,s=c[6]>0?c[6].toFixed(1)+" Hz":"ーー",_,y,d,b,T,C,k;function S(x,w){return!x[1]&&x[4]?Ae:Fe}let E=S(c),B=E(c);const N={c:function(){e=g("div"),t=g("div"),o=g("h3"),o.textContent=n,r=A(),l=g("div"),i=g("div"),_=K(s),y=A(),d=g("div"),b=K(c[7]),T=A(),C=g("div"),k=g("span"),B.c(),this.h()},l:function(w){e=p(w,"DIV",{class:!0});var V=D(e);t=p(V,"DIV",{class:!0});var R=D(t);o=p(R,"H3",{class:!0,"data-svelte-h":!0}),O(o)!=="svelte-1ofzoy2"&&(o.textContent=n),r=F(R),l=p(R,"DIV",{class:!0});var M=D(l);i=p(M,"DIV",{class:!0});var P=D(i);_=Z(P,s),P.forEach(u),y=F(M),d=p(M,"DIV",{class:!0});var U=D(d);b=Z(U,c[7]),U.forEach(u),M.forEach(u),T=F(R),C=p(R,"DIV",{class:!0});var L=D(C);k=p(L,"SPAN",{class:!0});var m=D(k);B.l(m),m.forEach(u),L.forEach(u),R.forEach(u),V.forEach(u),this.h()},h:function(){f(o,"class","display-title svelte-19mrh3"),h(o,v,293,12,9074),f(i,"class","frequency-value svelte-19mrh3"),h(i,v,295,14,9168),f(d,"class","note-value svelte-19mrh3"),h(d,v,296,14,9285),f(l,"class","frequency-display svelte-19mrh3"),h(l,v,294,12,9122),f(k,"class","status-pending svelte-19mrh3"),h(k,v,299,14,9405),f(C,"class","frequency-status svelte-19mrh3"),h(C,v,298,12,9360),f(t,"class","frequency-section svelte-19mrh3"),h(t,v,292,10,9030),f(e,"class","card-inner svelte-19mrh3"),h(e,v,291,8,8995)},m:function(w,V){q(w,e,V),a(e,t),a(t,o),a(t,r),a(t,l),a(l,i),a(i,_),a(l,y),a(l,d),a(d,b),a(t,T),a(t,C),a(C,k),B.m(k,null)},p:function(w,V){V&64&&s!==(s=w[6]>0?w[6].toFixed(1)+" Hz":"ーー")&&ee(_,s),V&128&&ee(b,w[7]),E!==(E=S(w))&&(B.d(1),B=E(w),B&&(B.c(),B.m(k,null)))},d:function(w){w&&u(e),B.d()}};return z("SvelteRegisterBlock",{block:N,id:Le.name,type:"slot",source:'(291:6) <Card variant=\\"default\\" padding=\\"lg\\">',ctx:c}),N}function He(c){let e,t,o,n,r,l,i,s,_,y,d,b,T,C,k,S="マイクテスト",E,B,N="音感トレーニングを始める前に、マイクの動作を確認します",x,w,V,R,M,P,U,L,m,G={isActive:c[3]==="granted",debugMode:!0};t=new Ve({props:G,$$inline:!0}),c[15](t),t.$on("pitchUpdate",c[13]),V=new fe({props:{variant:"default",padding:"lg",$$slots:{default:[xe]},$$scope:{ctx:c}},$$inline:!0}),P=new fe({props:{variant:"default",padding:"lg",$$slots:{default:[Ne]},$$scope:{ctx:c}},$$inline:!0}),L=new fe({props:{variant:"default",padding:"lg",$$slots:{default:[Le]},$$scope:{ctx:c}},$$inline:!0});const J={c:function(){e=g("div"),re(t.$$.fragment),o=A(),n=g("div"),r=g("div"),l=g("div"),i=g("div"),s=ne("svg"),_=ne("path"),y=ne("path"),d=ne("line"),b=ne("line"),T=A(),C=g("div"),k=g("h1"),k.textContent=S,E=A(),B=g("p"),B.textContent=N,x=A(),w=g("div"),re(V.$$.fragment),R=A(),M=g("div"),re(P.$$.fragment),U=A(),re(L.$$.fragment),this.h()},l:function(I){e=p(I,"DIV",{style:!0});var H=D(e);ce(t.$$.fragment,H),H.forEach(u),o=F(I),n=p(I,"DIV",{class:!0});var Q=D(n);r=p(Q,"DIV",{class:!0});var X=D(r);l=p(X,"DIV",{class:!0});var W=D(l);i=p(W,"DIV",{class:!0});var Y=D(i);s=te(Y,"svg",{width:!0,height:!0,viewBox:!0,fill:!0,stroke:!0,"stroke-width":!0});var $=D(s);_=te($,"path",{d:!0}),D(_).forEach(u),y=te($,"path",{d:!0}),D(y).forEach(u),d=te($,"line",{x1:!0,x2:!0,y1:!0,y2:!0}),D(d).forEach(u),b=te($,"line",{x1:!0,x2:!0,y1:!0,y2:!0}),D(b).forEach(u),$.forEach(u),Y.forEach(u),T=F(W),C=p(W,"DIV",{});var ae=D(C);k=p(ae,"H1",{class:!0,"data-svelte-h":!0}),O(k)!=="svelte-z7m4lk"&&(k.textContent=S),E=F(ae),B=p(ae,"P",{class:!0,"data-svelte-h":!0}),O(B)!=="svelte-1vtv92f"&&(B.textContent=N),ae.forEach(u),W.forEach(u),X.forEach(u),x=F(Q),w=p(Q,"DIV",{class:!0});var ge=D(w);ce(V.$$.fragment,ge),ge.forEach(u),R=F(Q),M=p(Q,"DIV",{class:!0});var ue=D(M);ce(P.$$.fragment,ue),U=F(ue),ce(L.$$.fragment,ue),ue.forEach(u),Q.forEach(u),this.h()},h:function(){he(e,"display","none"),h(e,v,171,2,4585),f(_,"d","M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z"),h(_,v,186,12,5064),f(y,"d","M19 10v2a7 7 0 0 1-14 0v-2"),h(y,v,187,12,5141),f(d,"x1","12"),f(d,"x2","12"),f(d,"y1","19"),f(d,"y2","22"),h(d,v,188,12,5192),f(b,"x1","8"),f(b,"x2","16"),f(b,"y1","22"),f(b,"y2","22"),h(b,v,189,12,5244),f(s,"width","48"),f(s,"height","48"),f(s,"viewBox","0 0 24 24"),f(s,"fill","none"),f(s,"stroke","currentColor"),f(s,"stroke-width","2"),h(s,v,185,10,4952),f(i,"class","mic-icon svelte-19mrh3"),h(i,v,184,8,4919),f(k,"class","mic-test-title svelte-19mrh3"),h(k,v,193,10,5339),f(B,"class","mic-test-description svelte-19mrh3"),h(B,v,194,10,5388),h(C,v,192,8,5323),f(l,"class","mic-test-header svelte-19mrh3"),h(l,v,183,6,4881),f(r,"class","header svelte-19mrh3"),h(r,v,182,4,4854),f(w,"class","training-mode-info svelte-19mrh3"),h(w,v,200,4,5521),f(M,"class","test-section svelte-19mrh3"),h(M,v,245,4,7283),f(n,"class","microphone-test svelte-19mrh3"),h(n,v,180,2,4802)},m:function(I,H){q(I,e,H),le(t,e,null),q(I,o,H),q(I,n,H),a(n,r),a(r,l),a(l,i),a(i,s),a(s,_),a(s,y),a(s,d),a(s,b),a(l,T),a(l,C),a(C,k),a(C,E),a(C,B),a(n,x),a(n,w),le(V,w,null),a(n,R),a(n,M),le(P,M,null),a(M,U),le(L,M,null),m=!0},p:function(I,H){const Q={};H&8&&(Q.isActive=I[3]==="granted"),t.$set(Q);const X={};H&4194335&&(X.$$scope={dirty:H,ctx:I}),V.$set(X);const W={};H&4196145&&(W.$$scope={dirty:H,ctx:I}),P.$set(W);const Y={};H&4194514&&(Y.$$scope={dirty:H,ctx:I}),L.$set(Y)},i:function(I){m||(oe(t.$$.fragment,I),oe(V.$$.fragment,I),oe(P.$$.fragment,I),oe(L.$$.fragment,I),m=!0)},o:function(I){ie(t.$$.fragment,I),ie(V.$$.fragment,I),ie(P.$$.fragment,I),ie(L.$$.fragment,I),m=!1},d:function(I){I&&(u(e),u(o),u(n)),c[15](null),se(t),se(V),se(P),se(L)}};return z("SvelteRegisterBlock",{block:J,id:He.name,type:"slot",source:"(170:0) <PageLayout showBackButton={true}>",ctx:c}),J}function _e(c){let e,t,o;t=new Ee({props:{showBackButton:!0,$$slots:{default:[He]},$$scope:{ctx:c}},$$inline:!0});const n={c:function(){e=A(),re(t.$$.fragment),this.h()},l:function(l){Ze("svelte-8st1fo",document.head).forEach(u),e=F(l),ce(t.$$.fragment,l),this.h()},h:function(){document.title="マイクテスト - 相対音感トレーニング"},m:function(l,i){q(l,e,i),le(t,l,i),o=!0},p:function(l,[i]){const s={};i&4198399&&(s.$$scope={dirty:i,ctx:l}),t.$set(s)},i:function(l){o||(oe(t.$$.fragment,l),o=!0)},o:function(l){ie(t.$$.fragment,l),o=!1},d:function(l){l&&u(e),se(t,l)}};return z("SvelteRegisterBlock",{block:n,id:_e.name,type:"component",source:"",ctx:c}),n}function $e(c,e,t){let o;Oe(me,"page"),Ge(c,me,m=>t(18,o=m));let{$$slots:n={},$$scope:r}=e;Je("Page",n,[]);let l="random";ye(()=>{o.url.searchParams.has("mode")&&(l=o.url.searchParams.get("mode")||"random")});let i="initial",s=!1,_=!1,y=!1,d=!1,b=0,T=0,C="ーー",k=0,S=0,E=0,B=0,N=null;const x={random:{name:"ランダム基音モード",description:"10種類の基音からランダムに選択してトレーニング",color:"green",path:"/training/random"},continuous:{name:"連続チャレンジモード",description:"選択した回数だけ連続で実行し、総合評価を確認",color:"orange",path:"/training/continuous"},chromatic:{name:"12音階モード",description:"クロマチックスケールの上行・下行で完全制覇",color:"purple",path:"/training/chromatic"}},w=x[l]||x.random;async function V(){t(3,i="pending");try{console.log("🎤 [MicTest] PitchDetector経由でマイク許可リクエスト開始"),N&&(await N.initialize(),console.log("✅ [MicTest] PitchDetector初期化完了")),t(3,i="granted"),t(4,s=!0),console.log("✅ [MicTest] マイク許可完了")}catch(m){console.error("❌ [MicTest] マイク許可エラー:",m),t(3,i="denied")}}function R(m){const{frequency:G,note:J,volume:j,rawVolume:I,clarity:H}=m.detail;t(6,T=G),t(7,C=J),t(5,b=j),k=H,t(8,S=I),t(9,E=j),S>0?t(10,B=Math.max(0,Math.round((S-E)/S*100))):t(10,B=0),b>5&&t(0,_=!0),G>80&&G<800&&t(1,y=!0),window.micTestDebugCount||(window.micTestDebugCount=0),window.micTestDebugCount<5&&(window.micTestDebugCount++,console.log(`🎙️ [MicTest] PitchUpdate ${window.micTestDebugCount}:`,{frequency:G.toFixed(1),volume:j.toFixed(1),rawVolume:I.toFixed(1),note:J}))}function M(){console.log("🛑 [MicTest] リスニング停止開始"),N&&(N.stopDetection(),console.log("✅ [MicTest] PitchDetector検出停止")),console.log("✅ [MicTest] リスニング停止完了")}function P(){console.log("🚀 [MicTest] トレーニング開始 - ランダム基音モードへ遷移"),De(`${ke}/training/random?from=microphone-test`)}be(()=>{M()});const U=[];Object.keys(e).forEach(m=>{!~U.indexOf(m)&&m.slice(0,2)!=="$$"&&m!=="slot"&&Ye.warn(`<Page> was created with unknown prop '${m}'`)});function L(m){Ke[m?"unshift":"push"](()=>{N=m,t(11,N)})}return c.$capture_state=()=>({onMount:ye,onDestroy:be,page:me,goto:De,base:ke,Card:fe,Button:We,PageLayout:Ee,PitchDetector:Ve,audioManager:Xe,mode:l,micPermission:i,isListening:s,volumeDetected:_,frequencyDetected:y,audioConfirmationComplete:d,currentVolume:b,currentFrequency:T,currentNote:C,pitchClarity:k,rawVolume:S,filteredVolume:E,noiseReduction:B,pitchDetectorComponent:N,trainingModes:x,selectedMode:w,requestMicrophone:V,handlePitchUpdate:R,stopListening:M,startTraining:P,$page:o}),c.$inject_state=m=>{"mode"in m&&(l=m.mode),"micPermission"in m&&t(3,i=m.micPermission),"isListening"in m&&t(4,s=m.isListening),"volumeDetected"in m&&t(0,_=m.volumeDetected),"frequencyDetected"in m&&t(1,y=m.frequencyDetected),"audioConfirmationComplete"in m&&t(2,d=m.audioConfirmationComplete),"currentVolume"in m&&t(5,b=m.currentVolume),"currentFrequency"in m&&t(6,T=m.currentFrequency),"currentNote"in m&&t(7,C=m.currentNote),"pitchClarity"in m&&(k=m.pitchClarity),"rawVolume"in m&&t(8,S=m.rawVolume),"filteredVolume"in m&&t(9,E=m.filteredVolume),"noiseReduction"in m&&t(10,B=m.noiseReduction),"pitchDetectorComponent"in m&&t(11,N=m.pitchDetectorComponent)},e&&"$$inject"in e&&c.$inject_state(e.$$inject),c.$$.update=()=>{c.$$.dirty&7&&_&&y&&!d&&t(2,d=!0)},[_,y,d,i,s,b,T,C,S,E,B,N,V,R,P,L]}class ct extends je{constructor(e){super(e),ze(this,e,$e,_e,Ue,{}),z("SvelteRegisterComponent",{component:this,tagName:"Page",options:e,id:_e.name})}}export{ct as component};
