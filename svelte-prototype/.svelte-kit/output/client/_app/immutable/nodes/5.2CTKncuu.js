const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["../chunks/DMOdon5X.js","../chunks/DXfV3yLF.js","../chunks/BnpKoSs-.js","../chunks/D0QH3NT1.js","../chunks/DMgp6OET.js","../assets/sessionStorage.2zs4CtXT.css"])))=>i.map(i=>d[i]);
import{_ as Cn}from"../chunks/C1FmrZbK.js";import{S as _o,i as So,d as ee,s as bo,v as Ae,c as Te,a as qo,H as Fn,V as Rn,b as h,q as ue,r as X,u as G,f as U,w as fe,I as Do,m as Z,x as de,p as $,y as me,J as wo,K as Me,L as Ie,g,z as P,h as F,M as Qe,j as R,k as z,A as pe,l as W,N as je,o as N,t as J,e as Ce,Q as lt,n as Et,R as Bn}from"../chunks/DXfV3yLF.js";import{g as ko}from"../chunks/D0QH3NT1.js";import"../chunks/BnpKoSs-.js";import{b as it,g as vt}from"../chunks/DMgp6OET.js";import{p as _t}from"../chunks/MIr5h7BS.js";import{P as Vn,B as ut,C as Je}from"../chunks/CrwomGmF.js";import{l as ce,a as We,h as St,P as Hn,b as zn,V as Co}from"../chunks/BRZWrjh2.js";import{l as bt,s as tt,c as Fo,r as Ro,a as Nn,u as qt,b as No,d as Dt,p as Ao,o as To,e as Mo,f as wt,i as kt,g as Io,h as Ct,n as Ft,j as Rt,k as Nt,t as At,E as An,m as nt,A as Qt,U as Xt,S as Eo,F as Po,C as xo,I as Bo,q as Vo,T as Ho,P as zo,M as jn,v as jo,w as Lo,x as Tt}from"../chunks/DMOdon5X.js";const Oo=!1,Go=!1,rr=Object.freeze(Object.defineProperty({__proto__:null,prerender:Go,ssr:Oo},Symbol.toStringTag,{value:"Module"})),{Object:Uo,console:Wo,document:Tn}=ko,A="src/routes/training/continuous/+page.svelte";function Mn(s,t,e){const i=s.slice();return i[99]=t[e],i[101]=e,i}function In(s,t,e){const i=s.slice();return i[102]=t[e],i}function Pt(s){var B,C;let t,e,i,a,n,r,c,u,f,d,m=(((B=s[24])==null?void 0:B.length)||0)+"",v,w,p,y,_,j,k,D,L=Math.round((((C=s[24])==null?void 0:C.length)||0)/8*100)+"",x,Q,M,b,K,I=s[0]==="results"&&s[5]&&xt(s);const q={c:function(){t=N("div"),e=N("div"),i=N("div"),a=N("span"),n=J("ã‚»ãƒƒã‚·ãƒ§ãƒ³ "),r=J(s[23]),c=J("/8"),u=$(),f=N("span"),d=J("å®Œäº†æ¸ˆã¿ "),v=J(m),w=J("ã‚»ãƒƒã‚·ãƒ§ãƒ³"),p=$(),y=N("div"),_=N("div"),j=N("div"),k=$(),D=N("span"),x=J(L),Q=J("%"),M=$(),I&&I.c(),b=je(),this.h()},l:function(E){t=R(E,"DIV",{class:!0});var Y=z(t);e=R(Y,"DIV",{class:!0});var ye=z(e);i=R(ye,"DIV",{class:!0});var oe=z(i);a=R(oe,"SPAN",{class:!0});var _e=z(a);n=W(_e,"ã‚»ãƒƒã‚·ãƒ§ãƒ³ "),r=W(_e,s[23]),c=W(_e,"/8"),_e.forEach(h),u=Z(oe),f=R(oe,"SPAN",{class:!0});var Se=z(f);d=W(Se,"å®Œäº†æ¸ˆã¿ "),v=W(Se,m),w=W(Se,"ã‚»ãƒƒã‚·ãƒ§ãƒ³"),Se.forEach(h),oe.forEach(h),p=Z(ye),y=R(ye,"DIV",{class:!0});var Ee=z(y);_=R(Ee,"DIV",{class:!0});var Le=z(_);j=R(Le,"DIV",{class:!0,style:!0}),z(j).forEach(h),Le.forEach(h),k=Z(Ee),D=R(Ee,"SPAN",{class:!0});var Ve=z(D);x=W(Ve,L),Q=W(Ve,"%"),Ve.forEach(h),Ee.forEach(h),ye.forEach(h),Y.forEach(h),M=Z(E),I&&I.l(E),b=je(),this.h()},h:function(){var E;P(a,"class","completed-count svelte-rt5px1"),F(a,A,2590,12,87458),P(f,"class","remaining-text svelte-rt5px1"),F(f,A,2591,12,87535),P(i,"class","session-info svelte-rt5px1"),F(i,A,2589,10,87419),P(j,"class","progress-fill svelte-rt5px1"),Qe(j,"width",(((E=s[24])==null?void 0:E.length)||0)/8*100+"%"),F(j,A,2595,14,87723),P(_,"class","progress-bar svelte-rt5px1"),F(_,A,2594,12,87682),P(D,"class","progress-text svelte-rt5px1"),F(D,A,2597,12,87849),P(y,"class","progress-section svelte-rt5px1"),F(y,A,2593,10,87639),P(e,"class","session-status svelte-rt5px1"),F(e,A,2588,8,87380),P(t,"class","session-progress svelte-rt5px1"),F(t,A,2587,6,87341)},m:function(E,Y){U(E,t,Y),g(t,e),g(e,i),g(i,a),g(a,n),g(a,r),g(a,c),g(i,u),g(i,f),g(f,d),g(f,v),g(f,w),g(e,p),g(e,y),g(y,_),g(_,j),g(y,k),g(y,D),g(D,x),g(D,Q),U(E,M,Y),I&&I.m(E,Y),U(E,b,Y),K=!0},p:function(E,Y){var ye,oe,_e;(!K||Y[0]&8388608)&&Ce(r,E[23]),(!K||Y[0]&16777216)&&m!==(m=(((ye=E[24])==null?void 0:ye.length)||0)+"")&&Ce(v,m),(!K||Y[0]&16777216)&&Qe(j,"width",(((oe=E[24])==null?void 0:oe.length)||0)/8*100+"%"),(!K||Y[0]&16777216)&&L!==(L=Math.round((((_e=E[24])==null?void 0:_e.length)||0)/8*100)+"")&&Ce(x,L),E[0]==="results"&&E[5]?I?(I.p(E,Y),Y[0]&33&&G(I,1)):(I=xt(E),I.c(),G(I,1),I.m(b.parentNode,b)):I&&(Me(),X(I,1,1,()=>{I=null}),Ie())},i:function(E){K||(G(I),K=!0)},o:function(E){X(I),K=!1},d:function(E){E&&(h(t),h(M),h(b)),I&&I.d(E)}};return ee("SvelteRegisterBlock",{block:q,id:Pt.name,type:"if",source:"(2587:4) {#if microphoneState === 'granted' && !$isLoading}",ctx:s}),q}function xt(s){let t,e,i;e=new Qt({props:{isCompleted:s[5],position:"top"},$$inline:!0}),e.$on("action",s[29]);const a={c:function(){t=N("div"),me(e.$$.fragment),this.h()},l:function(r){t=R(r,"DIV",{class:!0});var c=z(t);de(e.$$.fragment,c),c.forEach(h),this.h()},h:function(){P(t,"class","top-action-buttons svelte-rt5px1"),F(t,A,2605,8,88106)},m:function(r,c){U(r,t,c),fe(e,t,null),i=!0},p:function(r,c){const u={};c[0]&32&&(u.isCompleted=r[5]),e.$set(u)},i:function(r){i||(G(e.$$.fragment,r),i=!0)},o:function(r){X(e.$$.fragment,r),i=!1},d:function(r){r&&h(t),ue(e)}};return ee("SvelteRegisterBlock",{block:a,id:xt.name,type:"if",source:"(2605:6) {#if trainingPhase === 'results' && $isCompleted}",ctx:s}),a}function Ln(s){let t,e;t=new Je({props:{class:"error-card",$$slots:{default:[Wn]},$$scope:{ctx:s}},$$inline:!0});const i={c:function(){me(t.$$.fragment)},l:function(n){de(t.$$.fragment,n)},m:function(n,r){fe(t,n,r),e=!0},p:function(n,r){const c={};r[3]&4096&&(c.$$scope={dirty:r,ctx:n}),t.$set(c)},i:function(n){e||(G(t.$$.fragment,n),e=!0)},o:function(n){X(t.$$.fragment,n),e=!1},d:function(n){ue(t,n)}};return ee("SvelteRegisterBlock",{block:i,id:Ln.name,type:"else",source:"(2825:2) {:else}",ctx:s}),i}function On(s){let t,e,i,a,n,r,c,u={isActive:s[1]==="granted",trainingPhase:s[0],className:"pitch-detector-content",debugMode:!0,disableHarmonicCorrection:!1};e=new zn({props:u,$$inline:!0}),s[35](e),e.$on("pitchUpdate",s[28]),e.$on("stateChange",uo),e.$on("error",s[31]),e.$on("microphoneHealthChange",s[32]);let f=s[0]!=="results"&&Bt(s),d=s[0]!=="results"&&jt(s),m=s[0]==="results"&&Gt(s);const v={c:function(){t=N("div"),me(e.$$.fragment),i=$(),f&&f.c(),a=$(),d&&d.c(),n=$(),m&&m.c(),r=je(),this.h()},l:function(p){t=R(p,"DIV",{style:!0});var y=z(t);de(e.$$.fragment,y),y.forEach(h),i=Z(p),f&&f.l(p),a=Z(p),d&&d.l(p),n=Z(p),m&&m.l(p),r=je(),this.h()},h:function(){Qe(t,"display","none"),F(t,A,2624,4,88586)},m:function(p,y){U(p,t,y),fe(e,t,null),U(p,i,y),f&&f.m(p,y),U(p,a,y),d&&d.m(p,y),U(p,n,y),m&&m.m(p,y),U(p,r,y),c=!0},p:function(p,y){const _={};y[0]&2&&(_.isActive=p[1]==="granted"),y[0]&1&&(_.trainingPhase=p[0]),e.$set(_),p[0]!=="results"?f?(f.p(p,y),y[0]&1&&G(f,1)):(f=Bt(p),f.c(),G(f,1),f.m(a.parentNode,a)):f&&(Me(),X(f,1,1,()=>{f=null}),Ie()),p[0]!=="results"?d?(d.p(p,y),y[0]&1&&G(d,1)):(d=jt(p),d.c(),G(d,1),d.m(n.parentNode,n)):d&&(Me(),X(d,1,1,()=>{d=null}),Ie()),p[0]==="results"?m?(m.p(p,y),y[0]&1&&G(m,1)):(m=Gt(p),m.c(),G(m,1),m.m(r.parentNode,r)):m&&(Me(),X(m,1,1,()=>{m=null}),Ie())},i:function(p){c||(G(e.$$.fragment,p),G(f),G(d),G(m),c=!0)},o:function(p){X(e.$$.fragment,p),X(f),X(d),X(m),c=!1},d:function(p){p&&(h(t),h(i),h(a),h(n),h(r)),s[35](null),ue(e),f&&f.d(p),d&&d.d(p),m&&m.d(p)}};return ee("SvelteRegisterBlock",{block:v,id:On.name,type:"if",source:"(2623:2) {#if microphoneState === 'granted'}",ctx:s}),v}function Gn(s){let t;const e={c:function(){t=J("ğŸ¤ ãƒã‚¤ã‚¯ãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸ã¸ç§»å‹•")},l:function(a){t=W(a,"ğŸ¤ ãƒã‚¤ã‚¯ãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸ã¸ç§»å‹•")},m:function(a,n){U(a,t,n)},d:function(a){a&&h(t)}};return ee("SvelteRegisterBlock",{block:e,id:Gn.name,type:"slot",source:'(2839:10) <Button variant=\\"primary\\" on:click={goToMicrophoneTest}>',ctx:s}),e}function Un(s){let t;const e={c:function(){t=J("ğŸ  ãƒ›ãƒ¼ãƒ ã«æˆ»ã‚‹")},l:function(a){t=W(a,"ğŸ  ãƒ›ãƒ¼ãƒ ã«æˆ»ã‚‹")},m:function(a,n){U(a,t,n)},d:function(a){a&&h(t)}};return ee("SvelteRegisterBlock",{block:e,id:Un.name,type:"slot",source:'(2842:10) <Button variant=\\"secondary\\" on:click={goHome}>',ctx:s}),e}function Wn(s){let t,e,i="ğŸ¤",a,n,r="ãƒã‚¤ã‚¯ãƒ†ã‚¹ãƒˆãŒå¿…è¦ã§ã™",c,u,f="é€£ç¶šãƒãƒ£ãƒ¬ãƒ³ã‚¸ãƒ¢ãƒ¼ãƒ‰ã‚’é–‹å§‹ã™ã‚‹å‰ã«ã€ãƒã‚¤ã‚¯ãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸ã§éŸ³å£°å…¥åŠ›ã®ç¢ºèªã‚’ãŠé¡˜ã„ã—ã¾ã™ã€‚",d,m,v,w,p,y="ãƒã‚¤ã‚¯ãƒ†ã‚¹ãƒˆå®Œäº†å¾Œ",_,j,k,D="ã¾ãšã¯ãƒã‚¤ã‚¯ãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸ã§éŸ³å£°ç¢ºèªã‚’è¡Œã£ã¦ãã ã•ã„ã€‚",L,x,Q,M,b,K;Q=new ut({props:{variant:"primary",$$slots:{default:[Gn]},$$scope:{ctx:s}},$$inline:!0}),Q.$on("click",s[26]),b=new ut({props:{variant:"secondary",$$slots:{default:[Un]},$$scope:{ctx:s}},$$inline:!0}),b.$on("click",s[27]);const I={c:function(){t=N("div"),e=N("div"),e.textContent=i,a=$(),n=N("h3"),n.textContent=r,c=$(),u=N("p"),u.textContent=f,d=$(),m=N("div"),v=N("p"),w=J("ã“ã®ãƒšãƒ¼ã‚¸ã¯"),p=N("strong"),p.textContent=y,_=J("ã«ã”åˆ©ç”¨ã„ãŸã ã‘ã¾ã™ã€‚"),j=$(),k=N("p"),k.textContent=D,L=$(),x=N("div"),me(Q.$$.fragment),M=$(),me(b.$$.fragment),this.h()},l:function(B){t=R(B,"DIV",{class:!0});var C=z(t);e=R(C,"DIV",{class:!0,"data-svelte-h":!0}),pe(e)!=="svelte-15rbx8n"&&(e.textContent=i),a=Z(C),n=R(C,"H3",{class:!0,"data-svelte-h":!0}),pe(n)!=="svelte-17kvze2"&&(n.textContent=r),c=Z(C),u=R(C,"P",{class:!0,"data-svelte-h":!0}),pe(u)!=="svelte-1t09god"&&(u.textContent=f),d=Z(C),m=R(C,"DIV",{class:!0});var V=z(m);v=R(V,"P",{class:!0});var E=z(v);w=W(E,"ã“ã®ãƒšãƒ¼ã‚¸ã¯"),p=R(E,"STRONG",{"data-svelte-h":!0}),pe(p)!=="svelte-1n3qsr6"&&(p.textContent=y),_=W(E,"ã«ã”åˆ©ç”¨ã„ãŸã ã‘ã¾ã™ã€‚"),E.forEach(h),j=Z(V),k=R(V,"P",{class:!0,"data-svelte-h":!0}),pe(k)!=="svelte-v8nd09"&&(k.textContent=D),V.forEach(h),L=Z(C),x=R(C,"DIV",{class:!0});var Y=z(x);de(Q.$$.fragment,Y),M=Z(Y),de(b.$$.fragment,Y),Y.forEach(h),C.forEach(h),this.h()},h:function(){P(e,"class","error-icon svelte-rt5px1"),F(e,A,2828,8,95485),P(n,"class","svelte-rt5px1"),F(n,A,2829,8,95526),P(u,"class","svelte-rt5px1"),F(u,A,2830,8,95555),F(p,A,2833,19,95671),P(v,"class","svelte-rt5px1"),F(v,A,2833,10,95662),P(k,"class","svelte-rt5px1"),F(k,A,2834,10,95723),P(m,"class","recommendation svelte-rt5px1"),F(m,A,2832,8,95623),P(x,"class","action-buttons"),F(x,A,2837,8,95789),P(t,"class","error-content svelte-rt5px1"),F(t,A,2827,6,95449)},m:function(B,C){U(B,t,C),g(t,e),g(t,a),g(t,n),g(t,c),g(t,u),g(t,d),g(t,m),g(m,v),g(v,w),g(v,p),g(v,_),g(m,j),g(m,k),g(t,L),g(t,x),fe(Q,x,null),g(x,M),fe(b,x,null),K=!0},p:function(B,C){const V={};C[3]&4096&&(V.$$scope={dirty:C,ctx:B}),Q.$set(V);const E={};C[3]&4096&&(E.$$scope={dirty:C,ctx:B}),b.$set(E)},i:function(B){K||(G(Q.$$.fragment,B),G(b.$$.fragment,B),K=!0)},o:function(B){X(Q.$$.fragment,B),X(b.$$.fragment,B),K=!1},d:function(B){B&&h(t),ue(Q),ue(b)}};return ee("SvelteRegisterBlock",{block:I,id:Wn.name,type:"slot",source:'(2827:4) <Card class=\\"error-card\\">',ctx:s}),I}function Bt(s){let t,e,i,a,n,r,c=!s[2]&&s[6].length>0&&Vt(s);i=new Je({props:{class:"main-card half-width",$$slots:{default:[to]},$$scope:{ctx:s}},$$inline:!0}),n=new Hn({props:{frequency:s[14],note:s[15],volume:s[13],isMuted:s[0]!=="guiding",muteMessage:"åŸºéŸ³å†ç”Ÿå¾Œã«é–‹å§‹",className:"half-width",showGuidance:!1},$$inline:!0});const u={c:function(){c&&c.c(),t=$(),e=N("div"),me(i.$$.fragment),a=$(),me(n.$$.fragment),this.h()},l:function(d){c&&c.l(d),t=Z(d),e=R(d,"DIV",{class:!0});var m=z(e);de(i.$$.fragment,m),a=Z(m),de(n.$$.fragment,m),m.forEach(h),this.h()},h:function(){P(e,"class","side-by-side-container svelte-rt5px1"),F(e,A,2663,6,89923)},m:function(d,m){c&&c.m(d,m),U(d,t,m),U(d,e,m),fe(i,e,null),g(e,a),fe(n,e,null),r=!0},p:function(d,m){!d[2]&&d[6].length>0?c?(c.p(d,m),m[0]&68&&G(c,1)):(c=Vt(d),c.c(),G(c,1),c.m(t.parentNode,t)):c&&(Me(),X(c,1,1,()=>{c=null}),Ie());const v={};m[0]&8395649|m[3]&4096&&(v.$$scope={dirty:m,ctx:d}),i.$set(v);const w={};m[0]&16384&&(w.frequency=d[14]),m[0]&32768&&(w.note=d[15]),m[0]&8192&&(w.volume=d[13]),m[0]&1&&(w.isMuted=d[0]!=="guiding"),n.$set(w)},i:function(d){r||(G(c),G(i.$$.fragment,d),G(n.$$.fragment,d),r=!0)},o:function(d){X(c),X(i.$$.fragment,d),X(n.$$.fragment,d),r=!1},d:function(d){d&&(h(t),h(e)),c&&c.d(d),ue(i),ue(n)}};return ee("SvelteRegisterBlock",{block:u,id:Bt.name,type:"if",source:"(2642:4) {#if trainingPhase !== 'results'}",ctx:s}),u}function Vt(s){let t,e;t=new Je({props:{class:"warning-card",$$slots:{default:[Jn]},$$scope:{ctx:s}},$$inline:!0});const i={c:function(){me(t.$$.fragment)},l:function(n){de(t.$$.fragment,n)},m:function(n,r){fe(t,n,r),e=!0},p:function(n,r){const c={};r[0]&64|r[3]&4096&&(c.$$scope={dirty:r,ctx:n}),t.$set(c)},i:function(n){e||(G(t.$$.fragment,n),e=!0)},o:function(n){X(t.$$.fragment,n),e=!1},d:function(n){ue(t,n)}};return ee("SvelteRegisterBlock",{block:i,id:Vt.name,type:"if",source:"(2645:6) {#if !microphoneHealthy && microphoneErrors.length > 0}",ctx:s}),i}function Ht(s){let t,e=s[102]+"",i;const a={c:function(){t=N("li"),i=J(e),this.h()},l:function(r){t=R(r,"LI",{class:!0});var c=z(t);i=W(c,e),c.forEach(h),this.h()},h:function(){P(t,"class","svelte-rt5px1"),F(t,A,2653,16,89691)},m:function(r,c){U(r,t,c),g(t,i)},p:function(r,c){c[0]&64&&e!==(e=r[102]+"")&&Ce(i,e)},d:function(r){r&&h(t)}};return ee("SvelteRegisterBlock",{block:a,id:Ht.name,type:"each",source:"(2653:14) {#each microphoneErrors as error}",ctx:s}),a}function Jn(s){let t,e,i="âš ï¸ ãƒã‚¤ã‚¯æ¥ç¶šã«å•é¡ŒãŒã‚ã‚Šã¾ã™",a,n,r,c="ãƒã‚¤ã‚¯ãŒæ­£å¸¸ã«å‹•ä½œã—ã¦ã„ã¾ã›ã‚“ã€‚ä»¥ä¸‹ã®å•é¡ŒãŒæ¤œå‡ºã•ã‚Œã¾ã—ãŸï¼š",u,f,d,m,v,w="è§£æ±ºæ–¹æ³•:",p,y=lt(s[6]),_=[];for(let k=0;k<y.length;k+=1)_[k]=Ht(In(s,y,k));const j={c:function(){t=N("div"),e=N("h3"),e.textContent=i,a=$(),n=N("div"),r=N("p"),r.textContent=c,u=$(),f=N("ul");for(let D=0;D<_.length;D+=1)_[D].c();d=$(),m=N("p"),v=N("strong"),v.textContent=w,p=J(" ãƒšãƒ¼ã‚¸ã‚’å†èª­ã¿è¾¼ã¿ã—ã¦ãƒã‚¤ã‚¯è¨±å¯ã‚’å†åº¦å–å¾—ã—ã¦ãã ã•ã„ã€‚"),this.h()},l:function(D){t=R(D,"DIV",{class:!0});var L=z(t);e=R(L,"H3",{class:!0,"data-svelte-h":!0}),pe(e)!=="svelte-15qec5x"&&(e.textContent=i),L.forEach(h),a=Z(D),n=R(D,"DIV",{class:!0});var x=z(n);r=R(x,"P",{class:!0,"data-svelte-h":!0}),pe(r)!=="svelte-171o2p0"&&(r.textContent=c),u=Z(x),f=R(x,"UL",{class:!0});var Q=z(f);for(let b=0;b<_.length;b+=1)_[b].l(Q);Q.forEach(h),d=Z(x),m=R(x,"P",{class:!0});var M=z(m);v=R(M,"STRONG",{"data-svelte-h":!0}),pe(v)!=="svelte-79o66n"&&(v.textContent=w),p=W(M," ãƒšãƒ¼ã‚¸ã‚’å†èª­ã¿è¾¼ã¿ã—ã¦ãƒã‚¤ã‚¯è¨±å¯ã‚’å†åº¦å–å¾—ã—ã¦ãã ã•ã„ã€‚"),M.forEach(h),x.forEach(h),this.h()},h:function(){P(e,"class","section-title svelte-rt5px1"),F(e,A,2647,12,89415),P(t,"class","card-header svelte-rt5px1"),F(t,A,2646,10,89377),P(r,"class","warning-message svelte-rt5px1"),F(r,A,2650,12,89529),P(f,"class","error-list svelte-rt5px1"),F(f,A,2651,12,89603),F(v,A,2657,14,89802),P(m,"class","fix-instruction svelte-rt5px1"),F(m,A,2656,12,89760),P(n,"class","card-content svelte-rt5px1"),F(n,A,2649,10,89490)},m:function(D,L){U(D,t,L),g(t,e),U(D,a,L),U(D,n,L),g(n,r),g(n,u),g(n,f);for(let x=0;x<_.length;x+=1)_[x]&&_[x].m(f,null);g(n,d),g(n,m),g(m,v),g(m,p)},p:function(D,L){if(L[0]&64){y=lt(D[6]);let x;for(x=0;x<y.length;x+=1){const Q=In(D,y,x);_[x]?_[x].p(Q,L):(_[x]=Ht(Q),_[x].c(),_[x].m(f,null))}for(;x<_.length;x+=1)_[x].d(1);_.length=y.length}},d:function(D){D&&(h(t),h(a),h(n)),Bn(_,D)}};return ee("SvelteRegisterBlock",{block:j,id:Jn.name,type:"slot",source:'(2646:8) <Card class=\\"warning-card\\">',ctx:s}),j}function Kn(s){let t;function e(r,c){return r[9]?$n:r[0]==="guiding"?Zn:r[0]==="results"?Yn:Xn}let i=e(s),a=i(s);const n={c:function(){t=N("div"),a.c(),this.h()},l:function(c){t=R(c,"DIV",{class:!0});var u=z(t);a.l(u),u.forEach(h),this.h()},h:function(){P(t,"class","continuous-status svelte-rt5px1"),F(t,A,2680,14,90572)},m:function(c,u){U(c,t,u),a.m(t,null)},p:function(c,u){i===(i=e(c))&&a?a.p(c,u):(a.d(1),a=i(c),a&&(a.c(),a.m(t,null)))},i:Et,o:Et,d:function(c){c&&h(t),a.d()}};return ee("SvelteRegisterBlock",{block:n,id:Kn.name,type:"else",source:"(2679:12) {:else}",ctx:s}),n}function Qn(s){let t,e;t=new ut({props:{variant:"primary",$$slots:{default:[eo]},$$scope:{ctx:s}},$$inline:!0}),t.$on("click",s[30]);const i={c:function(){me(t.$$.fragment)},l:function(n){de(t.$$.fragment,n)},m:function(n,r){fe(t,n,r),e=!0},p:function(n,r){const c={};r[3]&4096&&(c.$$scope={dirty:r,ctx:n}),t.$set(c)},i:function(n){e||(G(t.$$.fragment,n),e=!0)},o:function(n){X(t.$$.fragment,n),e=!1},d:function(n){ue(t,n)}};return ee("SvelteRegisterBlock",{block:i,id:Qn.name,type:"if",source:"(2672:12) {#if trainingPhase === 'setup' && !isPlaying && !($currentSessionId > 1)}",ctx:s}),i}function Xn(s){let t,e,i,a;const n={c:function(){t=N("div"),e=J("âš¡ é€£ç¶šãƒ¢ãƒ¼ãƒ‰é€²è¡Œä¸­ ("),i=J(s[23]),a=J("/8)"),this.h()},l:function(c){t=R(c,"DIV",{class:!0});var u=z(t);e=W(u,"âš¡ é€£ç¶šãƒ¢ãƒ¼ãƒ‰é€²è¡Œä¸­ ("),i=W(u,s[23]),a=W(u,"/8)"),u.forEach(h),this.h()},h:function(){P(t,"class","status-text svelte-rt5px1"),F(t,A,2694,18,91162)},m:function(c,u){U(c,t,u),g(t,e),g(t,i),g(t,a)},p:function(c,u){u[0]&8388608&&Ce(i,c[23])},d:function(c){c&&h(t)}};return ee("SvelteRegisterBlock",{block:n,id:Xn.name,type:"else",source:"(2694:16) {:else}",ctx:s}),n}function Yn(s){let t,e,i,a;const n={c:function(){t=N("div"),e=J("âœ… ã‚»ãƒƒã‚·ãƒ§ãƒ³ "),i=J(s[23]),a=J("/8 å®Œäº†"),this.h()},l:function(c){t=R(c,"DIV",{class:!0});var u=z(t);e=W(u,"âœ… ã‚»ãƒƒã‚·ãƒ§ãƒ³ "),i=W(u,s[23]),a=W(u,"/8 å®Œäº†"),u.forEach(h),this.h()},h:function(){P(t,"class","status-text svelte-rt5px1"),F(t,A,2690,18,91016)},m:function(c,u){U(c,t,u),g(t,e),g(t,i),g(t,a)},p:function(c,u){u[0]&8388608&&Ce(i,c[23])},d:function(c){c&&h(t)}};return ee("SvelteRegisterBlock",{block:n,id:Yn.name,type:"if",source:"(2690:54) ",ctx:s}),n}function Zn(s){let t,e,i,a;const n={c:function(){t=N("div"),e=J("ğŸ¤ ã‚»ãƒƒã‚·ãƒ§ãƒ³ "),i=J(s[23]),a=J("/8: ãƒ‰ãƒ¬ãƒŸç™ºå£°ä¸­"),this.h()},l:function(c){t=R(c,"DIV",{class:!0});var u=z(t);e=W(u,"ğŸ¤ ã‚»ãƒƒã‚·ãƒ§ãƒ³ "),i=W(u,s[23]),a=W(u,"/8: ãƒ‰ãƒ¬ãƒŸç™ºå£°ä¸­"),u.forEach(h),this.h()},h:function(){P(t,"class","status-text svelte-rt5px1"),F(t,A,2686,18,90833)},m:function(c,u){U(c,t,u),g(t,e),g(t,i),g(t,a)},p:function(c,u){u[0]&8388608&&Ce(i,c[23])},d:function(c){c&&h(t)}};return ee("SvelteRegisterBlock",{block:n,id:Zn.name,type:"if",source:"(2686:54) ",ctx:s}),n}function $n(s){let t,e,i,a;const n={c:function(){t=N("div"),e=J("ğŸµ åŸºéŸ³ "),i=J(s[23]),a=J("/8 å†ç”Ÿä¸­..."),this.h()},l:function(c){t=R(c,"DIV",{class:!0});var u=z(t);e=W(u,"ğŸµ åŸºéŸ³ "),i=W(u,s[23]),a=W(u,"/8 å†ç”Ÿä¸­..."),u.forEach(h),this.h()},h:function(){P(t,"class","status-text svelte-rt5px1"),F(t,A,2682,18,90654)},m:function(c,u){U(c,t,u),g(t,e),g(t,i),g(t,a)},p:function(c,u){u[0]&8388608&&Ce(i,c[23])},d:function(c){c&&h(t)}};return ee("SvelteRegisterBlock",{block:n,id:$n.name,type:"if",source:"(2682:16) {#if isPlaying}",ctx:s}),n}function eo(s){let t;const e={c:function(){t=J("âš¡ é€£ç¶šãƒãƒ£ãƒ¬ãƒ³ã‚¸é–‹å§‹ï¼ˆ8ã‚»ãƒƒã‚·ãƒ§ãƒ³ï¼‰")},l:function(a){t=W(a,"âš¡ é€£ç¶šãƒãƒ£ãƒ¬ãƒ³ã‚¸é–‹å§‹ï¼ˆ8ã‚»ãƒƒã‚·ãƒ§ãƒ³ï¼‰")},m:function(a,n){U(a,t,n)},d:function(a){a&&h(t)}};return ee("SvelteRegisterBlock",{block:e,id:eo.name,type:"slot",source:'(2673:14) <Button                  variant=\\"primary\\"                 on:click={startContinuousMode}               >',ctx:s}),e}function zt(s){let t,e,i,a,n,r=s[8].toFixed(1)+"",c,u;const f={c:function(){t=N("div"),e=J("ç¾åœ¨ã®åŸºéŸ³: "),i=N("strong"),a=J(s[7]),n=J(" ("),c=J(r),u=J("Hz)"),this.h()},l:function(m){t=R(m,"DIV",{class:!0});var v=z(t);e=W(v,"ç¾åœ¨ã®åŸºéŸ³: "),i=R(v,"STRONG",{});var w=z(i);a=W(w,s[7]),w.forEach(h),n=W(v," ("),c=W(v,r),u=W(v,"Hz)"),v.forEach(h),this.h()},h:function(){F(i,A,2703,23,91442),P(t,"class","base-note-info svelte-rt5px1"),F(t,A,2702,14,91390)},m:function(m,v){U(m,t,v),g(t,e),g(t,i),g(i,a),g(t,n),g(t,c),g(t,u)},p:function(m,v){v[0]&128&&Ce(a,m[7]),v[0]&256&&r!==(r=m[8].toFixed(1)+"")&&Ce(c,r)},d:function(m){m&&h(t)}};return ee("SvelteRegisterBlock",{block:f,id:zt.name,type:"if",source:"(2702:12) {#if currentBaseNote}",ctx:s}),f}function to(s){let t,e,i="ğŸ¹ åŸºéŸ³å†ç”Ÿ",a,n,r,c,u,f,d,m,v="ã‚¬ã‚¤ãƒ‰é–‹å§‹ã¾ã§",w,p,y,_,j,k,D,L;const x=[Qn,Kn],Q=[];function M(I,q){return I[0]==="setup"&&!I[9]&&!(I[23]>1)?0:1}r=M(s),c=Q[r]=x[r](s);let b=s[7]&&zt(s);k=new jn({props:{size:"20"},$$inline:!0});const K={c:function(){t=N("div"),e=N("h3"),e.textContent=i,a=$(),n=N("div"),c.c(),u=$(),b&&b.c(),f=$(),d=N("div"),m=N("div"),m.textContent=v,w=$(),p=N("div"),y=N("div"),_=$(),j=N("div"),me(k.$$.fragment),this.h()},l:function(q){t=R(q,"DIV",{class:!0});var B=z(t);e=R(B,"H3",{class:!0,"data-svelte-h":!0}),pe(e)!=="svelte-syc53b"&&(e.textContent=i),B.forEach(h),a=Z(q),n=R(q,"DIV",{class:!0});var C=z(n);c.l(C),u=Z(C),b&&b.l(C),f=Z(C),d=R(C,"DIV",{class:!0});var V=z(d);m=R(V,"DIV",{class:!0,"data-svelte-h":!0}),pe(m)!=="svelte-1dufnpv"&&(m.textContent=v),w=Z(V),p=R(V,"DIV",{class:!0});var E=z(p);y=R(E,"DIV",{class:!0,style:!0}),z(y).forEach(h),_=Z(E),j=R(E,"DIV",{class:!0});var Y=z(j);de(k.$$.fragment,Y),Y.forEach(h),E.forEach(h),V.forEach(h),C.forEach(h),this.h()},h:function(){P(e,"class","section-title svelte-rt5px1"),F(e,A,2667,12,90087),P(t,"class","card-header svelte-rt5px1"),F(t,A,2666,10,90049),P(m,"class","guide-start-label svelte-rt5px1"),F(m,A,2709,14,91667),P(y,"class","guide-progress-fill svelte-rt5px1"),Qe(y,"width",s[11]+"%"),F(y,A,2711,16,91772),P(j,"class",D="guide-music-icon "+(s[12]?"glowing":"")+" svelte-rt5px1"),F(j,A,2715,16,91920),P(p,"class","guide-start-bar svelte-rt5px1"),F(p,A,2710,14,91726),P(d,"class","guide-start-bar-container svelte-rt5px1"),F(d,A,2708,12,91613),P(n,"class","card-content svelte-rt5px1"),F(n,A,2669,10,90153)},m:function(q,B){U(q,t,B),g(t,e),U(q,a,B),U(q,n,B),Q[r].m(n,null),g(n,u),b&&b.m(n,null),g(n,f),g(n,d),g(d,m),g(d,w),g(d,p),g(p,y),g(p,_),g(p,j),fe(k,j,null),L=!0},p:function(q,B){let C=r;r=M(q),r===C?Q[r].p(q,B):(Me(),X(Q[C],1,1,()=>{Q[C]=null}),Ie(),c=Q[r],c?c.p(q,B):(c=Q[r]=x[r](q),c.c()),G(c,1),c.m(n,u)),q[7]?b?b.p(q,B):(b=zt(q),b.c(),b.m(n,f)):b&&(b.d(1),b=null),(!L||B[0]&2048)&&Qe(y,"width",q[11]+"%"),(!L||B[0]&4096&&D!==(D="guide-music-icon "+(q[12]?"glowing":"")+" svelte-rt5px1"))&&P(j,"class",D)},i:function(q){L||(G(c),G(k.$$.fragment,q),L=!0)},o:function(q){X(c),X(k.$$.fragment,q),L=!1},d:function(q){q&&(h(t),h(a),h(n)),Q[r].d(),b&&b.d(),ue(k)}};return ee("SvelteRegisterBlock",{block:K,id:to.name,type:"slot",source:'(2666:8) <Card class=\\"main-card half-width\\">',ctx:s}),K}function jt(s){let t,e;t=new Je({props:{class:"main-card",$$slots:{default:[no]},$$scope:{ctx:s}},$$inline:!0});const i={c:function(){me(t.$$.fragment)},l:function(n){de(t.$$.fragment,n)},m:function(n,r){fe(t,n,r),e=!0},p:function(n,r){const c={};r[0]&1025|r[3]&4096&&(c.$$scope={dirty:r,ctx:n}),t.$set(c)},i:function(n){e||(G(t.$$.fragment,n),e=!0)},o:function(n){X(t.$$.fragment,n),e=!1},d:function(n){ue(t,n)}};return ee("SvelteRegisterBlock",{block:i,id:jt.name,type:"if",source:"(2737:4) {#if trainingPhase !== 'results'}",ctx:s}),i}function Lt(s){let t,e=s[99].name+"",i,a,n;const r={c:function(){t=N("div"),i=J(e),a=$(),this.h()},l:function(u){t=R(u,"DIV",{class:!0});var f=z(t);i=W(f,e),a=Z(f),f.forEach(h),this.h()},h:function(){P(t,"class",n="scale-item "+s[99].state+" svelte-rt5px1"),F(t,A,2745,14,92822)},m:function(u,f){U(u,t,f),g(t,i),g(t,a)},p:function(u,f){f[0]&1024&&e!==(e=u[99].name+"")&&Ce(i,e),f[0]&1024&&n!==(n="scale-item "+u[99].state+" svelte-rt5px1")&&P(t,"class",n)},d:function(u){u&&h(t)}};return ee("SvelteRegisterBlock",{block:r,id:Lt.name,type:"each",source:"(2745:12) {#each scaleSteps as step, index}",ctx:s}),r}function Ot(s){let t,e,i,a="ãƒ‰ãƒ¬ãƒŸãƒ•ã‚¡ã‚½ãƒ©ã‚·ãƒ‰",n;const r={c:function(){t=N("div"),e=J("ã‚¬ã‚¤ãƒ‰ã«åˆã‚ã›ã¦ "),i=N("strong"),i.textContent=a,n=J(" ã‚’æ­Œã£ã¦ãã ã•ã„"),this.h()},l:function(u){t=R(u,"DIV",{class:!0});var f=z(t);e=W(f,"ã‚¬ã‚¤ãƒ‰ã«åˆã‚ã›ã¦ "),i=R(f,"STRONG",{"data-svelte-h":!0}),pe(i)!=="svelte-1dipf74"&&(i.textContent=a),n=W(f," ã‚’æ­Œã£ã¦ãã ã•ã„"),f.forEach(h),this.h()},h:function(){F(i,A,2754,23,93089),P(t,"class","guide-instruction svelte-rt5px1"),F(t,A,2753,12,93034)},m:function(u,f){U(u,t,f),g(t,e),g(t,i),g(t,n)},d:function(u){u&&h(t)}};return ee("SvelteRegisterBlock",{block:r,id:Ot.name,type:"if",source:"(2753:10) {#if trainingPhase === 'guiding'}",ctx:s}),r}function no(s){let t,e,i="ğŸµ ãƒ‰ãƒ¬ãƒŸéŸ³éšã‚¬ã‚¤ãƒ‰",a,n,r,c,u=lt(s[10]),f=[];for(let v=0;v<u.length;v+=1)f[v]=Lt(Mn(s,u,v));let d=s[0]==="guiding"&&Ot(s);const m={c:function(){t=N("div"),e=N("h3"),e.textContent=i,a=$(),n=N("div"),r=N("div");for(let w=0;w<f.length;w+=1)f[w].c();c=$(),d&&d.c(),this.h()},l:function(w){t=R(w,"DIV",{class:!0});var p=z(t);e=R(p,"H3",{class:!0,"data-svelte-h":!0}),pe(e)!=="svelte-1mor0as"&&(e.textContent=i),p.forEach(h),a=Z(w),n=R(w,"DIV",{class:!0});var y=z(n);r=R(y,"DIV",{class:!0});var _=z(r);for(let j=0;j<f.length;j+=1)f[j].l(_);_.forEach(h),c=Z(y),d&&d.l(y),y.forEach(h),this.h()},h:function(){P(e,"class","section-title svelte-rt5px1"),F(e,A,2740,10,92633),P(t,"class","card-header svelte-rt5px1"),F(t,A,2739,8,92597),P(r,"class","scale-guide svelte-rt5px1"),F(r,A,2743,10,92736),P(n,"class","card-content svelte-rt5px1"),F(n,A,2742,8,92699)},m:function(w,p){U(w,t,p),g(t,e),U(w,a,p),U(w,n,p),g(n,r);for(let y=0;y<f.length;y+=1)f[y]&&f[y].m(r,null);g(n,c),d&&d.m(n,null)},p:function(w,p){if(p[0]&1024){u=lt(w[10]);let y;for(y=0;y<u.length;y+=1){const _=Mn(w,u,y);f[y]?f[y].p(_,p):(f[y]=Lt(_),f[y].c(),f[y].m(r,null))}for(;y<f.length;y+=1)f[y].d(1);f.length=u.length}w[0]==="guiding"?d||(d=Ot(w),d.c(),d.m(n,null)):d&&(d.d(1),d=null)},d:function(w){w&&(h(t),h(a),h(n)),Bn(f,w),d&&d.d()}};return ee("SvelteRegisterBlock",{block:m,id:no.name,type:"slot",source:'(2739:6) <Card class=\\"main-card\\">',ctx:s}),m}function Gt(s){let t,e,i,a,n,r,c;const u=[ro,oo],f=[];function d(y,_){return y[4]&&y[5]?0:y[21]?1:-1}~(t=d(s))&&(e=f[t]=u[t](s));const m=[so,ao],v=[];function w(y,_){return y[0]==="results"&&y[5]?0:y[0]==="results"&&!y[5]?1:-1}~(a=w(s))&&(n=v[a]=m[a](s));const p={c:function(){e&&e.c(),i=$(),n&&n.c(),r=je()},l:function(_){e&&e.l(_),i=Z(_),n&&n.l(_),r=je()},m:function(_,j){~t&&f[t].m(_,j),U(_,i,j),~a&&v[a].m(_,j),U(_,r,j),c=!0},p:function(_,j){let k=t;t=d(_),t===k?~t&&f[t].p(_,j):(e&&(Me(),X(f[k],1,1,()=>{f[k]=null}),Ie()),~t?(e=f[t],e?e.p(_,j):(e=f[t]=u[t](_),e.c()),G(e,1),e.m(i.parentNode,i)):e=null);let D=a;a=w(_),a===D?~a&&v[a].p(_,j):(n&&(Me(),X(v[D],1,1,()=>{v[D]=null}),Ie()),~a?(n=v[a],n?n.p(_,j):(n=v[a]=m[a](_),n.c()),G(n,1),n.m(r.parentNode,r)):n=null)},i:function(_){c||(G(e),G(n),c=!0)},o:function(_){X(e),X(n),c=!1},d:function(_){_&&(h(i),h(r)),~t&&f[t].d(_),~a&&v[a].d(_)}};return ee("SvelteRegisterBlock",{block:p,id:Gt.name,type:"if",source:"(2764:4) {#if trainingPhase === 'results'}",ctx:s}),p}function oo(s){let t,e;t=new Xt({props:{scoreData:s[21],showDetails:!1,className:"mb-6 iphone-no-margin",currentScoreData:s[16],intervalData:s[3],consistencyData:s[17],feedbackData:s[18],technicalFeedbackData:s[19],sessionStatistics:s[20]},$$inline:!0});const i={c:function(){me(t.$$.fragment)},l:function(n){de(t.$$.fragment,n)},m:function(n,r){fe(t,n,r),e=!0},p:function(n,r){const c={};r[0]&2097152&&(c.scoreData=n[21]),r[0]&65536&&(c.currentScoreData=n[16]),r[0]&8&&(c.intervalData=n[3]),r[0]&131072&&(c.consistencyData=n[17]),r[0]&262144&&(c.feedbackData=n[18]),r[0]&524288&&(c.technicalFeedbackData=n[19]),r[0]&1048576&&(c.sessionStatistics=n[20]),t.$set(c)},i:function(n){e||(G(t.$$.fragment,n),e=!0)},o:function(n){X(t.$$.fragment,n),e=!1},d:function(n){ue(t,n)}};return ee("SvelteRegisterBlock",{block:i,id:oo.name,type:"if",source:"(2779:40) ",ctx:s}),i}function ro(s){let t,e;t=new Xt({props:{scoreData:s[4],showDetails:!1,className:"mb-6 iphone-no-margin",currentScoreData:s[16],intervalData:s[3],consistencyData:s[17],feedbackData:s[18],technicalFeedbackData:s[19],sessionStatistics:s[20]},$$inline:!0});const i={c:function(){me(t.$$.fragment)},l:function(n){de(t.$$.fragment,n)},m:function(n,r){fe(t,n,r),e=!0},p:function(n,r){const c={};r[0]&16&&(c.scoreData=n[4]),r[0]&65536&&(c.currentScoreData=n[16]),r[0]&8&&(c.intervalData=n[3]),r[0]&131072&&(c.consistencyData=n[17]),r[0]&262144&&(c.feedbackData=n[18]),r[0]&524288&&(c.technicalFeedbackData=n[19]),r[0]&1048576&&(c.sessionStatistics=n[20]),t.$set(c)},i:function(n){e||(G(t.$$.fragment,n),e=!0)},o:function(n){X(t.$$.fragment,n),e=!1},d:function(n){ue(t,n)}};return ee("SvelteRegisterBlock",{block:i,id:ro.name,type:"if",source:"(2766:6) {#if $unifiedScoreData && $isCompleted}",ctx:s}),i}function ao(s){let t,e;t=new Je({props:{class:"main-card bottom-action-card",$$slots:{default:[co]},$$scope:{ctx:s}},$$inline:!0});const i={c:function(){me(t.$$.fragment)},l:function(n){de(t.$$.fragment,n)},m:function(n,r){fe(t,n,r),e=!0},p:function(n,r){const c={};r[3]&4096&&(c.$$scope={dirty:r,ctx:n}),t.$set(c)},i:function(n){e||(G(t.$$.fragment,n),e=!0)},o:function(n){X(t.$$.fragment,n),e=!1},d:function(n){ue(t,n)}};return ee("SvelteRegisterBlock",{block:i,id:ao.name,type:"if",source:"(2808:61) ",ctx:s}),i}function so(s){let t,e;t=new Je({props:{class:"main-card bottom-action-card",$$slots:{default:[io]},$$scope:{ctx:s}},$$inline:!0});const i={c:function(){me(t.$$.fragment)},l:function(n){de(t.$$.fragment,n)},m:function(n,r){fe(t,n,r),e=!0},p:function(n,r){const c={};r[0]&32|r[3]&4096&&(c.$$scope={dirty:r,ctx:n}),t.$set(c)},i:function(n){e||(G(t.$$.fragment,n),e=!0)},o:function(n){X(t.$$.fragment,n),e=!1},d:function(n){ue(t,n)}};return ee("SvelteRegisterBlock",{block:i,id:so.name,type:"if",source:"(2797:6) {#if trainingPhase === 'results' && $isCompleted}",ctx:s}),i}function co(s){let t,e,i,a,n,r,c="æ¬¡ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’æº–å‚™ä¸­...";const u={c:function(){t=N("div"),e=N("div"),i=N("div"),a=N("div"),n=$(),r=N("span"),r.textContent=c,this.h()},l:function(d){t=R(d,"DIV",{class:!0});var m=z(t);e=R(m,"DIV",{class:!0});var v=z(e);i=R(v,"DIV",{class:!0});var w=z(i);a=R(w,"DIV",{class:!0}),z(a).forEach(h),n=Z(w),r=R(w,"SPAN",{"data-svelte-h":!0}),pe(r)!=="svelte-11jhwau"&&(r.textContent=c),w.forEach(h),v.forEach(h),m.forEach(h),this.h()},h:function(){P(a,"class","spinner"),F(a,A,2813,16,95148),F(r,A,2814,16,95192),P(i,"class","auto-progress-indicator"),F(i,A,2812,14,95094),P(e,"class","continuous-mode-message"),F(e,A,2811,12,95042),P(t,"class","card-content svelte-rt5px1"),F(t,A,2810,10,95003)},m:function(d,m){U(d,t,m),g(t,e),g(e,i),g(i,a),g(i,n),g(i,r)},p:Et,d:function(d){d&&h(t)}};return ee("SvelteRegisterBlock",{block:u,id:co.name,type:"slot",source:'(2810:8) <Card class=\\"main-card bottom-action-card\\">',ctx:s}),u}function io(s){let t,e,i;e=new Qt({props:{isCompleted:s[5],position:"bottom"},$$inline:!0}),e.$on("action",s[29]);const a={c:function(){t=N("div"),me(e.$$.fragment),this.h()},l:function(r){t=R(r,"DIV",{class:!0});var c=z(t);de(e.$$.fragment,c),c.forEach(h),this.h()},h:function(){P(t,"class","card-content svelte-rt5px1"),F(t,A,2798,10,94561)},m:function(r,c){U(r,t,c),fe(e,t,null),i=!0},p:function(r,c){const u={};c[0]&32&&(u.isCompleted=r[5]),e.$set(u)},i:function(r){i||(G(e.$$.fragment,r),i=!0)},o:function(r){X(e.$$.fragment,r),i=!1},d:function(r){r&&h(t),ue(e)}};return ee("SvelteRegisterBlock",{block:a,id:io.name,type:"slot",source:'(2798:8) <Card class=\\"main-card bottom-action-card\\">',ctx:s}),a}function lo(s){let t,e,i="âš¡ é€£ç¶šãƒãƒ£ãƒ¬ãƒ³ã‚¸ãƒ¢ãƒ¼ãƒ‰",a,n,r="ä¸­ç´šè€…å‘ã‘ï¼š8ã‚»ãƒƒã‚·ãƒ§ãƒ³é€£ç¶šã§åŸºéŸ³ãŒè‡ªå‹•å†ç”Ÿã•ã‚Œã‚‹é›†ä¸­ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°",c,u,f,d,m,v,w,p,y,_,j,k,D,L,x,Q,M=s[1]==="granted"&&!s[25]&&Pt(s);const b=[On,Ln],K=[];function I(B,C){return B[1]==="granted"?0:1}D=I(s),L=K[D]=b[D](s);const q={c:function(){t=N("div"),e=N("h1"),e.textContent=i,a=$(),n=N("p"),n.textContent=r,c=$(),M&&M.c(),u=$(),f=N("div"),d=J("ğŸ“± "),m=J(Wt),v=J(" | "),w=J(Jt),p=N("br"),y=$(),_=N("small"),j=J(Kt),k=$(),L.c(),x=je(),this.h()},l:function(C){t=R(C,"DIV",{class:!0});var V=z(t);e=R(V,"H1",{class:!0,"data-svelte-h":!0}),pe(e)!=="svelte-1nub9gt"&&(e.textContent=i),a=Z(V),n=R(V,"P",{class:!0,"data-svelte-h":!0}),pe(n)!=="svelte-gneggn"&&(n.textContent=r),c=Z(V),M&&M.l(V),u=Z(V),f=R(V,"DIV",{class:!0});var E=z(f);d=W(E,"ğŸ“± "),m=W(E,Wt),v=W(E," | "),w=W(E,Jt),p=R(E,"BR",{}),y=Z(E),_=R(E,"SMALL",{style:!0});var Y=z(_);j=W(Y,Kt),Y.forEach(h),E.forEach(h),V.forEach(h),k=Z(C),L.l(C),x=je(),this.h()},h:function(){P(e,"class","page-title svelte-rt5px1"),F(e,A,2581,4,87136),P(n,"class","page-description svelte-rt5px1"),F(n,A,2582,4,87181),F(p,A,2616,42,88405),Qe(_,"font-size","0.6rem"),F(_,A,2617,6,88417),P(f,"class","debug-info svelte-rt5px1"),F(f,A,2615,4,88338),P(t,"class","header-section svelte-rt5px1"),F(t,A,2580,2,87103)},m:function(C,V){U(C,t,V),g(t,e),g(t,a),g(t,n),g(t,c),M&&M.m(t,null),g(t,u),g(t,f),g(f,d),g(f,m),g(f,v),g(f,w),g(f,p),g(f,y),g(f,_),g(_,j),U(C,k,V),K[D].m(C,V),U(C,x,V),Q=!0},p:function(C,V){C[1]==="granted"&&!C[25]?M?(M.p(C,V),V[0]&33554434&&G(M,1)):(M=Pt(C),M.c(),G(M,1),M.m(t,u)):M&&(Me(),X(M,1,1,()=>{M=null}),Ie());let E=D;D=I(C),D===E?K[D].p(C,V):(Me(),X(K[E],1,1,()=>{K[E]=null}),Ie(),L=K[D],L?L.p(C,V):(L=K[D]=b[D](C),L.c()),G(L,1),L.m(x.parentNode,x))},i:function(C){Q||(G(M),G(L),Q=!0)},o:function(C){X(M),X(L),Q=!1},d:function(C){C&&(h(t),h(k),h(x)),M&&M.d(),K[D].d(C)}};return ee("SvelteRegisterBlock",{block:q,id:lo.name,type:"slot",source:"(2579:0) <PageLayout>",ctx:s}),q}function Ut(s){let t,e,i;e=new Vn({props:{$$slots:{default:[lo]},$$scope:{ctx:s}},$$inline:!0});const a={c:function(){t=$(),me(e.$$.fragment),this.h()},l:function(r){Do("svelte-13kpo59",Tn.head).forEach(h),t=Z(r),de(e.$$.fragment,r),this.h()},h:function(){Tn.title="é€£ç¶šãƒãƒ£ãƒ¬ãƒ³ã‚¸ãƒ¢ãƒ¼ãƒ‰ - ç›¸å¯¾éŸ³æ„Ÿãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°"},m:function(r,c){U(r,t,c),fe(e,r,c),i=!0},p:function(r,c){const u={};c[0]&67108863|c[3]&4096&&(u.$$scope={dirty:c,ctx:r}),e.$set(u)},i:function(r){i||(G(e.$$.fragment,r),i=!0)},o:function(r){X(e.$$.fragment,r),i=!1},d:function(r){r&&h(t),ue(e,r)}};return ee("SvelteRegisterBlock",{block:a,id:Ut.name,type:"component",source:"",ctx:s}),a}const Wt="v2.3.1-ANIMATED",Jt="07/29 04:15",Kt="ğŸ¬ è©•ä¾¡åˆ†å¸ƒã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè£…ãƒ»UXå‘ä¸Š";function En(){const s=/iPhone/.test(navigator.userAgent),t=/iPad/.test(navigator.userAgent),e=/Macintosh/.test(navigator.userAgent)&&"ontouchend"in document;return s||t||e?(console.log("ğŸ”Š [RandomTraining] iOS/iPadOSæ¤œå‡º - éŸ³é‡35dBè¨­å®š"),35):(console.log("ğŸ”Š [RandomTraining] PCæ¤œå‡º - éŸ³é‡-6dBè¨­å®š"),-6)}function Jo(){return{mode:"continuous",timestamp:new Date,duration:480,totalNotes:64,measuredNotes:59,averageAccuracy:79,baseNote:"C5",baseFrequency:523.25,sessionHistory:[{grade:"excellent",accuracy:92,baseNote:"C4",baseFrequency:261.63,timestamp:new Date(Date.now()-7*6e4),measuredNotes:8,noteResults:[{name:"ãƒ‰",note:"ãƒ‰",frequency:262,detectedFrequency:264,cents:13,grade:"excellent"},{name:"ãƒ¬",note:"ãƒ¬",frequency:294,detectedFrequency:291,cents:-18,grade:"good"},{name:"ãƒŸ",note:"ãƒŸ",frequency:330,detectedFrequency:335,cents:26,grade:"pass"},{name:"ãƒ•ã‚¡",note:"ãƒ•ã‚¡",frequency:349,detectedFrequency:346,cents:-15,grade:"excellent"},{name:"ã‚½",note:"ã‚½",frequency:392,detectedFrequency:388,cents:-18,grade:"good"},{name:"ãƒ©",note:"ãƒ©",frequency:440,detectedFrequency:444,cents:16,grade:"good"},{name:"ã‚·",note:"ã‚·",frequency:494,detectedFrequency:499,cents:17,grade:"good"},{name:"ãƒ‰ï¼ˆé«˜ï¼‰",note:"ãƒ‰ï¼ˆé«˜ï¼‰",frequency:523,detectedFrequency:520,cents:-10,grade:"excellent"}]},{grade:"good",accuracy:78,baseNote:"D4",baseFrequency:293.66,timestamp:new Date(Date.now()-6*6e4),measuredNotes:7,noteResults:[{name:"ãƒ‰",note:"ãƒ‰",frequency:294,detectedFrequency:290,cents:-23,grade:"good"},{name:"ãƒ¬",note:"ãƒ¬",frequency:330,detectedFrequency:340,cents:53,grade:"needWork"},{name:"ãƒŸ",note:"ãƒŸ",frequency:370,detectedFrequency:375,cents:23,grade:"good"},{name:"ãƒ•ã‚¡",note:"ãƒ•ã‚¡",frequency:392,detectedFrequency:385,cents:-31,grade:"pass"},{name:"ã‚½",note:"ã‚½",frequency:440,detectedFrequency:432,cents:-31,grade:"pass"},{name:"ãƒ©",note:"ãƒ©",frequency:494,detectedFrequency:510,cents:56,grade:"needWork"},{name:"ã‚·",note:"ã‚·",frequency:554,detectedFrequency:null,cents:null,grade:"notMeasured"},{name:"ãƒ‰ï¼ˆé«˜ï¼‰",note:"ãƒ‰ï¼ˆé«˜ï¼‰",frequency:587,detectedFrequency:580,cents:-21,grade:"good"}]},{grade:"excellent",accuracy:95,baseNote:"E4",baseFrequency:329.63,timestamp:new Date(Date.now()-5*6e4),measuredNotes:8,noteResults:[{name:"ãƒ‰",note:"ãƒ‰",frequency:330,detectedFrequency:332,cents:10,grade:"excellent"},{name:"ãƒ¬",note:"ãƒ¬",frequency:370,detectedFrequency:368,cents:-9,grade:"excellent"},{name:"ãƒŸ",note:"ãƒŸ",frequency:415,detectedFrequency:418,cents:12,grade:"excellent"},{name:"ãƒ•ã‚¡",note:"ãƒ•ã‚¡",frequency:440,detectedFrequency:436,cents:-16,grade:"good"},{name:"ã‚½",note:"ã‚½",frequency:494,detectedFrequency:497,cents:11,grade:"excellent"},{name:"ãƒ©",note:"ãƒ©",frequency:554,detectedFrequency:551,cents:-9,grade:"excellent"},{name:"ã‚·",note:"ã‚·",frequency:622,detectedFrequency:625,cents:8,grade:"excellent"},{name:"ãƒ‰ï¼ˆé«˜ï¼‰",note:"ãƒ‰ï¼ˆé«˜ï¼‰",frequency:659,detectedFrequency:655,cents:-10,grade:"excellent"}]},{grade:"needWork",accuracy:45,baseNote:"F4",baseFrequency:349.23,timestamp:new Date(Date.now()-4*6e4),measuredNotes:6,noteResults:[{name:"ãƒ‰",note:"ãƒ‰",frequency:349,detectedFrequency:345,cents:-20,grade:"good"},{name:"ãƒ¬",note:"ãƒ¬",frequency:392,detectedFrequency:420,cents:124,grade:"needWork"},{name:"ãƒŸ",note:"ãƒŸ",frequency:440,detectedFrequency:435,cents:-20,grade:"good"},{name:"ãƒ•ã‚¡",note:"ãƒ•ã‚¡",frequency:466,detectedFrequency:520,cents:195,grade:"needWork"},{name:"ã‚½",note:"ã‚½",frequency:523,detectedFrequency:410,cents:-455,grade:"needWork"},{name:"ãƒ©",note:"ãƒ©",frequency:587,detectedFrequency:null,cents:null,grade:"notMeasured"},{name:"ã‚·",note:"ã‚·",frequency:659,detectedFrequency:650,cents:-24,grade:"good"},{name:"ãƒ‰ï¼ˆé«˜ï¼‰",note:"ãƒ‰ï¼ˆé«˜ï¼‰",frequency:698,detectedFrequency:null,cents:null,grade:"notMeasured"}]},{grade:"good",accuracy:85,baseNote:"G4",baseFrequency:392,timestamp:new Date(Date.now()-3*6e4),measuredNotes:8,noteResults:[{name:"ãƒ‰",note:"ãƒ‰",frequency:392,detectedFrequency:395,cents:13,grade:"excellent"},{name:"ãƒ¬",note:"ãƒ¬",frequency:440,detectedFrequency:438,cents:-8,grade:"excellent"},{name:"ãƒŸ",note:"ãƒŸ",frequency:494,detectedFrequency:500,cents:21,grade:"good"},{name:"ãƒ•ã‚¡",note:"ãƒ•ã‚¡",frequency:523,detectedFrequency:520,cents:-10,grade:"excellent"},{name:"ã‚½",note:"ã‚½",frequency:587,detectedFrequency:595,cents:24,grade:"good"},{name:"ãƒ©",note:"ãƒ©",frequency:659,detectedFrequency:665,cents:16,grade:"good"},{name:"ã‚·",note:"ã‚·",frequency:740,detectedFrequency:755,cents:35,grade:"pass"},{name:"ãƒ‰ï¼ˆé«˜ï¼‰",note:"ãƒ‰ï¼ˆé«˜ï¼‰",frequency:784,detectedFrequency:780,cents:-9,grade:"excellent"}]},{grade:"excellent",accuracy:94,baseNote:"A4",baseFrequency:440,timestamp:new Date(Date.now()-2*6e4),measuredNotes:8,noteResults:[{name:"ãƒ‰",note:"ãƒ‰",frequency:440,detectedFrequency:442,cents:8,grade:"excellent"},{name:"ãƒ¬",note:"ãƒ¬",frequency:494,detectedFrequency:492,cents:-7,grade:"excellent"},{name:"ãƒŸ",note:"ãƒŸ",frequency:554,detectedFrequency:558,cents:12,grade:"excellent"},{name:"ãƒ•ã‚¡",note:"ãƒ•ã‚¡",frequency:587,detectedFrequency:585,cents:-6,grade:"excellent"},{name:"ã‚½",note:"ã‚½",frequency:659,detectedFrequency:665,cents:16,grade:"good"},{name:"ãƒ©",note:"ãƒ©",frequency:740,detectedFrequency:738,cents:-5,grade:"excellent"},{name:"ã‚·",note:"ã‚·",frequency:831,detectedFrequency:840,cents:19,grade:"good"},{name:"ãƒ‰ï¼ˆé«˜ï¼‰",note:"ãƒ‰ï¼ˆé«˜ï¼‰",frequency:880,detectedFrequency:882,cents:4,grade:"excellent"}]},{grade:"pass",accuracy:68,baseNote:"Bb4",baseFrequency:466.16,timestamp:new Date(Date.now()-1*6e4),measuredNotes:7,noteResults:[{name:"ãƒ‰",note:"ãƒ‰",frequency:466,detectedFrequency:470,cents:15,grade:"excellent"},{name:"ãƒ¬",note:"ãƒ¬",frequency:523,detectedFrequency:535,cents:39,grade:"pass"},{name:"ãƒŸ",note:"ãƒŸ",frequency:587,detectedFrequency:600,cents:38,grade:"pass"},{name:"ãƒ•ã‚¡",note:"ãƒ•ã‚¡",frequency:622,detectedFrequency:615,cents:-19,grade:"good"},{name:"ã‚½",note:"ã‚½",frequency:698,detectedFrequency:720,cents:54,grade:"needWork"},{name:"ãƒ©",note:"ãƒ©",frequency:784,detectedFrequency:null,cents:null,grade:"notMeasured"},{name:"ã‚·",note:"ã‚·",frequency:880,detectedFrequency:895,cents:29,grade:"pass"},{name:"ãƒ‰ï¼ˆé«˜ï¼‰",note:"ãƒ‰ï¼ˆé«˜ï¼‰",frequency:932,detectedFrequency:925,cents:-13,grade:"excellent"}]},{grade:"good",accuracy:82,baseNote:"C5",baseFrequency:523.25,timestamp:new Date,measuredNotes:8,noteResults:[{name:"ãƒ‰",note:"ãƒ‰",frequency:523,detectedFrequency:526,cents:10,grade:"excellent"},{name:"ãƒ¬",note:"ãƒ¬",frequency:587,detectedFrequency:584,cents:-9,grade:"excellent"},{name:"ãƒŸ",note:"ãƒŸ",frequency:659,detectedFrequency:665,cents:16,grade:"good"},{name:"ãƒ•ã‚¡",note:"ãƒ•ã‚¡",frequency:698,detectedFrequency:692,cents:-15,grade:"excellent"},{name:"ã‚½",note:"ã‚½",frequency:784,detectedFrequency:795,cents:24,grade:"good"},{name:"ãƒ©",note:"ãƒ©",frequency:880,detectedFrequency:890,cents:19,grade:"good"},{name:"ã‚·",note:"ã‚·",frequency:988,detectedFrequency:1010,cents:38,grade:"pass"},{name:"ãƒ‰ï¼ˆé«˜ï¼‰",note:"ãƒ‰ï¼ˆé«˜ï¼‰",frequency:1047,detectedFrequency:1042,cents:-8,grade:"excellent"}]}]}}function Mt(s){return[{scale:"ãƒ‰",interval:"unison",intervalName:"ãƒ¦ãƒ‹ã‚¾ãƒ³"},{scale:"ãƒ¬",interval:"major_second",intervalName:"é•·2åº¦"},{scale:"ãƒŸ",interval:"major_third",intervalName:"é•·3åº¦"},{scale:"ãƒ•ã‚¡",interval:"perfect_fourth",intervalName:"å®Œå…¨4åº¦"},{scale:"ã‚½",interval:"perfect_fifth",intervalName:"å®Œå…¨5åº¦"},{scale:"ãƒ©",interval:"major_sixth",intervalName:"é•·6åº¦"},{scale:"ã‚·",interval:"major_seventh",intervalName:"é•·7åº¦"},{scale:"ãƒ‰ï¼ˆé«˜ï¼‰",interval:"octave",intervalName:"ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–"}].map((e,i)=>{const a=s.find(n=>n.targetNote&&n.targetNote.includes(e.scale))||s[i];if(a&&a.accuracy!=="notMeasured"){const n=parseFloat(a.accuracy)||0,r=Math.round((100-n)*.5);return{type:e.interval,scale:e.scale,intervalName:e.intervalName,attempts:1,averageError:r,accuracy:n}}else return{type:e.interval,scale:e.scale,intervalName:e.intervalName,attempts:0,averageError:null,accuracy:0}})}function Pn(s){if(!s||!Array.isArray(s))return console.warn("âš ï¸ [RandomTraining] sessionHistory ãŒç„¡åŠ¹ã§ã™"),[];const t=[{type:"unison",scale:"ãƒ‰",intervalName:"ãƒ¦ãƒ‹ã‚¾ãƒ³",noteIndex:0},{type:"major_second",scale:"ãƒ¬",intervalName:"é•·2åº¦",noteIndex:1},{type:"major_third",scale:"ãƒŸ",intervalName:"é•·3åº¦",noteIndex:2},{type:"perfect_fourth",scale:"ãƒ•ã‚¡",intervalName:"å®Œå…¨4åº¦",noteIndex:3},{type:"perfect_fifth",scale:"ã‚½",intervalName:"å®Œå…¨5åº¦",noteIndex:4},{type:"major_sixth",scale:"ãƒ©",intervalName:"é•·6åº¦",noteIndex:5},{type:"major_seventh",scale:"ã‚·",intervalName:"é•·7åº¦",noteIndex:6},{type:"octave",scale:"ãƒ‰ï¼ˆé«˜ï¼‰",intervalName:"ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–",noteIndex:7}],e={};return t.forEach(i=>{e[i.type]={type:i.type,scale:i.scale,intervalName:i.intervalName,attempts:0,successCount:0,accuracySum:0,accuracyValues:[],errorValues:[]}}),s.forEach(i=>{!i.noteResults||!Array.isArray(i.noteResults)||i.noteResults.forEach((a,n)=>{if(n>=t.length)return;const r=t[n].type,c=e[r];if(c.attempts++,a.accuracy!=="notMeasured"&&typeof a.accuracy=="number"){c.accuracyValues.push(a.accuracy),c.accuracySum+=a.accuracy;const u=Math.round((100-a.accuracy)*.5);c.errorValues.push(u),a.accuracy>=70&&c.successCount++}})}),t.map(i=>{const a=e[i.type];if(a.attempts===0)return{type:i.type,scale:i.scale,intervalName:i.intervalName,attempts:0,averageError:null,accuracy:0};const n=a.accuracyValues.length>0?Math.round(a.accuracySum/a.accuracyValues.length):0,r=a.errorValues.length>0?Math.round(a.errorValues.reduce((u,f)=>u+f,0)/a.errorValues.length):null,c=a.accuracyValues.length>0?Math.round(a.successCount/a.accuracyValues.length*100):0;return{type:i.type,scale:i.scale,intervalName:i.intervalName,mastery:c,attempts:a.attempts,averageError:r,accuracy:n}})}function xn(s){const t=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];if(s<=0)return"ãƒ¼ãƒ¼";const i=Math.round(12*Math.log2(s/440)),a=(i+9+120)%12,n=Math.floor((i+9)/12)+4;return t[a]+n}function It(s,t){const e=[{factor:4,freq:s*4,description:"2ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–ä¸Š"},{factor:3,freq:s*3,description:"1.5ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–ä¸Š"},{factor:2.5,freq:s*2.5,description:"1.3ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–ä¸Š"},{factor:2,freq:s*2,description:"1ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–ä¸Š"},{factor:1.5,freq:s*1.5,description:"0.5ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–ä¸Š"},{factor:1,freq:s,description:"è£œæ­£ãªã—"},{factor:.75,freq:s*.75,description:"0.33ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–ä¸‹"},{factor:.67,freq:s*.67,description:"0.5ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–ä¸‹"},{factor:.5,freq:s*.5,description:"1ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–ä¸‹"},{factor:.4,freq:s*.4,description:"1.3ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–ä¸‹"},{factor:.33,freq:s*.33,description:"1.5ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–ä¸‹"},{factor:.25,freq:s*.25,description:"2ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–ä¸‹"}];let i=null,a=1/0;const n=t*.5,r=t*1.5,c=e.filter(u=>u.freq>=n&&u.freq<=r);for(const u of c){const f=Math.abs(u.freq-t);f<a&&(a=f,i=u)}if(!i)for(const u of e){const f=Math.abs(u.freq-t);f<a&&(a=f,i=u)}return i?{correctedFrequency:i.freq,factor:i.factor,description:i.description,error:a}:{correctedFrequency:s,factor:1,description:"è£œæ­£ãªã—ï¼ˆãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼‰",error:Math.abs(s-t)}}function ot(){try{"scrollTo"in window&&"behavior"in document.documentElement.style?window.scrollTo({top:0,behavior:"smooth"}):window.scrollTo(0,0),document.body&&(document.body.scrollTop=0),document.documentElement&&(document.documentElement.scrollTop=0),document.querySelectorAll("[data-scroll-container], .scroll-container, main").forEach(t=>{t.scrollTo?t.scrollTo(0,0):t.scrollTop=0})}catch(s){console.warn("ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã‚¨ãƒ©ãƒ¼:",s);try{window.scroll(0,0)}catch(t){console.error("ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«å®Œå…¨å¤±æ•—:",t)}}}function uo(s){}function Ko(s,t,e){let i,a,n,r,c,u,f,d,m,v,w,p;Ae(Nt,"currentSessionId"),Te(s,Nt,o=>e(23,n=o)),Ae(qt,"unifiedScoreData"),Te(s,qt,o=>e(4,r=o)),Ae(kt,"isCompleted"),Te(s,kt,o=>e(5,c=o)),Ae(_t,"page"),Te(s,_t,o=>e(54,u=o)),Ae(Dt,"remainingSessions"),Te(s,Dt,o=>e(55,f=o)),Ae(Ft,"nextBaseName"),Te(s,Ft,o=>e(56,d=o)),Ae(Rt,"nextBaseNote"),Te(s,Rt,o=>e(57,m=o)),Ae(wt,"sessionHistory"),Te(s,wt,o=>e(24,v=o)),Ae(At,"trainingProgress"),Te(s,At,o=>e(58,w=o)),Ae(Ct,"isLoading"),Te(s,Ct,o=>e(25,p=o));let{$$slots:y={},$$scope:_}=t;qo("Page",y,[]);function j(o){return nt.evaluateOverall(o)}let k="setup",D=typeof window<"u"?new URLSearchParams(window.location.search).get("from")==="microphone-test"?(ce.info("[RandomTraining] ãƒã‚¤ã‚¯ãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸ã‹ã‚‰ã®é·ç§»ã‚’æ¤œå‡º"),"granted"):(ce.info("[RandomTraining] ãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã‚¢ã‚¯ã‚»ã‚¹ã‚’æ¤œå‡º"),"checking"):"checking",L=!0,x=[];const Q=["ãƒ‰","ãƒ¬","ãƒŸ","ãƒ•ã‚¡","ã‚½","ãƒ©","ã‚·","ãƒ‰ï¼ˆé«˜ï¼‰"];let M="",b=0,K=!1,I=0,q=Q.map(o=>({name:o,state:"inactive",completed:!1})),B=null,C=!1,V=0,E=!1,Y=null,ye=!1,oe=[],_e=[],Se=0,Ee=0,Le="ãƒ¼ãƒ¼",Ve=0,He={correctCount:0,totalCount:8,averageAccuracy:0,averageTime:0,isCompleted:!1},we=null,ze={totalScore:0,grade:"C",componentScores:{pitchAccuracy:0,recognitionSpeed:0,intervalMastery:0,directionAccuracy:0,consistency:0}},ke=[],Pe=[],Oe={},Xe={},Fe={totalAttempts:0,successRate:0,averageScore:0,bestScore:0,sessionDuration:0,streakCount:0,fatigueLevel:"fresh",mostDifficultInterval:"-",mostSuccessfulInterval:"-",averageResponseTime:0,sessionStart:Date.now()},ft="intervals",re=[],le=null,ge=null,Re=!0,ae=null,xe=null,rt=null,at=null,Ke=null;const Ge=[{note:"C4",name:"ãƒ‰ï¼ˆä¸­ï¼‰",frequency:261.63,semitonesFromC:0},{note:"Db4",name:"ãƒ‰#ï¼ˆä¸­ï¼‰",frequency:277.18,semitonesFromC:1},{note:"D4",name:"ãƒ¬ï¼ˆä¸­ï¼‰",frequency:293.66,semitonesFromC:2},{note:"Eb4",name:"ãƒ¬#ï¼ˆä¸­ï¼‰",frequency:311.13,semitonesFromC:3},{note:"E4",name:"ãƒŸï¼ˆä¸­ï¼‰",frequency:329.63,semitonesFromC:4},{note:"F4",name:"ãƒ•ã‚¡ï¼ˆä¸­ï¼‰",frequency:349.23,semitonesFromC:5},{note:"Gb4",name:"ãƒ•ã‚¡#ï¼ˆä¸­ï¼‰",frequency:369.99,semitonesFromC:6},{note:"Ab4",name:"ãƒ©bï¼ˆä¸­ï¼‰",frequency:415.3,semitonesFromC:8},{note:"Bb3",name:"ã‚·bï¼ˆä½ï¼‰",frequency:233.08,semitonesFromC:-2},{note:"B3",name:"ã‚·ï¼ˆä½ï¼‰",frequency:246.94,semitonesFromC:-1}];async function Ue(){var o;e(1,D="checking");try{if(console.log("ğŸ¤ [RandomTraining] AudioManagerçµŒç”±ã§ãƒã‚¤ã‚¯è¨±å¯ç¢ºèªé–‹å§‹"),!((o=navigator.mediaDevices)!=null&&o.getUserMedia)){e(1,D="error");return}const l=await We.initialize();rt=l.audioContext,xe=l.mediaStream,at=l.sourceNode,console.log("âœ… [RandomTraining] AudioManager ãƒªã‚½ãƒ¼ã‚¹å–å¾—å®Œäº†"),e(1,D="granted"),e(0,k="setup"),setTimeout(async()=>{if(ae){ce.audio("[RandomTraining] PitchDetectoråˆæœŸåŒ–é–‹å§‹");const S=/iPhone/.test(navigator.userAgent),T=/iPad/.test(navigator.userAgent),H=/Macintosh/.test(navigator.userAgent)&&"ontouchend"in document;(T||H)&&(console.log("ğŸ”§ [RandomTraining] iPadæ¤œå‡º - ãƒã‚¤ã‚¯æ„Ÿåº¦7.0xè‡ªå‹•è¨­å®šé–‹å§‹"),We.setSensitivity(7),console.log("âœ… [RandomTraining] iPad ãƒã‚¤ã‚¯æ„Ÿåº¦7.0xè‡ªå‹•è¨­å®šå®Œäº†"));try{console.log("ğŸ¤ [RandomTraining] AudioManagerå†åˆæœŸåŒ–é–‹å§‹ï¼ˆiPadå¯¾å¿œï¼‰"),await We.initialize(),console.log("âœ… [RandomTraining] AudioManagerå†åˆæœŸåŒ–å®Œäº†")}catch(O){console.warn("âš ï¸ AudioManagerå†åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼:",O)}await ae.initialize(),ce.audio("[RandomTraining] PitchDetectoråˆæœŸåŒ–å®Œäº†")}},200)}catch(l){ce.error("[RandomTraining] ãƒã‚¤ã‚¯è¨±å¯ã‚¨ãƒ©ãƒ¼:",l),e(1,D=(l==null?void 0:l.name)==="NotAllowedError"?"denied":"error")}}function dt(){const o=m,l=d,S=Ge.find(T=>T.note===o)||Ge.find(T=>T.name===l)||Ge[0];if(e(7,M=S.name),e(8,b=S.frequency),ce.info(`[BaseNote] åŸºéŸ³è¨­å®šï¼ˆlocalStorageé€£æºï¼‰: ${M} = ${b}Hz`),ce.info(`[BaseNote] localStorageåŸºéŸ³æƒ…å ±: note=${o}, name=${l}`),!b||b<=0)throw ce.error("[BaseNote] åŸºéŸ³å‘¨æ³¢æ•°è¨­å®šã‚¨ãƒ©ãƒ¼:",S),new Error(`Invalid base frequency: ${b}`)}async function Yt(){if(K||!ge||Re)return;if(D!=="granted"){console.log("ğŸ¤ [RandomTraining] ãƒã‚¤ã‚¯è¨±å¯ãŒå¿…è¦ã§ã™ã€‚è¨±å¯å–å¾—ã‚’é–‹å§‹...");try{await Ue(),console.log("ğŸ¤ [RandomTraining] ãƒã‚¤ã‚¯è¨±å¯å–å¾—å®Œäº†")}catch(l){console.error("âŒ ãƒã‚¤ã‚¯è¨±å¯ã‚¨ãƒ©ãƒ¼:",l);return}}if(!xe&&D==="granted"){console.log("ğŸ¤ [RandomTraining] AudioManagerãƒªã‚½ãƒ¼ã‚¹æœªåˆæœŸåŒ–ã®ãŸã‚å–å¾—ã—ã¾ã™");try{await Ue()}catch(l){console.error("âŒ AudioManagerãƒªã‚½ãƒ¼ã‚¹åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼:",l);return}}else xe&&console.log("ğŸ¤ [RandomTraining] AudioManagerãƒªã‚½ãƒ¼ã‚¹æ—¢å­˜ã®ãŸã‚å†åˆ©ç”¨");e(9,K=!0),e(0,k="listening"),Ke=Date.now(),dt();const o=Ge.find(l=>l.name===M).note;ge.triggerAttackRelease(o,2,Tt(),.7),setTimeout(()=>{e(9,K=!1),e(0,k="waiting"),setTimeout(()=>gt(),500)},2e3)}async function Zt(){if(K||!ge||p||!M)return;if(D!=="granted"){console.log("ğŸ¤ [RandomTraining] ãƒã‚¤ã‚¯è¨±å¯ãŒå¿…è¦ã§ã™ã€‚è¨±å¯å–å¾—ã‚’é–‹å§‹...");try{await Ue(),console.log("ğŸ¤ [RandomTraining] ãƒã‚¤ã‚¯è¨±å¯å–å¾—å®Œäº†")}catch(l){console.error("âŒ ãƒã‚¤ã‚¯è¨±å¯ã‚¨ãƒ©ãƒ¼:",l);return}}if(!xe&&D==="granted"){console.log("ğŸ¤ [RandomTraining] AudioManagerãƒªã‚½ãƒ¼ã‚¹æœªåˆæœŸåŒ–ã®ãŸã‚å–å¾—ã—ã¾ã™");try{await Ue()}catch(l){console.error("âŒ AudioManagerãƒªã‚½ãƒ¼ã‚¹åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼:",l);return}}else xe&&console.log("ğŸ¤ [RandomTraining] AudioManagerãƒªã‚½ãƒ¼ã‚¹æ—¢å­˜ã®ãŸã‚å†åˆ©ç”¨");if(e(9,K=!0),e(0,k="listening"),Ke=Date.now(),typeof window<"u"&&window.Tone){const l=window.Tone.context||window.Tone.getContext();l&&l.state==="suspended"&&(console.log("ğŸ”„ [RandomTraining] AudioContext suspendedæ¤œå‡º - å†é–‹ä¸­..."),await l.resume(),console.log("âœ… [RandomTraining] AudioContextå†é–‹å®Œäº†"))}const o=Ge.find(l=>l.name===M).note;ge.triggerAttackRelease(o,2,Tt(),.7),setTimeout(()=>{e(9,K=!1),e(0,k="waiting"),setTimeout(()=>gt(),500)},2e3)}async function fo(){if(K||!ge||p||!M){console.log("ğŸ”„ [BaseNoteOnly] å†ç”Ÿæ¡ä»¶æœªæº€: isPlaying:",K,"sampler:",!!ge,"isLoading:",p,"currentBaseNote:",M);return}if(console.log("ğŸµ [BaseNoteOnly] åŸºéŸ³ã®ã¿å†ç”Ÿé–‹å§‹:",M),typeof window<"u"&&window.Tone){const l=window.Tone.context||window.Tone.getContext();l&&l.state==="suspended"&&(console.log("ğŸ”„ [BaseNoteOnly] AudioContext suspendedæ¤œå‡º - å†é–‹ä¸­..."),await l.resume(),console.log("âœ… [BaseNoteOnly] AudioContextå†é–‹å®Œäº†"))}const o=Ge.find(l=>l.name===M).note;ge.triggerAttackRelease(o,1.5,Tt(),.7),console.log("ğŸµ [BaseNoteOnly] åŸºéŸ³å†ç”Ÿå®Œäº†:",o)}function mt(){M&&b>0?Zt():Yt(),$t()}function $t(){Y&&clearInterval(Y),e(11,V=0),E=!0,e(12,ye=!1),console.log("ğŸµ [GuideStartBar] ã‚¬ã‚¤ãƒ‰ã‚¹ã‚¿ãƒ¼ãƒˆãƒãƒ¼é–‹å§‹"),Y=setInterval(()=>{e(11,V+=2.5),V>=100&&(e(11,V=100),e(12,ye=!0),console.log("ğŸµ [GuideStartBar] ã‚¬ã‚¤ãƒ‰é–‹å§‹ã‚¿ã‚¤ãƒŸãƒ³ã‚°ï¼"),setTimeout(()=>{E=!1,e(12,ye=!1),e(11,V=0)},800),clearInterval(Y),Y=null)},50)}function mo(){Y&&(clearInterval(Y),Y=null),E=!1,e(12,ye=!1),e(11,V=0)}function Ye(o,l){const T=[0,2,4,5,7,9,11,12][l],H=o*Math.pow(2,T/12);return ce.debug(`[calculateExpectedFrequency] ${q[l].name}: åŸºéŸ³${o.toFixed(1)}Hz + ${T}åŠéŸ³ = ${H.toFixed(1)}Hz`),H}function en(o,l){return Ye(o,l)}function gt(){e(0,k="guiding"),I=0,C=!0,oe=[],console.log(`ğŸ¬ ã‚¬ã‚¤ãƒ‰é–‹å§‹: ${M} (${b.toFixed(1)}Hz)`);function o(){if(I<q.length){I>0&&e(10,q[I-1].state="inactive",q),e(10,q[I].state="active",q);const l=en(b,I);St.setScaleContext({baseFrequency:b,currentScale:q[I].name,targetFrequency:l}),console.log(`ğŸµ [Scale] åŸºéŸ³:${M}(${b.toFixed(0)}Hz) ç¾åœ¨:${q[I].name} ç›®æ¨™:${l.toFixed(0)}Hz`),I>=4&&console.log(`ğŸ” [ãƒ‡ãƒãƒƒã‚°] Step ${I}: currentBaseFrequency=${b}, currentBaseNote='${M}'`),I++,B=setTimeout(()=>{o()},600)}else tn()}o()}function tn(){C=!1,console.log(`ğŸ ã‚¬ã‚¤ãƒ‰å®Œäº†: ${oe.length}/${q.length}ã‚¹ãƒ†ãƒƒãƒ—è©•ä¾¡`),q.length>0&&e(10,q[q.length-1].state="inactive",q),ae&&ae.stopDetection(),St.clearContext(),nn(),cn(),pn(),re=Q.map(o=>{const l=oe.find(S=>S.stepName===o);return l?{name:l.stepName,cents:l.adjustedFrequency?Math.round(l.centDifference):null,targetFreq:l.expectedFrequency,detectedFreq:l.adjustedFrequency||null,diff:l.adjustedFrequency?l.adjustedFrequency-l.expectedFrequency:null,accuracy:l.accuracy}:{name:o,cents:null,targetFreq:null,detectedFreq:null,diff:null,accuracy:"notMeasured"}}),un(),dn(),e(0,k="results")}function nn(){let o=0,l=0;oe.forEach((H,O)=>{H.isCorrect&&o++,l+=H.accuracy});const S=oe.length>0?Math.round(l/oe.length):0,T=Math.round(o/q.length*100);He={correctCount:o,totalCount:q.length,averageAccuracy:S,averageTime:0,isCompleted:!0},console.log(`ğŸ¯ çµæœ: ${o}/${q.length}æ­£è§£ (${T}%) å¹³å‡ç²¾åº¦${S}%`),oe.length>0&&(_e=[...oe])}function go(){switch(k){case"setup":return Re||!ge?"ğŸµ éŸ³æºèª­ã¿è¾¼ã¿ä¸­...":"ğŸ¤ ãƒã‚¤ã‚¯æº–å‚™å®Œäº† - ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°é–‹å§‹å¯èƒ½";case"listening":return"ğŸµ åŸºéŸ³å†ç”Ÿä¸­...";case"waiting":return"â³ é–“ã‚‚ãªãé–‹å§‹...";case"guiding":return"ğŸ™ï¸ ã‚¬ã‚¤ãƒ‰ã«åˆã‚ã›ã¦ãƒ‰ãƒ¬ãƒŸãƒ•ã‚¡ã‚½ãƒ©ã‚·ãƒ‰ã‚’æ­Œã£ã¦ãã ã•ã„";case"results":return"ğŸ‰ æ¡ç‚¹çµæœ";default:return"ğŸ”„ æº–å‚™ä¸­..."}}function yo(){return oe.length>0?oe:_e.length>0?_e:[]}function on(){vt(`${it}/microphone-test`)}function Ze(){vt(`${it}/`)}async function rn(){try{e(34,Re=!0),e(33,ge=new Lo({urls:{C4:"C4.mp3"},baseUrl:`${it}/audio/piano/`,release:1.5,volume:En(),onload:()=>{e(34,Re=!1)},onerror:H=>{console.error("âŒ Salamander PianoéŸ³æºèª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:",H),e(34,Re=!1)}}).toDestination());const o=/iPhone/.test(navigator.userAgent),l=/iPad/.test(navigator.userAgent),S=/Macintosh/.test(navigator.userAgent)&&"ontouchend"in document,T=o||l||S;console.log(l?"ğŸ” [RandomTraining] iPadæ¤œå‡º:":S?"ğŸ” [RandomTraining] iPadOSæ¤œå‡º:":o?"ğŸ” [RandomTraining] iPhoneæ¤œå‡º:":"ğŸ” [RandomTraining] ãã®ä»–ãƒ‡ãƒã‚¤ã‚¹æ¤œå‡º:",navigator.userAgent),console.log("ğŸ”Š [RandomTraining] éŸ³é‡è¨­å®šç¶­æŒ: 35dB")}catch(o){console.error("ã‚µãƒ³ãƒ—ãƒ©ãƒ¼åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼:",o),e(34,Re=!1)}}async function st(){try{(await navigator.permissions.query({name:"microphone"})).state==="granted"?await Ue():e(1,D="denied")}catch{e(1,D="denied")}}function an(){try{we=new An,ce.info("[RandomTraining] æ¡ç‚¹ã‚¨ãƒ³ã‚¸ãƒ³åˆæœŸåŒ–å®Œäº†")}catch(o){ce.error("[RandomTraining] æ¡ç‚¹ã‚¨ãƒ³ã‚¸ãƒ³åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼:",o)}}function sn(o,l){if(!we||!C)return;const S=I-1;if(S<0||S>=q.length)return;const T=Ye(b,S),H={baseFrequency:b,targetFrequency:T,detectedFrequency:o,detectedNote:l,volume:Se,timestamp:Date.now(),scaleIndex:S,scaleName:q[S].name};try{we.processAttempt(H)}catch(O){ce.error("[RandomTraining] æ¡ç‚¹ã‚¨ãƒ³ã‚¸ãƒ³ã‚¨ãƒ©ãƒ¼:",O)}}function cn(){if(!we){ce.error("[RandomTraining] æ¡ç‚¹ã‚¨ãƒ³ã‚¸ãƒ³ãŒåˆæœŸåŒ–ã•ã‚Œã¦ã„ã¾ã›ã‚“"),ln();return}try{const o=we.generateDetailedReport();e(16,ze={totalScore:o.totalScore,grade:o.grade,componentScores:o.componentScores}),o.intervalAnalysis&&o.intervalAnalysis.masteryLevels?e(3,ke=Object.entries(o.intervalAnalysis.masteryLevels).map(([l,S])=>{var T,H;return{type:l,mastery:Math.round(S),attempts:((T=o.intervalAnalysis.attemptCounts)==null?void 0:T[l])||0,accuracy:((H=o.intervalAnalysis.accuracyRates)==null?void 0:H[l])||0}})):(console.warn("âš ï¸ [RandomTraining] intervalAnalysis.masteryLevels ãŒæœªå®šç¾©ã§ã™"),e(3,ke=[])),o.consistencyHistory&&Array.isArray(o.consistencyHistory)?e(17,Pe=o.consistencyHistory.map((l,S)=>({score:Math.round(l),timestamp:Date.now()-(o.consistencyHistory.length-S)*1e3}))):(console.warn("âš ï¸ [RandomTraining] consistencyHistory ãŒæœªå®šç¾©ã¾ãŸã¯é…åˆ—ã§ã¯ã‚ã‚Šã¾ã›ã‚“"),e(17,Pe=[])),e(18,Oe=o.feedback||{primary:"æ¡ç‚¹çµæœã‚’ç”Ÿæˆä¸­ã§ã™...",detailed:[],suggestions:[]}),e(20,Fe={totalAttempts:o.totalAttempts||0,successRate:o.successRate||0,averageScore:o.totalScore||0,bestScore:Math.max(o.totalScore||0,Fe.bestScore||0),sessionDuration:Math.round((Date.now()-Fe.sessionStart)/6e4)||0,streakCount:o.streak||0,fatigueLevel:o.fatigueLevel||"normal",mostDifficultInterval:o.mostDifficultInterval||"-",mostSuccessfulInterval:o.mostSuccessfulInterval||"-",averageResponseTime:o.averageResponseTime||0}),ce.info("[RandomTraining] æ¡ç‚¹çµæœç”Ÿæˆå®Œäº†:",ze)}catch(o){ce.error("[RandomTraining] æ¡ç‚¹çµæœç”Ÿæˆã‚¨ãƒ©ãƒ¼:",o)}}function ln(){ce.info("[RandomTraining] ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã§æ¡ç‚¹çµæœã‚’ç”Ÿæˆ"),e(16,ze={totalScore:78,grade:"B+",componentScores:{pitchAccuracy:82,recognitionSpeed:75,intervalMastery:80,directionAccuracy:85,consistency:70}}),e(3,ke=[{type:"unison",mastery:95,attempts:8,accuracy:98},{type:"major_second",mastery:82,attempts:8,accuracy:85},{type:"major_third",mastery:78,attempts:8,accuracy:80},{type:"perfect_fourth",mastery:65,attempts:8,accuracy:68},{type:"perfect_fifth",mastery:88,attempts:8,accuracy:90},{type:"major_sixth",mastery:72,attempts:8,accuracy:75},{type:"major_seventh",mastery:58,attempts:8,accuracy:62},{type:"octave",mastery:92,attempts:8,accuracy:94}]),e(17,Pe=[{score:65,timestamp:Date.now()-42e4},{score:72,timestamp:Date.now()-36e4},{score:68,timestamp:Date.now()-3e5},{score:75,timestamp:Date.now()-24e4},{score:78,timestamp:Date.now()-18e4},{score:82,timestamp:Date.now()-12e4},{score:80,timestamp:Date.now()-6e4},{score:85,timestamp:Date.now()}]),e(18,Oe={type:"improvement",primary:"è‰¯ã„é€²æ­©ãŒè¦‹ã‚‰ã‚Œã¾ã™ï¼",summary:"éŸ³ç¨‹ã®èªè­˜ç²¾åº¦ãŒå‘ä¸Šã—ã¦ã„ã¾ã™ã€‚ç‰¹ã«å®Œå…¨5åº¦ã¨ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–ã®ç¿’å¾—åº¦ãŒé«˜ãã€åŸºæœ¬çš„ãªéŸ³æ„ŸãŒèº«ã«ã¤ã„ã¦ãã¦ã„ã¾ã™ã€‚",details:[{category:"strengths",text:"ãƒ¦ãƒ‹ã‚¾ãƒ³ã¨ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–ã®èªè­˜ãŒã»ã¼å®Œç’§ã§ã™"},{category:"strengths",text:"å®Œå…¨5åº¦ã®å®‰å®šæ€§ãŒå„ªç§€ã§ã™"},{category:"improvements",text:"å®Œå…¨4åº¦ã®ç·´ç¿’ã‚’ã‚‚ã†å°‘ã—å¢—ã‚„ã—ã¾ã—ã‚‡ã†"},{category:"improvements",text:"é•·7åº¦ã®èªè­˜ç²¾åº¦ã‚’å‘ä¸Šã•ã›ã¾ã—ã‚‡ã†"},{category:"tips",text:"4åº¦ã¯ã€Œã‚½ãƒ¼ãƒ•ã‚¡ãƒ¼ã€ã®éŸ³ç¨‹ã§ã™"},{category:"practice",text:"æ¯æ—¥15åˆ†ã®ç¶™ç¶šç·´ç¿’ã‚’å¿ƒãŒã‘ã¾ã—ã‚‡ã†"}],nextSteps:["å®Œå…¨4åº¦ã®é›†ä¸­ç·´ç¿’ã‚’è¡Œã„ã¾ã—ã‚‡ã†","é€£ç¶šãƒãƒ£ãƒ¬ãƒ³ã‚¸ãƒ¢ãƒ¼ãƒ‰ã§å®Ÿè·µç·´ç¿’ã‚’","1æ—¥15åˆ†ã®ç¶™ç¶šç·´ç¿’ã‚’å¿ƒãŒã‘ã¾ã—ã‚‡ã†"],motivation:"ç¶™ç¶šã¯åŠ›ãªã‚Šï¼ã‚ãªãŸã®ç›¸å¯¾éŸ³æ„Ÿã¯ç¢ºå®Ÿã«å‘ä¸Šã—ã¦ã„ã¾ã™ï¼"}),e(20,Fe={totalAttempts:32,successRate:68.8,averageScore:78,bestScore:85,sessionDuration:8,streakCount:4,fatigueLevel:"normal",mostDifficultInterval:"å®Œå…¨4åº¦",mostSuccessfulInterval:"ãƒ¦ãƒ‹ã‚¾ãƒ³",averageResponseTime:2.1,sessionStart:Date.now()-48e4}),ce.info("[RandomTraining] ãƒ†ã‚¹ãƒˆæ¡ç‚¹çµæœç”Ÿæˆå®Œäº†")}function ho(o){ft=o}function un(){if(!re||re.length===0){console.warn("[UnifiedScore] noteResultsForDisplay ãŒç©ºã§ã™");return}const o=re.filter(te=>te.accuracy!=="notMeasured").length,l=re.length,S=re.filter(te=>te.accuracy!=="notMeasured"&&typeof te.accuracy=="number").map(te=>te.accuracy),T=S.length>0?Math.round(S.reduce((te,Ne)=>te+Ne,0)/S.length):0,H=M||"Unknown",O=b||0,se=re.map(te=>({name:te.name,note:te.note||te.name,frequency:te.targetFreq||te.expectedFrequency,detectedFrequency:te.detectedFreq,cents:te.cents,grade:nt.evaluateNote(te.cents),targetFreq:te.targetFreq,diff:te.diff})),ie=w,ne=(ie==null?void 0:ie.sessionHistory)||[],qe={timestamp:new Date,baseNote:H,baseFrequency:O,noteResults:se,measuredNotes:o,accuracy:T,grade:nt.evaluateSession(re)},Be=[...ne,qe];e(21,le={mode:"continuous",timestamp:new Date,duration:60,totalNotes:l,measuredNotes:o,averageAccuracy:T,baseNote:H,baseFrequency:O,noteResults:se,distribution:nt.calculateDistribution(re),sessionHistory:Be,unifiedGrade:j(Be)}),console.log("[UnifiedScore] çµ±åˆæ¡ç‚¹ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆå®Œäº†ï¼ˆå®Œå…¨ç‰ˆï¼‰:",le),fn()}async function fn(){if(!re||re.length===0){console.warn("ğŸ“Š [SessionStorage] ä¿å­˜ãƒ‡ãƒ¼ã‚¿ãªã—");return}try{console.log("ğŸ“Š [SessionStorage] ã‚»ãƒƒã‚·ãƒ§ãƒ³çµæœä¿å­˜é–‹å§‹");const o=re.map(O=>({name:O.name,cents:O.cents,targetFreq:O.targetFreq||O.expectedFrequency,detectedFreq:O.detectedFreq,diff:O.diff,accuracy:typeof O.accuracy=="number"?O.accuracy:0})),l=Ke?Math.round((Date.now()-Ke)/1e3):60;await Nn(o,l,m,d)?(console.log("ğŸ“Š [SessionStorage] ã‚»ãƒƒã‚·ãƒ§ãƒ³çµæœä¿å­˜å®Œäº†"),console.log("ğŸ“Š [SessionStorage] ä¿å­˜å¾Œã®çŠ¶æ³:",{currentSession:n,totalSessions:v.length,isCompleted:c,nextBaseNote:m,nextBaseName:d})):console.error("ğŸ“Š [SessionStorage] ã‚»ãƒƒã‚·ãƒ§ãƒ³çµæœä¿å­˜å¤±æ•—")}catch(o){console.error("ğŸ“Š [SessionStorage] ã‚»ãƒƒã‚·ãƒ§ãƒ³ä¿å­˜ã‚¨ãƒ©ãƒ¼:",o)}}async function dn(){try{if(we){const o=v||[];for(const[S,T]of o.entries())if(T.noteResults&&T.noteResults.length>0){const H=T.baseFrequency||262;for(const O of T.noteResults)O.detectedFreq&&O.targetFreq&&await we.analyzePerformance({baseFreq:H,targetFreq:O.targetFreq,detectedFreq:O.detectedFreq,responseTime:2e3,volume:50,harmonicCorrection:null})}const l=we.generateDetailedReport();e(16,ze={totalScore:l.totalScore||0,grade:l.grade||"C",componentScores:l.componentScores||{accuracy:0,speed:0,consistency:0}}),l.intervalAnalysis&&l.intervalAnalysis.masteryLevels?e(3,ke=Object.entries(l.intervalAnalysis.masteryLevels).map(([S,T])=>{var H;return{type:S,mastery:Math.round(T),attempts:((H=l.intervalAnalysis.attemptCounts)==null?void 0:H[S])||0,accuracy:Math.round(T*.9)}})):e(3,ke=Mt(re)),l.consistencyHistory&&Array.isArray(l.consistencyHistory)?e(17,Pe=l.consistencyHistory.map((S,T)=>({score:Math.round(S),timestamp:Date.now()-(l.consistencyHistory.length-T)*1e3}))):e(17,Pe=ht(re)),e(18,Oe=pt(re)||l.feedback),console.log("ğŸ¯ [generateEnhancedScoringData] æŠ€è¡“åˆ†æçµæœç”Ÿæˆã‚’é–‹å§‹"),console.log("ğŸ¯ [generateEnhancedScoringData] results:",l),e(19,Xe=mn(l)),console.log("ğŸ¯ [generateEnhancedScoringData] technicalFeedbackDataçµæœ:",Xe),e(20,Fe={totalAttempts:l.totalAttempts||re.length,successRate:l.successRate||re.filter(S=>S.accuracy!=="notMeasured").length/re.length*100,averageScore:l.totalScore||(le==null?void 0:le.averageAccuracy)||0,bestScore:Math.max(l.totalScore||0,Fe.bestScore||0),sessionDuration:Math.round(60),streakCount:l.streak||0,fatigueLevel:l.fatigueLevel||"normal",mostDifficultInterval:l.mostDifficultInterval||"æœªç‰¹å®š",mostSuccessfulInterval:l.mostSuccessfulInterval||"æœªç‰¹å®š",averageResponseTime:l.averageResponseTime||2.5,sessionStart:Date.now()-6e4})}else yt();console.log("[EnhancedScoring] è¿½åŠ æ¡ç‚¹ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆå®Œäº†")}catch(o){console.error("[EnhancedScoring] ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆã‚¨ãƒ©ãƒ¼:",o),yt()}}function yt(){const o=re.filter(S=>S.accuracy!=="notMeasured"),l=(le==null?void 0:le.averageAccuracy)||0;e(16,ze={totalScore:Math.round(l*.8),grade:l>=90?"A":l>=80?"B":l>=70?"C":"D",componentScores:{accuracy:l,speed:85,consistency:Math.max(60,l-10)}}),e(3,ke=Mt(re)),e(17,Pe=ht()),e(18,Oe=pt(re)),e(20,Fe={totalAttempts:re.length,successRate:o.length/re.length*100,averageScore:l,bestScore:l,sessionDuration:60,streakCount:0,fatigueLevel:"normal",mostDifficultInterval:"æœªåˆ†æ",mostSuccessfulInterval:"æœªåˆ†æ",averageResponseTime:2.5,sessionStart:Date.now()-6e4})}function ht(o){const l=(le==null?void 0:le.averageAccuracy)||70;return Array.from({length:8},(S,T)=>({score:Math.max(30,Math.min(100,l+(Math.random()-.5)*20)),timestamp:Date.now()-(8-T)*7500}))}function pt(o){const l=o.filter(et=>et.accuracy!=="notMeasured").length,S=(le==null?void 0:le.averageAccuracy)||0,T=8,H=v||[],O=H.length,se={type:"info",categories:[{name:"éŸ³ç¨‹ç²¾åº¦",icon:"Target",score:S,message:`${S}%ã®ç²¾åº¦ã§éŸ³ç¨‹ã‚’æ‰ãˆã¦ã„ã¾ã™`},{name:"æ¸¬å®šæˆåŠŸç‡",icon:"Mic",score:Math.round(l/o.length*100),message:`${o.length}éŸ³ä¸­${l}éŸ³ã‚’æ­£å¸¸ã«æ¸¬å®š`}]};if(O<T)return se;let ie,ne,qe;const Be=(le==null?void 0:le.unifiedGrade)||"E",te=H.length;let Ne=0,he=0,ve=0;H.forEach(et=>{et.grade==="excellent"?Ne++:et.grade==="good"?he++:et.grade==="pass"&&ve++});const be=te>0?Math.round(Ne/te*100):0,$e=te>0?Math.round((Ne+he+ve)/te*100):0,De=te>0?Math.round((Ne+he+ve)/te*100):0;switch(Be){case"S":ie="excellent",ne="éŸ³æ¥½å®¶ãƒ¬ãƒ™ãƒ«ã®ç›¸å¯¾éŸ³æ„Ÿã‚’é”æˆï¼",qe=`å„ªç§€ç‡${be}%è¶…ãˆã®å®ŸåŠ›ã‚’è¨¼æ˜ã•ã‚Œã¾ã—ãŸã€‚`;break;case"A":ie="excellent",ne="ã‚¨ã‚­ã‚¹ãƒ‘ãƒ¼ãƒˆãƒ¬ãƒ™ãƒ«åˆ°é”ï¼",qe=`å„ªç§€ç‡${be}%ã®å®‰å®šã—ãŸéŸ³æ„Ÿèƒ½åŠ›ã§ã™ã€‚`;break;case"B":ie="improvement",ne="ãƒ—ãƒ­ãƒ•ã‚£ã‚·ã‚¨ãƒ³ãƒˆç´šé”æˆï¼",qe=`è‰¯å¥½ç‡${$e}%ã®ç¢ºå®Ÿãªé€²æ­©ã‚’ç¤ºã—ã¦ã„ã¾ã™ã€‚`;break;case"C":ie="improvement",ne="ã‚¢ãƒ‰ãƒãƒ³ã‚¹ç´šåˆ°é”ï¼",qe=`åˆæ ¼ç‡${De}%ã§ç€å®Ÿã«æˆé•·ä¸­ã§ã™ã€‚`;break;case"D":ie="practice",ne="ç¶™ç¶šç·´ç¿’ã§å¿…ãšä¸Šé”ï¼",qe=`ç¾åœ¨ã®åˆæ ¼ç‡${De}%ã‹ã‚‰ç›®æ¨™70%ã¸å‘ã‘ã¦ç·´ç¿’ã‚’ç¶šã‘ã¾ã—ã‚‡ã†ã€‚`;break;case"E":default:ie="encouragement",ne="Eç´šãƒ“ã‚®ãƒŠãƒ¼",qe="ç·´ç¿’é–‹å§‹æ®µéšã§ã™ã€‚ç¶™ç¶šçš„ãªç·´ç¿’ã§å¿…ãšä¸Šé”ã—ã¾ã™ã€‚";break}return{...se,type:ie,primary:ne,summary:qe}}function mn(o){var Be,te,Ne;if((v||[]).length<8||!o)return null;const H=o.improvements||[];(Be=o.detailed)!=null&&Be.statistics;const O=[];let se=0,ie=0;if((te=o.detailed)!=null&&te.intervals){const he=o.detailed.intervals;if(he.totalAnalyses>0){let ve=0,be=0;for(const[$e,De]of Object.entries(he.masteryLevels))De.attempts>0&&(ve+=De.averageAccuracy*De.attempts,be+=De.attempts);se=be>0?ve/be:0}}if((Ne=o.detailed)!=null&&Ne.directions){const he=o.detailed.directions;if(he.totalAnalyses>0){let ve=0,be=0;for(const[$e,De]of Object.entries(he.masteryData))De.attempts>0&&(ve+=De.averageAccuracy*De.attempts,be+=De.attempts);ie=be>0?ve/be:0}}O.push({category:"improvements",text:`éŸ³ç¨‹ç²¾åº¦: ${Math.round(se)}%ã€€ï¼ˆéŸ³ã®é«˜ã•ã‚’æ‰ãˆã‚‹æ­£ç¢ºæ€§ã€€ç›®æ¨™åŸºæº–ï¼š70ã€œ85%ï¼‰`}),O.push({category:"improvements",text:`æ–¹å‘æ€§: ${Math.round(ie)}%ã€€ï¼ˆéŸ³ç¨‹ã®ä¸Šä¸‹åˆ¤æ–­ã®ç²¾åº¦ã€€ç›®æ¨™åŸºæº–ï¼š80ã€œ90%ï¼‰`});const ne=H.map(he=>({category:"tips",text:he.message})),qe=H.flatMap(he=>(he.actions||[]).map(ve=>({category:"practice",text:ve})));return[...O,...ne,...qe],{type:"info",primary:"è©³ç´°åˆ†æçµæœ",summary:"éŸ³ç¨‹ç²¾åº¦ãƒ»ä¸€è²«æ€§ãƒ»æ–¹å‘æ€§ã®ç·åˆåˆ†æ",details:O}}Fn(async()=>{if(!(typeof localStorage<"u"?localStorage.getItem("mic-test-completed"):null)){console.log("ğŸš« [RandomTraining] ãƒã‚¤ã‚¯ãƒ†ã‚¹ãƒˆæœªå®Œäº† - æº–å‚™ç”»é¢è¡¨ç¤º"),st();return}console.log("ğŸ“Š [SessionStorage] ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†åˆæœŸåŒ–é–‹å§‹");try{if(await bt()){if(console.log("ğŸ“Š [SessionStorage] ã‚»ãƒƒã‚·ãƒ§ãƒ³é€²è¡ŒçŠ¶æ³ã®èª­ã¿è¾¼ã¿å®Œäº†"),console.log("ğŸ“Š [SessionStorage] ç¾åœ¨ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³:",n,"/ 8"),console.log("ğŸ“Š [SessionStorage] æ¬¡ã®åŸºéŸ³:",m,"(",d,")"),console.log("ğŸ“Š [SessionStorage] å®Œäº†çŠ¶æ³:",c?"8ã‚»ãƒƒã‚·ãƒ§ãƒ³å®Œäº†":`æ®‹ã‚Š${f}ã‚»ãƒƒã‚·ãƒ§ãƒ³`),c&&(console.log("ğŸ”„ [SessionStorage] 8ã‚»ãƒƒã‚·ãƒ§ãƒ³å®Œäº†æ¤œå‡º - æ–°ã‚µã‚¤ã‚¯ãƒ«é–‹å§‹å‡¦ç†"),await tt()?console.log("âœ… [SessionStorage] æ–°ã‚µã‚¤ã‚¯ãƒ«é–‹å§‹å®Œäº† - ã‚»ãƒƒã‚·ãƒ§ãƒ³1/8ã‹ã‚‰å†é–‹"):console.warn("âš ï¸ [SessionStorage] æ–°ã‚µã‚¤ã‚¯ãƒ«é–‹å§‹å‡¦ç†ãŒå¤±æ•—")),n>1&&!c){console.warn("ğŸ”„ [SessionStorage] ã‚»ãƒƒã‚·ãƒ§ãƒ³é€”ä¸­ã§ã®ãƒªãƒ­ãƒ¼ãƒ‰æ¤œå‡º - ã‚»ãƒƒã‚·ãƒ§ãƒ³1ã‹ã‚‰å†é–‹"),console.warn("ğŸ”„ [SessionStorage] ç¾åœ¨:",n,"ã‚»ãƒƒã‚·ãƒ§ãƒ³ç›® â†’ ãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã‚¢ã‚¯ã‚»ã‚¹èª˜å°");const{SessionStorageManager:S}=await Cn(async()=>{const{SessionStorageManager:O}=await import("../chunks/DMOdon5X.js").then(se=>se.y);return{SessionStorageManager:O}},__vite__mapDeps([0,1,2,3,4,5]),import.meta.url),T=S.getInstance();typeof localStorage<"u"&&(localStorage.removeItem("random-training-progress"),localStorage.removeItem("random-training-progress-backup"));const{resetProgress:H}=await Cn(async()=>{const{resetProgress:O}=await import("../chunks/DMOdon5X.js").then(se=>se.z);return{resetProgress:O}},__vite__mapDeps([0,1,2,3,4,5]),import.meta.url);await H(),console.log("ğŸ”„ [SessionStorage] localStorage + ã‚¹ãƒˆã‚¢çŠ¶æ…‹å®Œå…¨ãƒªã‚»ãƒƒãƒˆå®Œäº†"),st();return}}else console.log("ğŸ“Š [SessionStorage] æ–°è¦ã‚»ãƒƒã‚·ãƒ§ãƒ³é–‹å§‹")}catch(l){console.error("ğŸ“Š [SessionStorage] åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼:",l)}if(rn(),an(),u.url.searchParams.get("from")==="microphone-test"){console.log("ğŸ¤ [RandomTraining] ãƒã‚¤ã‚¯ãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸ã‹ã‚‰ã®é·ç§»ã‚’æ¤œå‡º");const l=new URL(window.location);if(l.searchParams.delete("from"),window.history.replaceState({},"",l),e(1,D="granted"),e(0,k="setup"),console.log('ğŸ¤ [RandomTraining] microphoneState="granted", trainingPhase="setup" ã«è¨­å®š'),!xe){console.log("ğŸ¤ [RandomTraining] AudioManagerãƒªã‚½ãƒ¼ã‚¹å–å¾—é–‹å§‹");try{const S=await We.initialize();rt=S.audioContext,xe=S.mediaStream,at=S.sourceNode,console.log("ğŸ¤ [RandomTraining] AudioManagerãƒªã‚½ãƒ¼ã‚¹å–å¾—å®Œäº†")}catch(S){console.warn("âš ï¸ AudioManagerãƒªã‚½ãƒ¼ã‚¹å–å¾—å¤±æ•—ï¼ˆå¾Œã§å†è©¦è¡Œï¼‰:",S)}}if(await new Promise(S=>setTimeout(S,300)),ae&&ae.getIsInitialized&&!ae.getIsInitialized())try{console.log("ğŸ™ï¸ [RandomTraining] PitchDetectoråˆæœŸåŒ–é–‹å§‹");const S=We.getStatus();console.log("ğŸ” [RandomTraining] AudioManagerçŠ¶æ…‹:",S),(!S.isInitialized||!S.mediaStreamActive)&&(console.log("ğŸ”„ [RandomTraining] AudioManagerçŠ¶æ…‹ä¸è‰¯ - å†åˆæœŸåŒ–å®Ÿè¡Œ"),await We.initialize()),await ae.initialize(),console.log("âœ… [RandomTraining] PitchDetectoråˆæœŸåŒ–å®Œäº†")}catch(S){console.warn("âš ï¸ PitchDetectoråˆæœŸåŒ–å¤±æ•—:",S)}}else await new Promise(l=>setTimeout(l,100)),st()});function gn(o){try{if(!o||!o.detail){console.warn("âš ï¸ [ContinuousMode] handlePitchUpdate: event.detail ãŒ undefined");return}const{frequency:l,note:S,volume:T,rawVolume:H,clarity:O}=o.detail;let se=l,ie=S;if(k==="guiding"&&C&&b>0&&l>0){const ne=yn(l);ne&&(se=ne.frequency,ie=ne.note)}e(14,Ee=se),e(15,Le=ie),e(13,Se=T),b>0&&se>0?Ve=Math.round(1200*Math.log2(se/b)):Ve=0;try{hn(l,S)}catch(ne){console.error("âŒ [ContinuousMode] evaluateScaleStep ã‚¨ãƒ©ãƒ¼:",ne)}try{we&&l>0&&b>0&&sn(l,S)}catch(ne){console.error("âŒ [ContinuousMode] updateScoringEngine ã‚¨ãƒ©ãƒ¼:",ne)}}catch(l){console.error("âŒ [ContinuousMode] handlePitchUpdate ã‚¨ãƒ©ãƒ¼:",{error:l.message,stack:l.stack,eventDetail:o==null?void 0:o.detail,trainingPhase:k,currentSessionId:n})}}function yn(o){if(!o||o<=0||!C||!b||Se<25)return null;const S=I-1;if(S<0||S>=q.length)return null;const T=Ye(b,S);if(!T||T<=0)return null;const O=It(o,T).correctedFrequency,se=xn(O);return{frequency:Math.round(O),note:se}}function hn(o,l){if(!o||o<=0||!C)return;if(!b||b<=0){console.error(`âŒ [æ¡ç‚¹ã‚¨ãƒ©ãƒ¼] åŸºéŸ³å‘¨æ³¢æ•°ãŒç„¡åŠ¹: ${b}Hz`),console.error(`âŒ [æ¡ç‚¹ã‚¨ãƒ©ãƒ¼] åŸºéŸ³å: ${M}`),console.error(`âŒ [æ¡ç‚¹ã‚¨ãƒ©ãƒ¼] activeStepIndex: ${I-1}`),console.error(`âŒ [æ¡ç‚¹ã‚¨ãƒ©ãƒ¼] trainingPhase: ${k}`),console.error(`âŒ [æ¡ç‚¹ã‚¨ãƒ©ãƒ¼] isGuideAnimationActive: ${C}`);return}if(Se<25)return;const T=I-1;if(T<0||T>=q.length)return;T>=4&&ce.debug(`[æ¡ç‚¹ãƒ‡ãƒãƒƒã‚°] activeStepIndex=${T} (${q[T].name}), currentBaseFrequency=${b}Hz`);const H=Ye(b,T);if(T>=0&&ce.debug(`[éŸ³ç¨‹è¨ˆç®—ä¿®æ­£ç‰ˆ] ${q[T].name}: æœŸå¾…å‘¨æ³¢æ•° ${H.toFixed(1)}Hz`),!H||H<=0||!isFinite(H)){console.error("âŒ [æ¡ç‚¹ã‚¨ãƒ©ãƒ¼] æœŸå¾…å‘¨æ³¢æ•°è¨ˆç®—ã‚¨ãƒ©ãƒ¼:"),console.error(`   åŸºéŸ³å‘¨æ³¢æ•°: ${b}Hz`),console.error(`   éŸ³éšã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹: ${T}`),console.error(`   æœŸå¾…å‘¨æ³¢æ•°: ${H}Hz`);return}const O=It(o,H),se=O.correctedFrequency,ie=O.factor,ne=Math.round(1200*Math.log2(se/H));if((Math.abs(ne)>200||ie!==1)&&(ce.debug(`[ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—å¼è£œæ­£] ${q[T].name}:`),console.warn(`   æ¤œå‡ºå‘¨æ³¢æ•°: ${o.toFixed(1)}Hz`),console.warn(`   è£œæ­£å¾Œå‘¨æ³¢æ•°: ${se.toFixed(1)}Hz`),console.warn(`   æœŸå¾…å‘¨æ³¢æ•°: ${H.toFixed(1)}Hz`),console.warn(`   ã‚»ãƒ³ãƒˆå·®: ${ne}Â¢`),console.warn(`   è£œæ­£ä¿‚æ•°: ${ie} (${O.description})`),console.warn(`   åŸºéŸ³: ${M} (${b.toFixed(1)}Hz)`)),!isFinite(ne)){console.error("âŒ [æ¡ç‚¹ã‚¨ãƒ©ãƒ¼] ã‚»ãƒ³ãƒˆè¨ˆç®—ã‚¨ãƒ©ãƒ¼:"),console.error(`   æ¤œå‡ºå‘¨æ³¢æ•°: ${o}Hz`),console.error(`   æœŸå¾…å‘¨æ³¢æ•°: ${H}Hz`),console.error(`   ã‚»ãƒ³ãƒˆå·®: ${ne}`);return}const Be=Math.abs(ne)<=50;if(Se>=15){const he=Math.max(0,Math.round(100-Math.abs(ne))),ve=oe.findIndex($e=>$e.stepIndex===T),be={stepIndex:T,stepName:q[T].name,expectedFrequency:Math.round(H),detectedFrequency:Math.round(o),adjustedFrequency:Math.round(se),centDifference:ne,accuracy:he,isCorrect:Be,correctionFactor:ie,correctionDescription:O.description,timestamp:Date.now()};ve>=0?oe[ve]=be:oe.push(be),oe.length%4===0&&ce.realtime(`æ¡ç‚¹é€²æ—: ${oe.length}/${q.length}ã‚¹ãƒ†ãƒƒãƒ—å®Œäº†`)}}function pn(){e(0,k="results"),He.isCompleted=!0,He.averageAccuracy=Math.round(He.correctCount/He.totalCount*100),ae&&ae.stopDetection(),Dn()}async function vn(){if(c){console.warn("ğŸš« [RestartSame] 8ã‚»ãƒƒã‚·ãƒ§ãƒ³å®Œäº†çŠ¶æ…‹ã§ã¯å†æŒ‘æˆ¦ä¸å¯ - æ–°ã‚µã‚¤ã‚¯ãƒ«é–‹å§‹ãŒå¿…è¦"),await tt()?(console.log("âœ… [RestartSame] æ–°ã‚µã‚¤ã‚¯ãƒ«é–‹å§‹å®Œäº† - ã‚»ãƒƒã‚·ãƒ§ãƒ³1/8ã‹ã‚‰å†é–‹"),window.location.reload()):console.error("âŒ [RestartSame] æ–°ã‚µã‚¤ã‚¯ãƒ«é–‹å§‹å¤±æ•—");return}ot(),e(0,k="setup"),B&&(clearTimeout(B),B=null),ae&&ae.resetDisplayState&&ae.resetDisplayState(),ct(),console.log("ğŸ”„ [RestartSame] åŒã˜åŸºéŸ³ã§å†æŒ‘æˆ¦:",M,b+"Hz"),console.log("ğŸ”„ [RestartSame] åŸºéŸ³æƒ…å ±ä¿æŒå®Œäº† - ãƒ¦ãƒ¼ã‚¶ãƒ¼æ“ä½œå¾…æ©Ÿ")}async function _n(){if(c){console.warn("ğŸš« [RestartDifferent] 8ã‚»ãƒƒã‚·ãƒ§ãƒ³å®Œäº†çŠ¶æ…‹ã§ã¯å†æŒ‘æˆ¦ä¸å¯ - æ–°ã‚µã‚¤ã‚¯ãƒ«é–‹å§‹ãŒå¿…è¦"),await tt()?(console.log("âœ… [RestartDifferent] æ–°ã‚µã‚¤ã‚¯ãƒ«é–‹å§‹å®Œäº† - ã‚»ãƒƒã‚·ãƒ§ãƒ³1/8ã‹ã‚‰å†é–‹"),window.location.reload()):console.error("âŒ [RestartDifferent] æ–°ã‚µã‚¤ã‚¯ãƒ«é–‹å§‹å¤±æ•—");return}ot(),e(0,k="setup"),B&&(clearTimeout(B),B=null),e(7,M=""),e(8,b=0),console.log("ğŸ”„ [restartDifferentBaseNote] åŸºéŸ³æƒ…å ±ã‚’ãƒªã‚»ãƒƒãƒˆã—ã¾ã—ãŸ"),ae&&ae.resetDisplayState&&ae.resetDisplayState(),ct()}function ct(){I=0,C=!1,oe=[],e(10,q=q.map(o=>({...o,state:"inactive",completed:!1})))}async function Sn(){console.log("ğŸš€ [StartNewCycle] 8ã‚»ãƒƒã‚·ãƒ§ãƒ³å®Œäº†å¾Œã®æœ€åˆã‹ã‚‰æŒ‘æˆ¦é–‹å§‹");try{await tt()?(console.log("âœ… [StartNewCycle] æ–°ã‚µã‚¤ã‚¯ãƒ«é–‹å§‹å®Œäº†"),localStorage.getItem("mic-test-completed")?(console.log("âœ… [StartNewCycle] ãƒã‚¤ã‚¯ãƒ†ã‚¹ãƒˆå®Œäº†ãƒ•ãƒ©ã‚°ç¢ºèª - ãƒªãƒ­ãƒ¼ãƒ‰ãªã—ã§çŠ¶æ…‹ãƒªã‚»ãƒƒãƒˆ"),ot(),await bt(),e(0,k="setup"),ct(),dt(),console.log("âœ… [StartNewCycle] çŠ¶æ…‹ãƒªã‚»ãƒƒãƒˆå®Œäº† - ã‚»ãƒƒã‚·ãƒ§ãƒ³1/8ã‹ã‚‰å†é–‹")):window.location.reload()):(console.error("âŒ [StartNewCycle] æ–°ã‚µã‚¤ã‚¯ãƒ«é–‹å§‹å¤±æ•—"),Ze())}catch(o){console.error("âŒ [StartNewCycle] æ–°ã‚µã‚¤ã‚¯ãƒ«é–‹å§‹ã‚¨ãƒ©ãƒ¼:",o),Ze()}}function bn(o){const{type:l}=o.detail;switch(l){case"same":vn();break;case"different":_n();break;case"restart":Sn();break;case"home":Ze();break;default:console.warn("ğŸš« [ActionButtons] æœªçŸ¥ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚¿ã‚¤ãƒ—:",l)}}function qn(){console.log("âš¡ [ContinuousMode] 8ã‚»ãƒƒã‚·ãƒ§ãƒ³é€£ç¶šé–‹å§‹"),mt()}function Dn(){console.log("âœ… [ContinuousMode] ã‚»ãƒƒã‚·ãƒ§ãƒ³å®Œäº†:",n),n<8?setTimeout(()=>{console.log("ğŸ”„ [ContinuousMode] æ¬¡ã‚»ãƒƒã‚·ãƒ§ãƒ³è‡ªå‹•é–‹å§‹æº–å‚™:",n+1),e(0,k="setup"),He={isCompleted:!1,correctCount:0,totalCount:0,averageAccuracy:0},e(9,K=!1),ae&&(console.log("ğŸ¤ [ContinuousMode] éŸ³ç¨‹æ¤œå‡ºå†é–‹"),ae.startDetection()),console.log("ğŸµ [ContinuousMode] æ¬¡ã®åŸºéŸ³è‡ªå‹•å†ç”Ÿé–‹å§‹"),mt()},5e3):(console.log("ğŸ‰ [ContinuousMode] 8ã‚»ãƒƒã‚·ãƒ§ãƒ³å®Œäº†ï¼"),setTimeout(()=>{console.log("ğŸ† [ContinuousMode] ç·åˆè©•ä¾¡ç”»é¢è¡¨ç¤ºå®Œäº†")},1e3))}function wn(o){const{error:l,context:S,reason:T,recovery:H}=o.detail;console.error("âŒ [ContinuousMode] PitchDetectorã‚¨ãƒ©ãƒ¼è©³ç´°:",{error:(l==null?void 0:l.message)||l,stack:l==null?void 0:l.stack,context:S,reason:T,recovery:H,trainingPhase:k,currentSessionId:n}),T==="mediastream_ended"&&H==="restart_required"&&(console.log("âš¡ [ContinuousMode] MediaStreamçµ‚äº†æ¤œå‡º - è‡ªå‹•å¾©æ—§ã‚’è©¦è¡Œ"),setTimeout(async()=>{try{await Ue()}catch(O){console.error("âŒ [ContinuousMode] è‡ªå‹•å¾©æ—§å¤±æ•—:",O)}},1e3))}function kn(o){const{healthy:l,errors:S,details:T}=o.detail;e(2,L=l),e(6,x=S),l||(console.warn("âš ï¸ ãƒã‚¤ã‚¯ã®å¥åº·çŠ¶æ…‹ãŒæ‚ªåŒ–:",S),k==="guiding"&&(e(0,k="setup"),console.warn("ğŸ›‘ ãƒã‚¤ã‚¯å•é¡Œã«ã‚ˆã‚Šãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã‚’åœæ­¢")))}Rn(()=>{console.log("ğŸ”„ [RandomTraining] onDestroy - AudioManagerãƒªã‚½ãƒ¼ã‚¹ã¯ä¿æŒ"),ge&&(ge.dispose(),e(33,ge=null))});const po=[];Uo.keys(t).forEach(o=>{!~po.indexOf(o)&&o.slice(0,2)!=="$$"&&o!=="slot"&&Wo.warn(`<Page> was created with unknown prop '${o}'`)});function vo(o){wo[o?"unshift":"push"](()=>{ae=o,e(22,ae)})}return s.$capture_state=()=>({onMount:Fn,onDestroy:Rn,goto:vt,base:it,page:_t,ChevronRight:jo,Music:jn,Card:Je,Button:ut,VolumeBar:Co,PitchDisplay:zo,PitchDetector:zn,PitchDetectionDisplay:Hn,PageLayout:Vn,Tone:Ho,audioManager:We,harmonicCorrection:St,logger:ce,ScoreResultPanel:Vo,IntervalProgressTracker:Bo,ConsistencyGraph:xo,FeedbackDisplay:Po,SessionStatistics:Eo,UnifiedScoreResultFixed:Xt,ActionButtons:Qt,EvaluationEngine:nt,EnhancedScoringEngine:An,trainingProgress:At,currentSessionId:Nt,nextBaseNote:Rt,nextBaseName:Ft,isLoading:Ct,storageError:Io,isCompleted:kt,sessionHistory:wt,overallGrade:Mo,overallAccuracy:To,progressPercentage:Ao,remainingSessions:Dt,latestSessionResult:No,unifiedScoreData:qt,loadProgress:bt,saveSessionResult:Nn,resetProgress:Ro,createNewProgress:Fo,startNewCycleIfCompleted:tt,getVolumeForDevice:En,calculateUnifiedGrade:j,generateTestUnifiedScoreData:Jo,trainingPhase:k,microphoneState:D,microphoneHealthy:L,microphoneErrors:x,buildVersion:Wt,buildTimestamp:Jt,updateStatus:Kt,SCALE_NAMES:Q,currentBaseNote:M,currentBaseFrequency:b,isPlaying:K,currentScaleIndex:I,scaleSteps:q,guideAnimationTimer:B,isGuideAnimationActive:C,guideStartProgress:V,isGuideStartBarActive:E,guideStartTimer:Y,musicIconGlowing:ye,scaleEvaluations:oe,previousEvaluations:_e,currentVolume:Se,currentFrequency:Ee,detectedNote:Le,pitchDifference:Ve,sessionResults:He,scoringEngine:we,currentScoreData:ze,intervalData:ke,consistencyData:Pe,feedbackData:Oe,technicalFeedbackData:Xe,sessionStatistics:Fe,activeTab:ft,noteResultsForDisplay:re,currentUnifiedScoreData:le,sampler:ge,isSamplerLoading:Re,pitchDetectorComponent:ae,mediaStream:xe,audioContext:rt,sourceNode:at,sessionStartTime:Ke,baseNotes:Ge,checkMicrophonePermission:Ue,selectRandomBaseNote:dt,playRandomBaseNote:Yt,playCurrentBaseNote:Zt,playBaseNoteOnly:fo,playBaseNote:mt,startGuideStartBar:$t,cleanupGuideStartBar:mo,calculateExpectedFrequency:Ye,calculateTargetFrequency:en,startGuideAnimation:gt,finishGuideAnimation:tn,calculateFinalResults:nn,getStatusMessage:go,getDisplayEvaluations:yo,goToMicrophoneTest:on,goHome:Ze,initializeSampler:rn,checkExistingMicrophonePermission:st,initializeScoringEngine:an,updateScoringEngine:sn,generateFinalScoring:cn,generateTestScoreData:ln,switchTab:ho,generateUnifiedScoreData:un,saveSessionToStorage:fn,generateEnhancedScoringData:dn,generateFallbackEnhancedData:yt,generateIntervalDataFromResults:Mt,generateIntervalDataFromSessionHistory:Pn,generateConsistencyDataFromResults:ht,generateFeedbackFromResults:pt,generateTechnicalFeedbackFromEnhancedEngine:mn,handlePitchUpdate:gn,getEvaluationCorrectedFrequency:yn,frequencyToNote:xn,multiStageOctaveCorrection:It,evaluateScaleStep:hn,completeSession:pn,restartSameBaseNote:vn,restartDifferentBaseNote:_n,scrollToTop:ot,resetSessionState:ct,startNewCycle:Sn,handleActionButtonClick:bn,startContinuousMode:qn,handleSessionComplete:Dn,handlePitchDetectorStateChange:uo,handlePitchDetectorError:wn,handleMicrophoneHealthChange:kn,canRestartSession:a,canStartTraining:i,$currentSessionId:n,$unifiedScoreData:r,$isCompleted:c,$page:u,$remainingSessions:f,$nextBaseName:d,$nextBaseNote:m,$sessionHistory:v,$trainingProgress:w,$isLoading:p}),s.$inject_state=o=>{"trainingPhase"in o&&e(0,k=o.trainingPhase),"microphoneState"in o&&e(1,D=o.microphoneState),"microphoneHealthy"in o&&e(2,L=o.microphoneHealthy),"microphoneErrors"in o&&e(6,x=o.microphoneErrors),"currentBaseNote"in o&&e(7,M=o.currentBaseNote),"currentBaseFrequency"in o&&e(8,b=o.currentBaseFrequency),"isPlaying"in o&&e(9,K=o.isPlaying),"currentScaleIndex"in o&&(I=o.currentScaleIndex),"scaleSteps"in o&&e(10,q=o.scaleSteps),"guideAnimationTimer"in o&&(B=o.guideAnimationTimer),"isGuideAnimationActive"in o&&(C=o.isGuideAnimationActive),"guideStartProgress"in o&&e(11,V=o.guideStartProgress),"isGuideStartBarActive"in o&&(E=o.isGuideStartBarActive),"guideStartTimer"in o&&(Y=o.guideStartTimer),"musicIconGlowing"in o&&e(12,ye=o.musicIconGlowing),"scaleEvaluations"in o&&(oe=o.scaleEvaluations),"previousEvaluations"in o&&(_e=o.previousEvaluations),"currentVolume"in o&&e(13,Se=o.currentVolume),"currentFrequency"in o&&e(14,Ee=o.currentFrequency),"detectedNote"in o&&e(15,Le=o.detectedNote),"pitchDifference"in o&&(Ve=o.pitchDifference),"sessionResults"in o&&(He=o.sessionResults),"scoringEngine"in o&&(we=o.scoringEngine),"currentScoreData"in o&&e(16,ze=o.currentScoreData),"intervalData"in o&&e(3,ke=o.intervalData),"consistencyData"in o&&e(17,Pe=o.consistencyData),"feedbackData"in o&&e(18,Oe=o.feedbackData),"technicalFeedbackData"in o&&e(19,Xe=o.technicalFeedbackData),"sessionStatistics"in o&&e(20,Fe=o.sessionStatistics),"activeTab"in o&&(ft=o.activeTab),"noteResultsForDisplay"in o&&(re=o.noteResultsForDisplay),"currentUnifiedScoreData"in o&&e(21,le=o.currentUnifiedScoreData),"sampler"in o&&e(33,ge=o.sampler),"isSamplerLoading"in o&&e(34,Re=o.isSamplerLoading),"pitchDetectorComponent"in o&&e(22,ae=o.pitchDetectorComponent),"mediaStream"in o&&(xe=o.mediaStream),"audioContext"in o&&(rt=o.audioContext),"sourceNode"in o&&(at=o.sourceNode),"sessionStartTime"in o&&(Ke=o.sessionStartTime),"canRestartSession"in o&&(a=o.canRestartSession),"canStartTraining"in o&&(i=o.canStartTraining)},t&&"$$inject"in t&&s.$inject_state(t.$$inject),s.$$.update=()=>{s.$$.dirty[0]&6|s.$$.dirty[1]&12&&(i=D==="granted"&&!Re&&ge&&L),s.$$.dirty[0]&1&&(a=k==="results"),s.$$.dirty[0]&56&&r&&c&&r.sessionHistory&&(e(3,ke=Pn(r.sessionHistory)),console.log("ğŸµ [RandomTraining] intervalDataç”Ÿæˆå®Œäº†:",ke.length,"ä»¶")),s.$$.dirty[0]&3&&k==="setup"&&D==="granted"&&ot()},[k,D,L,ke,r,c,x,M,b,K,q,V,ye,Se,Ee,Le,ze,Pe,Oe,Xe,Fe,le,ae,n,v,p,on,Ze,gn,bn,qn,wn,kn,ge,Re,vo]}class ar extends _o{constructor(t){super(t),So(this,t,Ko,Ut,bo,{},null,[-1,-1,-1,-1]),ee("SvelteRegisterComponent",{component:this,tagName:"Page",options:t,id:Ut.name})}}export{ar as component,rr as universal};
