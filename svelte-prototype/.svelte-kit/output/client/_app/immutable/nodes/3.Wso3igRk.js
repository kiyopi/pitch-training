import{S as Ge,i as We,d as F,s as Te,v as Je,c as Oe,a as Ze,D as _e,b as c,q as re,r as ee,u as te,f as z,w as ae,E as Ke,m as M,x as ce,p as R,y as ue,g as r,z as a,h as d,j as p,k as b,B as le,A as U,o as g,C as ie,F as Qe,G as Ue,l as K,t as Q,H as $e,e as pe,I as Pe}from"../chunks/p0IT90XR.js";import"../chunks/B0HqwU-P.js";import{p as ge}from"../chunks/CEK4v7sV.js";import{P as Me,B as Ce,C as ye}from"../chunks/cNaTqdNa.js";const v="src/routes/microphone-test/+page.svelte";function ke(i){let e,t,l,o="音量レベル",n,s,f,_,w,h,m=Math.round(i[3])+"",k,A,I,E,H,q,y,C="音程検出",u,B,S,T=i[4].toFixed(1)+"",X,j,$,V,J,L,G,O,W,P=!i[1]&&be(i);function oe(Y,D){return Y[2]?Ne:Re}let fe=oe(i),Z=fe(i),N=i[1]&&!i[2]&&we(i);const Ee={c:function(){e=g("div"),t=g("div"),l=g("h3"),l.textContent=o,n=R(),s=g("div"),f=g("div"),_=g("div"),w=R(),h=g("span"),k=Q(m),A=Q("%"),I=R(),E=g("div"),P&&P.c(),H=R(),q=g("div"),y=g("h3"),y.textContent=C,u=R(),B=g("div"),S=g("div"),X=Q(T),j=Q(" Hz"),$=R(),V=g("div"),J=Q(i[5]),L=R(),G=g("div"),Z.c(),O=R(),N&&N.c(),W=Pe(),this.h()},l:function(D){e=p(D,"DIV",{class:!0});var x=b(e);t=p(x,"DIV",{class:!0});var ne=b(t);l=p(ne,"H3",{class:!0,"data-svelte-h":!0}),U(l)!=="svelte-1nc8gri"&&(l.textContent=o),n=M(ne),s=p(ne,"DIV",{class:!0});var de=b(s);f=p(de,"DIV",{class:!0});var De=b(f);_=p(De,"DIV",{class:!0,style:!0}),b(_).forEach(c),De.forEach(c),w=M(de),h=p(de,"SPAN",{class:!0});var me=b(h);k=K(me,m),A=K(me,"%"),me.forEach(c),de.forEach(c),I=M(ne),E=p(ne,"DIV",{class:!0});var Be=b(E);P&&P.l(Be),Be.forEach(c),ne.forEach(c),H=M(x),q=p(x,"DIV",{class:!0});var se=b(q);y=p(se,"H3",{class:!0,"data-svelte-h":!0}),U(y)!=="svelte-1ofzoy2"&&(y.textContent=C),u=M(se),B=p(se,"DIV",{class:!0});var ve=b(B);S=p(ve,"DIV",{class:!0});var he=b(S);X=K(he,T),j=K(he," Hz"),he.forEach(c),$=M(ve),V=p(ve,"DIV",{class:!0});var Ie=b(V);J=K(Ie,i[5]),Ie.forEach(c),ve.forEach(c),L=M(se),G=p(se,"DIV",{class:!0});var Ve=b(G);Z.l(Ve),Ve.forEach(c),se.forEach(c),x.forEach(c),O=M(D),N&&N.l(D),W=Pe(),this.h()},h:function(){a(l,"class","display-title svelte-14qwe2r"),d(l,v,151,16,4342),a(_,"class","volume-fill svelte-14qwe2r"),$e(_,"width",i[3]+"%"),d(_,v,154,20,4493),a(f,"class","volume-bar svelte-14qwe2r"),d(f,v,153,18,4448),a(h,"class","volume-text svelte-14qwe2r"),d(h,v,156,18,4600),a(s,"class","volume-bar-container svelte-14qwe2r"),d(s,v,152,16,4395),a(E,"class","volume-status svelte-14qwe2r"),d(E,v,158,16,4701),a(t,"class","volume-section svelte-14qwe2r"),d(t,v,150,14,4297),a(y,"class","display-title svelte-14qwe2r"),d(y,v,167,16,5007),a(S,"class","frequency-value svelte-14qwe2r"),d(S,v,169,18,5109),a(V,"class","note-value svelte-14qwe2r"),d(V,v,170,18,5195),a(B,"class","frequency-display svelte-14qwe2r"),d(B,v,168,16,5059),a(G,"class","frequency-status svelte-14qwe2r"),d(G,v,172,16,5278),a(q,"class","frequency-section"),d(q,v,166,14,4959),a(e,"class","realtime-display svelte-14qwe2r"),d(e,v,148,12,4223)},m:function(D,x){z(D,e,x),r(e,t),r(t,l),r(t,n),r(t,s),r(s,f),r(f,_),r(s,w),r(s,h),r(h,k),r(h,A),r(t,I),r(t,E),P&&P.m(E,null),r(e,H),r(e,q),r(q,y),r(q,u),r(q,B),r(B,S),r(S,X),r(S,j),r(B,$),r(B,V),r(V,J),r(q,L),r(q,G),Z.m(G,null),z(D,O,x),N&&N.m(D,x),z(D,W,x)},p:function(D,x){x&8&&$e(_,"width",D[3]+"%"),x&8&&m!==(m=Math.round(D[3])+"")&&pe(k,m),D[1]?P&&(P.d(1),P=null):P||(P=be(D),P.c(),P.m(E,null)),x&16&&T!==(T=D[4].toFixed(1)+"")&&pe(X,T),x&32&&pe(J,D[5]),fe!==(fe=oe(D))&&(Z.d(1),Z=fe(D),Z&&(Z.c(),Z.m(G,null))),D[1]&&!D[2]?N||(N=we(D),N.c(),N.m(W.parentNode,W)):N&&(N.d(1),N=null)},d:function(D){D&&(c(e),c(O),c(W)),P&&P.d(),Z.d(),N&&N.d(D)}};return F("SvelteRegisterBlock",{block:Ee,id:ke.name,type:"if",source:"(148:10) {#if micPermission === 'granted'}",ctx:i}),Ee}function be(i){let e,t="⏳ 声を出して音量を確認してください";const l={c:function(){e=g("span"),e.textContent=t,this.h()},l:function(n){e=p(n,"SPAN",{class:!0,"data-svelte-h":!0}),U(e)!=="svelte-7eexnn"&&(e.textContent=t),this.h()},h:function(){a(e,"class","status-pending svelte-14qwe2r"),d(e,v,160,20,4789)},m:function(n,s){z(n,e,s)},d:function(n){n&&c(e)}};return F("SvelteRegisterBlock",{block:l,id:be.name,type:"if",source:"(160:18) {#if !volumeDetected}",ctx:i}),l}function Re(i){let e,t="⏳ 「ド」を発声して音程を確認してください";const l={c:function(){e=g("span"),e.textContent=t,this.h()},l:function(n){e=p(n,"SPAN",{class:!0,"data-svelte-h":!0}),U(e)!=="svelte-lvftl7"&&(e.textContent=t),this.h()},h:function(){a(e,"class","status-pending svelte-14qwe2r"),d(e,v,176,20,5466)},m:function(n,s){z(n,e,s)},d:function(n){n&&c(e)}};return F("SvelteRegisterBlock",{block:l,id:Re.name,type:"else",source:"(176:18) {:else}",ctx:i}),l}function Ne(i){let e,t="✅ 音程を検出しています";const l={c:function(){e=g("span"),e.textContent=t,this.h()},l:function(n){e=p(n,"SPAN",{class:!0,"data-svelte-h":!0}),U(e)!=="svelte-pzbfd6"&&(e.textContent=t),this.h()},h:function(){a(e,"class","status-success svelte-14qwe2r"),d(e,v,174,20,5371)},m:function(n,s){z(n,e,s)},d:function(n){n&&c(e)}};return F("SvelteRegisterBlock",{block:l,id:Ne.name,type:"if",source:"(174:18) {#if frequencyDetected}",ctx:i}),l}function we(i){let e,t,l,o="「ド」を発声してください",n,s,f="任意の高さで「ドー」と歌うように発声してください";const _={c:function(){e=g("div"),t=g("div"),l=g("h3"),l.textContent=o,n=R(),s=g("p"),s.textContent=f,this.h()},l:function(h){e=p(h,"DIV",{class:!0});var m=b(e);t=p(m,"DIV",{class:!0});var k=b(t);l=p(k,"H3",{class:!0,"data-svelte-h":!0}),U(l)!=="svelte-xe90gt"&&(l.textContent=o),n=M(k),s=p(k,"P",{class:!0,"data-svelte-h":!0}),U(s)!=="svelte-1rtajtc"&&(s.textContent=f),k.forEach(c),m.forEach(c),this.h()},h:function(){a(l,"class","svelte-14qwe2r"),d(l,v,186,18,5796),a(s,"class","svelte-14qwe2r"),d(s,v,187,18,5836),a(t,"class","guidance-content svelte-14qwe2r"),d(t,v,185,16,5747),a(e,"class","guidance svelte-14qwe2r"),d(e,v,184,14,5708)},m:function(h,m){z(h,e,m),r(e,t),r(t,l),r(t,n),r(t,s)},d:function(h){h&&c(e)}};return F("SvelteRegisterBlock",{block:_,id:we.name,type:"if",source:"(184:12) {#if volumeDetected && !frequencyDetected}",ctx:i}),_}function Ae(i){let e,t=i[0]==="granted"&&ke(i);const l={c:function(){e=g("div"),t&&t.c(),this.h()},l:function(n){e=p(n,"DIV",{class:!0});var s=b(e);t&&t.l(s),s.forEach(c),this.h()},h:function(){a(e,"class","mic-test-content svelte-14qwe2r"),d(e,v,144,8,4107)},m:function(n,s){z(n,e,s),t&&t.m(e,null)},p:function(n,s){n[0]==="granted"?t?t.p(n,s):(t=ke(n),t.c(),t.m(e,null)):t&&(t.d(1),t=null)},d:function(n){n&&c(e),t&&t.d()}};return F("SvelteRegisterBlock",{block:l,id:Ae.name,type:"slot",source:'(144:6) <Card variant=\\"default\\" padding=\\"lg\\">',ctx:i}),l}function xe(i){let e,t;e=new Ce({props:{variant:"disabled",size:"lg",fullWidth:!0,disabled:!0,$$slots:{default:[ze]},$$scope:{ctx:i}},$$inline:!0});const l={c:function(){ue(e.$$.fragment)},l:function(n){ce(e.$$.fragment,n)},m:function(n,s){ae(e,n,s),t=!0},p:function(n,s){const f={};s&16384&&(f.$$scope={dirty:s,ctx:n}),e.$set(f)},i:function(n){t||(te(e.$$.fragment,n),t=!0)},o:function(n){ee(e.$$.fragment,n),t=!1},d:function(n){re(e,n)}};return F("SvelteRegisterBlock",{block:l,id:xe.name,type:"else",source:"(215:10) {:else}",ctx:i}),l}function Fe(i){let e,t;e=new Ce({props:{href:i[7].path,variant:"primary",size:"lg",fullWidth:!0,$$slots:{default:[He]},$$scope:{ctx:i}},$$inline:!0});const l={c:function(){ue(e.$$.fragment)},l:function(n){ce(e.$$.fragment,n)},m:function(n,s){ae(e,n,s),t=!0},p:function(n,s){const f={};s&16384&&(f.$$scope={dirty:s,ctx:n}),e.$set(f)},i:function(n){t||(te(e.$$.fragment,n),t=!0)},o:function(n){ee(e.$$.fragment,n),t=!1},d:function(n){re(e,n)}};return F("SvelteRegisterBlock",{block:l,id:Fe.name,type:"if",source:"(206:10) {#if startButtonEnabled}",ctx:i}),l}function ze(i){let e;const t={c:function(){e=Q("マイクテスト完了後に開始")},l:function(o){e=K(o,"マイクテスト完了後に開始")},m:function(o,n){z(o,e,n)},d:function(o){o&&c(e)}};return F("SvelteRegisterBlock",{block:t,id:ze.name,type:"slot",source:'(216:12) <Button                variant=\\"disabled\\"                size=\\"lg\\"                fullWidth                disabled             >',ctx:i}),t}function He(i){let e;const t={c:function(){e=Q("トレーニング開始")},l:function(o){e=K(o,"トレーニング開始")},m:function(o,n){z(o,e,n)},d:function(o){o&&c(e)}};return F("SvelteRegisterBlock",{block:t,id:He.name,type:"slot",source:'(207:12) <Button                href={selectedMode.path}                variant=\\"primary\\"                size=\\"lg\\"                fullWidth             >',ctx:i}),t}function je(i){let e,t,l=i[7].name+"",o,n,s,f=i[7].description+"",_,w,h,m,k;const A=[Fe,xe],I=[];function E(q,y){return q[6]?0:1}h=E(i),m=I[h]=A[h](i);const H={c:function(){e=g("div"),t=g("h3"),o=Q(l),n=R(),s=g("p"),_=Q(f),w=R(),m.c(),this.h()},l:function(y){e=p(y,"DIV",{class:!0});var C=b(e);t=p(C,"H3",{class:!0});var u=b(t);o=K(u,l),u.forEach(c),n=M(C),s=p(C,"P",{class:!0});var B=b(s);_=K(B,f),B.forEach(c),w=M(C),m.l(C),C.forEach(c),this.h()},h:function(){a(t,"class","start-title svelte-14qwe2r"),d(t,v,200,10,6130),a(s,"class","start-description svelte-14qwe2r"),d(s,v,201,10,6189),a(e,"class","start-content svelte-14qwe2r"),d(e,v,199,8,6092)},m:function(y,C){z(y,e,C),r(e,t),r(t,o),r(e,n),r(e,s),r(s,_),r(e,w),I[h].m(e,null),k=!0},p:function(y,C){let u=h;h=E(y),h===u?I[h].p(y,C):(Qe(),ee(I[u],1,1,()=>{I[u]=null}),Ue(),m=I[h],m?m.p(y,C):(m=I[h]=A[h](y),m.c()),te(m,1),m.m(e,null))},i:function(y){k||(te(m),k=!0)},o:function(y){ee(m),k=!1},d:function(y){y&&c(e),I[h].d()}};return F("SvelteRegisterBlock",{block:H,id:je.name,type:"slot",source:'(199:6) <Card variant=\\"default\\" padding=\\"lg\\">',ctx:i}),H}function Le(i){let e,t,l,o,n,s,f,_,w,h,m,k,A="マイクテスト",I,E,H="音感トレーニングを始める前に、マイクの動作を確認します",q,y,C,u,B,S,T;C=new ye({props:{variant:"default",padding:"lg",$$slots:{default:[Ae]},$$scope:{ctx:i}},$$inline:!0}),S=new ye({props:{variant:"default",padding:"lg",$$slots:{default:[je]},$$scope:{ctx:i}},$$inline:!0});const X={c:function(){e=g("div"),t=g("div"),l=g("div"),o=g("div"),n=ie("svg"),s=ie("path"),f=ie("path"),_=ie("line"),w=ie("line"),h=R(),m=g("div"),k=g("h1"),k.textContent=A,I=R(),E=g("p"),E.textContent=H,q=R(),y=g("div"),ue(C.$$.fragment),u=R(),B=g("div"),ue(S.$$.fragment),this.h()},l:function($){e=p($,"DIV",{class:!0});var V=b(e);t=p(V,"DIV",{class:!0});var J=b(t);l=p(J,"DIV",{class:!0});var L=b(l);o=p(L,"DIV",{class:!0});var G=b(o);n=le(G,"svg",{width:!0,height:!0,viewBox:!0,fill:!0,stroke:!0,"stroke-width":!0});var O=b(n);s=le(O,"path",{d:!0}),b(s).forEach(c),f=le(O,"path",{d:!0}),b(f).forEach(c),_=le(O,"line",{x1:!0,x2:!0,y1:!0,y2:!0}),b(_).forEach(c),w=le(O,"line",{x1:!0,x2:!0,y1:!0,y2:!0}),b(w).forEach(c),O.forEach(c),G.forEach(c),h=M(L),m=p(L,"DIV",{});var W=b(m);k=p(W,"H1",{class:!0,"data-svelte-h":!0}),U(k)!=="svelte-z7m4lk"&&(k.textContent=A),I=M(W),E=p(W,"P",{class:!0,"data-svelte-h":!0}),U(E)!=="svelte-1vtv92f"&&(E.textContent=H),W.forEach(c),L.forEach(c),J.forEach(c),q=M(V),y=p(V,"DIV",{class:!0});var P=b(y);ce(C.$$.fragment,P),P.forEach(c),u=M(V),B=p(V,"DIV",{class:!0});var oe=b(B);ce(S.$$.fragment,oe),oe.forEach(c),V.forEach(c),this.h()},h:function(){a(s,"d","M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z"),d(s,v,128,12,3571),a(f,"d","M19 10v2a7 7 0 0 1-14 0v-2"),d(f,v,129,12,3648),a(_,"x1","12"),a(_,"x2","12"),a(_,"y1","19"),a(_,"y2","22"),d(_,v,130,12,3699),a(w,"x1","8"),a(w,"x2","16"),a(w,"y1","22"),a(w,"y2","22"),d(w,v,131,12,3751),a(n,"width","48"),a(n,"height","48"),a(n,"viewBox","0 0 24 24"),a(n,"fill","none"),a(n,"stroke","currentColor"),a(n,"stroke-width","2"),d(n,v,127,10,3459),a(o,"class","mic-icon svelte-14qwe2r"),d(o,v,126,8,3426),a(k,"class","mic-test-title svelte-14qwe2r"),d(k,v,135,10,3846),a(E,"class","mic-test-description svelte-14qwe2r"),d(E,v,136,10,3895),d(m,v,134,8,3830),a(l,"class","mic-test-header svelte-14qwe2r"),d(l,v,125,6,3388),a(t,"class","header svelte-14qwe2r"),d(t,v,124,4,3361),a(y,"class","test-section"),d(y,v,142,4,4028),a(B,"class","start-section"),d(B,v,197,4,6012),a(e,"class","microphone-test svelte-14qwe2r"),d(e,v,122,2,3309)},m:function($,V){z($,e,V),r(e,t),r(t,l),r(l,o),r(o,n),r(n,s),r(n,f),r(n,_),r(n,w),r(l,h),r(l,m),r(m,k),r(m,I),r(m,E),r(e,q),r(e,y),ae(C,y,null),r(e,u),r(e,B),ae(S,B,null),T=!0},p:function($,V){const J={};V&16447&&(J.$$scope={dirty:V,ctx:$}),C.$set(J);const L={};V&16448&&(L.$$scope={dirty:V,ctx:$}),S.$set(L)},i:function($){T||(te(C.$$.fragment,$),te(S.$$.fragment,$),T=!0)},o:function($){ee(C.$$.fragment,$),ee(S.$$.fragment,$),T=!1},d:function($){$&&c(e),re(C),re(S)}};return F("SvelteRegisterBlock",{block:X,id:Le.name,type:"slot",source:"(122:0) <PageLayout showBackButton={true}>",ctx:i}),X}function qe(i){let e,t,l;t=new Me({props:{showBackButton:!0,$$slots:{default:[Le]},$$scope:{ctx:i}},$$inline:!0});const o={c:function(){e=R(),ue(t.$$.fragment),this.h()},l:function(s){Ke("svelte-8st1fo",document.head).forEach(c),e=M(s),ce(t.$$.fragment,s),this.h()},h:function(){document.title="マイクテスト - 相対音感トレーニング"},m:function(s,f){z(s,e,f),ae(t,s,f),l=!0},p:function(s,[f]){const _={};f&16511&&(_.$$scope={dirty:f,ctx:s}),t.$set(_)},i:function(s){l||(te(t.$$.fragment,s),l=!0)},o:function(s){ee(t.$$.fragment,s),l=!1},d:function(s){s&&c(e),re(t,s)}};return F("SvelteRegisterBlock",{block:o,id:qe.name,type:"component",source:"",ctx:i}),o}function Se(i){if(i<=0)return"C4（ド4）";const t=Math.round(12*Math.log2(i/440)),l=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],o=((t+9)%12+12)%12,n=Math.floor((t+9)/12)+4,s=l[o];return`${s}${n}（${{C:"ド","C#":"ド#",D:"レ","D#":"レ#",E:"ミ",F:"ファ","F#":"ファ#",G:"ソ","G#":"ソ#",A:"ラ","A#":"ラ#",B:"シ"}[s]}${n}）`}function Xe(i,e,t){let l,o;Je(ge,"page"),Oe(i,ge,u=>t(10,o=u));let{$$slots:n={},$$scope:s}=e;Ze("Page",n,[]);let f="random";_e(()=>{o.url.searchParams.has("mode")&&(f=o.url.searchParams.get("mode")||"random")});let _="pending",w=!1,h=!1,m=0,k=0,A="",I=!1;const E={random:{name:"ランダム基音モード",description:"10種類の基音からランダムに選択してトレーニング",color:"green",path:"./training/random"},continuous:{name:"連続チャレンジモード",description:"選択した回数だけ連続で実行し、総合評価を確認",color:"orange",path:"./training/continuous"},chromatic:{name:"12音階モード",description:"クロマチックスケールの上行・下行で完全制覇",color:"purple",path:"./training/chromatic"}},H=E[f]||E.random;function q(){t(0,_="pending"),setTimeout(()=>{t(0,_="granted"),y()},1e3)}function y(){if(_!=="granted")return;I=!0;const u=setInterval(()=>{if(!I){clearInterval(u);return}t(3,m=Math.random()*100),m>20&&t(1,w=!0);const B=[130.81,146.83,164.81,174.61,196,220,246.94,261.63,293.66,329.63];t(4,k=B[Math.floor(Math.random()*B.length)]),t(5,A=Se(k)),k>0&&t(2,h=!0)},200)}_e(()=>{setTimeout(()=>{q()},500)});const C=[];return Object.keys(e).forEach(u=>{!~C.indexOf(u)&&u.slice(0,2)!=="$$"&&u!=="slot"&&console.warn(`<Page> was created with unknown prop '${u}'`)}),i.$capture_state=()=>({onMount:_e,page:ge,Card:ye,Button:Ce,PageLayout:Me,mode:f,micPermission:_,volumeDetected:w,frequencyDetected:h,currentVolume:m,currentFrequency:k,currentNote:A,isListening:I,trainingModes:E,selectedMode:H,frequencyToNote:Se,requestMicrophone:q,startListening:y,startButtonEnabled:l,$page:o}),i.$inject_state=u=>{"mode"in u&&(f=u.mode),"micPermission"in u&&t(0,_=u.micPermission),"volumeDetected"in u&&t(1,w=u.volumeDetected),"frequencyDetected"in u&&t(2,h=u.frequencyDetected),"currentVolume"in u&&t(3,m=u.currentVolume),"currentFrequency"in u&&t(4,k=u.currentFrequency),"currentNote"in u&&t(5,A=u.currentNote),"isListening"in u&&(I=u.isListening),"startButtonEnabled"in u&&t(6,l=u.startButtonEnabled)},e&&"$$inject"in e&&i.$inject_state(e.$$inject),i.$$.update=()=>{i.$$.dirty&7&&t(6,l=_==="granted"&&w&&h)},[_,w,h,m,k,A,l,H]}class st extends Ge{constructor(e){super(e),We(this,e,Xe,qe,Te,{}),F("SvelteRegisterComponent",{component:this,tagName:"Page",options:e,id:qe.name})}}export{st as component};
