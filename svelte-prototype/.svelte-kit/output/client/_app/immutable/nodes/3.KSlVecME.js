import{S as $t,i as te,d as M,s as ee,v as ne,c as ie,a as oe,D as Vt,E as Pt,b as r,q as mt,r as vt,u as ht,f as w,w as _t,F as se,m as F,x as yt,p as A,y as pt,g as v,z as d,h as _,j as p,k as C,B as it,A as z,o as b,C as ot,G as It,e as ft,l as U,t as J,n as at,H as Ft,I as kt}from"../chunks/Dujr-1LT.js";import"../chunks/B_rl9Jj9.js";import{p as dt}from"../chunks/DOKgOMem.js";import{P as Rt,B as le,C as bt}from"../chunks/BlOhcc-l.js";const y="src/routes/microphone-test/+page.svelte";function Nt(c){let t,n="マイク準備完了",i,e,l="トレーニング開始ボタンを押してランダム基音モードへ進んでください",a,s,o,h="トレーニング開始",m,u;const k={c:function(){t=b("h3"),t.textContent=n,i=A(),e=b("p"),e.textContent=l,a=A(),s=b("div"),o=b("button"),o.textContent=h,this.h()},l:function(x){t=p(x,"H3",{class:!0,"data-svelte-h":!0}),z(t)!=="svelte-11dam81"&&(t.textContent=n),i=F(x),e=p(x,"P",{class:!0,"data-svelte-h":!0}),z(e)!=="svelte-5idwhi"&&(e.textContent=l),a=F(x),s=p(x,"DIV",{class:!0});var g=C(s);o=p(g,"BUTTON",{class:!0,"data-svelte-h":!0}),z(o)!=="svelte-1oiqs6i"&&(o.textContent=h),g.forEach(r),this.h()},h:function(){d(t,"class","ready-title svelte-1byxpqw"),_(t,y,280,12,8294),d(e,"class","ready-description svelte-1byxpqw"),_(e,y,281,12,8343),d(o,"class","training-start-button enabled svelte-1byxpqw"),_(o,y,284,14,8489),d(s,"class","training-start-button-area svelte-1byxpqw"),_(s,y,283,12,8434)},m:function(x,g){w(x,t,g),w(x,i,g),w(x,e,g),w(x,a,g),w(x,s,g),v(s,o),m||(u=kt(o,"click",c[10],!1),m=!0)},p:at,d:function(x){x&&(r(t),r(i),r(e),r(a),r(s)),m=!1,u()}};return M("SvelteRegisterBlock",{block:k,id:Nt.name,type:"else",source:"(279:10) {:else}",ctx:c}),k}function Lt(c){let t,n;function i(m,u){return m[3]==="granted"&&m[4]&&(!m[0]||!m[1])?zt:Tt}let e=i(c),l=e(c);function a(m,u){if(m[3]==="pending")return Gt;if(m[3]==="denied")return jt;if(m[3]==="initial")return Ht}let s=a(c),o=s&&s(c);const h={c:function(){l.c(),t=A(),o&&o.c(),n=Ft()},l:function(u){l.l(u),t=F(u),o&&o.l(u),n=Ft()},m:function(u,k){l.m(u,k),w(u,t,k),o&&o.m(u,k),w(u,n,k)},p:function(u,k){e!==(e=i(u))&&(l.d(1),l=e(u),l&&(l.c(),l.m(t.parentNode,t))),s===(s=a(u))&&o?o.p(u,k):(o&&o.d(1),o=s&&s(u),o&&(o.c(),o.m(n.parentNode,n)))},d:function(u){u&&(r(t),r(n)),l.d(u),o&&o.d(u)}};return M("SvelteRegisterBlock",{block:h,id:Lt.name,type:"if",source:"(249:10) {#if !audioConfirmationComplete}",ctx:c}),h}function Tt(c){let t,n="マイクのテストを開始します",i,e,l="マイクテスト開始ボタンを押してマイクの使用を許可してください";const a={c:function(){t=b("h3"),t.textContent=n,i=A(),e=b("p"),e.textContent=l,this.h()},l:function(o){t=p(o,"H3",{class:!0,"data-svelte-h":!0}),z(t)!=="svelte-gfi16f"&&(t.textContent=n),i=F(o),e=p(o,"P",{class:!0,"data-svelte-h":!0}),z(e)!=="svelte-1w19y1h"&&(e.textContent=l),this.h()},h:function(){d(t,"class","instructions-title svelte-1byxpqw"),_(t,y,259,14,7431),d(e,"class","instructions-description svelte-1byxpqw"),_(e,y,260,14,7495)},m:function(o,h){w(o,t,h),w(o,i,h),w(o,e,h)},d:function(o){o&&(r(t),r(i),r(e))}};return M("SvelteRegisterBlock",{block:a,id:Tt.name,type:"else",source:"(258:12) {:else}",ctx:c}),a}function zt(c){let t,n="「ドー」と発声してください",i,e,l="マイク準備完了",a,s,o="トレーニング開始ボタンを押してランダム基音モードへ進んでください";const h={c:function(){t=b("p"),t.textContent=n,i=A(),e=b("h3"),e.textContent=l,a=A(),s=b("p"),s.textContent=o,this.h()},l:function(u){t=p(u,"P",{class:!0,"data-svelte-h":!0}),z(t)!=="svelte-15d2sx7"&&(t.textContent=n),i=F(u),e=p(u,"H3",{class:!0,"data-svelte-h":!0}),z(e)!=="svelte-11dam81"&&(e.textContent=l),a=F(u),s=p(u,"P",{class:!0,"data-svelte-h":!0}),z(s)!=="svelte-5idwhi"&&(s.textContent=o),this.h()},h:function(){d(t,"class","status-text voice-instruction svelte-1byxpqw"),_(t,y,252,14,7122),d(e,"class","ready-title svelte-1byxpqw"),_(e,y,255,14,7245),d(s,"class","ready-description svelte-1byxpqw"),_(s,y,256,14,7296)},m:function(u,k){w(u,t,k),w(u,i,k),w(u,e,k),w(u,a,k),w(u,s,k)},d:function(u){u&&(r(t),r(i),r(e),r(a),r(s))}};return M("SvelteRegisterBlock",{block:h,id:zt.name,type:"if",source:"(251:12) {#if micPermission === 'granted' && isListening && (!volumeDetected || !frequencyDetected)}",ctx:c}),h}function Ht(c){let t,n,i="マイクテストを開始",e,l;const a={c:function(){t=b("div"),n=b("button"),n.textContent=i,this.h()},l:function(o){t=p(o,"DIV",{class:!0});var h=C(t);n=p(h,"BUTTON",{class:!0,"data-svelte-h":!0}),z(n)!=="svelte-caex95"&&(n.textContent=i),h.forEach(r),this.h()},h:function(){d(n,"class","mic-test-button start svelte-1byxpqw"),_(n,y,273,16,8068),d(t,"class","mic-test-button-area svelte-1byxpqw"),_(t,y,272,14,8017)},m:function(o,h){w(o,t,h),v(t,n),e||(l=kt(n,"click",c[9],!1),e=!0)},p:at,d:function(o){o&&r(t),e=!1,l()}};return M("SvelteRegisterBlock",{block:a,id:Ht.name,type:"if",source:"(272:50) ",ctx:c}),a}function jt(c){let t,n,i="マイク許可を再試行",e,l;const a={c:function(){t=b("div"),n=b("button"),n.textContent=i,this.h()},l:function(o){t=p(o,"DIV",{class:!0});var h=C(t);n=p(h,"BUTTON",{class:!0,"data-svelte-h":!0}),z(n)!=="svelte-1p3n8nt"&&(n.textContent=i),h.forEach(r),this.h()},h:function(){d(n,"class","mic-test-button retry svelte-1byxpqw"),_(n,y,267,16,7809),d(t,"class","mic-test-button-area svelte-1byxpqw"),_(t,y,266,14,7758)},m:function(o,h){w(o,t,h),v(t,n),e||(l=kt(n,"click",c[9],!1),e=!0)},p:at,d:function(o){o&&r(t),e=!1,l()}};return M("SvelteRegisterBlock",{block:a,id:jt.name,type:"if",source:"(266:49) ",ctx:c}),a}function Gt(c){let t,n="マイク準備中...";const i={c:function(){t=b("p"),t.textContent=n,this.h()},l:function(l){t=p(l,"P",{class:!0,"data-svelte-h":!0}),z(t)!=="svelte-1vb5g92"&&(t.textContent=n),this.h()},h:function(){d(t,"class","status-text svelte-1byxpqw"),_(t,y,264,14,7657)},m:function(l,a){w(l,t,a)},p:at,d:function(l){l&&r(t)}};return M("SvelteRegisterBlock",{block:i,id:Gt.name,type:"if",source:"(264:12) {#if micPermission === 'pending'}",ctx:c}),i}function Ot(c){let t;function n(a,s){return a[2]?Nt:Lt}let i=n(c),e=i(c);const l={c:function(){t=b("div"),e.c(),this.h()},l:function(s){t=p(s,"DIV",{class:!0});var o=C(t);e.l(o),o.forEach(r),this.h()},h:function(){d(t,"class","training-mode-content svelte-1byxpqw"),_(t,y,247,8,6857)},m:function(s,o){w(s,t,o),e.m(t,null)},p:function(s,o){i===(i=n(s))&&e?e.p(s,o):(e.d(1),e=i(s),e&&(e.c(),e.m(t,null)))},d:function(s){s&&r(t),e.d()}};return M("SvelteRegisterBlock",{block:l,id:Ot.name,type:"slot",source:'(247:6) <Card variant=\\"default\\" padding=\\"lg\\">',ctx:c}),l}function Ut(c){let t;const n={c:function(){t=J(" ")},l:function(e){t=U(e," ")},m:function(e,l){w(e,t,l)},d:function(e){e&&r(t)}};return M("SvelteRegisterBlock",{block:n,id:Ut.name,type:"else",source:"(315:18) {:else}",ctx:c}),n}function Jt(c){let t;const n={c:function(){t=J("マイクテスト開始後に表示されます")},l:function(e){t=U(e,"マイクテスト開始後に表示されます")},m:function(e,l){w(e,t,l)},d:function(e){e&&r(t)}};return M("SvelteRegisterBlock",{block:n,id:Jt.name,type:"if",source:"(313:41) ",ctx:c}),n}function Zt(c){let t;const n={c:function(){t=J("⏳ 声を出して音量を確認してください")},l:function(e){t=U(e,"⏳ 声を出して音量を確認してください")},m:function(e,l){w(e,t,l)},d:function(e){e&&r(t)}};return M("SvelteRegisterBlock",{block:n,id:Zt.name,type:"if",source:"(311:18) {#if !volumeDetected && isListening}",ctx:c}),n}function Kt(c){let t;const n={c:function(){t=J(" ")},l:function(e){t=U(e," ")},m:function(e,l){w(e,t,l)},d:function(e){e&&r(t)}};return M("SvelteRegisterBlock",{block:n,id:Kt.name,type:"else",source:"(335:18) {:else}",ctx:c}),n}function Qt(c){let t;const n={c:function(){t=J("マイクテスト開始後に表示されます")},l:function(e){t=U(e,"マイクテスト開始後に表示されます")},m:function(e,l){w(e,t,l)},d:function(e){e&&r(t)}};return M("SvelteRegisterBlock",{block:n,id:Qt.name,type:"if",source:"(333:41) ",ctx:c}),n}function Wt(c){let t;const n={c:function(){t=J("⏳ 「ド」を発声して音程を確認してください")},l:function(e){t=U(e,"⏳ 「ド」を発声して音程を確認してください")},m:function(e,l){w(e,t,l)},d:function(e){e&&r(t)}};return M("SvelteRegisterBlock",{block:n,id:Wt.name,type:"if",source:"(331:18) {#if !frequencyDetected && isListening}",ctx:c}),n}function Xt(c){let t,n,i,e,l="音量レベル",a,s,o,h,m,u=c[5].toFixed(1)+"",k,R,x,g,V,E,q,S,Z="音程検出",H,B,N,K=c[6].toFixed(1)+"",j,f,D,L,G,Q,P,I;function nt(O,T){return!O[0]&&O[4]?Zt:O[4]?Ut:Jt}let tt=nt(c),W=tt(c);function Ct(O,T){return!O[1]&&O[4]?Wt:O[4]?Kt:Qt}let st=Ct(c),X=st(c);const wt={c:function(){t=b("div"),n=b("div"),i=b("div"),e=b("h3"),e.textContent=l,a=A(),s=b("div"),o=b("div"),h=A(),m=b("div"),k=J(u),R=J("%"),x=A(),g=b("div"),V=b("span"),W.c(),E=A(),q=b("div"),S=b("h3"),S.textContent=Z,H=A(),B=b("div"),N=b("div"),j=J(K),f=J(" Hz"),D=A(),L=b("div"),G=J(c[7]),Q=A(),P=b("div"),I=b("span"),X.c(),this.h()},l:function(T){t=p(T,"DIV",{class:!0});var Y=C(t);n=p(Y,"DIV",{class:!0});var lt=C(n);i=p(lt,"DIV",{class:!0});var $=C(i);e=p($,"H3",{class:!0,"data-svelte-h":!0}),z(e)!=="svelte-1nc8gri"&&(e.textContent=l),a=F($),s=p($,"DIV",{class:!0});var xt=C(s);o=p(xt,"DIV",{class:!0,style:!0}),C(o).forEach(r),xt.forEach(r),h=F($),m=p($,"DIV",{class:!0});var rt=C(m);k=U(rt,u),R=U(rt,"%"),rt.forEach(r),x=F($),g=p($,"DIV",{class:!0});var qt=C(g);V=p(qt,"SPAN",{class:!0});var Dt=C(V);W.l(Dt),Dt.forEach(r),qt.forEach(r),$.forEach(r),E=F(lt),q=p(lt,"DIV",{class:!0});var et=C(q);S=p(et,"H3",{class:!0,"data-svelte-h":!0}),z(S)!=="svelte-1ofzoy2"&&(S.textContent=Z),H=F(et),B=p(et,"DIV",{class:!0});var ct=C(B);N=p(ct,"DIV",{class:!0});var ut=C(N);j=U(ut,K),f=U(ut," Hz"),ut.forEach(r),D=F(ct),L=p(ct,"DIV",{class:!0});var Et=C(L);G=U(Et,c[7]),Et.forEach(r),ct.forEach(r),Q=F(et),P=p(et,"DIV",{class:!0});var Bt=C(P);I=p(Bt,"SPAN",{class:!0});var St=C(I);X.l(St),St.forEach(r),Bt.forEach(r),et.forEach(r),lt.forEach(r),Y.forEach(r),this.h()},h:function(){d(e,"class","display-title svelte-1byxpqw"),_(e,y,303,14,9027),d(o,"class","volume-bar svelte-1byxpqw"),It(o,"width",c[5]+"%"),_(o,y,305,16,9129),d(s,"class","volume-bar-container svelte-1byxpqw"),_(s,y,304,14,9078),d(m,"class","volume-text svelte-1byxpqw"),_(m,y,307,14,9227),d(V,"class","status-pending svelte-1byxpqw"),_(V,y,309,16,9344),d(g,"class","volume-status svelte-1byxpqw"),_(g,y,308,14,9300),d(i,"class","volume-section svelte-1byxpqw"),_(i,y,302,12,8984),d(S,"class","display-title svelte-1byxpqw"),_(S,y,323,14,9777),d(N,"class","frequency-value svelte-1byxpqw"),_(N,y,325,16,9875),d(L,"class","note-value svelte-1byxpqw"),_(L,y,326,16,9959),d(B,"class","frequency-display svelte-1byxpqw"),_(B,y,324,14,9827),d(I,"class","status-pending svelte-1byxpqw"),_(I,y,329,16,10085),d(P,"class","frequency-status svelte-1byxpqw"),_(P,y,328,14,10038),d(q,"class","frequency-section"),_(q,y,322,12,9731),d(n,"class","realtime-display svelte-1byxpqw"),_(n,y,300,10,8914),d(t,"class","mic-test-content svelte-1byxpqw"),_(t,y,296,8,8827)},m:function(T,Y){w(T,t,Y),v(t,n),v(n,i),v(i,e),v(i,a),v(i,s),v(s,o),v(i,h),v(i,m),v(m,k),v(m,R),v(i,x),v(i,g),v(g,V),W.m(V,null),v(n,E),v(n,q),v(q,S),v(q,H),v(q,B),v(B,N),v(N,j),v(N,f),v(B,D),v(B,L),v(L,G),v(q,Q),v(q,P),v(P,I),X.m(I,null)},p:function(T,Y){Y&32&&It(o,"width",T[5]+"%"),Y&32&&u!==(u=T[5].toFixed(1)+"")&&ft(k,u),tt!==(tt=nt(T))&&(W.d(1),W=tt(T),W&&(W.c(),W.m(V,null))),Y&64&&K!==(K=T[6].toFixed(1)+"")&&ft(j,K),Y&128&&ft(G,T[7]),st!==(st=Ct(T))&&(X.d(1),X=st(T),X&&(X.c(),X.m(I,null)))},d:function(T){T&&r(t),W.d(),X.d()}};return M("SvelteRegisterBlock",{block:wt,id:Xt.name,type:"slot",source:'(296:6) <Card variant=\\"default\\" padding=\\"lg\\">',ctx:c}),wt}function Yt(c){let t,n,i,e,l,a,s,o,h,m,u,k,R="マイクテスト",x,g,V="音感トレーニングを始める前に、マイクの動作を確認します",E,q,S,Z,H,B,N;S=new bt({props:{variant:"default",padding:"lg",$$slots:{default:[Ot]},$$scope:{ctx:c}},$$inline:!0}),B=new bt({props:{variant:"default",padding:"lg",$$slots:{default:[Xt]},$$scope:{ctx:c}},$$inline:!0});const K={c:function(){t=b("div"),n=b("div"),i=b("div"),e=b("div"),l=ot("svg"),a=ot("path"),s=ot("path"),o=ot("line"),h=ot("line"),m=A(),u=b("div"),k=b("h1"),k.textContent=R,x=A(),g=b("p"),g.textContent=V,E=A(),q=b("div"),pt(S.$$.fragment),Z=A(),H=b("div"),pt(B.$$.fragment),this.h()},l:function(f){t=p(f,"DIV",{class:!0});var D=C(t);n=p(D,"DIV",{class:!0});var L=C(n);i=p(L,"DIV",{class:!0});var G=C(i);e=p(G,"DIV",{class:!0});var Q=C(e);l=it(Q,"svg",{width:!0,height:!0,viewBox:!0,fill:!0,stroke:!0,"stroke-width":!0});var P=C(l);a=it(P,"path",{d:!0}),C(a).forEach(r),s=it(P,"path",{d:!0}),C(s).forEach(r),o=it(P,"line",{x1:!0,x2:!0,y1:!0,y2:!0}),C(o).forEach(r),h=it(P,"line",{x1:!0,x2:!0,y1:!0,y2:!0}),C(h).forEach(r),P.forEach(r),Q.forEach(r),m=F(G),u=p(G,"DIV",{});var I=C(u);k=p(I,"H1",{class:!0,"data-svelte-h":!0}),z(k)!=="svelte-z7m4lk"&&(k.textContent=R),x=F(I),g=p(I,"P",{class:!0,"data-svelte-h":!0}),z(g)!=="svelte-1vtv92f"&&(g.textContent=V),I.forEach(r),G.forEach(r),L.forEach(r),E=F(D),q=p(D,"DIV",{class:!0});var nt=C(q);yt(S.$$.fragment,nt),nt.forEach(r),Z=F(D),H=p(D,"DIV",{class:!0});var tt=C(H);yt(B.$$.fragment,tt),tt.forEach(r),D.forEach(r),this.h()},h:function(){d(a,"d","M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z"),_(a,y,231,12,6315),d(s,"d","M19 10v2a7 7 0 0 1-14 0v-2"),_(s,y,232,12,6392),d(o,"x1","12"),d(o,"x2","12"),d(o,"y1","19"),d(o,"y2","22"),_(o,y,233,12,6443),d(h,"x1","8"),d(h,"x2","16"),d(h,"y1","22"),d(h,"y2","22"),_(h,y,234,12,6495),d(l,"width","48"),d(l,"height","48"),d(l,"viewBox","0 0 24 24"),d(l,"fill","none"),d(l,"stroke","currentColor"),d(l,"stroke-width","2"),_(l,y,230,10,6203),d(e,"class","mic-icon svelte-1byxpqw"),_(e,y,229,8,6170),d(k,"class","mic-test-title svelte-1byxpqw"),_(k,y,238,10,6590),d(g,"class","mic-test-description svelte-1byxpqw"),_(g,y,239,10,6639),_(u,y,237,8,6574),d(i,"class","mic-test-header svelte-1byxpqw"),_(i,y,228,6,6132),d(n,"class","header svelte-1byxpqw"),_(n,y,227,4,6105),d(q,"class","training-mode-info svelte-1byxpqw"),_(q,y,245,4,6772),d(H,"class","test-section"),_(H,y,294,4,8748),d(t,"class","microphone-test svelte-1byxpqw"),_(t,y,225,2,6053)},m:function(f,D){w(f,t,D),v(t,n),v(n,i),v(i,e),v(e,l),v(l,a),v(l,s),v(l,o),v(l,h),v(i,m),v(i,u),v(u,k),v(u,x),v(u,g),v(t,E),v(t,q),_t(S,q,null),v(t,Z),v(t,H),_t(B,H,null),N=!0},p:function(f,D){const L={};D&1048607&&(L.$$scope={dirty:D,ctx:f}),S.$set(L);const G={};D&1048819&&(G.$$scope={dirty:D,ctx:f}),B.$set(G)},i:function(f){N||(ht(S.$$.fragment,f),ht(B.$$.fragment,f),N=!0)},o:function(f){vt(S.$$.fragment,f),vt(B.$$.fragment,f),N=!1},d:function(f){f&&r(t),mt(S),mt(B)}};return M("SvelteRegisterBlock",{block:K,id:Yt.name,type:"slot",source:"(225:0) <PageLayout showBackButton={true}>",ctx:c}),K}function gt(c){let t,n,i;n=new Rt({props:{showBackButton:!0,$$slots:{default:[Yt]},$$scope:{ctx:c}},$$inline:!0});const e={c:function(){t=A(),pt(n.$$.fragment),this.h()},l:function(a){se("svelte-8st1fo",document.head).forEach(r),t=F(a),yt(n.$$.fragment,a),this.h()},h:function(){document.title="マイクテスト - 相対音感トレーニング"},m:function(a,s){w(a,t,s),_t(n,a,s),i=!0},p:function(a,[s]){const o={};s&1048831&&(o.$$scope={dirty:s,ctx:a}),n.$set(o)},i:function(a){i||(ht(n.$$.fragment,a),i=!0)},o:function(a){vt(n.$$.fragment,a),i=!1},d:function(a){a&&r(t),mt(n,a)}};return M("SvelteRegisterBlock",{block:e,id:gt.name,type:"component",source:"",ctx:c}),e}function At(c,t){let n=0;for(let s=0;s<c.length;s++)n+=c[s]*c[s];if(n=Math.sqrt(n/c.length),n<.005)return 0;const i=Math.floor(t/800),e=Math.floor(t/80);let l=0,a=0;for(let s=i;s<=e;s++){let o=0,h=0;for(let m=0;m<c.length-s;m++)o+=c[m]*c[m+s],h+=c[m]*c[m];h>0&&(o=o/Math.sqrt(h),o>l&&(l=o,a=s))}return l>.25?t/a:0}function Mt(c){const n=Math.round(12*Math.log2(c/440)),i=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],e=((n+9)%12+12)%12,l=Math.floor((n+9)/12)+4,a=i[e];return`${a}${l}（${{C:"ド","C#":"ド#",D:"レ","D#":"レ#",E:"ミ",F:"ファ","F#":"ファ#",G:"ソ","G#":"ソ#",A:"ラ","A#":"ラ#",B:"シ"}[a]}${l}）`}function ce(c,t,n){let i;ne(dt,"page"),ie(c,dt,f=>n(16,i=f));let{$$slots:e={},$$scope:l}=t;oe("Page",e,[]);let a="random";Vt(()=>{i.url.searchParams.has("mode")&&(a=i.url.searchParams.get("mode")||"random")});let s="initial",o=!1,h=!1,m=!1,u=!1,k=0,R=0,x="",g=null,V=null,E=null,q=null;const S={random:{name:"ランダム基音モード",description:"10種類の基音からランダムに選択してトレーニング",color:"green",path:"./training/random"},continuous:{name:"連続チャレンジモード",description:"選択した回数だけ連続で実行し、総合評価を確認",color:"orange",path:"./training/continuous"},chromatic:{name:"12音階モード",description:"クロマチックスケールの上行・下行で完全制覇",color:"purple",path:"./training/chromatic"}},Z=S[a]||S.random;async function H(){n(3,s="pending");try{V=await navigator.mediaDevices.getUserMedia({audio:!0}),n(3,s="granted"),g=new(window.AudioContext||window.webkitAudioContext),g.state==="suspended"&&await g.resume(),E=g.createAnalyser(),E.fftSize=2048,E.smoothingTimeConstant=.8,E.minDecibels=-90,E.maxDecibels=-10,g.createMediaStreamSource(V).connect(E),n(4,o=!0),B()}catch{n(3,s="denied")}}function B(){if(!o||!E)return;const f=E.frequencyBinCount,D=new Uint8Array(f);E.getByteFrequencyData(D);let L=0;for(let I=0;I<D.length;I++)L+=D[I]*D[I];const G=Math.sqrt(L/D.length);n(5,k=Math.min(100,G/64*100)),k>15&&n(0,h=!0);const Q=new Float32Array(E.fftSize);E.getFloatTimeDomainData(Q);const P=At(Q,g.sampleRate);P>80&&P<800?(n(6,R=P),n(7,x=Mt(P)),n(1,m=!0)):(n(6,R=0),n(7,x="")),q=requestAnimationFrame(B)}function N(){n(4,o=!1),q&&(cancelAnimationFrame(q),q=null),V&&(V.getTracks().forEach(f=>f.stop()),V=null),g&&g.state!=="closed"&&(g.close(),g=null),E=null}Pt(()=>{N()});const K=[];Object.keys(t).forEach(f=>{!~K.indexOf(f)&&f.slice(0,2)!=="$$"&&f!=="slot"&&console.warn(`<Page> was created with unknown prop '${f}'`)});const j=()=>window.location.href=Z.path;return c.$capture_state=()=>({onMount:Vt,onDestroy:Pt,page:dt,Card:bt,Button:le,PageLayout:Rt,mode:a,micPermission:s,isListening:o,volumeDetected:h,frequencyDetected:m,audioConfirmationComplete:u,currentVolume:k,currentFrequency:R,currentNote:x,audioContext:g,mediaStream:V,analyser:E,animationFrame:q,trainingModes:S,selectedMode:Z,requestMicrophone:H,analyzeAudio:B,detectPitch:At,frequencyToNote:Mt,stopListening:N,$page:i}),c.$inject_state=f=>{"mode"in f&&(a=f.mode),"micPermission"in f&&n(3,s=f.micPermission),"isListening"in f&&n(4,o=f.isListening),"volumeDetected"in f&&n(0,h=f.volumeDetected),"frequencyDetected"in f&&n(1,m=f.frequencyDetected),"audioConfirmationComplete"in f&&n(2,u=f.audioConfirmationComplete),"currentVolume"in f&&n(5,k=f.currentVolume),"currentFrequency"in f&&n(6,R=f.currentFrequency),"currentNote"in f&&n(7,x=f.currentNote),"audioContext"in f&&(g=f.audioContext),"mediaStream"in f&&(V=f.mediaStream),"analyser"in f&&(E=f.analyser),"animationFrame"in f&&(q=f.animationFrame)},t&&"$$inject"in t&&c.$inject_state(t.$$inject),c.$$.update=()=>{c.$$.dirty&7&&h&&m&&!u&&n(2,u=!0)},[h,m,u,s,o,k,R,x,Z,H,j]}class de extends $t{constructor(t){super(t),te(this,t,ce,gt,ee,{}),M("SvelteRegisterComponent",{component:this,tagName:"Page",options:t,id:gt.name})}}export{de as component};
