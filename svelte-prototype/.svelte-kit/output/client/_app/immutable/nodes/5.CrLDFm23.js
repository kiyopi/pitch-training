const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["../chunks/C56X5YjC.js","../chunks/DXfV3yLF.js","../chunks/BnpKoSs-.js","../chunks/D0QH3NT1.js","../chunks/DKsDfBP_.js","../assets/sessionStorage.2zs4CtXT.css"])))=>i.map(i=>d[i]);
import{_ as Fn}from"../chunks/C1FmrZbK.js";import{S as Do,i as qo,d as ee,s as wo,v as Ne,c as Ie,a as Co,H as Rn,V as Mn,b as h,q as ue,r as X,u as U,f as O,w as fe,I as ko,m as Z,x as de,p as $,y as me,J as Fo,K as Ae,L as Te,g,z as P,h as R,M as Qe,j as M,k as z,A as pe,l as W,N as Le,o as N,t as J,e as De,Q as lt,n as Et,R as zn}from"../chunks/DXfV3yLF.js";import{g as Ro}from"../chunks/D0QH3NT1.js";import"../chunks/BnpKoSs-.js";import{b as it,g as vt}from"../chunks/DKsDfBP_.js";import{p as _t}from"../chunks/DE-oDtoq.js";import{P as Ln,B as ut,C as Je}from"../chunks/CrwomGmF.js";import{l as ce,a as We,h as St,P as jn,b as On,V as Mo}from"../chunks/BRZWrjh2.js";import{l as bt,s as tt,c as No,r as Io,a as Nn,u as Dt,b as Ao,d as qt,p as To,o as Eo,e as Po,f as wt,i as Ct,g as Bo,h as kt,n as Ft,j as Rt,k as Mt,t as Nt,E as In,m as nt,A as Xt,U as Yt,S as xo,F as Ho,C as Vo,I as zo,q as Lo,T as jo,P as Oo,M as Gn,v as Go,w as Uo,x as It}from"../chunks/C56X5YjC.js";const Wo=!1,Jo=!1,cs=Object.freeze(Object.defineProperty({__proto__:null,prerender:Jo,ssr:Wo},Symbol.toStringTag,{value:"Module"})),{Object:Ko,console:Qo,document:An}=Ro,I="src/routes/training/continuous/+page.svelte";function Tn(r,t,e){const i=r.slice();return i[99]=t[e],i[101]=e,i}function En(r,t,e){const i=r.slice();return i[102]=t[e],i}function Pt(r){var x,F;let t,e,i,s,n,c,a,u,f,d,m=(((x=r[24])==null?void 0:x.length)||0)+"",v,D,p,y,_,L,k,w,j=Math.round((((F=r[24])==null?void 0:F.length)||0)/8*100)+"",B,Q,A,b,K,T=r[0]==="results"&&r[5]&&Bt(r);const q={c:function(){t=N("div"),e=N("div"),i=N("div"),s=N("span"),n=J("„Çª„ÉÉ„Ç∑„Éß„É≥ "),c=J(r[23]),a=J("/8"),u=$(),f=N("span"),d=J("ÂÆå‰∫ÜÊ∏à„Åø "),v=J(m),D=J("„Çª„ÉÉ„Ç∑„Éß„É≥"),p=$(),y=N("div"),_=N("div"),L=N("div"),k=$(),w=N("span"),B=J(j),Q=J("%"),A=$(),T&&T.c(),b=Le(),this.h()},l:function(E){t=M(E,"DIV",{class:!0});var Y=z(t);e=M(Y,"DIV",{class:!0});var ye=z(e);i=M(ye,"DIV",{class:!0});var se=z(i);s=M(se,"SPAN",{class:!0});var _e=z(s);n=W(_e,"„Çª„ÉÉ„Ç∑„Éß„É≥ "),c=W(_e,r[23]),a=W(_e,"/8"),_e.forEach(h),u=Z(se),f=M(se,"SPAN",{class:!0});var Se=z(f);d=W(Se,"ÂÆå‰∫ÜÊ∏à„Åø "),v=W(Se,m),D=W(Se,"„Çª„ÉÉ„Ç∑„Éß„É≥"),Se.forEach(h),se.forEach(h),p=Z(ye),y=M(ye,"DIV",{class:!0});var Ee=z(y);_=M(Ee,"DIV",{class:!0});var je=z(_);L=M(je,"DIV",{class:!0,style:!0}),z(L).forEach(h),je.forEach(h),k=Z(Ee),w=M(Ee,"SPAN",{class:!0});var He=z(w);B=W(He,j),Q=W(He,"%"),He.forEach(h),Ee.forEach(h),ye.forEach(h),Y.forEach(h),A=Z(E),T&&T.l(E),b=Le(),this.h()},h:function(){var E;P(s,"class","completed-count svelte-rt5px1"),R(s,I,2659,12,90393),P(f,"class","remaining-text svelte-rt5px1"),R(f,I,2660,12,90470),P(i,"class","session-info svelte-rt5px1"),R(i,I,2658,10,90354),P(L,"class","progress-fill svelte-rt5px1"),Qe(L,"width",(((E=r[24])==null?void 0:E.length)||0)/8*100+"%"),R(L,I,2664,14,90658),P(_,"class","progress-bar svelte-rt5px1"),R(_,I,2663,12,90617),P(w,"class","progress-text svelte-rt5px1"),R(w,I,2666,12,90784),P(y,"class","progress-section svelte-rt5px1"),R(y,I,2662,10,90574),P(e,"class","session-status svelte-rt5px1"),R(e,I,2657,8,90315),P(t,"class","session-progress svelte-rt5px1"),R(t,I,2656,6,90276)},m:function(E,Y){O(E,t,Y),g(t,e),g(e,i),g(i,s),g(s,n),g(s,c),g(s,a),g(i,u),g(i,f),g(f,d),g(f,v),g(f,D),g(e,p),g(e,y),g(y,_),g(_,L),g(y,k),g(y,w),g(w,B),g(w,Q),O(E,A,Y),T&&T.m(E,Y),O(E,b,Y),K=!0},p:function(E,Y){var ye,se,_e;(!K||Y[0]&8388608)&&De(c,E[23]),(!K||Y[0]&16777216)&&m!==(m=(((ye=E[24])==null?void 0:ye.length)||0)+"")&&De(v,m),(!K||Y[0]&16777216)&&Qe(L,"width",(((se=E[24])==null?void 0:se.length)||0)/8*100+"%"),(!K||Y[0]&16777216)&&j!==(j=Math.round((((_e=E[24])==null?void 0:_e.length)||0)/8*100)+"")&&De(B,j),E[0]==="results"&&E[5]?T?(T.p(E,Y),Y[0]&33&&U(T,1)):(T=Bt(E),T.c(),U(T,1),T.m(b.parentNode,b)):T&&(Ae(),X(T,1,1,()=>{T=null}),Te())},i:function(E){K||(U(T),K=!0)},o:function(E){X(T),K=!1},d:function(E){E&&(h(t),h(A),h(b)),T&&T.d(E)}};return ee("SvelteRegisterBlock",{block:q,id:Pt.name,type:"if",source:"(2656:4) {#if microphoneState === 'granted' && !$isLoading}",ctx:r}),q}function Bt(r){let t,e,i;e=new Xt({props:{isCompleted:r[5],position:"top"},$$inline:!0}),e.$on("action",r[29]);const s={c:function(){t=N("div"),me(e.$$.fragment),this.h()},l:function(c){t=M(c,"DIV",{class:!0});var a=z(t);de(e.$$.fragment,a),a.forEach(h),this.h()},h:function(){P(t,"class","top-action-buttons svelte-rt5px1"),R(t,I,2674,8,91041)},m:function(c,a){O(c,t,a),fe(e,t,null),i=!0},p:function(c,a){const u={};a[0]&32&&(u.isCompleted=c[5]),e.$set(u)},i:function(c){i||(U(e.$$.fragment,c),i=!0)},o:function(c){X(e.$$.fragment,c),i=!1},d:function(c){c&&h(t),ue(e)}};return ee("SvelteRegisterBlock",{block:s,id:Bt.name,type:"if",source:"(2674:6) {#if trainingPhase === 'results' && $isCompleted}",ctx:r}),s}function Un(r){let t,e;t=new Je({props:{class:"error-card",$$slots:{default:[Qn]},$$scope:{ctx:r}},$$inline:!0});const i={c:function(){me(t.$$.fragment)},l:function(n){de(t.$$.fragment,n)},m:function(n,c){fe(t,n,c),e=!0},p:function(n,c){const a={};c[3]&4096&&(a.$$scope={dirty:c,ctx:n}),t.$set(a)},i:function(n){e||(U(t.$$.fragment,n),e=!0)},o:function(n){X(t.$$.fragment,n),e=!1},d:function(n){ue(t,n)}};return ee("SvelteRegisterBlock",{block:i,id:Un.name,type:"else",source:"(2918:2) {:else}",ctx:r}),i}function Wn(r){let t,e,i,s,n,c,a,u={isActive:r[1]==="granted",trainingPhase:r[0],className:"pitch-detector-content",debugMode:!0,disableHarmonicCorrection:!1};e=new On({props:u,$$inline:!0}),r[35](e),e.$on("pitchUpdate",r[28]),e.$on("stateChange",go),e.$on("error",r[31]),e.$on("microphoneHealthChange",r[32]);let f=r[0]!=="results"&&xt(r),d=r[0]!=="results"&&Lt(r),m=r[0]==="results"&&Gt(r);const v={c:function(){t=N("div"),me(e.$$.fragment),i=$(),f&&f.c(),s=$(),d&&d.c(),n=$(),m&&m.c(),c=Le(),this.h()},l:function(p){t=M(p,"DIV",{style:!0});var y=z(t);de(e.$$.fragment,y),y.forEach(h),i=Z(p),f&&f.l(p),s=Z(p),d&&d.l(p),n=Z(p),m&&m.l(p),c=Le(),this.h()},h:function(){Qe(t,"display","none"),R(t,I,2693,4,91521)},m:function(p,y){O(p,t,y),fe(e,t,null),O(p,i,y),f&&f.m(p,y),O(p,s,y),d&&d.m(p,y),O(p,n,y),m&&m.m(p,y),O(p,c,y),a=!0},p:function(p,y){const _={};y[0]&2&&(_.isActive=p[1]==="granted"),y[0]&1&&(_.trainingPhase=p[0]),e.$set(_),p[0]!=="results"?f?(f.p(p,y),y[0]&1&&U(f,1)):(f=xt(p),f.c(),U(f,1),f.m(s.parentNode,s)):f&&(Ae(),X(f,1,1,()=>{f=null}),Te()),p[0]!=="results"?d?(d.p(p,y),y[0]&1&&U(d,1)):(d=Lt(p),d.c(),U(d,1),d.m(n.parentNode,n)):d&&(Ae(),X(d,1,1,()=>{d=null}),Te()),p[0]==="results"?m?(m.p(p,y),y[0]&1&&U(m,1)):(m=Gt(p),m.c(),U(m,1),m.m(c.parentNode,c)):m&&(Ae(),X(m,1,1,()=>{m=null}),Te())},i:function(p){a||(U(e.$$.fragment,p),U(f),U(d),U(m),a=!0)},o:function(p){X(e.$$.fragment,p),X(f),X(d),X(m),a=!1},d:function(p){p&&(h(t),h(i),h(s),h(n),h(c)),r[35](null),ue(e),f&&f.d(p),d&&d.d(p),m&&m.d(p)}};return ee("SvelteRegisterBlock",{block:v,id:Wn.name,type:"if",source:"(2692:2) {#if microphoneState === 'granted'}",ctx:r}),v}function Jn(r){let t;const e={c:function(){t=J("üé§ „Éû„Ç§„ÇØ„ÉÜ„Çπ„Éà„Éö„Éº„Ç∏„Å∏ÁßªÂãï")},l:function(s){t=W(s,"üé§ „Éû„Ç§„ÇØ„ÉÜ„Çπ„Éà„Éö„Éº„Ç∏„Å∏ÁßªÂãï")},m:function(s,n){O(s,t,n)},d:function(s){s&&h(t)}};return ee("SvelteRegisterBlock",{block:e,id:Jn.name,type:"slot",source:'(2932:10) <Button variant=\\"primary\\" on:click={goToMicrophoneTest}>',ctx:r}),e}function Kn(r){let t;const e={c:function(){t=J("üè† „Éõ„Éº„É†„Å´Êàª„Çã")},l:function(s){t=W(s,"üè† „Éõ„Éº„É†„Å´Êàª„Çã")},m:function(s,n){O(s,t,n)},d:function(s){s&&h(t)}};return ee("SvelteRegisterBlock",{block:e,id:Kn.name,type:"slot",source:'(2935:10) <Button variant=\\"secondary\\" on:click={goHome}>',ctx:r}),e}function Qn(r){let t,e,i="üé§",s,n,c="„Éû„Ç§„ÇØ„ÉÜ„Çπ„Éà„ÅåÂøÖË¶Å„Åß„Åô",a,u,f="ÈÄ£Á∂ö„ÉÅ„É£„É¨„É≥„Ç∏„É¢„Éº„Éâ„ÇíÈñãÂßã„Åô„ÇãÂâç„Å´„ÄÅ„Éû„Ç§„ÇØ„ÉÜ„Çπ„Éà„Éö„Éº„Ç∏„ÅßÈü≥Â£∞ÂÖ•Âäõ„ÅÆÁ¢∫Ë™ç„Çí„ÅäÈ°ò„ÅÑ„Åó„Åæ„Åô„ÄÇ",d,m,v,D,p,y="„Éû„Ç§„ÇØ„ÉÜ„Çπ„ÉàÂÆå‰∫ÜÂæå",_,L,k,w="„Åæ„Åö„ÅØ„Éû„Ç§„ÇØ„ÉÜ„Çπ„Éà„Éö„Éº„Ç∏„ÅßÈü≥Â£∞Á¢∫Ë™ç„ÇíË°å„Å£„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ",j,B,Q,A,b,K;Q=new ut({props:{variant:"primary",$$slots:{default:[Jn]},$$scope:{ctx:r}},$$inline:!0}),Q.$on("click",r[26]),b=new ut({props:{variant:"secondary",$$slots:{default:[Kn]},$$scope:{ctx:r}},$$inline:!0}),b.$on("click",r[27]);const T={c:function(){t=N("div"),e=N("div"),e.textContent=i,s=$(),n=N("h3"),n.textContent=c,a=$(),u=N("p"),u.textContent=f,d=$(),m=N("div"),v=N("p"),D=J("„Åì„ÅÆ„Éö„Éº„Ç∏„ÅØ"),p=N("strong"),p.textContent=y,_=J("„Å´„ÅîÂà©Áî®„ÅÑ„Åü„Å†„Åë„Åæ„Åô„ÄÇ"),L=$(),k=N("p"),k.textContent=w,j=$(),B=N("div"),me(Q.$$.fragment),A=$(),me(b.$$.fragment),this.h()},l:function(x){t=M(x,"DIV",{class:!0});var F=z(t);e=M(F,"DIV",{class:!0,"data-svelte-h":!0}),pe(e)!=="svelte-15rbx8n"&&(e.textContent=i),s=Z(F),n=M(F,"H3",{class:!0,"data-svelte-h":!0}),pe(n)!=="svelte-17kvze2"&&(n.textContent=c),a=Z(F),u=M(F,"P",{class:!0,"data-svelte-h":!0}),pe(u)!=="svelte-1t09god"&&(u.textContent=f),d=Z(F),m=M(F,"DIV",{class:!0});var H=z(m);v=M(H,"P",{class:!0});var E=z(v);D=W(E,"„Åì„ÅÆ„Éö„Éº„Ç∏„ÅØ"),p=M(E,"STRONG",{"data-svelte-h":!0}),pe(p)!=="svelte-1n3qsr6"&&(p.textContent=y),_=W(E,"„Å´„ÅîÂà©Áî®„ÅÑ„Åü„Å†„Åë„Åæ„Åô„ÄÇ"),E.forEach(h),L=Z(H),k=M(H,"P",{class:!0,"data-svelte-h":!0}),pe(k)!=="svelte-v8nd09"&&(k.textContent=w),H.forEach(h),j=Z(F),B=M(F,"DIV",{class:!0});var Y=z(B);de(Q.$$.fragment,Y),A=Z(Y),de(b.$$.fragment,Y),Y.forEach(h),F.forEach(h),this.h()},h:function(){P(e,"class","error-icon svelte-rt5px1"),R(e,I,2921,8,99489),P(n,"class","svelte-rt5px1"),R(n,I,2922,8,99530),P(u,"class","svelte-rt5px1"),R(u,I,2923,8,99559),R(p,I,2926,19,99675),P(v,"class","svelte-rt5px1"),R(v,I,2926,10,99666),P(k,"class","svelte-rt5px1"),R(k,I,2927,10,99727),P(m,"class","recommendation svelte-rt5px1"),R(m,I,2925,8,99627),P(B,"class","action-buttons"),R(B,I,2930,8,99793),P(t,"class","error-content svelte-rt5px1"),R(t,I,2920,6,99453)},m:function(x,F){O(x,t,F),g(t,e),g(t,s),g(t,n),g(t,a),g(t,u),g(t,d),g(t,m),g(m,v),g(v,D),g(v,p),g(v,_),g(m,L),g(m,k),g(t,j),g(t,B),fe(Q,B,null),g(B,A),fe(b,B,null),K=!0},p:function(x,F){const H={};F[3]&4096&&(H.$$scope={dirty:F,ctx:x}),Q.$set(H);const E={};F[3]&4096&&(E.$$scope={dirty:F,ctx:x}),b.$set(E)},i:function(x){K||(U(Q.$$.fragment,x),U(b.$$.fragment,x),K=!0)},o:function(x){X(Q.$$.fragment,x),X(b.$$.fragment,x),K=!1},d:function(x){x&&h(t),ue(Q),ue(b)}};return ee("SvelteRegisterBlock",{block:T,id:Qn.name,type:"slot",source:'(2920:4) <Card class=\\"error-card\\">',ctx:r}),T}function xt(r){let t,e,i,s,n,c,a=!r[2]&&r[6].length>0&&Ht(r);i=new Je({props:{class:"main-card half-width",$$slots:{default:[so]},$$scope:{ctx:r}},$$inline:!0}),n=new jn({props:{frequency:r[14],note:r[15],volume:r[13],isMuted:r[0]!=="guiding",muteMessage:"Âü∫Èü≥ÂÜçÁîüÂæå„Å´ÈñãÂßã",className:"half-width",showGuidance:!1},$$inline:!0});const u={c:function(){a&&a.c(),t=$(),e=N("div"),me(i.$$.fragment),s=$(),me(n.$$.fragment),this.h()},l:function(d){a&&a.l(d),t=Z(d),e=M(d,"DIV",{class:!0});var m=z(e);de(i.$$.fragment,m),s=Z(m),de(n.$$.fragment,m),m.forEach(h),this.h()},h:function(){P(e,"class","side-by-side-container svelte-rt5px1"),R(e,I,2732,6,92858)},m:function(d,m){a&&a.m(d,m),O(d,t,m),O(d,e,m),fe(i,e,null),g(e,s),fe(n,e,null),c=!0},p:function(d,m){!d[2]&&d[6].length>0?a?(a.p(d,m),m[0]&68&&U(a,1)):(a=Ht(d),a.c(),U(a,1),a.m(t.parentNode,t)):a&&(Ae(),X(a,1,1,()=>{a=null}),Te());const v={};m[0]&8395649|m[3]&4096&&(v.$$scope={dirty:m,ctx:d}),i.$set(v);const D={};m[0]&16384&&(D.frequency=d[14]),m[0]&32768&&(D.note=d[15]),m[0]&8192&&(D.volume=d[13]),m[0]&1&&(D.isMuted=d[0]!=="guiding"),n.$set(D)},i:function(d){c||(U(a),U(i.$$.fragment,d),U(n.$$.fragment,d),c=!0)},o:function(d){X(a),X(i.$$.fragment,d),X(n.$$.fragment,d),c=!1},d:function(d){d&&(h(t),h(e)),a&&a.d(d),ue(i),ue(n)}};return ee("SvelteRegisterBlock",{block:u,id:xt.name,type:"if",source:"(2711:4) {#if trainingPhase !== 'results'}",ctx:r}),u}function Ht(r){let t,e;t=new Je({props:{class:"warning-card",$$slots:{default:[Xn]},$$scope:{ctx:r}},$$inline:!0});const i={c:function(){me(t.$$.fragment)},l:function(n){de(t.$$.fragment,n)},m:function(n,c){fe(t,n,c),e=!0},p:function(n,c){const a={};c[0]&64|c[3]&4096&&(a.$$scope={dirty:c,ctx:n}),t.$set(a)},i:function(n){e||(U(t.$$.fragment,n),e=!0)},o:function(n){X(t.$$.fragment,n),e=!1},d:function(n){ue(t,n)}};return ee("SvelteRegisterBlock",{block:i,id:Ht.name,type:"if",source:"(2714:6) {#if !microphoneHealthy && microphoneErrors.length > 0}",ctx:r}),i}function Vt(r){let t,e=r[102]+"",i;const s={c:function(){t=N("li"),i=J(e),this.h()},l:function(c){t=M(c,"LI",{class:!0});var a=z(t);i=W(a,e),a.forEach(h),this.h()},h:function(){P(t,"class","svelte-rt5px1"),R(t,I,2722,16,92626)},m:function(c,a){O(c,t,a),g(t,i)},p:function(c,a){a[0]&64&&e!==(e=c[102]+"")&&De(i,e)},d:function(c){c&&h(t)}};return ee("SvelteRegisterBlock",{block:s,id:Vt.name,type:"each",source:"(2722:14) {#each microphoneErrors as error}",ctx:r}),s}function Xn(r){let t,e,i="‚ö†Ô∏è „Éû„Ç§„ÇØÊé•Á∂ö„Å´ÂïèÈ°å„Åå„ÅÇ„Çä„Åæ„Åô",s,n,c,a="„Éû„Ç§„ÇØ„ÅåÊ≠£Â∏∏„Å´Âãï‰Ωú„Åó„Å¶„ÅÑ„Åæ„Åõ„Çì„ÄÇ‰ª•‰∏ã„ÅÆÂïèÈ°å„ÅåÊ§úÂá∫„Åï„Çå„Åæ„Åó„ÅüÔºö",u,f,d,m,v,D="Ëß£Ê±∫ÊñπÊ≥ï:",p,y=lt(r[6]),_=[];for(let k=0;k<y.length;k+=1)_[k]=Vt(En(r,y,k));const L={c:function(){t=N("div"),e=N("h3"),e.textContent=i,s=$(),n=N("div"),c=N("p"),c.textContent=a,u=$(),f=N("ul");for(let w=0;w<_.length;w+=1)_[w].c();d=$(),m=N("p"),v=N("strong"),v.textContent=D,p=J(" „Éö„Éº„Ç∏„ÇíÂÜçË™≠„ÅøËæº„Åø„Åó„Å¶„Éû„Ç§„ÇØË®±ÂèØ„ÇíÂÜçÂ∫¶ÂèñÂæó„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ"),this.h()},l:function(w){t=M(w,"DIV",{class:!0});var j=z(t);e=M(j,"H3",{class:!0,"data-svelte-h":!0}),pe(e)!=="svelte-15qec5x"&&(e.textContent=i),j.forEach(h),s=Z(w),n=M(w,"DIV",{class:!0});var B=z(n);c=M(B,"P",{class:!0,"data-svelte-h":!0}),pe(c)!=="svelte-171o2p0"&&(c.textContent=a),u=Z(B),f=M(B,"UL",{class:!0});var Q=z(f);for(let b=0;b<_.length;b+=1)_[b].l(Q);Q.forEach(h),d=Z(B),m=M(B,"P",{class:!0});var A=z(m);v=M(A,"STRONG",{"data-svelte-h":!0}),pe(v)!=="svelte-79o66n"&&(v.textContent=D),p=W(A," „Éö„Éº„Ç∏„ÇíÂÜçË™≠„ÅøËæº„Åø„Åó„Å¶„Éû„Ç§„ÇØË®±ÂèØ„ÇíÂÜçÂ∫¶ÂèñÂæó„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ"),A.forEach(h),B.forEach(h),this.h()},h:function(){P(e,"class","section-title svelte-rt5px1"),R(e,I,2716,12,92350),P(t,"class","card-header svelte-rt5px1"),R(t,I,2715,10,92312),P(c,"class","warning-message svelte-rt5px1"),R(c,I,2719,12,92464),P(f,"class","error-list svelte-rt5px1"),R(f,I,2720,12,92538),R(v,I,2726,14,92737),P(m,"class","fix-instruction svelte-rt5px1"),R(m,I,2725,12,92695),P(n,"class","card-content svelte-rt5px1"),R(n,I,2718,10,92425)},m:function(w,j){O(w,t,j),g(t,e),O(w,s,j),O(w,n,j),g(n,c),g(n,u),g(n,f);for(let B=0;B<_.length;B+=1)_[B]&&_[B].m(f,null);g(n,d),g(n,m),g(m,v),g(m,p)},p:function(w,j){if(j[0]&64){y=lt(w[6]);let B;for(B=0;B<y.length;B+=1){const Q=En(w,y,B);_[B]?_[B].p(Q,j):(_[B]=Vt(Q),_[B].c(),_[B].m(f,null))}for(;B<_.length;B+=1)_[B].d(1);_.length=y.length}},d:function(w){w&&(h(t),h(s),h(n)),zn(_,w)}};return ee("SvelteRegisterBlock",{block:L,id:Xn.name,type:"slot",source:'(2715:8) <Card class=\\"warning-card\\">',ctx:r}),L}function Yn(r){let t;function e(c,a){return c[9]?no:c[0]==="guiding"?to:c[0]==="results"?eo:$n}let i=e(r),s=i(r);const n={c:function(){t=N("div"),s.c(),this.h()},l:function(a){t=M(a,"DIV",{class:!0});var u=z(t);s.l(u),u.forEach(h),this.h()},h:function(){P(t,"class","continuous-status svelte-rt5px1"),R(t,I,2749,14,93507)},m:function(a,u){O(a,t,u),s.m(t,null)},p:function(a,u){i===(i=e(a))&&s?s.p(a,u):(s.d(1),s=i(a),s&&(s.c(),s.m(t,null)))},i:Et,o:Et,d:function(a){a&&h(t),s.d()}};return ee("SvelteRegisterBlock",{block:n,id:Yn.name,type:"else",source:"(2748:12) {:else}",ctx:r}),n}function Zn(r){let t,e;t=new ut({props:{variant:"primary",$$slots:{default:[oo]},$$scope:{ctx:r}},$$inline:!0}),t.$on("click",r[30]);const i={c:function(){me(t.$$.fragment)},l:function(n){de(t.$$.fragment,n)},m:function(n,c){fe(t,n,c),e=!0},p:function(n,c){const a={};c[3]&4096&&(a.$$scope={dirty:c,ctx:n}),t.$set(a)},i:function(n){e||(U(t.$$.fragment,n),e=!0)},o:function(n){X(t.$$.fragment,n),e=!1},d:function(n){ue(t,n)}};return ee("SvelteRegisterBlock",{block:i,id:Zn.name,type:"if",source:"(2741:12) {#if trainingPhase === 'setup' && !isPlaying && !($currentSessionId > 1)}",ctx:r}),i}function $n(r){let t,e,i,s;const n={c:function(){t=N("div"),e=J("‚ö° ÈÄ£Á∂ö„É¢„Éº„ÉâÈÄ≤Ë°å‰∏≠ ("),i=J(r[23]),s=J("/8)"),this.h()},l:function(a){t=M(a,"DIV",{class:!0});var u=z(t);e=W(u,"‚ö° ÈÄ£Á∂ö„É¢„Éº„ÉâÈÄ≤Ë°å‰∏≠ ("),i=W(u,r[23]),s=W(u,"/8)"),u.forEach(h),this.h()},h:function(){P(t,"class","status-text svelte-rt5px1"),R(t,I,2763,18,94097)},m:function(a,u){O(a,t,u),g(t,e),g(t,i),g(t,s)},p:function(a,u){u[0]&8388608&&De(i,a[23])},d:function(a){a&&h(t)}};return ee("SvelteRegisterBlock",{block:n,id:$n.name,type:"else",source:"(2763:16) {:else}",ctx:r}),n}function eo(r){let t,e,i,s;const n={c:function(){t=N("div"),e=J("‚úÖ „Çª„ÉÉ„Ç∑„Éß„É≥ "),i=J(r[23]),s=J("/8 ÂÆå‰∫Ü"),this.h()},l:function(a){t=M(a,"DIV",{class:!0});var u=z(t);e=W(u,"‚úÖ „Çª„ÉÉ„Ç∑„Éß„É≥ "),i=W(u,r[23]),s=W(u,"/8 ÂÆå‰∫Ü"),u.forEach(h),this.h()},h:function(){P(t,"class","status-text svelte-rt5px1"),R(t,I,2759,18,93951)},m:function(a,u){O(a,t,u),g(t,e),g(t,i),g(t,s)},p:function(a,u){u[0]&8388608&&De(i,a[23])},d:function(a){a&&h(t)}};return ee("SvelteRegisterBlock",{block:n,id:eo.name,type:"if",source:"(2759:54) ",ctx:r}),n}function to(r){let t,e,i,s;const n={c:function(){t=N("div"),e=J("üé§ „Çª„ÉÉ„Ç∑„Éß„É≥ "),i=J(r[23]),s=J("/8: „Éâ„É¨„ÉüÁô∫Â£∞‰∏≠"),this.h()},l:function(a){t=M(a,"DIV",{class:!0});var u=z(t);e=W(u,"üé§ „Çª„ÉÉ„Ç∑„Éß„É≥ "),i=W(u,r[23]),s=W(u,"/8: „Éâ„É¨„ÉüÁô∫Â£∞‰∏≠"),u.forEach(h),this.h()},h:function(){P(t,"class","status-text svelte-rt5px1"),R(t,I,2755,18,93768)},m:function(a,u){O(a,t,u),g(t,e),g(t,i),g(t,s)},p:function(a,u){u[0]&8388608&&De(i,a[23])},d:function(a){a&&h(t)}};return ee("SvelteRegisterBlock",{block:n,id:to.name,type:"if",source:"(2755:54) ",ctx:r}),n}function no(r){let t,e,i,s;const n={c:function(){t=N("div"),e=J("üéµ Âü∫Èü≥ "),i=J(r[23]),s=J("/8 ÂÜçÁîü‰∏≠..."),this.h()},l:function(a){t=M(a,"DIV",{class:!0});var u=z(t);e=W(u,"üéµ Âü∫Èü≥ "),i=W(u,r[23]),s=W(u,"/8 ÂÜçÁîü‰∏≠..."),u.forEach(h),this.h()},h:function(){P(t,"class","status-text svelte-rt5px1"),R(t,I,2751,18,93589)},m:function(a,u){O(a,t,u),g(t,e),g(t,i),g(t,s)},p:function(a,u){u[0]&8388608&&De(i,a[23])},d:function(a){a&&h(t)}};return ee("SvelteRegisterBlock",{block:n,id:no.name,type:"if",source:"(2751:16) {#if isPlaying}",ctx:r}),n}function oo(r){let t;const e={c:function(){t=J("‚ö° ÈÄ£Á∂ö„ÉÅ„É£„É¨„É≥„Ç∏ÈñãÂßãÔºà8„Çª„ÉÉ„Ç∑„Éß„É≥Ôºâ")},l:function(s){t=W(s,"‚ö° ÈÄ£Á∂ö„ÉÅ„É£„É¨„É≥„Ç∏ÈñãÂßãÔºà8„Çª„ÉÉ„Ç∑„Éß„É≥Ôºâ")},m:function(s,n){O(s,t,n)},d:function(s){s&&h(t)}};return ee("SvelteRegisterBlock",{block:e,id:oo.name,type:"slot",source:'(2742:14) <Button                  variant=\\"primary\\"                 on:click={startContinuousMode}               >',ctx:r}),e}function zt(r){let t,e,i,s,n,c=r[8].toFixed(1)+"",a,u;const f={c:function(){t=N("div"),e=J("ÁèæÂú®„ÅÆÂü∫Èü≥: "),i=N("strong"),s=J(r[7]),n=J(" ("),a=J(c),u=J("Hz)"),this.h()},l:function(m){t=M(m,"DIV",{class:!0});var v=z(t);e=W(v,"ÁèæÂú®„ÅÆÂü∫Èü≥: "),i=M(v,"STRONG",{});var D=z(i);s=W(D,r[7]),D.forEach(h),n=W(v," ("),a=W(v,c),u=W(v,"Hz)"),v.forEach(h),this.h()},h:function(){R(i,I,2772,23,94377),P(t,"class","base-note-info svelte-rt5px1"),R(t,I,2771,14,94325)},m:function(m,v){O(m,t,v),g(t,e),g(t,i),g(i,s),g(t,n),g(t,a),g(t,u)},p:function(m,v){v[0]&128&&De(s,m[7]),v[0]&256&&c!==(c=m[8].toFixed(1)+"")&&De(a,c)},d:function(m){m&&h(t)}};return ee("SvelteRegisterBlock",{block:f,id:zt.name,type:"if",source:"(2771:12) {#if currentBaseNote}",ctx:r}),f}function so(r){let t,e,i="üéπ Âü∫Èü≥ÂÜçÁîü",s,n,c,a,u,f,d,m,v="„Ç¨„Ç§„ÉâÈñãÂßã„Åæ„Åß",D,p,y,_,L,k,w,j;const B=[Zn,Yn],Q=[];function A(T,q){return T[0]==="setup"&&!T[9]&&!(T[23]>1)?0:1}c=A(r),a=Q[c]=B[c](r);let b=r[7]&&zt(r);k=new Gn({props:{size:"20"},$$inline:!0});const K={c:function(){t=N("div"),e=N("h3"),e.textContent=i,s=$(),n=N("div"),a.c(),u=$(),b&&b.c(),f=$(),d=N("div"),m=N("div"),m.textContent=v,D=$(),p=N("div"),y=N("div"),_=$(),L=N("div"),me(k.$$.fragment),this.h()},l:function(q){t=M(q,"DIV",{class:!0});var x=z(t);e=M(x,"H3",{class:!0,"data-svelte-h":!0}),pe(e)!=="svelte-syc53b"&&(e.textContent=i),x.forEach(h),s=Z(q),n=M(q,"DIV",{class:!0});var F=z(n);a.l(F),u=Z(F),b&&b.l(F),f=Z(F),d=M(F,"DIV",{class:!0});var H=z(d);m=M(H,"DIV",{class:!0,"data-svelte-h":!0}),pe(m)!=="svelte-1dufnpv"&&(m.textContent=v),D=Z(H),p=M(H,"DIV",{class:!0});var E=z(p);y=M(E,"DIV",{class:!0,style:!0}),z(y).forEach(h),_=Z(E),L=M(E,"DIV",{class:!0});var Y=z(L);de(k.$$.fragment,Y),Y.forEach(h),E.forEach(h),H.forEach(h),F.forEach(h),this.h()},h:function(){P(e,"class","section-title svelte-rt5px1"),R(e,I,2736,12,93022),P(t,"class","card-header svelte-rt5px1"),R(t,I,2735,10,92984),P(m,"class","guide-start-label svelte-rt5px1"),R(m,I,2778,14,94602),P(y,"class","guide-progress-fill svelte-rt5px1"),Qe(y,"width",r[11]+"%"),R(y,I,2780,16,94707),P(L,"class",w="guide-music-icon "+(r[12]?"glowing":"")+" svelte-rt5px1"),R(L,I,2784,16,94855),P(p,"class","guide-start-bar svelte-rt5px1"),R(p,I,2779,14,94661),P(d,"class","guide-start-bar-container svelte-rt5px1"),R(d,I,2777,12,94548),P(n,"class","card-content svelte-rt5px1"),R(n,I,2738,10,93088)},m:function(q,x){O(q,t,x),g(t,e),O(q,s,x),O(q,n,x),Q[c].m(n,null),g(n,u),b&&b.m(n,null),g(n,f),g(n,d),g(d,m),g(d,D),g(d,p),g(p,y),g(p,_),g(p,L),fe(k,L,null),j=!0},p:function(q,x){let F=c;c=A(q),c===F?Q[c].p(q,x):(Ae(),X(Q[F],1,1,()=>{Q[F]=null}),Te(),a=Q[c],a?a.p(q,x):(a=Q[c]=B[c](q),a.c()),U(a,1),a.m(n,u)),q[7]?b?b.p(q,x):(b=zt(q),b.c(),b.m(n,f)):b&&(b.d(1),b=null),(!j||x[0]&2048)&&Qe(y,"width",q[11]+"%"),(!j||x[0]&4096&&w!==(w="guide-music-icon "+(q[12]?"glowing":"")+" svelte-rt5px1"))&&P(L,"class",w)},i:function(q){j||(U(a),U(k.$$.fragment,q),j=!0)},o:function(q){X(a),X(k.$$.fragment,q),j=!1},d:function(q){q&&(h(t),h(s),h(n)),Q[c].d(),b&&b.d(),ue(k)}};return ee("SvelteRegisterBlock",{block:K,id:so.name,type:"slot",source:'(2735:8) <Card class=\\"main-card half-width\\">',ctx:r}),K}function Lt(r){let t,e;t=new Je({props:{class:"main-card",$$slots:{default:[ro]},$$scope:{ctx:r}},$$inline:!0});const i={c:function(){me(t.$$.fragment)},l:function(n){de(t.$$.fragment,n)},m:function(n,c){fe(t,n,c),e=!0},p:function(n,c){const a={};c[0]&1025|c[3]&4096&&(a.$$scope={dirty:c,ctx:n}),t.$set(a)},i:function(n){e||(U(t.$$.fragment,n),e=!0)},o:function(n){X(t.$$.fragment,n),e=!1},d:function(n){ue(t,n)}};return ee("SvelteRegisterBlock",{block:i,id:Lt.name,type:"if",source:"(2806:4) {#if trainingPhase !== 'results'}",ctx:r}),i}function jt(r){let t,e=r[99].name+"",i,s,n;const c={c:function(){t=N("div"),i=J(e),s=$(),this.h()},l:function(u){t=M(u,"DIV",{class:!0});var f=z(t);i=W(f,e),s=Z(f),f.forEach(h),this.h()},h:function(){P(t,"class",n="scale-item "+r[99].state+" svelte-rt5px1"),R(t,I,2814,14,95757)},m:function(u,f){O(u,t,f),g(t,i),g(t,s)},p:function(u,f){f[0]&1024&&e!==(e=u[99].name+"")&&De(i,e),f[0]&1024&&n!==(n="scale-item "+u[99].state+" svelte-rt5px1")&&P(t,"class",n)},d:function(u){u&&h(t)}};return ee("SvelteRegisterBlock",{block:c,id:jt.name,type:"each",source:"(2814:12) {#each scaleSteps as step, index}",ctx:r}),c}function Ot(r){let t,e,i,s="„Éâ„É¨„Éü„Éï„Ç°„ÇΩ„É©„Ç∑„Éâ",n;const c={c:function(){t=N("div"),e=J("„Ç¨„Ç§„Éâ„Å´Âêà„Çè„Åõ„Å¶ "),i=N("strong"),i.textContent=s,n=J(" „ÇíÊ≠å„Å£„Å¶„Åè„Å†„Åï„ÅÑ"),this.h()},l:function(u){t=M(u,"DIV",{class:!0});var f=z(t);e=W(f,"„Ç¨„Ç§„Éâ„Å´Âêà„Çè„Åõ„Å¶ "),i=M(f,"STRONG",{"data-svelte-h":!0}),pe(i)!=="svelte-1dipf74"&&(i.textContent=s),n=W(f," „ÇíÊ≠å„Å£„Å¶„Åè„Å†„Åï„ÅÑ"),f.forEach(h),this.h()},h:function(){R(i,I,2823,23,96024),P(t,"class","guide-instruction svelte-rt5px1"),R(t,I,2822,12,95969)},m:function(u,f){O(u,t,f),g(t,e),g(t,i),g(t,n)},d:function(u){u&&h(t)}};return ee("SvelteRegisterBlock",{block:c,id:Ot.name,type:"if",source:"(2822:10) {#if trainingPhase === 'guiding'}",ctx:r}),c}function ro(r){let t,e,i="üéµ „Éâ„É¨„ÉüÈü≥Èöé„Ç¨„Ç§„Éâ",s,n,c,a,u=lt(r[10]),f=[];for(let v=0;v<u.length;v+=1)f[v]=jt(Tn(r,u,v));let d=r[0]==="guiding"&&Ot(r);const m={c:function(){t=N("div"),e=N("h3"),e.textContent=i,s=$(),n=N("div"),c=N("div");for(let D=0;D<f.length;D+=1)f[D].c();a=$(),d&&d.c(),this.h()},l:function(D){t=M(D,"DIV",{class:!0});var p=z(t);e=M(p,"H3",{class:!0,"data-svelte-h":!0}),pe(e)!=="svelte-1mor0as"&&(e.textContent=i),p.forEach(h),s=Z(D),n=M(D,"DIV",{class:!0});var y=z(n);c=M(y,"DIV",{class:!0});var _=z(c);for(let L=0;L<f.length;L+=1)f[L].l(_);_.forEach(h),a=Z(y),d&&d.l(y),y.forEach(h),this.h()},h:function(){P(e,"class","section-title svelte-rt5px1"),R(e,I,2809,10,95568),P(t,"class","card-header svelte-rt5px1"),R(t,I,2808,8,95532),P(c,"class","scale-guide svelte-rt5px1"),R(c,I,2812,10,95671),P(n,"class","card-content svelte-rt5px1"),R(n,I,2811,8,95634)},m:function(D,p){O(D,t,p),g(t,e),O(D,s,p),O(D,n,p),g(n,c);for(let y=0;y<f.length;y+=1)f[y]&&f[y].m(c,null);g(n,a),d&&d.m(n,null)},p:function(D,p){if(p[0]&1024){u=lt(D[10]);let y;for(y=0;y<u.length;y+=1){const _=Tn(D,u,y);f[y]?f[y].p(_,p):(f[y]=jt(_),f[y].c(),f[y].m(c,null))}for(;y<f.length;y+=1)f[y].d(1);f.length=u.length}D[0]==="guiding"?d||(d=Ot(D),d.c(),d.m(n,null)):d&&(d.d(1),d=null)},d:function(D){D&&(h(t),h(s),h(n)),zn(f,D),d&&d.d()}};return ee("SvelteRegisterBlock",{block:m,id:ro.name,type:"slot",source:'(2808:6) <Card class=\\"main-card\\">',ctx:r}),m}function Gt(r){let t,e,i,s,n,c,a;const u=[co,ao],f=[];function d(y,_){return y[4]&&y[5]?0:y[21]?1:-1}~(t=d(r))&&(e=f[t]=u[t](r));const m=[lo,io],v=[];function D(y,_){return y[0]==="results"&&y[5]?0:y[0]==="results"&&!y[5]?1:-1}~(s=D(r))&&(n=v[s]=m[s](r));const p={c:function(){e&&e.c(),i=$(),n&&n.c(),c=Le()},l:function(_){e&&e.l(_),i=Z(_),n&&n.l(_),c=Le()},m:function(_,L){~t&&f[t].m(_,L),O(_,i,L),~s&&v[s].m(_,L),O(_,c,L),a=!0},p:function(_,L){let k=t;t=d(_),t===k?~t&&f[t].p(_,L):(e&&(Ae(),X(f[k],1,1,()=>{f[k]=null}),Te()),~t?(e=f[t],e?e.p(_,L):(e=f[t]=u[t](_),e.c()),U(e,1),e.m(i.parentNode,i)):e=null);let w=s;s=D(_),s===w?~s&&v[s].p(_,L):(n&&(Ae(),X(v[w],1,1,()=>{v[w]=null}),Te()),~s?(n=v[s],n?n.p(_,L):(n=v[s]=m[s](_),n.c()),U(n,1),n.m(c.parentNode,c)):n=null)},i:function(_){a||(U(e),U(n),a=!0)},o:function(_){X(e),X(n),a=!1},d:function(_){_&&(h(i),h(c)),~t&&f[t].d(_),~s&&v[s].d(_)}};return ee("SvelteRegisterBlock",{block:p,id:Gt.name,type:"if",source:"(2833:4) {#if trainingPhase === 'results'}",ctx:r}),p}function ao(r){var a,u;let t=console.log("üîç [ContinuousMode] CurrentUnifiedScoreData structure:",{sessionHistoryLength:((a=r[21].sessionHistory)==null?void 0:a.length)||0,sessionHistory:((u=r[21].sessionHistory)==null?void 0:u.map(Vn))||[]})+"",e,i,s,n;s=new Yt({props:{scoreData:r[21],showDetails:!1,className:"mb-6 iphone-no-margin",currentScoreData:r[16],intervalData:r[3],consistencyData:r[17],feedbackData:r[18],technicalFeedbackData:r[19],sessionStatistics:r[20]},$$inline:!0});const c={c:function(){e=J(t),i=$(),me(s.$$.fragment)},l:function(d){e=W(d,t),i=Z(d),de(s.$$.fragment,d)},m:function(d,m){O(d,e,m),O(d,i,m),fe(s,d,m),n=!0},p:function(d,m){var D,p;(!n||m[0]&2097152)&&t!==(t=console.log("üîç [ContinuousMode] CurrentUnifiedScoreData structure:",{sessionHistoryLength:((D=d[21].sessionHistory)==null?void 0:D.length)||0,sessionHistory:((p=d[21].sessionHistory)==null?void 0:p.map(Vn))||[]})+"")&&De(e,t);const v={};m[0]&2097152&&(v.scoreData=d[21]),m[0]&65536&&(v.currentScoreData=d[16]),m[0]&8&&(v.intervalData=d[3]),m[0]&131072&&(v.consistencyData=d[17]),m[0]&262144&&(v.feedbackData=d[18]),m[0]&524288&&(v.technicalFeedbackData=d[19]),m[0]&1048576&&(v.sessionStatistics=d[20]),s.$set(v)},i:function(d){n||(U(s.$$.fragment,d),n=!0)},o:function(d){X(s.$$.fragment,d),n=!1},d:function(d){d&&(h(e),h(i)),ue(s,d)}};return ee("SvelteRegisterBlock",{block:c,id:ao.name,type:"if",source:"(2861:40) ",ctx:r}),c}function co(r){let t,e,i,s=r[4]&&Ut(r);e=new Yt({props:{scoreData:r[4],showDetails:!1,className:"mb-6 iphone-no-margin",currentScoreData:r[16],intervalData:r[3],consistencyData:r[17],feedbackData:r[18],technicalFeedbackData:r[19],sessionStatistics:r[20]},$$inline:!0});const n={c:function(){s&&s.c(),t=$(),me(e.$$.fragment)},l:function(a){s&&s.l(a),t=Z(a),de(e.$$.fragment,a)},m:function(a,u){s&&s.m(a,u),O(a,t,u),fe(e,a,u),i=!0},p:function(a,u){a[4]?s?s.p(a,u):(s=Ut(a),s.c(),s.m(t.parentNode,t)):s&&(s.d(1),s=null);const f={};u[0]&16&&(f.scoreData=a[4]),u[0]&65536&&(f.currentScoreData=a[16]),u[0]&8&&(f.intervalData=a[3]),u[0]&131072&&(f.consistencyData=a[17]),u[0]&262144&&(f.feedbackData=a[18]),u[0]&524288&&(f.technicalFeedbackData=a[19]),u[0]&1048576&&(f.sessionStatistics=a[20]),e.$set(f)},i:function(a){i||(U(e.$$.fragment,a),i=!0)},o:function(a){X(e.$$.fragment,a),i=!1},d:function(a){a&&h(t),s&&s.d(a),ue(e,a)}};return ee("SvelteRegisterBlock",{block:n,id:co.name,type:"if",source:"(2835:6) {#if $unifiedScoreData && $isCompleted}",ctx:r}),n}function Ut(r){var s,n;let t=console.log("üîç [ContinuousMode] UnifiedScoreData structure:",{sessionHistoryLength:((s=r[4].sessionHistory)==null?void 0:s.length)||0,sessionHistory:((n=r[4].sessionHistory)==null?void 0:n.map(Hn))||[]})+"",e;const i={c:function(){e=J(t)},l:function(a){e=W(a,t)},m:function(a,u){O(a,e,u)},p:function(a,u){var f,d;u[0]&16&&t!==(t=console.log("üîç [ContinuousMode] UnifiedScoreData structure:",{sessionHistoryLength:((f=a[4].sessionHistory)==null?void 0:f.length)||0,sessionHistory:((d=a[4].sessionHistory)==null?void 0:d.map(Hn))||[]})+"")&&De(e,t)},d:function(a){a&&h(e)}};return ee("SvelteRegisterBlock",{block:i,id:Ut.name,type:"if",source:"(2837:8) {#if $unifiedScoreData}",ctx:r}),i}function io(r){let t,e;t=new Je({props:{class:"main-card bottom-action-card",$$slots:{default:[uo]},$$scope:{ctx:r}},$$inline:!0});const i={c:function(){me(t.$$.fragment)},l:function(n){de(t.$$.fragment,n)},m:function(n,c){fe(t,n,c),e=!0},p:function(n,c){const a={};c[3]&4096&&(a.$$scope={dirty:c,ctx:n}),t.$set(a)},i:function(n){e||(U(t.$$.fragment,n),e=!0)},o:function(n){X(t.$$.fragment,n),e=!1},d:function(n){ue(t,n)}};return ee("SvelteRegisterBlock",{block:i,id:io.name,type:"if",source:"(2901:61) ",ctx:r}),i}function lo(r){let t,e;t=new Je({props:{class:"main-card bottom-action-card",$$slots:{default:[fo]},$$scope:{ctx:r}},$$inline:!0});const i={c:function(){me(t.$$.fragment)},l:function(n){de(t.$$.fragment,n)},m:function(n,c){fe(t,n,c),e=!0},p:function(n,c){const a={};c[0]&32|c[3]&4096&&(a.$$scope={dirty:c,ctx:n}),t.$set(a)},i:function(n){e||(U(t.$$.fragment,n),e=!0)},o:function(n){X(t.$$.fragment,n),e=!1},d:function(n){ue(t,n)}};return ee("SvelteRegisterBlock",{block:i,id:lo.name,type:"if",source:"(2890:6) {#if trainingPhase === 'results' && $isCompleted}",ctx:r}),i}function uo(r){let t,e,i,s,n,c,a="Ê¨°„ÅÆ„Çª„ÉÉ„Ç∑„Éß„É≥„ÇíÊ∫ñÂÇô‰∏≠...";const u={c:function(){t=N("div"),e=N("div"),i=N("div"),s=N("div"),n=$(),c=N("span"),c.textContent=a,this.h()},l:function(d){t=M(d,"DIV",{class:!0});var m=z(t);e=M(m,"DIV",{class:!0});var v=z(e);i=M(v,"DIV",{class:!0});var D=z(i);s=M(D,"DIV",{class:!0}),z(s).forEach(h),n=Z(D),c=M(D,"SPAN",{"data-svelte-h":!0}),pe(c)!=="svelte-11jhwau"&&(c.textContent=a),D.forEach(h),v.forEach(h),m.forEach(h),this.h()},h:function(){P(s,"class","spinner"),R(s,I,2906,16,99152),R(c,I,2907,16,99196),P(i,"class","auto-progress-indicator"),R(i,I,2905,14,99098),P(e,"class","continuous-mode-message"),R(e,I,2904,12,99046),P(t,"class","card-content svelte-rt5px1"),R(t,I,2903,10,99007)},m:function(d,m){O(d,t,m),g(t,e),g(e,i),g(i,s),g(i,n),g(i,c)},p:Et,d:function(d){d&&h(t)}};return ee("SvelteRegisterBlock",{block:u,id:uo.name,type:"slot",source:'(2903:8) <Card class=\\"main-card bottom-action-card\\">',ctx:r}),u}function fo(r){let t,e,i;e=new Xt({props:{isCompleted:r[5],position:"bottom"},$$inline:!0}),e.$on("action",r[29]);const s={c:function(){t=N("div"),me(e.$$.fragment),this.h()},l:function(c){t=M(c,"DIV",{class:!0});var a=z(t);de(e.$$.fragment,a),a.forEach(h),this.h()},h:function(){P(t,"class","card-content svelte-rt5px1"),R(t,I,2891,10,98565)},m:function(c,a){O(c,t,a),fe(e,t,null),i=!0},p:function(c,a){const u={};a[0]&32&&(u.isCompleted=c[5]),e.$set(u)},i:function(c){i||(U(e.$$.fragment,c),i=!0)},o:function(c){X(e.$$.fragment,c),i=!1},d:function(c){c&&h(t),ue(e)}};return ee("SvelteRegisterBlock",{block:s,id:fo.name,type:"slot",source:'(2891:8) <Card class=\\"main-card bottom-action-card\\">',ctx:r}),s}function mo(r){let t,e,i="‚ö° ÈÄ£Á∂ö„ÉÅ„É£„É¨„É≥„Ç∏„É¢„Éº„Éâ",s,n,c="‰∏≠Á¥öËÄÖÂêë„ÅëÔºö8„Çª„ÉÉ„Ç∑„Éß„É≥ÈÄ£Á∂ö„ÅßÂü∫Èü≥„ÅåËá™ÂãïÂÜçÁîü„Åï„Çå„ÇãÈõÜ‰∏≠„Éà„É¨„Éº„Éã„É≥„Ç∞",a,u,f,d,m,v,D,p,y,_,L,k,w,j,B,Q,A=r[1]==="granted"&&!r[25]&&Pt(r);const b=[Wn,Un],K=[];function T(x,F){return x[1]==="granted"?0:1}w=T(r),j=K[w]=b[w](r);const q={c:function(){t=N("div"),e=N("h1"),e.textContent=i,s=$(),n=N("p"),n.textContent=c,a=$(),A&&A.c(),u=$(),f=N("div"),d=J("üì± "),m=J(Jt),v=J(" | "),D=J(Kt),p=N("br"),y=$(),_=N("small"),L=J(Qt),k=$(),j.c(),B=Le(),this.h()},l:function(F){t=M(F,"DIV",{class:!0});var H=z(t);e=M(H,"H1",{class:!0,"data-svelte-h":!0}),pe(e)!=="svelte-1nub9gt"&&(e.textContent=i),s=Z(H),n=M(H,"P",{class:!0,"data-svelte-h":!0}),pe(n)!=="svelte-gneggn"&&(n.textContent=c),a=Z(H),A&&A.l(H),u=Z(H),f=M(H,"DIV",{class:!0});var E=z(f);d=W(E,"üì± "),m=W(E,Jt),v=W(E," | "),D=W(E,Kt),p=M(E,"BR",{}),y=Z(E),_=M(E,"SMALL",{style:!0});var Y=z(_);L=W(Y,Qt),Y.forEach(h),E.forEach(h),H.forEach(h),k=Z(F),j.l(F),B=Le(),this.h()},h:function(){P(e,"class","page-title svelte-rt5px1"),R(e,I,2650,4,90071),P(n,"class","page-description svelte-rt5px1"),R(n,I,2651,4,90116),R(p,I,2685,42,91340),Qe(_,"font-size","0.6rem"),R(_,I,2686,6,91352),P(f,"class","debug-info svelte-rt5px1"),R(f,I,2684,4,91273),P(t,"class","header-section svelte-rt5px1"),R(t,I,2649,2,90038)},m:function(F,H){O(F,t,H),g(t,e),g(t,s),g(t,n),g(t,a),A&&A.m(t,null),g(t,u),g(t,f),g(f,d),g(f,m),g(f,v),g(f,D),g(f,p),g(f,y),g(f,_),g(_,L),O(F,k,H),K[w].m(F,H),O(F,B,H),Q=!0},p:function(F,H){F[1]==="granted"&&!F[25]?A?(A.p(F,H),H[0]&33554434&&U(A,1)):(A=Pt(F),A.c(),U(A,1),A.m(t,u)):A&&(Ae(),X(A,1,1,()=>{A=null}),Te());let E=w;w=T(F),w===E?K[w].p(F,H):(Ae(),X(K[E],1,1,()=>{K[E]=null}),Te(),j=K[w],j?j.p(F,H):(j=K[w]=b[w](F),j.c()),U(j,1),j.m(B.parentNode,B))},i:function(F){Q||(U(A),U(j),Q=!0)},o:function(F){X(A),X(j),Q=!1},d:function(F){F&&(h(t),h(k),h(B)),A&&A.d(),K[w].d(F)}};return ee("SvelteRegisterBlock",{block:q,id:mo.name,type:"slot",source:"(2648:0) <PageLayout>",ctx:r}),q}function Wt(r){let t,e,i;e=new Ln({props:{$$slots:{default:[mo]},$$scope:{ctx:r}},$$inline:!0});const s={c:function(){t=$(),me(e.$$.fragment),this.h()},l:function(c){ko("svelte-13kpo59",An.head).forEach(h),t=Z(c),de(e.$$.fragment,c),this.h()},h:function(){An.title="ÈÄ£Á∂ö„ÉÅ„É£„É¨„É≥„Ç∏„É¢„Éº„Éâ - Áõ∏ÂØæÈü≥ÊÑü„Éà„É¨„Éº„Éã„É≥„Ç∞"},m:function(c,a){O(c,t,a),fe(e,c,a),i=!0},p:function(c,a){const u={};a[0]&67108863|a[3]&4096&&(u.$$scope={dirty:a,ctx:c}),e.$set(u)},i:function(c){i||(U(e.$$.fragment,c),i=!0)},o:function(c){X(e.$$.fragment,c),i=!1},d:function(c){c&&h(t),ue(e,c)}};return ee("SvelteRegisterBlock",{block:s,id:Wt.name,type:"component",source:"",ctx:r}),s}const Jt="v2.3.1-ANIMATED",Kt="07/29 04:15",Qt="üé¨ Ë©ï‰æ°ÂàÜÂ∏É„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥ÂÆüË£Ö„ÉªUXÂêë‰∏ä";function Pn(){const r=/iPhone/.test(navigator.userAgent),t=/iPad/.test(navigator.userAgent),e=/Macintosh/.test(navigator.userAgent)&&"ontouchend"in document;return r||t||e?(console.log("üîä [RandomTraining] iOS/iPadOSÊ§úÂá∫ - Èü≥Èáè35dBË®≠ÂÆö"),35):(console.log("üîä [RandomTraining] PCÊ§úÂá∫ - Èü≥Èáè-6dBË®≠ÂÆö"),-6)}function Xo(){return{mode:"continuous",timestamp:new Date,duration:480,totalNotes:64,measuredNotes:59,averageAccuracy:79,baseNote:"C5",baseFrequency:523.25,sessionHistory:[{grade:"excellent",accuracy:92,baseNote:"C4",baseFrequency:261.63,timestamp:new Date(Date.now()-7*6e4),measuredNotes:8,noteResults:[{name:"„Éâ",note:"„Éâ",frequency:262,detectedFrequency:264,cents:13,grade:"excellent"},{name:"„É¨",note:"„É¨",frequency:294,detectedFrequency:291,cents:-18,grade:"good"},{name:"„Éü",note:"„Éü",frequency:330,detectedFrequency:335,cents:26,grade:"pass"},{name:"„Éï„Ç°",note:"„Éï„Ç°",frequency:349,detectedFrequency:346,cents:-15,grade:"excellent"},{name:"„ÇΩ",note:"„ÇΩ",frequency:392,detectedFrequency:388,cents:-18,grade:"good"},{name:"„É©",note:"„É©",frequency:440,detectedFrequency:444,cents:16,grade:"good"},{name:"„Ç∑",note:"„Ç∑",frequency:494,detectedFrequency:499,cents:17,grade:"good"},{name:"„ÉâÔºàÈ´òÔºâ",note:"„ÉâÔºàÈ´òÔºâ",frequency:523,detectedFrequency:520,cents:-10,grade:"excellent"}]},{grade:"good",accuracy:78,baseNote:"D4",baseFrequency:293.66,timestamp:new Date(Date.now()-6*6e4),measuredNotes:7,noteResults:[{name:"„Éâ",note:"„Éâ",frequency:294,detectedFrequency:290,cents:-23,grade:"good"},{name:"„É¨",note:"„É¨",frequency:330,detectedFrequency:340,cents:53,grade:"needWork"},{name:"„Éü",note:"„Éü",frequency:370,detectedFrequency:375,cents:23,grade:"good"},{name:"„Éï„Ç°",note:"„Éï„Ç°",frequency:392,detectedFrequency:385,cents:-31,grade:"pass"},{name:"„ÇΩ",note:"„ÇΩ",frequency:440,detectedFrequency:432,cents:-31,grade:"pass"},{name:"„É©",note:"„É©",frequency:494,detectedFrequency:510,cents:56,grade:"needWork"},{name:"„Ç∑",note:"„Ç∑",frequency:554,detectedFrequency:null,cents:null,grade:"notMeasured"},{name:"„ÉâÔºàÈ´òÔºâ",note:"„ÉâÔºàÈ´òÔºâ",frequency:587,detectedFrequency:580,cents:-21,grade:"good"}]},{grade:"excellent",accuracy:95,baseNote:"E4",baseFrequency:329.63,timestamp:new Date(Date.now()-5*6e4),measuredNotes:8,noteResults:[{name:"„Éâ",note:"„Éâ",frequency:330,detectedFrequency:332,cents:10,grade:"excellent"},{name:"„É¨",note:"„É¨",frequency:370,detectedFrequency:368,cents:-9,grade:"excellent"},{name:"„Éü",note:"„Éü",frequency:415,detectedFrequency:418,cents:12,grade:"excellent"},{name:"„Éï„Ç°",note:"„Éï„Ç°",frequency:440,detectedFrequency:436,cents:-16,grade:"good"},{name:"„ÇΩ",note:"„ÇΩ",frequency:494,detectedFrequency:497,cents:11,grade:"excellent"},{name:"„É©",note:"„É©",frequency:554,detectedFrequency:551,cents:-9,grade:"excellent"},{name:"„Ç∑",note:"„Ç∑",frequency:622,detectedFrequency:625,cents:8,grade:"excellent"},{name:"„ÉâÔºàÈ´òÔºâ",note:"„ÉâÔºàÈ´òÔºâ",frequency:659,detectedFrequency:655,cents:-10,grade:"excellent"}]},{grade:"needWork",accuracy:45,baseNote:"F4",baseFrequency:349.23,timestamp:new Date(Date.now()-4*6e4),measuredNotes:6,noteResults:[{name:"„Éâ",note:"„Éâ",frequency:349,detectedFrequency:345,cents:-20,grade:"good"},{name:"„É¨",note:"„É¨",frequency:392,detectedFrequency:420,cents:124,grade:"needWork"},{name:"„Éü",note:"„Éü",frequency:440,detectedFrequency:435,cents:-20,grade:"good"},{name:"„Éï„Ç°",note:"„Éï„Ç°",frequency:466,detectedFrequency:520,cents:195,grade:"needWork"},{name:"„ÇΩ",note:"„ÇΩ",frequency:523,detectedFrequency:410,cents:-455,grade:"needWork"},{name:"„É©",note:"„É©",frequency:587,detectedFrequency:null,cents:null,grade:"notMeasured"},{name:"„Ç∑",note:"„Ç∑",frequency:659,detectedFrequency:650,cents:-24,grade:"good"},{name:"„ÉâÔºàÈ´òÔºâ",note:"„ÉâÔºàÈ´òÔºâ",frequency:698,detectedFrequency:null,cents:null,grade:"notMeasured"}]},{grade:"good",accuracy:85,baseNote:"G4",baseFrequency:392,timestamp:new Date(Date.now()-3*6e4),measuredNotes:8,noteResults:[{name:"„Éâ",note:"„Éâ",frequency:392,detectedFrequency:395,cents:13,grade:"excellent"},{name:"„É¨",note:"„É¨",frequency:440,detectedFrequency:438,cents:-8,grade:"excellent"},{name:"„Éü",note:"„Éü",frequency:494,detectedFrequency:500,cents:21,grade:"good"},{name:"„Éï„Ç°",note:"„Éï„Ç°",frequency:523,detectedFrequency:520,cents:-10,grade:"excellent"},{name:"„ÇΩ",note:"„ÇΩ",frequency:587,detectedFrequency:595,cents:24,grade:"good"},{name:"„É©",note:"„É©",frequency:659,detectedFrequency:665,cents:16,grade:"good"},{name:"„Ç∑",note:"„Ç∑",frequency:740,detectedFrequency:755,cents:35,grade:"pass"},{name:"„ÉâÔºàÈ´òÔºâ",note:"„ÉâÔºàÈ´òÔºâ",frequency:784,detectedFrequency:780,cents:-9,grade:"excellent"}]},{grade:"excellent",accuracy:94,baseNote:"A4",baseFrequency:440,timestamp:new Date(Date.now()-2*6e4),measuredNotes:8,noteResults:[{name:"„Éâ",note:"„Éâ",frequency:440,detectedFrequency:442,cents:8,grade:"excellent"},{name:"„É¨",note:"„É¨",frequency:494,detectedFrequency:492,cents:-7,grade:"excellent"},{name:"„Éü",note:"„Éü",frequency:554,detectedFrequency:558,cents:12,grade:"excellent"},{name:"„Éï„Ç°",note:"„Éï„Ç°",frequency:587,detectedFrequency:585,cents:-6,grade:"excellent"},{name:"„ÇΩ",note:"„ÇΩ",frequency:659,detectedFrequency:665,cents:16,grade:"good"},{name:"„É©",note:"„É©",frequency:740,detectedFrequency:738,cents:-5,grade:"excellent"},{name:"„Ç∑",note:"„Ç∑",frequency:831,detectedFrequency:840,cents:19,grade:"good"},{name:"„ÉâÔºàÈ´òÔºâ",note:"„ÉâÔºàÈ´òÔºâ",frequency:880,detectedFrequency:882,cents:4,grade:"excellent"}]},{grade:"pass",accuracy:68,baseNote:"Bb4",baseFrequency:466.16,timestamp:new Date(Date.now()-1*6e4),measuredNotes:7,noteResults:[{name:"„Éâ",note:"„Éâ",frequency:466,detectedFrequency:470,cents:15,grade:"excellent"},{name:"„É¨",note:"„É¨",frequency:523,detectedFrequency:535,cents:39,grade:"pass"},{name:"„Éü",note:"„Éü",frequency:587,detectedFrequency:600,cents:38,grade:"pass"},{name:"„Éï„Ç°",note:"„Éï„Ç°",frequency:622,detectedFrequency:615,cents:-19,grade:"good"},{name:"„ÇΩ",note:"„ÇΩ",frequency:698,detectedFrequency:720,cents:54,grade:"needWork"},{name:"„É©",note:"„É©",frequency:784,detectedFrequency:null,cents:null,grade:"notMeasured"},{name:"„Ç∑",note:"„Ç∑",frequency:880,detectedFrequency:895,cents:29,grade:"pass"},{name:"„ÉâÔºàÈ´òÔºâ",note:"„ÉâÔºàÈ´òÔºâ",frequency:932,detectedFrequency:925,cents:-13,grade:"excellent"}]},{grade:"good",accuracy:82,baseNote:"C5",baseFrequency:523.25,timestamp:new Date,measuredNotes:8,noteResults:[{name:"„Éâ",note:"„Éâ",frequency:523,detectedFrequency:526,cents:10,grade:"excellent"},{name:"„É¨",note:"„É¨",frequency:587,detectedFrequency:584,cents:-9,grade:"excellent"},{name:"„Éü",note:"„Éü",frequency:659,detectedFrequency:665,cents:16,grade:"good"},{name:"„Éï„Ç°",note:"„Éï„Ç°",frequency:698,detectedFrequency:692,cents:-15,grade:"excellent"},{name:"„ÇΩ",note:"„ÇΩ",frequency:784,detectedFrequency:795,cents:24,grade:"good"},{name:"„É©",note:"„É©",frequency:880,detectedFrequency:890,cents:19,grade:"good"},{name:"„Ç∑",note:"„Ç∑",frequency:988,detectedFrequency:1010,cents:38,grade:"pass"},{name:"„ÉâÔºàÈ´òÔºâ",note:"„ÉâÔºàÈ´òÔºâ",frequency:1047,detectedFrequency:1042,cents:-8,grade:"excellent"}]}]}}function At(r){return[{scale:"„Éâ",interval:"unison",intervalName:"„É¶„Éã„Çæ„É≥"},{scale:"„É¨",interval:"major_second",intervalName:"Èï∑2Â∫¶"},{scale:"„Éü",interval:"major_third",intervalName:"Èï∑3Â∫¶"},{scale:"„Éï„Ç°",interval:"perfect_fourth",intervalName:"ÂÆåÂÖ®4Â∫¶"},{scale:"„ÇΩ",interval:"perfect_fifth",intervalName:"ÂÆåÂÖ®5Â∫¶"},{scale:"„É©",interval:"major_sixth",intervalName:"Èï∑6Â∫¶"},{scale:"„Ç∑",interval:"major_seventh",intervalName:"Èï∑7Â∫¶"},{scale:"„ÉâÔºàÈ´òÔºâ",interval:"octave",intervalName:"„Ç™„ÇØ„Çø„Éº„Éñ"}].map((e,i)=>{const s=r.find(n=>n.targetNote&&n.targetNote.includes(e.scale))||r[i];if(s&&s.accuracy!=="notMeasured"){const n=parseFloat(s.accuracy)||0,c=Math.round((100-n)*.5);return{type:e.interval,scale:e.scale,intervalName:e.intervalName,attempts:1,averageError:c,accuracy:n}}else return{type:e.interval,scale:e.scale,intervalName:e.intervalName,attempts:0,averageError:null,accuracy:0}})}function Bn(r){if(!r||!Array.isArray(r))return console.warn("‚ö†Ô∏è [RandomTraining] sessionHistory „ÅåÁÑ°Âäπ„Åß„Åô"),[];const t=[{type:"unison",scale:"„Éâ",intervalName:"„É¶„Éã„Çæ„É≥",noteIndex:0},{type:"major_second",scale:"„É¨",intervalName:"Èï∑2Â∫¶",noteIndex:1},{type:"major_third",scale:"„Éü",intervalName:"Èï∑3Â∫¶",noteIndex:2},{type:"perfect_fourth",scale:"„Éï„Ç°",intervalName:"ÂÆåÂÖ®4Â∫¶",noteIndex:3},{type:"perfect_fifth",scale:"„ÇΩ",intervalName:"ÂÆåÂÖ®5Â∫¶",noteIndex:4},{type:"major_sixth",scale:"„É©",intervalName:"Èï∑6Â∫¶",noteIndex:5},{type:"major_seventh",scale:"„Ç∑",intervalName:"Èï∑7Â∫¶",noteIndex:6},{type:"octave",scale:"„ÉâÔºàÈ´òÔºâ",intervalName:"„Ç™„ÇØ„Çø„Éº„Éñ",noteIndex:7}],e={};return t.forEach(i=>{e[i.type]={type:i.type,scale:i.scale,intervalName:i.intervalName,attempts:0,successCount:0,accuracySum:0,accuracyValues:[],errorValues:[]}}),r.forEach(i=>{!i.noteResults||!Array.isArray(i.noteResults)||i.noteResults.forEach((s,n)=>{if(n>=t.length)return;const c=t[n].type,a=e[c];if(a.attempts++,s.accuracy!=="notMeasured"&&typeof s.accuracy=="number"){a.accuracyValues.push(s.accuracy),a.accuracySum+=s.accuracy;const u=Math.round((100-s.accuracy)*.5);a.errorValues.push(u),s.accuracy>=70&&a.successCount++}})}),t.map(i=>{const s=e[i.type];if(s.attempts===0)return{type:i.type,scale:i.scale,intervalName:i.intervalName,attempts:0,averageError:null,accuracy:0};const n=s.accuracyValues.length>0?Math.round(s.accuracySum/s.accuracyValues.length):0,c=s.errorValues.length>0?Math.round(s.errorValues.reduce((u,f)=>u+f,0)/s.errorValues.length):null,a=s.accuracyValues.length>0?Math.round(s.successCount/s.accuracyValues.length*100):0;return{type:i.type,scale:i.scale,intervalName:i.intervalName,mastery:a,attempts:s.attempts,averageError:c,accuracy:n}})}function xn(r){const t=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];if(r<=0)return"„Éº„Éº";const i=Math.round(12*Math.log2(r/440)),s=(i+9+120)%12,n=Math.floor((i+9)/12)+4;return t[s]+n}function Tt(r,t){const e=[{factor:4,freq:r*4,description:"2„Ç™„ÇØ„Çø„Éº„Éñ‰∏ä"},{factor:3,freq:r*3,description:"1.5„Ç™„ÇØ„Çø„Éº„Éñ‰∏ä"},{factor:2.5,freq:r*2.5,description:"1.3„Ç™„ÇØ„Çø„Éº„Éñ‰∏ä"},{factor:2,freq:r*2,description:"1„Ç™„ÇØ„Çø„Éº„Éñ‰∏ä"},{factor:1.5,freq:r*1.5,description:"0.5„Ç™„ÇØ„Çø„Éº„Éñ‰∏ä"},{factor:1,freq:r,description:"Ë£úÊ≠£„Å™„Åó"},{factor:.75,freq:r*.75,description:"0.33„Ç™„ÇØ„Çø„Éº„Éñ‰∏ã"},{factor:.67,freq:r*.67,description:"0.5„Ç™„ÇØ„Çø„Éº„Éñ‰∏ã"},{factor:.5,freq:r*.5,description:"1„Ç™„ÇØ„Çø„Éº„Éñ‰∏ã"},{factor:.4,freq:r*.4,description:"1.3„Ç™„ÇØ„Çø„Éº„Éñ‰∏ã"},{factor:.33,freq:r*.33,description:"1.5„Ç™„ÇØ„Çø„Éº„Éñ‰∏ã"},{factor:.25,freq:r*.25,description:"2„Ç™„ÇØ„Çø„Éº„Éñ‰∏ã"}];let i=null,s=1/0;const n=t*.5,c=t*1.5,a=e.filter(u=>u.freq>=n&&u.freq<=c);for(const u of a){const f=Math.abs(u.freq-t);f<s&&(s=f,i=u)}if(!i)for(const u of e){const f=Math.abs(u.freq-t);f<s&&(s=f,i=u)}return i?{correctedFrequency:i.freq,factor:i.factor,description:i.description,error:s}:{correctedFrequency:r,factor:1,description:"Ë£úÊ≠£„Å™„ÅóÔºà„Éï„Ç©„Éº„É´„Éê„ÉÉ„ÇØÔºâ",error:Math.abs(r-t)}}function ot(){try{"scrollTo"in window&&"behavior"in document.documentElement.style?window.scrollTo({top:0,behavior:"smooth"}):window.scrollTo(0,0),document.body&&(document.body.scrollTop=0),document.documentElement&&(document.documentElement.scrollTop=0),document.querySelectorAll("[data-scroll-container], .scroll-container, main").forEach(t=>{t.scrollTo?t.scrollTo(0,0):t.scrollTop=0})}catch(r){console.warn("„Çπ„ÇØ„É≠„Éº„É´„Ç®„É©„Éº:",r);try{window.scroll(0,0)}catch(t){console.error("„Çπ„ÇØ„É≠„Éº„É´ÂÆåÂÖ®Â§±Êïó:",t)}}}function go(r){}const Hn=(r,t)=>{var e;return{index:t,sessionId:r.sessionId,baseNote:r.baseNote,hasNoteResults:!!r.noteResults,noteResultsLength:((e=r.noteResults)==null?void 0:e.length)||0,accuracy:r.accuracy}},Vn=(r,t)=>{var e;return{index:t,sessionId:r.sessionId,baseNote:r.baseNote,hasNoteResults:!!r.noteResults,noteResultsLength:((e=r.noteResults)==null?void 0:e.length)||0,accuracy:r.accuracy}};function Yo(r,t,e){let i,s,n,c,a,u,f,d,m,v,D,p;Ne(Mt,"currentSessionId"),Ie(r,Mt,o=>e(23,n=o)),Ne(Dt,"unifiedScoreData"),Ie(r,Dt,o=>e(4,c=o)),Ne(Ct,"isCompleted"),Ie(r,Ct,o=>e(5,a=o)),Ne(_t,"page"),Ie(r,_t,o=>e(54,u=o)),Ne(qt,"remainingSessions"),Ie(r,qt,o=>e(55,f=o)),Ne(Ft,"nextBaseName"),Ie(r,Ft,o=>e(56,d=o)),Ne(Rt,"nextBaseNote"),Ie(r,Rt,o=>e(57,m=o)),Ne(wt,"sessionHistory"),Ie(r,wt,o=>e(24,v=o)),Ne(Nt,"trainingProgress"),Ie(r,Nt,o=>e(58,D=o)),Ne(kt,"isLoading"),Ie(r,kt,o=>e(25,p=o));let{$$slots:y={},$$scope:_}=t;Co("Page",y,[]);function L(o){return nt.evaluateOverall(o)}let k="setup",w=typeof window<"u"?new URLSearchParams(window.location.search).get("from")==="microphone-test"?(ce.info("[RandomTraining] „Éû„Ç§„ÇØ„ÉÜ„Çπ„Éà„Éö„Éº„Ç∏„Åã„Çâ„ÅÆÈÅ∑Áßª„ÇíÊ§úÂá∫"),"granted"):(ce.info("[RandomTraining] „ÉÄ„Ç§„É¨„ÇØ„Éà„Ç¢„ÇØ„Çª„Çπ„ÇíÊ§úÂá∫"),"checking"):"checking",j=!0,B=[];const Q=["„Éâ","„É¨","„Éü","„Éï„Ç°","„ÇΩ","„É©","„Ç∑","„ÉâÔºàÈ´òÔºâ"];let A="",b=0,K=!1,T=0,q=Q.map(o=>({name:o,state:"inactive",completed:!1})),x=null,F=!1,H=0,E=!1,Y=null,ye=!1,se=[],_e=[],Se=0,Ee=0,je="„Éº„Éº",He=0,Ve={correctCount:0,totalCount:8,averageAccuracy:0,averageTime:0,isCompleted:!1},Ce=null,ze={totalScore:0,grade:"C",componentScores:{pitchAccuracy:0,recognitionSpeed:0,intervalMastery:0,directionAccuracy:0,consistency:0}},ke=[],Pe=[],Oe={},Xe={},Fe={totalAttempts:0,successRate:0,averageScore:0,bestScore:0,sessionDuration:0,streakCount:0,fatigueLevel:"fresh",mostDifficultInterval:"-",mostSuccessfulInterval:"-",averageResponseTime:0,sessionStart:Date.now()},ft="intervals",re=[],le=null,ge=null,Re=!0,te=null,Be=null,st=null,rt=null,Ke=null;const Ge=[{note:"C4",name:"„ÉâÔºà‰∏≠Ôºâ",frequency:261.63,semitonesFromC:0},{note:"Db4",name:"„Éâ#Ôºà‰∏≠Ôºâ",frequency:277.18,semitonesFromC:1},{note:"D4",name:"„É¨Ôºà‰∏≠Ôºâ",frequency:293.66,semitonesFromC:2},{note:"Eb4",name:"„É¨#Ôºà‰∏≠Ôºâ",frequency:311.13,semitonesFromC:3},{note:"E4",name:"„ÉüÔºà‰∏≠Ôºâ",frequency:329.63,semitonesFromC:4},{note:"F4",name:"„Éï„Ç°Ôºà‰∏≠Ôºâ",frequency:349.23,semitonesFromC:5},{note:"Gb4",name:"„Éï„Ç°#Ôºà‰∏≠Ôºâ",frequency:369.99,semitonesFromC:6},{note:"Ab4",name:"„É©bÔºà‰∏≠Ôºâ",frequency:415.3,semitonesFromC:8},{note:"Bb3",name:"„Ç∑bÔºà‰ΩéÔºâ",frequency:233.08,semitonesFromC:-2},{note:"B3",name:"„Ç∑Ôºà‰ΩéÔºâ",frequency:246.94,semitonesFromC:-1}];async function Ue(){var o;e(1,w="checking");try{if(console.log("üé§ [RandomTraining] AudioManagerÁµåÁî±„Åß„Éû„Ç§„ÇØË®±ÂèØÁ¢∫Ë™çÈñãÂßã"),!((o=navigator.mediaDevices)!=null&&o.getUserMedia)){e(1,w="error");return}const l=await We.initialize();st=l.audioContext,Be=l.mediaStream,rt=l.sourceNode,console.log("‚úÖ [RandomTraining] AudioManager „É™„ÇΩ„Éº„ÇπÂèñÂæóÂÆå‰∫Ü"),e(1,w="granted"),e(0,k="setup"),setTimeout(async()=>{if(te){ce.audio("[RandomTraining] PitchDetectorÂàùÊúüÂåñÈñãÂßã");const S=/iPhone/.test(navigator.userAgent),C=/iPad/.test(navigator.userAgent),V=/Macintosh/.test(navigator.userAgent)&&"ontouchend"in document;(C||V)&&(console.log("üîß [RandomTraining] iPadÊ§úÂá∫ - „Éû„Ç§„ÇØÊÑüÂ∫¶7.0xËá™ÂãïË®≠ÂÆöÈñãÂßã"),We.setSensitivity(7),console.log("‚úÖ [RandomTraining] iPad „Éû„Ç§„ÇØÊÑüÂ∫¶7.0xËá™ÂãïË®≠ÂÆöÂÆå‰∫Ü"));try{console.log("üé§ [RandomTraining] AudioManagerÂÜçÂàùÊúüÂåñÈñãÂßãÔºàiPadÂØæÂøúÔºâ"),await We.initialize(),console.log("‚úÖ [RandomTraining] AudioManagerÂÜçÂàùÊúüÂåñÂÆå‰∫Ü")}catch(G){console.warn("‚ö†Ô∏è AudioManagerÂÜçÂàùÊúüÂåñ„Ç®„É©„Éº:",G)}await te.initialize(),ce.audio("[RandomTraining] PitchDetectorÂàùÊúüÂåñÂÆå‰∫Ü")}},200)}catch(l){ce.error("[RandomTraining] „Éû„Ç§„ÇØË®±ÂèØ„Ç®„É©„Éº:",l),e(1,w=(l==null?void 0:l.name)==="NotAllowedError"?"denied":"error")}}function dt(){const o=m,l=d,S=Ge.find(C=>C.note===o)||Ge.find(C=>C.name===l)||Ge[0];if(e(7,A=S.name),e(8,b=S.frequency),ce.info(`[BaseNote] Âü∫Èü≥Ë®≠ÂÆöÔºàlocalStorageÈÄ£Êê∫Ôºâ: ${A} = ${b}Hz`),ce.info(`[BaseNote] localStorageÂü∫Èü≥ÊÉÖÂ†±: note=${o}, name=${l}`),!b||b<=0)throw ce.error("[BaseNote] Âü∫Èü≥Âë®Ê≥¢Êï∞Ë®≠ÂÆö„Ç®„É©„Éº:",S),new Error(`Invalid base frequency: ${b}`)}async function Zt(){if(K||!ge||Re)return;if(w!=="granted"){console.log("üé§ [RandomTraining] „Éû„Ç§„ÇØË®±ÂèØ„ÅåÂøÖË¶Å„Åß„Åô„ÄÇË®±ÂèØÂèñÂæó„ÇíÈñãÂßã...");try{await Ue(),console.log("üé§ [RandomTraining] „Éû„Ç§„ÇØË®±ÂèØÂèñÂæóÂÆå‰∫Ü")}catch(l){console.error("‚ùå „Éû„Ç§„ÇØË®±ÂèØ„Ç®„É©„Éº:",l);return}}if(!Be&&w==="granted"){console.log("üé§ [RandomTraining] AudioManager„É™„ÇΩ„Éº„ÇπÊú™ÂàùÊúüÂåñ„ÅÆ„Åü„ÇÅÂèñÂæó„Åó„Åæ„Åô");try{await Ue()}catch(l){console.error("‚ùå AudioManager„É™„ÇΩ„Éº„ÇπÂàùÊúüÂåñ„Ç®„É©„Éº:",l);return}}else Be&&console.log("üé§ [RandomTraining] AudioManager„É™„ÇΩ„Éº„ÇπÊó¢Â≠ò„ÅÆ„Åü„ÇÅÂÜçÂà©Áî®");e(9,K=!0),e(0,k="listening"),Ke=Date.now(),dt();const o=Ge.find(l=>l.name===A).note;ge.triggerAttackRelease(o,2,It(),.7),setTimeout(()=>{e(9,K=!1),e(0,k="waiting"),setTimeout(()=>gt(),500)},2e3)}async function $t(){if(K||!ge||p||!A)return;if(w!=="granted"){console.log("üé§ [RandomTraining] „Éû„Ç§„ÇØË®±ÂèØ„ÅåÂøÖË¶Å„Åß„Åô„ÄÇË®±ÂèØÂèñÂæó„ÇíÈñãÂßã...");try{await Ue(),console.log("üé§ [RandomTraining] „Éû„Ç§„ÇØË®±ÂèØÂèñÂæóÂÆå‰∫Ü")}catch(l){console.error("‚ùå „Éû„Ç§„ÇØË®±ÂèØ„Ç®„É©„Éº:",l);return}}if(!Be&&w==="granted"){console.log("üé§ [RandomTraining] AudioManager„É™„ÇΩ„Éº„ÇπÊú™ÂàùÊúüÂåñ„ÅÆ„Åü„ÇÅÂèñÂæó„Åó„Åæ„Åô");try{await Ue()}catch(l){console.error("‚ùå AudioManager„É™„ÇΩ„Éº„ÇπÂàùÊúüÂåñ„Ç®„É©„Éº:",l);return}}else Be&&console.log("üé§ [RandomTraining] AudioManager„É™„ÇΩ„Éº„ÇπÊó¢Â≠ò„ÅÆ„Åü„ÇÅÂÜçÂà©Áî®");if(e(9,K=!0),e(0,k="listening"),Ke=Date.now(),typeof window<"u"&&window.Tone){const l=window.Tone.context||window.Tone.getContext();l&&l.state==="suspended"&&(console.log("üîÑ [RandomTraining] AudioContext suspendedÊ§úÂá∫ - ÂÜçÈñã‰∏≠..."),await l.resume(),console.log("‚úÖ [RandomTraining] AudioContextÂÜçÈñãÂÆå‰∫Ü"))}const o=Ge.find(l=>l.name===A).note;ge.triggerAttackRelease(o,2,It(),.7),setTimeout(()=>{e(9,K=!1),e(0,k="waiting"),setTimeout(()=>gt(),500)},2e3)}async function yo(){if(K||!ge||p||!A){console.log("üîÑ [BaseNoteOnly] ÂÜçÁîüÊù°‰ª∂Êú™Ê∫Ä: isPlaying:",K,"sampler:",!!ge,"isLoading:",p,"currentBaseNote:",A);return}if(console.log("üéµ [BaseNoteOnly] Âü∫Èü≥„ÅÆ„ÅøÂÜçÁîüÈñãÂßã:",A),typeof window<"u"&&window.Tone){const l=window.Tone.context||window.Tone.getContext();l&&l.state==="suspended"&&(console.log("üîÑ [BaseNoteOnly] AudioContext suspendedÊ§úÂá∫ - ÂÜçÈñã‰∏≠..."),await l.resume(),console.log("‚úÖ [BaseNoteOnly] AudioContextÂÜçÈñãÂÆå‰∫Ü"))}const o=Ge.find(l=>l.name===A).note;ge.triggerAttackRelease(o,1.5,It(),.7),console.log("üéµ [BaseNoteOnly] Âü∫Èü≥ÂÜçÁîüÂÆå‰∫Ü:",o)}function mt(){A&&b>0?$t():Zt(),en()}function en(){Y&&clearInterval(Y),e(11,H=0),E=!0,e(12,ye=!1),console.log("üéµ [GuideStartBar] „Ç¨„Ç§„Éâ„Çπ„Çø„Éº„Éà„Éê„ÉºÈñãÂßã"),Y=setInterval(()=>{e(11,H+=2.5),H>=100&&(e(11,H=100),e(12,ye=!0),console.log("üéµ [GuideStartBar] „Ç¨„Ç§„ÉâÈñãÂßã„Çø„Ç§„Éü„É≥„Ç∞ÔºÅ"),setTimeout(()=>{E=!1,e(12,ye=!1),e(11,H=0)},800),clearInterval(Y),Y=null)},50)}function ho(){Y&&(clearInterval(Y),Y=null),E=!1,e(12,ye=!1),e(11,H=0)}function Ye(o,l){const C=[0,2,4,5,7,9,11,12][l],V=o*Math.pow(2,C/12);return ce.debug(`[calculateExpectedFrequency] ${q[l].name}: Âü∫Èü≥${o.toFixed(1)}Hz + ${C}ÂçäÈü≥ = ${V.toFixed(1)}Hz`),V}function tn(o,l){return Ye(o,l)}function gt(){e(0,k="guiding"),T=0,F=!0,se=[],console.log(`üé¨ „Ç¨„Ç§„ÉâÈñãÂßã: ${A} (${b.toFixed(1)}Hz)`);function o(){if(T<q.length){T>0&&e(10,q[T-1].state="inactive",q),e(10,q[T].state="active",q);const l=tn(b,T);St.setScaleContext({baseFrequency:b,currentScale:q[T].name,targetFrequency:l}),console.log(`üéµ [Scale] Âü∫Èü≥:${A}(${b.toFixed(0)}Hz) ÁèæÂú®:${q[T].name} ÁõÆÊ®ô:${l.toFixed(0)}Hz`),T>=4&&console.log(`üîç [„Éá„Éê„ÉÉ„Ç∞] Step ${T}: currentBaseFrequency=${b}, currentBaseNote='${A}'`),T++,x=setTimeout(()=>{o()},600)}else nn()}o()}function nn(){F=!1,console.log(`üèÅ „Ç¨„Ç§„ÉâÂÆå‰∫Ü: ${se.length}/${q.length}„Çπ„ÉÜ„ÉÉ„ÉóË©ï‰æ°`),q.length>0&&e(10,q[q.length-1].state="inactive",q),te&&te.stopDetection(),St.clearContext(),on(),ln(),vn(),re=Q.map(o=>{const l=se.find(S=>S.stepName===o);return l?{name:l.stepName,cents:l.adjustedFrequency?Math.round(l.centDifference):null,targetFreq:l.expectedFrequency,detectedFreq:l.adjustedFrequency||null,diff:l.adjustedFrequency?l.adjustedFrequency-l.expectedFrequency:null,accuracy:l.accuracy}:{name:o,cents:null,targetFreq:null,detectedFreq:null,diff:null,accuracy:"notMeasured"}}),fn(),mn(),e(0,k="results")}function on(){let o=0,l=0;se.forEach((V,G)=>{V.isCorrect&&o++,l+=V.accuracy});const S=se.length>0?Math.round(l/se.length):0,C=Math.round(o/q.length*100);Ve={correctCount:o,totalCount:q.length,averageAccuracy:S,averageTime:0,isCompleted:!0},console.log(`üéØ ÁµêÊûú: ${o}/${q.length}Ê≠£Ëß£ (${C}%) Âπ≥ÂùáÁ≤æÂ∫¶${S}%`),se.length>0&&(_e=[...se])}function po(){switch(k){case"setup":return Re||!ge?"üéµ Èü≥Ê∫êË™≠„ÅøËæº„Åø‰∏≠...":"üé§ „Éû„Ç§„ÇØÊ∫ñÂÇôÂÆå‰∫Ü - „Éà„É¨„Éº„Éã„É≥„Ç∞ÈñãÂßãÂèØËÉΩ";case"listening":return"üéµ Âü∫Èü≥ÂÜçÁîü‰∏≠...";case"waiting":return"‚è≥ Èñì„ÇÇ„Å™„ÅèÈñãÂßã...";case"guiding":return"üéôÔ∏è „Ç¨„Ç§„Éâ„Å´Âêà„Çè„Åõ„Å¶„Éâ„É¨„Éü„Éï„Ç°„ÇΩ„É©„Ç∑„Éâ„ÇíÊ≠å„Å£„Å¶„Åè„Å†„Åï„ÅÑ";case"results":return"üéâ Êé°ÁÇπÁµêÊûú";default:return"üîÑ Ê∫ñÂÇô‰∏≠..."}}function vo(){return se.length>0?se:_e.length>0?_e:[]}function sn(){vt(`${it}/microphone-test`)}function Ze(){vt(`${it}/`)}async function rn(){try{e(34,Re=!0),e(33,ge=new Uo({urls:{C4:"C4.mp3"},baseUrl:`${it}/audio/piano/`,release:1.5,volume:Pn(),onload:()=>{e(34,Re=!1)},onerror:V=>{console.error("‚ùå Salamander PianoÈü≥Ê∫êË™≠„ÅøËæº„Åø„Ç®„É©„Éº:",V),e(34,Re=!1)}}).toDestination());const o=/iPhone/.test(navigator.userAgent),l=/iPad/.test(navigator.userAgent),S=/Macintosh/.test(navigator.userAgent)&&"ontouchend"in document,C=o||l||S;console.log(l?"üîç [RandomTraining] iPadÊ§úÂá∫:":S?"üîç [RandomTraining] iPadOSÊ§úÂá∫:":o?"üîç [RandomTraining] iPhoneÊ§úÂá∫:":"üîç [RandomTraining] „Åù„ÅÆ‰ªñ„Éá„Éê„Ç§„ÇπÊ§úÂá∫:",navigator.userAgent),console.log("üîä [RandomTraining] Èü≥ÈáèË®≠ÂÆöÁ∂≠ÊåÅ: 35dB")}catch(o){console.error("„Çµ„É≥„Éó„É©„ÉºÂàùÊúüÂåñ„Ç®„É©„Éº:",o),e(34,Re=!1)}}async function at(){try{(await navigator.permissions.query({name:"microphone"})).state==="granted"?await Ue():e(1,w="denied")}catch{e(1,w="denied")}}function an(){try{Ce=new In,ce.info("[RandomTraining] Êé°ÁÇπ„Ç®„É≥„Ç∏„É≥ÂàùÊúüÂåñÂÆå‰∫Ü")}catch(o){ce.error("[RandomTraining] Êé°ÁÇπ„Ç®„É≥„Ç∏„É≥ÂàùÊúüÂåñ„Ç®„É©„Éº:",o)}}function cn(o,l){if(!Ce||!F)return;const S=T-1;if(S<0||S>=q.length)return;const C=Ye(b,S),V={baseFrequency:b,targetFrequency:C,detectedFrequency:o,detectedNote:l,volume:Se,timestamp:Date.now(),scaleIndex:S,scaleName:q[S].name};try{Ce.processAttempt(V)}catch(G){ce.error("[RandomTraining] Êé°ÁÇπ„Ç®„É≥„Ç∏„É≥„Ç®„É©„Éº:",G)}}function ln(){if(!Ce){ce.error("[RandomTraining] Êé°ÁÇπ„Ç®„É≥„Ç∏„É≥„ÅåÂàùÊúüÂåñ„Åï„Çå„Å¶„ÅÑ„Åæ„Åõ„Çì"),un();return}try{const o=Ce.generateDetailedReport();e(16,ze={totalScore:o.totalScore,grade:o.grade,componentScores:o.componentScores}),o.intervalAnalysis&&o.intervalAnalysis.masteryLevels?e(3,ke=Object.entries(o.intervalAnalysis.masteryLevels).map(([l,S])=>{var C,V;return{type:l,mastery:Math.round(S),attempts:((C=o.intervalAnalysis.attemptCounts)==null?void 0:C[l])||0,accuracy:((V=o.intervalAnalysis.accuracyRates)==null?void 0:V[l])||0}})):(console.warn("‚ö†Ô∏è [RandomTraining] intervalAnalysis.masteryLevels „ÅåÊú™ÂÆöÁæ©„Åß„Åô"),e(3,ke=[])),o.consistencyHistory&&Array.isArray(o.consistencyHistory)?e(17,Pe=o.consistencyHistory.map((l,S)=>({score:Math.round(l),timestamp:Date.now()-(o.consistencyHistory.length-S)*1e3}))):(console.warn("‚ö†Ô∏è [RandomTraining] consistencyHistory „ÅåÊú™ÂÆöÁæ©„Åæ„Åü„ÅØÈÖçÂàó„Åß„ÅØ„ÅÇ„Çä„Åæ„Åõ„Çì"),e(17,Pe=[])),e(18,Oe=o.feedback||{primary:"Êé°ÁÇπÁµêÊûú„ÇíÁîüÊàê‰∏≠„Åß„Åô...",detailed:[],suggestions:[]}),e(20,Fe={totalAttempts:o.totalAttempts||0,successRate:o.successRate||0,averageScore:o.totalScore||0,bestScore:Math.max(o.totalScore||0,Fe.bestScore||0),sessionDuration:Math.round((Date.now()-Fe.sessionStart)/6e4)||0,streakCount:o.streak||0,fatigueLevel:o.fatigueLevel||"normal",mostDifficultInterval:o.mostDifficultInterval||"-",mostSuccessfulInterval:o.mostSuccessfulInterval||"-",averageResponseTime:o.averageResponseTime||0}),ce.info("[RandomTraining] Êé°ÁÇπÁµêÊûúÁîüÊàêÂÆå‰∫Ü:",ze)}catch(o){ce.error("[RandomTraining] Êé°ÁÇπÁµêÊûúÁîüÊàê„Ç®„É©„Éº:",o)}}function un(){ce.info("[RandomTraining] „ÉÜ„Çπ„Éà„Éá„Éº„Çø„ÅßÊé°ÁÇπÁµêÊûú„ÇíÁîüÊàê"),e(16,ze={totalScore:78,grade:"B+",componentScores:{pitchAccuracy:82,recognitionSpeed:75,intervalMastery:80,directionAccuracy:85,consistency:70}}),e(3,ke=[{type:"unison",mastery:95,attempts:8,accuracy:98},{type:"major_second",mastery:82,attempts:8,accuracy:85},{type:"major_third",mastery:78,attempts:8,accuracy:80},{type:"perfect_fourth",mastery:65,attempts:8,accuracy:68},{type:"perfect_fifth",mastery:88,attempts:8,accuracy:90},{type:"major_sixth",mastery:72,attempts:8,accuracy:75},{type:"major_seventh",mastery:58,attempts:8,accuracy:62},{type:"octave",mastery:92,attempts:8,accuracy:94}]),e(17,Pe=[{score:65,timestamp:Date.now()-42e4},{score:72,timestamp:Date.now()-36e4},{score:68,timestamp:Date.now()-3e5},{score:75,timestamp:Date.now()-24e4},{score:78,timestamp:Date.now()-18e4},{score:82,timestamp:Date.now()-12e4},{score:80,timestamp:Date.now()-6e4},{score:85,timestamp:Date.now()}]),e(18,Oe={type:"improvement",primary:"ËâØ„ÅÑÈÄ≤Ê≠©„ÅåË¶ã„Çâ„Çå„Åæ„ÅôÔºÅ",summary:"Èü≥Á®ã„ÅÆË™çË≠òÁ≤æÂ∫¶„ÅåÂêë‰∏ä„Åó„Å¶„ÅÑ„Åæ„Åô„ÄÇÁâπ„Å´ÂÆåÂÖ®5Â∫¶„Å®„Ç™„ÇØ„Çø„Éº„Éñ„ÅÆÁøíÂæóÂ∫¶„ÅåÈ´ò„Åè„ÄÅÂü∫Êú¨ÁöÑ„Å™Èü≥ÊÑü„ÅåË∫´„Å´„Å§„ÅÑ„Å¶„Åç„Å¶„ÅÑ„Åæ„Åô„ÄÇ",details:[{category:"strengths",text:"„É¶„Éã„Çæ„É≥„Å®„Ç™„ÇØ„Çø„Éº„Éñ„ÅÆË™çË≠ò„Åå„Åª„ÅºÂÆåÁíß„Åß„Åô"},{category:"strengths",text:"ÂÆåÂÖ®5Â∫¶„ÅÆÂÆâÂÆöÊÄß„ÅåÂÑ™ÁßÄ„Åß„Åô"},{category:"improvements",text:"ÂÆåÂÖ®4Â∫¶„ÅÆÁ∑¥Áøí„Çí„ÇÇ„ÅÜÂ∞ë„ÅóÂ¢ó„ÇÑ„Åó„Åæ„Åó„Çá„ÅÜ"},{category:"improvements",text:"Èï∑7Â∫¶„ÅÆË™çË≠òÁ≤æÂ∫¶„ÇíÂêë‰∏ä„Åï„Åõ„Åæ„Åó„Çá„ÅÜ"},{category:"tips",text:"4Â∫¶„ÅØ„Äå„ÇΩ„Éº„Éï„Ç°„Éº„Äç„ÅÆÈü≥Á®ã„Åß„Åô"},{category:"practice",text:"ÊØéÊó•15ÂàÜ„ÅÆÁ∂ôÁ∂öÁ∑¥Áøí„ÇíÂøÉ„Åå„Åë„Åæ„Åó„Çá„ÅÜ"}],nextSteps:["ÂÆåÂÖ®4Â∫¶„ÅÆÈõÜ‰∏≠Á∑¥Áøí„ÇíË°å„ÅÑ„Åæ„Åó„Çá„ÅÜ","ÈÄ£Á∂ö„ÉÅ„É£„É¨„É≥„Ç∏„É¢„Éº„Éâ„ÅßÂÆüË∑µÁ∑¥Áøí„Çí","1Êó•15ÂàÜ„ÅÆÁ∂ôÁ∂öÁ∑¥Áøí„ÇíÂøÉ„Åå„Åë„Åæ„Åó„Çá„ÅÜ"],motivation:"Á∂ôÁ∂ö„ÅØÂäõ„Å™„ÇäÔºÅ„ÅÇ„Å™„Åü„ÅÆÁõ∏ÂØæÈü≥ÊÑü„ÅØÁ¢∫ÂÆü„Å´Âêë‰∏ä„Åó„Å¶„ÅÑ„Åæ„ÅôÔºÅ"}),e(20,Fe={totalAttempts:32,successRate:68.8,averageScore:78,bestScore:85,sessionDuration:8,streakCount:4,fatigueLevel:"normal",mostDifficultInterval:"ÂÆåÂÖ®4Â∫¶",mostSuccessfulInterval:"„É¶„Éã„Çæ„É≥",averageResponseTime:2.1,sessionStart:Date.now()-48e4}),ce.info("[RandomTraining] „ÉÜ„Çπ„ÉàÊé°ÁÇπÁµêÊûúÁîüÊàêÂÆå‰∫Ü")}function _o(o){ft=o}function fn(){if(!re||re.length===0){console.warn("[UnifiedScore] noteResultsForDisplay „ÅåÁ©∫„Åß„Åô");return}const o=re.filter(ne=>ne.accuracy!=="notMeasured").length,l=re.length,S=re.filter(ne=>ne.accuracy!=="notMeasured"&&typeof ne.accuracy=="number").map(ne=>ne.accuracy),C=S.length>0?Math.round(S.reduce((ne,Me)=>ne+Me,0)/S.length):0,V=A||"Unknown",G=b||0,ae=re.map(ne=>({name:ne.name,note:ne.note||ne.name,frequency:ne.targetFreq||ne.expectedFrequency,detectedFrequency:ne.detectedFreq,cents:ne.cents,grade:nt.evaluateNote(ne.cents),targetFreq:ne.targetFreq,diff:ne.diff})),ie=D,oe=(ie==null?void 0:ie.sessionHistory)||[],qe={timestamp:new Date,baseNote:V,baseFrequency:G,noteResults:ae,measuredNotes:o,accuracy:C,grade:nt.evaluateSession(re)},xe=[...oe,qe];e(21,le={mode:"continuous",timestamp:new Date,duration:60,totalNotes:l,measuredNotes:o,averageAccuracy:C,baseNote:V,baseFrequency:G,noteResults:ae,distribution:nt.calculateDistribution(re),sessionHistory:xe,unifiedGrade:L(xe)}),console.log("[UnifiedScore] Áµ±ÂêàÊé°ÁÇπ„Éá„Éº„ÇøÁîüÊàêÂÆå‰∫ÜÔºàÂÆåÂÖ®ÁâàÔºâ:",le),dn()}async function dn(){if(!re||re.length===0){console.warn("üìä [SessionStorage] ‰øùÂ≠ò„Éá„Éº„Çø„Å™„Åó");return}try{console.log("üìä [SessionStorage] „Çª„ÉÉ„Ç∑„Éß„É≥ÁµêÊûú‰øùÂ≠òÈñãÂßã");const o=re.map(G=>({name:G.name,cents:G.cents,targetFreq:G.targetFreq||G.expectedFrequency,detectedFreq:G.detectedFreq,diff:G.diff,accuracy:typeof G.accuracy=="number"?G.accuracy:0})),l=Ke?Math.round((Date.now()-Ke)/1e3):60;await Nn(o,l,m,d)?(console.log("üìä [SessionStorage] „Çª„ÉÉ„Ç∑„Éß„É≥ÁµêÊûú‰øùÂ≠òÂÆå‰∫Ü"),console.log("üìä [SessionStorage] ‰øùÂ≠òÂæå„ÅÆÁä∂Ê≥Å:",{currentSession:n,totalSessions:v.length,isCompleted:a,nextBaseNote:m,nextBaseName:d})):console.error("üìä [SessionStorage] „Çª„ÉÉ„Ç∑„Éß„É≥ÁµêÊûú‰øùÂ≠òÂ§±Êïó")}catch(o){console.error("üìä [SessionStorage] „Çª„ÉÉ„Ç∑„Éß„É≥‰øùÂ≠ò„Ç®„É©„Éº:",o)}}async function mn(){try{if(Ce){const o=v||[];for(const[S,C]of o.entries())if(C.noteResults&&C.noteResults.length>0){const V=C.baseFrequency||262;for(const G of C.noteResults)G.detectedFreq&&G.targetFreq&&await Ce.analyzePerformance({baseFreq:V,targetFreq:G.targetFreq,detectedFreq:G.detectedFreq,responseTime:2e3,volume:50,harmonicCorrection:null})}const l=Ce.generateDetailedReport();e(16,ze={totalScore:l.totalScore||0,grade:l.grade||"C",componentScores:l.componentScores||{accuracy:0,speed:0,consistency:0}}),l.intervalAnalysis&&l.intervalAnalysis.masteryLevels?e(3,ke=Object.entries(l.intervalAnalysis.masteryLevels).map(([S,C])=>{var V;return{type:S,mastery:Math.round(C),attempts:((V=l.intervalAnalysis.attemptCounts)==null?void 0:V[S])||0,accuracy:Math.round(C*.9)}})):e(3,ke=At(re)),l.consistencyHistory&&Array.isArray(l.consistencyHistory)?e(17,Pe=l.consistencyHistory.map((S,C)=>({score:Math.round(S),timestamp:Date.now()-(l.consistencyHistory.length-C)*1e3}))):e(17,Pe=ht(re)),e(18,Oe=pt(re)||l.feedback),console.log("üéØ [generateEnhancedScoringData] ÊäÄË°ìÂàÜÊûêÁµêÊûúÁîüÊàê„ÇíÈñãÂßã"),console.log("üéØ [generateEnhancedScoringData] results:",l),e(19,Xe=gn(l)),console.log("üéØ [generateEnhancedScoringData] technicalFeedbackDataÁµêÊûú:",Xe),e(20,Fe={totalAttempts:l.totalAttempts||re.length,successRate:l.successRate||re.filter(S=>S.accuracy!=="notMeasured").length/re.length*100,averageScore:l.totalScore||(le==null?void 0:le.averageAccuracy)||0,bestScore:Math.max(l.totalScore||0,Fe.bestScore||0),sessionDuration:Math.round(60),streakCount:l.streak||0,fatigueLevel:l.fatigueLevel||"normal",mostDifficultInterval:l.mostDifficultInterval||"Êú™ÁâπÂÆö",mostSuccessfulInterval:l.mostSuccessfulInterval||"Êú™ÁâπÂÆö",averageResponseTime:l.averageResponseTime||2.5,sessionStart:Date.now()-6e4})}else yt();console.log("[EnhancedScoring] ËøΩÂä†Êé°ÁÇπ„Éá„Éº„ÇøÁîüÊàêÂÆå‰∫Ü")}catch(o){console.error("[EnhancedScoring] „Éá„Éº„ÇøÁîüÊàê„Ç®„É©„Éº:",o),yt()}}function yt(){const o=re.filter(S=>S.accuracy!=="notMeasured"),l=(le==null?void 0:le.averageAccuracy)||0;e(16,ze={totalScore:Math.round(l*.8),grade:l>=90?"A":l>=80?"B":l>=70?"C":"D",componentScores:{accuracy:l,speed:85,consistency:Math.max(60,l-10)}}),e(3,ke=At(re)),e(17,Pe=ht()),e(18,Oe=pt(re)),e(20,Fe={totalAttempts:re.length,successRate:o.length/re.length*100,averageScore:l,bestScore:l,sessionDuration:60,streakCount:0,fatigueLevel:"normal",mostDifficultInterval:"Êú™ÂàÜÊûê",mostSuccessfulInterval:"Êú™ÂàÜÊûê",averageResponseTime:2.5,sessionStart:Date.now()-6e4})}function ht(o){const l=(le==null?void 0:le.averageAccuracy)||70;return Array.from({length:8},(S,C)=>({score:Math.max(30,Math.min(100,l+(Math.random()-.5)*20)),timestamp:Date.now()-(8-C)*7500}))}function pt(o){const l=o.filter(et=>et.accuracy!=="notMeasured").length,S=(le==null?void 0:le.averageAccuracy)||0,C=8,V=v||[],G=V.length,ae={type:"info",categories:[{name:"Èü≥Á®ãÁ≤æÂ∫¶",icon:"Target",score:S,message:`${S}%„ÅÆÁ≤æÂ∫¶„ÅßÈü≥Á®ã„ÇíÊçâ„Åà„Å¶„ÅÑ„Åæ„Åô`},{name:"Ê∏¨ÂÆöÊàêÂäüÁéá",icon:"Mic",score:Math.round(l/o.length*100),message:`${o.length}Èü≥‰∏≠${l}Èü≥„ÇíÊ≠£Â∏∏„Å´Ê∏¨ÂÆö`}]};if(G<C)return ae;let ie,oe,qe;const xe=(le==null?void 0:le.unifiedGrade)||"E",ne=V.length;let Me=0,he=0,ve=0;V.forEach(et=>{et.grade==="excellent"?Me++:et.grade==="good"?he++:et.grade==="pass"&&ve++});const be=ne>0?Math.round(Me/ne*100):0,$e=ne>0?Math.round((Me+he+ve)/ne*100):0,we=ne>0?Math.round((Me+he+ve)/ne*100):0;switch(xe){case"S":ie="excellent",oe="Èü≥Ê•ΩÂÆ∂„É¨„Éô„É´„ÅÆÁõ∏ÂØæÈü≥ÊÑü„ÇíÈÅîÊàêÔºÅ",qe=`ÂÑ™ÁßÄÁéá${be}%Ë∂Ö„Åà„ÅÆÂÆüÂäõ„ÇíË®ºÊòé„Åï„Çå„Åæ„Åó„Åü„ÄÇ`;break;case"A":ie="excellent",oe="„Ç®„Ç≠„Çπ„Éë„Éº„Éà„É¨„Éô„É´Âà∞ÈÅîÔºÅ",qe=`ÂÑ™ÁßÄÁéá${be}%„ÅÆÂÆâÂÆö„Åó„ÅüÈü≥ÊÑüËÉΩÂäõ„Åß„Åô„ÄÇ`;break;case"B":ie="improvement",oe="„Éó„É≠„Éï„Ç£„Ç∑„Ç®„É≥„ÉàÁ¥öÈÅîÊàêÔºÅ",qe=`ËâØÂ•ΩÁéá${$e}%„ÅÆÁ¢∫ÂÆü„Å™ÈÄ≤Ê≠©„ÇíÁ§∫„Åó„Å¶„ÅÑ„Åæ„Åô„ÄÇ`;break;case"C":ie="improvement",oe="„Ç¢„Éâ„Éê„É≥„ÇπÁ¥öÂà∞ÈÅîÔºÅ",qe=`ÂêàÊ†ºÁéá${we}%„ÅßÁùÄÂÆü„Å´ÊàêÈï∑‰∏≠„Åß„Åô„ÄÇ`;break;case"D":ie="practice",oe="Á∂ôÁ∂öÁ∑¥Áøí„ÅßÂøÖ„Åö‰∏äÈÅîÔºÅ",qe=`ÁèæÂú®„ÅÆÂêàÊ†ºÁéá${we}%„Åã„ÇâÁõÆÊ®ô70%„Å∏Âêë„Åë„Å¶Á∑¥Áøí„ÇíÁ∂ö„Åë„Åæ„Åó„Çá„ÅÜ„ÄÇ`;break;case"E":default:ie="encouragement",oe="EÁ¥ö„Éì„ÇÆ„Éä„Éº",qe="Á∑¥ÁøíÈñãÂßãÊÆµÈöé„Åß„Åô„ÄÇÁ∂ôÁ∂öÁöÑ„Å™Á∑¥Áøí„ÅßÂøÖ„Åö‰∏äÈÅî„Åó„Åæ„Åô„ÄÇ";break}return{...ae,type:ie,primary:oe,summary:qe}}function gn(o){var xe,ne,Me;if((v||[]).length<8||!o)return null;const V=o.improvements||[];(xe=o.detailed)!=null&&xe.statistics;const G=[];let ae=0,ie=0;if((ne=o.detailed)!=null&&ne.intervals){const he=o.detailed.intervals;if(he.totalAnalyses>0){let ve=0,be=0;for(const[$e,we]of Object.entries(he.masteryLevels))we.attempts>0&&(ve+=we.averageAccuracy*we.attempts,be+=we.attempts);ae=be>0?ve/be:0}}if((Me=o.detailed)!=null&&Me.directions){const he=o.detailed.directions;if(he.totalAnalyses>0){let ve=0,be=0;for(const[$e,we]of Object.entries(he.masteryData))we.attempts>0&&(ve+=we.averageAccuracy*we.attempts,be+=we.attempts);ie=be>0?ve/be:0}}G.push({category:"improvements",text:`Èü≥Á®ãÁ≤æÂ∫¶: ${Math.round(ae)}%„ÄÄÔºàÈü≥„ÅÆÈ´ò„Åï„ÇíÊçâ„Åà„ÇãÊ≠£Á¢∫ÊÄß„ÄÄÁõÆÊ®ôÂü∫Ê∫ñÔºö70„Äú85%Ôºâ`}),G.push({category:"improvements",text:`ÊñπÂêëÊÄß: ${Math.round(ie)}%„ÄÄÔºàÈü≥Á®ã„ÅÆ‰∏ä‰∏ãÂà§Êñ≠„ÅÆÁ≤æÂ∫¶„ÄÄÁõÆÊ®ôÂü∫Ê∫ñÔºö80„Äú90%Ôºâ`});const oe=V.map(he=>({category:"tips",text:he.message})),qe=V.flatMap(he=>(he.actions||[]).map(ve=>({category:"practice",text:ve})));return[...G,...oe,...qe],{type:"info",primary:"Ë©≥Á¥∞ÂàÜÊûêÁµêÊûú",summary:"Èü≥Á®ãÁ≤æÂ∫¶„Éª‰∏ÄË≤´ÊÄß„ÉªÊñπÂêëÊÄß„ÅÆÁ∑èÂêàÂàÜÊûê",details:G}}Rn(async()=>{if(!(typeof localStorage<"u"?localStorage.getItem("mic-test-completed"):null)){console.log("üö´ [RandomTraining] „Éû„Ç§„ÇØ„ÉÜ„Çπ„ÉàÊú™ÂÆå‰∫Ü - Ê∫ñÂÇôÁîªÈù¢Ë°®Á§∫"),at();return}console.log("üìä [SessionStorage] „Çª„ÉÉ„Ç∑„Éß„É≥ÁÆ°ÁêÜÂàùÊúüÂåñÈñãÂßã");try{if(await bt()){if(console.log("üìä [SessionStorage] „Çª„ÉÉ„Ç∑„Éß„É≥ÈÄ≤Ë°åÁä∂Ê≥Å„ÅÆË™≠„ÅøËæº„ÅøÂÆå‰∫Ü"),console.log("üìä [SessionStorage] ÁèæÂú®„ÅÆ„Çª„ÉÉ„Ç∑„Éß„É≥:",n,"/ 8"),console.log("üìä [SessionStorage] Ê¨°„ÅÆÂü∫Èü≥:",m,"(",d,")"),console.log("üìä [SessionStorage] ÂÆå‰∫ÜÁä∂Ê≥Å:",a?"8„Çª„ÉÉ„Ç∑„Éß„É≥ÂÆå‰∫Ü":`ÊÆã„Çä${f}„Çª„ÉÉ„Ç∑„Éß„É≥`),a&&(console.log("üîÑ [SessionStorage] 8„Çª„ÉÉ„Ç∑„Éß„É≥ÂÆå‰∫ÜÊ§úÂá∫ - Êñ∞„Çµ„Ç§„ÇØ„É´ÈñãÂßãÂá¶ÁêÜ"),await tt()?console.log("‚úÖ [SessionStorage] Êñ∞„Çµ„Ç§„ÇØ„É´ÈñãÂßãÂÆå‰∫Ü - „Çª„ÉÉ„Ç∑„Éß„É≥1/8„Åã„ÇâÂÜçÈñã"):console.warn("‚ö†Ô∏è [SessionStorage] Êñ∞„Çµ„Ç§„ÇØ„É´ÈñãÂßãÂá¶ÁêÜ„ÅåÂ§±Êïó")),n>1&&!a){console.warn("üîÑ [SessionStorage] „Çª„ÉÉ„Ç∑„Éß„É≥ÈÄî‰∏≠„Åß„ÅÆ„É™„É≠„Éº„ÉâÊ§úÂá∫ - „Çª„ÉÉ„Ç∑„Éß„É≥1„Åã„ÇâÂÜçÈñã"),console.warn("üîÑ [SessionStorage] ÁèæÂú®:",n,"„Çª„ÉÉ„Ç∑„Éß„É≥ÁõÆ ‚Üí „ÉÄ„Ç§„É¨„ÇØ„Éà„Ç¢„ÇØ„Çª„ÇπË™òÂ∞é");const{SessionStorageManager:S}=await Fn(async()=>{const{SessionStorageManager:G}=await import("../chunks/C56X5YjC.js").then(ae=>ae.y);return{SessionStorageManager:G}},__vite__mapDeps([0,1,2,3,4,5]),import.meta.url),C=S.getInstance();typeof localStorage<"u"&&(localStorage.removeItem("random-training-progress"),localStorage.removeItem("random-training-progress-backup"));const{resetProgress:V}=await Fn(async()=>{const{resetProgress:G}=await import("../chunks/C56X5YjC.js").then(ae=>ae.z);return{resetProgress:G}},__vite__mapDeps([0,1,2,3,4,5]),import.meta.url);await V(),console.log("üîÑ [SessionStorage] localStorage + „Çπ„Éà„Ç¢Áä∂ÊÖãÂÆåÂÖ®„É™„Çª„ÉÉ„ÉàÂÆå‰∫Ü"),at();return}}else console.log("üìä [SessionStorage] Êñ∞Ë¶è„Çª„ÉÉ„Ç∑„Éß„É≥ÈñãÂßã")}catch(l){console.error("üìä [SessionStorage] ÂàùÊúüÂåñ„Ç®„É©„Éº:",l)}if(rn(),an(),u.url.searchParams.get("from")==="microphone-test"){console.log("üé§ [RandomTraining] „Éû„Ç§„ÇØ„ÉÜ„Çπ„Éà„Éö„Éº„Ç∏„Åã„Çâ„ÅÆÈÅ∑Áßª„ÇíÊ§úÂá∫");const l=new URL(window.location);if(l.searchParams.delete("from"),window.history.replaceState({},"",l),e(1,w="granted"),e(0,k="setup"),console.log('üé§ [RandomTraining] microphoneState="granted", trainingPhase="setup" „Å´Ë®≠ÂÆö'),!Be){console.log("üé§ [RandomTraining] AudioManager„É™„ÇΩ„Éº„ÇπÂèñÂæóÈñãÂßã");try{const S=await We.initialize();st=S.audioContext,Be=S.mediaStream,rt=S.sourceNode,console.log("üé§ [RandomTraining] AudioManager„É™„ÇΩ„Éº„ÇπÂèñÂæóÂÆå‰∫Ü")}catch(S){console.warn("‚ö†Ô∏è AudioManager„É™„ÇΩ„Éº„ÇπÂèñÂæóÂ§±ÊïóÔºàÂæå„ÅßÂÜçË©¶Ë°åÔºâ:",S)}}if(await new Promise(S=>setTimeout(S,500)),te)try{if(console.log("üéôÔ∏è [ContinuousMode] PitchDetectorÂàùÊúüÂåñÈñãÂßã"),typeof te.getIsInitialized=="function"){const S=te.getIsInitialized();if(console.log("üîç [ContinuousMode] PitchDetectorÂàùÊúüÂåñÁä∂ÊÖã:",S),S)console.log("‚úÖ [ContinuousMode] PitchDetector„ÅØÊó¢„Å´ÂàùÊúüÂåñÊ∏à„Åø");else{const C=We.getStatus();console.log("üîç [ContinuousMode] AudioManagerÁä∂ÊÖã:",C),(!C.isInitialized||!C.mediaStreamActive)&&(console.log("üîÑ [ContinuousMode] AudioManagerÂÜçÂàùÊúüÂåñÂÆüË°å"),await We.initialize()),await te.initialize(),console.log("‚úÖ [ContinuousMode] PitchDetectorÂàùÊúüÂåñÂÆå‰∫Ü")}}else console.error("‚ùå [ContinuousMode] getIsInitialized„É°„ÇΩ„ÉÉ„Éâ„ÅåÂà©Áî®„Åß„Åç„Åæ„Åõ„Çì"),await te.initialize()}catch(S){console.error("‚ùå [ContinuousMode] PitchDetectorÂàùÊúüÂåñ„Ç®„É©„Éº:",S),await new Promise(C=>setTimeout(C,1e3));try{await te.initialize(),console.log("‚úÖ [ContinuousMode] PitchDetectorÂàùÊúüÂåñÂÜçË©¶Ë°åÊàêÂäü")}catch(C){console.error("‚ùå [ContinuousMode] PitchDetectorÂàùÊúüÂåñÂÜçË©¶Ë°å„ÇÇÂ§±Êïó:",C)}}else console.warn("‚ö†Ô∏è [ContinuousMode] PitchDetector„Ç≥„É≥„Éù„Éº„Éç„É≥„Éà„ÅåÂ≠òÂú®„Åó„Åæ„Åõ„Çì")}else await new Promise(l=>setTimeout(l,100)),at()});function yn(o){try{if(!o||!o.detail){console.warn("‚ö†Ô∏è [ContinuousMode] handlePitchUpdate: event.detail „Åå undefined");return}const{frequency:l,note:S,volume:C,rawVolume:V,clarity:G}=o.detail;let ae=l,ie=S;if(k==="guiding"&&F&&b>0&&l>0){const oe=hn(l);oe&&(ae=oe.frequency,ie=oe.note)}e(14,Ee=ae),e(15,je=ie),e(13,Se=C),b>0&&ae>0?He=Math.round(1200*Math.log2(ae/b)):He=0;try{pn(l,S)}catch(oe){console.error("‚ùå [ContinuousMode] evaluateScaleStep „Ç®„É©„Éº:",oe)}try{Ce&&l>0&&b>0&&cn(l,S)}catch(oe){console.error("‚ùå [ContinuousMode] updateScoringEngine „Ç®„É©„Éº:",oe)}}catch(l){console.error("‚ùå [ContinuousMode] handlePitchUpdate „Ç®„É©„Éº:",{error:l.message,stack:l.stack,eventDetail:o==null?void 0:o.detail,trainingPhase:k,currentSessionId:n})}}function hn(o){if(!o||o<=0||!F||!b||Se<25)return null;const S=T-1;if(S<0||S>=q.length)return null;const C=Ye(b,S);if(!C||C<=0)return null;const G=Tt(o,C).correctedFrequency,ae=xn(G);return{frequency:Math.round(G),note:ae}}function pn(o,l){if(!o||o<=0||!F)return;if(!b||b<=0){console.error(`‚ùå [Êé°ÁÇπ„Ç®„É©„Éº] Âü∫Èü≥Âë®Ê≥¢Êï∞„ÅåÁÑ°Âäπ: ${b}Hz`),console.error(`‚ùå [Êé°ÁÇπ„Ç®„É©„Éº] Âü∫Èü≥Âêç: ${A}`),console.error(`‚ùå [Êé°ÁÇπ„Ç®„É©„Éº] activeStepIndex: ${T-1}`),console.error(`‚ùå [Êé°ÁÇπ„Ç®„É©„Éº] trainingPhase: ${k}`),console.error(`‚ùå [Êé°ÁÇπ„Ç®„É©„Éº] isGuideAnimationActive: ${F}`);return}if(Se<25)return;const C=T-1;if(C<0||C>=q.length)return;C>=4&&ce.debug(`[Êé°ÁÇπ„Éá„Éê„ÉÉ„Ç∞] activeStepIndex=${C} (${q[C].name}), currentBaseFrequency=${b}Hz`);const V=Ye(b,C);if(C>=0&&ce.debug(`[Èü≥Á®ãË®àÁÆó‰øÆÊ≠£Áâà] ${q[C].name}: ÊúüÂæÖÂë®Ê≥¢Êï∞ ${V.toFixed(1)}Hz`),!V||V<=0||!isFinite(V)){console.error("‚ùå [Êé°ÁÇπ„Ç®„É©„Éº] ÊúüÂæÖÂë®Ê≥¢Êï∞Ë®àÁÆó„Ç®„É©„Éº:"),console.error(`   Âü∫Èü≥Âë®Ê≥¢Êï∞: ${b}Hz`),console.error(`   Èü≥Èöé„Ç§„É≥„Éá„ÉÉ„ÇØ„Çπ: ${C}`),console.error(`   ÊúüÂæÖÂë®Ê≥¢Êï∞: ${V}Hz`);return}const G=Tt(o,V),ae=G.correctedFrequency,ie=G.factor,oe=Math.round(1200*Math.log2(ae/V));if((Math.abs(oe)>200||ie!==1)&&(ce.debug(`[„Éó„É≠„Éà„Çø„Ç§„ÉóÂºèË£úÊ≠£] ${q[C].name}:`),console.warn(`   Ê§úÂá∫Âë®Ê≥¢Êï∞: ${o.toFixed(1)}Hz`),console.warn(`   Ë£úÊ≠£ÂæåÂë®Ê≥¢Êï∞: ${ae.toFixed(1)}Hz`),console.warn(`   ÊúüÂæÖÂë®Ê≥¢Êï∞: ${V.toFixed(1)}Hz`),console.warn(`   „Çª„É≥„ÉàÂ∑Æ: ${oe}¬¢`),console.warn(`   Ë£úÊ≠£‰øÇÊï∞: ${ie} (${G.description})`),console.warn(`   Âü∫Èü≥: ${A} (${b.toFixed(1)}Hz)`)),!isFinite(oe)){console.error("‚ùå [Êé°ÁÇπ„Ç®„É©„Éº] „Çª„É≥„ÉàË®àÁÆó„Ç®„É©„Éº:"),console.error(`   Ê§úÂá∫Âë®Ê≥¢Êï∞: ${o}Hz`),console.error(`   ÊúüÂæÖÂë®Ê≥¢Êï∞: ${V}Hz`),console.error(`   „Çª„É≥„ÉàÂ∑Æ: ${oe}`);return}const xe=Math.abs(oe)<=50;if(Se>=15){const he=Math.max(0,Math.round(100-Math.abs(oe))),ve=se.findIndex($e=>$e.stepIndex===C),be={stepIndex:C,stepName:q[C].name,expectedFrequency:Math.round(V),detectedFrequency:Math.round(o),adjustedFrequency:Math.round(ae),centDifference:oe,accuracy:he,isCorrect:xe,correctionFactor:ie,correctionDescription:G.description,timestamp:Date.now()};ve>=0?se[ve]=be:se.push(be),se.length%4===0&&ce.realtime(`Êé°ÁÇπÈÄ≤Êçó: ${se.length}/${q.length}„Çπ„ÉÜ„ÉÉ„ÉóÂÆå‰∫Ü`)}}function vn(){e(0,k="results"),Ve.isCompleted=!0,Ve.averageAccuracy=Math.round(Ve.correctCount/Ve.totalCount*100),te&&te.stopDetection(),wn()}async function _n(){if(a){console.warn("üö´ [RestartSame] 8„Çª„ÉÉ„Ç∑„Éß„É≥ÂÆå‰∫ÜÁä∂ÊÖã„Åß„ÅØÂÜçÊåëÊà¶‰∏çÂèØ - Êñ∞„Çµ„Ç§„ÇØ„É´ÈñãÂßã„ÅåÂøÖË¶Å"),await tt()?(console.log("‚úÖ [RestartSame] Êñ∞„Çµ„Ç§„ÇØ„É´ÈñãÂßãÂÆå‰∫Ü - „Çª„ÉÉ„Ç∑„Éß„É≥1/8„Åã„ÇâÂÜçÈñã"),window.location.reload()):console.error("‚ùå [RestartSame] Êñ∞„Çµ„Ç§„ÇØ„É´ÈñãÂßãÂ§±Êïó");return}ot(),e(0,k="setup"),x&&(clearTimeout(x),x=null),te&&te.resetDisplayState&&te.resetDisplayState(),ct(),console.log("üîÑ [RestartSame] Âêå„ÅòÂü∫Èü≥„ÅßÂÜçÊåëÊà¶:",A,b+"Hz"),console.log("üîÑ [RestartSame] Âü∫Èü≥ÊÉÖÂ†±‰øùÊåÅÂÆå‰∫Ü - „É¶„Éº„Ç∂„ÉºÊìç‰ΩúÂæÖÊ©ü")}async function Sn(){if(a){console.warn("üö´ [RestartDifferent] 8„Çª„ÉÉ„Ç∑„Éß„É≥ÂÆå‰∫ÜÁä∂ÊÖã„Åß„ÅØÂÜçÊåëÊà¶‰∏çÂèØ - Êñ∞„Çµ„Ç§„ÇØ„É´ÈñãÂßã„ÅåÂøÖË¶Å"),await tt()?(console.log("‚úÖ [RestartDifferent] Êñ∞„Çµ„Ç§„ÇØ„É´ÈñãÂßãÂÆå‰∫Ü - „Çª„ÉÉ„Ç∑„Éß„É≥1/8„Åã„ÇâÂÜçÈñã"),window.location.reload()):console.error("‚ùå [RestartDifferent] Êñ∞„Çµ„Ç§„ÇØ„É´ÈñãÂßãÂ§±Êïó");return}ot(),e(0,k="setup"),x&&(clearTimeout(x),x=null),e(7,A=""),e(8,b=0),console.log("üîÑ [restartDifferentBaseNote] Âü∫Èü≥ÊÉÖÂ†±„Çí„É™„Çª„ÉÉ„Éà„Åó„Åæ„Åó„Åü"),te&&te.resetDisplayState&&te.resetDisplayState(),ct()}function ct(){T=0,F=!1,se=[],e(10,q=q.map(o=>({...o,state:"inactive",completed:!1})))}async function bn(){console.log("üöÄ [StartNewCycle] 8„Çª„ÉÉ„Ç∑„Éß„É≥ÂÆå‰∫ÜÂæå„ÅÆÊúÄÂàù„Åã„ÇâÊåëÊà¶ÈñãÂßã");try{await tt()?(console.log("‚úÖ [StartNewCycle] Êñ∞„Çµ„Ç§„ÇØ„É´ÈñãÂßãÂÆå‰∫Ü"),localStorage.getItem("mic-test-completed")?(console.log("‚úÖ [StartNewCycle] „Éû„Ç§„ÇØ„ÉÜ„Çπ„ÉàÂÆå‰∫Ü„Éï„É©„Ç∞Á¢∫Ë™ç - „É™„É≠„Éº„Éâ„Å™„Åó„ÅßÁä∂ÊÖã„É™„Çª„ÉÉ„Éà"),ot(),await bt(),e(0,k="setup"),ct(),dt(),console.log("‚úÖ [StartNewCycle] Áä∂ÊÖã„É™„Çª„ÉÉ„ÉàÂÆå‰∫Ü - „Çª„ÉÉ„Ç∑„Éß„É≥1/8„Åã„ÇâÂÜçÈñã")):window.location.reload()):(console.error("‚ùå [StartNewCycle] Êñ∞„Çµ„Ç§„ÇØ„É´ÈñãÂßãÂ§±Êïó"),Ze())}catch(o){console.error("‚ùå [StartNewCycle] Êñ∞„Çµ„Ç§„ÇØ„É´ÈñãÂßã„Ç®„É©„Éº:",o),Ze()}}function Dn(o){const{type:l}=o.detail;switch(l){case"same":_n();break;case"different":Sn();break;case"restart":bn();break;case"home":Ze();break;default:console.warn("üö´ [ActionButtons] Êú™Áü•„ÅÆ„Ç¢„ÇØ„Ç∑„Éß„É≥„Çø„Ç§„Éó:",l)}}function qn(){console.log("‚ö° [ContinuousMode] 8„Çª„ÉÉ„Ç∑„Éß„É≥ÈÄ£Á∂öÈñãÂßã"),mt()}function wn(){console.log("‚úÖ [ContinuousMode] „Çª„ÉÉ„Ç∑„Éß„É≥ÂÆå‰∫Ü:",n),n<8?setTimeout(()=>{if(console.log("üîÑ [ContinuousMode] Ê¨°„Çª„ÉÉ„Ç∑„Éß„É≥Ëá™ÂãïÈñãÂßãÊ∫ñÂÇô:",n+1),e(0,k="setup"),Ve={isCompleted:!1,correctCount:0,totalCount:0,averageAccuracy:0},e(9,K=!1),te)try{if(te.getState){const o=te.getState();console.log("üîç [ContinuousMode] PitchDetectorÁä∂ÊÖã:",o),o.isInitialized&&o.componentState==="ready"?(console.log("üé§ [ContinuousMode] Èü≥Á®ãÊ§úÂá∫ÂÜçÈñã"),te.startDetection()):o.componentState==="detecting"?console.log("üîÑ [ContinuousMode] Èü≥Á®ãÊ§úÂá∫„ÅØÊó¢„Å´„Ç¢„ÇØ„ÉÜ„Ç£„ÉñÁä∂ÊÖã - „Çπ„Ç≠„ÉÉ„Éó"):console.log("‚ö†Ô∏è [ContinuousMode] PitchDetectorÁä∂ÊÖã‰∏çÊ≠£ - Èü≥Á®ãÊ§úÂá∫ÂÜçÈñã„Çí„Çπ„Ç≠„ÉÉ„Éó:",o.componentState)}else console.log("‚ö†Ô∏è [ContinuousMode] getState()„É°„ÇΩ„ÉÉ„ÉâÊú™ÂØæÂøú - „Éï„Ç©„Éº„É´„Éê„ÉÉ„ÇØÂá¶ÁêÜ"),te.getIsInitialized&&te.getIsInitialized()&&te.startDetection()}catch(o){console.warn("‚ö†Ô∏è [ContinuousMode] Èü≥Á®ãÊ§úÂá∫ÂÜçÈñãÂ§±Êïó:",o.message)}console.log("üéµ [ContinuousMode] Ê¨°„ÅÆÂü∫Èü≥Ëá™ÂãïÂÜçÁîüÈñãÂßã"),mt()},5e3):(console.log("üéâ [ContinuousMode] 8„Çª„ÉÉ„Ç∑„Éß„É≥ÂÆå‰∫ÜÔºÅ"),setTimeout(()=>{console.log("üèÜ [ContinuousMode] Á∑èÂêàË©ï‰æ°ÁîªÈù¢Ë°®Á§∫ÂÆå‰∫Ü")},1e3))}function Cn(o){var G;const{error:l,context:S,reason:C,recovery:V}=o.detail;if(S==="initialization"||l!=null&&l.message&&l.message.includes("getIsInitialized")){console.error("‚ùå [ContinuousMode] PitchDetectorÂàùÊúüÂåñ„Ç®„É©„ÉºË©≥Á¥∞:",{error:(l==null?void 0:l.message)||l,stack:l==null?void 0:l.stack,context:S,componentExists:!!te,hasGetIsInitialized:typeof(te==null?void 0:te.getIsInitialized)=="function",trainingPhase:k,currentSessionId:n});return}if(console.error("‚ùå [ContinuousMode] PitchDetector„Ç®„É©„ÉºË©≥Á¥∞:",{error:(l==null?void 0:l.message)||l,stack:l==null?void 0:l.stack,context:S,reason:C,recovery:V,trainingPhase:k,currentSessionId:n}),C==="mediastream_ended"&&V==="restart_required"&&(console.log("‚ö° [ContinuousMode] MediaStreamÁµÇ‰∫ÜÊ§úÂá∫ - Ëá™ÂãïÂæ©Êóß„ÇíË©¶Ë°å"),setTimeout(async()=>{try{await Ue()}catch(ae){console.error("‚ùå [ContinuousMode] Ëá™ÂãïÂæ©ÊóßÂ§±Êïó:",ae)}},1e3)),S==="start-detection"&&((G=l==null?void 0:l.message)!=null&&G.includes("component state is detecting"))){console.log("üîÑ [ContinuousMode] Èü≥Á®ãÊ§úÂá∫„ÅØÊó¢„Å´„Ç¢„ÇØ„ÉÜ„Ç£„ÉñÁä∂ÊÖã„Åß„ÅôÔºàÊ≠£Â∏∏Ôºâ");return}}function kn(o){const{healthy:l,errors:S,details:C}=o.detail;e(2,j=l),e(6,B=S),l||(console.warn("‚ö†Ô∏è „Éû„Ç§„ÇØ„ÅÆÂÅ•Â∫∑Áä∂ÊÖã„ÅåÊÇ™Âåñ:",S),k==="guiding"&&(e(0,k="setup"),console.warn("üõë „Éû„Ç§„ÇØÂïèÈ°å„Å´„Çà„Çä„Éà„É¨„Éº„Éã„É≥„Ç∞„ÇíÂÅúÊ≠¢")))}Mn(()=>{console.log("üîÑ [RandomTraining] onDestroy - AudioManager„É™„ÇΩ„Éº„Çπ„ÅØ‰øùÊåÅ"),ge&&(ge.dispose(),e(33,ge=null))});const So=[];Ko.keys(t).forEach(o=>{!~So.indexOf(o)&&o.slice(0,2)!=="$$"&&o!=="slot"&&Qo.warn(`<Page> was created with unknown prop '${o}'`)});function bo(o){Fo[o?"unshift":"push"](()=>{te=o,e(22,te)})}return r.$capture_state=()=>({onMount:Rn,onDestroy:Mn,goto:vt,base:it,page:_t,ChevronRight:Go,Music:Gn,Card:Je,Button:ut,VolumeBar:Mo,PitchDisplay:Oo,PitchDetector:On,PitchDetectionDisplay:jn,PageLayout:Ln,Tone:jo,audioManager:We,harmonicCorrection:St,logger:ce,ScoreResultPanel:Lo,IntervalProgressTracker:zo,ConsistencyGraph:Vo,FeedbackDisplay:Ho,SessionStatistics:xo,UnifiedScoreResultFixed:Yt,ActionButtons:Xt,EvaluationEngine:nt,EnhancedScoringEngine:In,trainingProgress:Nt,currentSessionId:Mt,nextBaseNote:Rt,nextBaseName:Ft,isLoading:kt,storageError:Bo,isCompleted:Ct,sessionHistory:wt,overallGrade:Po,overallAccuracy:Eo,progressPercentage:To,remainingSessions:qt,latestSessionResult:Ao,unifiedScoreData:Dt,loadProgress:bt,saveSessionResult:Nn,resetProgress:Io,createNewProgress:No,startNewCycleIfCompleted:tt,getVolumeForDevice:Pn,calculateUnifiedGrade:L,generateTestUnifiedScoreData:Xo,trainingPhase:k,microphoneState:w,microphoneHealthy:j,microphoneErrors:B,buildVersion:Jt,buildTimestamp:Kt,updateStatus:Qt,SCALE_NAMES:Q,currentBaseNote:A,currentBaseFrequency:b,isPlaying:K,currentScaleIndex:T,scaleSteps:q,guideAnimationTimer:x,isGuideAnimationActive:F,guideStartProgress:H,isGuideStartBarActive:E,guideStartTimer:Y,musicIconGlowing:ye,scaleEvaluations:se,previousEvaluations:_e,currentVolume:Se,currentFrequency:Ee,detectedNote:je,pitchDifference:He,sessionResults:Ve,scoringEngine:Ce,currentScoreData:ze,intervalData:ke,consistencyData:Pe,feedbackData:Oe,technicalFeedbackData:Xe,sessionStatistics:Fe,activeTab:ft,noteResultsForDisplay:re,currentUnifiedScoreData:le,sampler:ge,isSamplerLoading:Re,pitchDetectorComponent:te,mediaStream:Be,audioContext:st,sourceNode:rt,sessionStartTime:Ke,baseNotes:Ge,checkMicrophonePermission:Ue,selectRandomBaseNote:dt,playRandomBaseNote:Zt,playCurrentBaseNote:$t,playBaseNoteOnly:yo,playBaseNote:mt,startGuideStartBar:en,cleanupGuideStartBar:ho,calculateExpectedFrequency:Ye,calculateTargetFrequency:tn,startGuideAnimation:gt,finishGuideAnimation:nn,calculateFinalResults:on,getStatusMessage:po,getDisplayEvaluations:vo,goToMicrophoneTest:sn,goHome:Ze,initializeSampler:rn,checkExistingMicrophonePermission:at,initializeScoringEngine:an,updateScoringEngine:cn,generateFinalScoring:ln,generateTestScoreData:un,switchTab:_o,generateUnifiedScoreData:fn,saveSessionToStorage:dn,generateEnhancedScoringData:mn,generateFallbackEnhancedData:yt,generateIntervalDataFromResults:At,generateIntervalDataFromSessionHistory:Bn,generateConsistencyDataFromResults:ht,generateFeedbackFromResults:pt,generateTechnicalFeedbackFromEnhancedEngine:gn,handlePitchUpdate:yn,getEvaluationCorrectedFrequency:hn,frequencyToNote:xn,multiStageOctaveCorrection:Tt,evaluateScaleStep:pn,completeSession:vn,restartSameBaseNote:_n,restartDifferentBaseNote:Sn,scrollToTop:ot,resetSessionState:ct,startNewCycle:bn,handleActionButtonClick:Dn,startContinuousMode:qn,handleSessionComplete:wn,handlePitchDetectorStateChange:go,handlePitchDetectorError:Cn,handleMicrophoneHealthChange:kn,canRestartSession:s,canStartTraining:i,$currentSessionId:n,$unifiedScoreData:c,$isCompleted:a,$page:u,$remainingSessions:f,$nextBaseName:d,$nextBaseNote:m,$sessionHistory:v,$trainingProgress:D,$isLoading:p}),r.$inject_state=o=>{"trainingPhase"in o&&e(0,k=o.trainingPhase),"microphoneState"in o&&e(1,w=o.microphoneState),"microphoneHealthy"in o&&e(2,j=o.microphoneHealthy),"microphoneErrors"in o&&e(6,B=o.microphoneErrors),"currentBaseNote"in o&&e(7,A=o.currentBaseNote),"currentBaseFrequency"in o&&e(8,b=o.currentBaseFrequency),"isPlaying"in o&&e(9,K=o.isPlaying),"currentScaleIndex"in o&&(T=o.currentScaleIndex),"scaleSteps"in o&&e(10,q=o.scaleSteps),"guideAnimationTimer"in o&&(x=o.guideAnimationTimer),"isGuideAnimationActive"in o&&(F=o.isGuideAnimationActive),"guideStartProgress"in o&&e(11,H=o.guideStartProgress),"isGuideStartBarActive"in o&&(E=o.isGuideStartBarActive),"guideStartTimer"in o&&(Y=o.guideStartTimer),"musicIconGlowing"in o&&e(12,ye=o.musicIconGlowing),"scaleEvaluations"in o&&(se=o.scaleEvaluations),"previousEvaluations"in o&&(_e=o.previousEvaluations),"currentVolume"in o&&e(13,Se=o.currentVolume),"currentFrequency"in o&&e(14,Ee=o.currentFrequency),"detectedNote"in o&&e(15,je=o.detectedNote),"pitchDifference"in o&&(He=o.pitchDifference),"sessionResults"in o&&(Ve=o.sessionResults),"scoringEngine"in o&&(Ce=o.scoringEngine),"currentScoreData"in o&&e(16,ze=o.currentScoreData),"intervalData"in o&&e(3,ke=o.intervalData),"consistencyData"in o&&e(17,Pe=o.consistencyData),"feedbackData"in o&&e(18,Oe=o.feedbackData),"technicalFeedbackData"in o&&e(19,Xe=o.technicalFeedbackData),"sessionStatistics"in o&&e(20,Fe=o.sessionStatistics),"activeTab"in o&&(ft=o.activeTab),"noteResultsForDisplay"in o&&(re=o.noteResultsForDisplay),"currentUnifiedScoreData"in o&&e(21,le=o.currentUnifiedScoreData),"sampler"in o&&e(33,ge=o.sampler),"isSamplerLoading"in o&&e(34,Re=o.isSamplerLoading),"pitchDetectorComponent"in o&&e(22,te=o.pitchDetectorComponent),"mediaStream"in o&&(Be=o.mediaStream),"audioContext"in o&&(st=o.audioContext),"sourceNode"in o&&(rt=o.sourceNode),"sessionStartTime"in o&&(Ke=o.sessionStartTime),"canRestartSession"in o&&(s=o.canRestartSession),"canStartTraining"in o&&(i=o.canStartTraining)},t&&"$$inject"in t&&r.$inject_state(t.$$inject),r.$$.update=()=>{r.$$.dirty[0]&6|r.$$.dirty[1]&12&&(i=w==="granted"&&!Re&&ge&&j),r.$$.dirty[0]&1&&(s=k==="results"),r.$$.dirty[0]&56&&c&&a&&c.sessionHistory&&(e(3,ke=Bn(c.sessionHistory)),console.log("üéµ [RandomTraining] intervalDataÁîüÊàêÂÆå‰∫Ü:",ke.length,"‰ª∂")),r.$$.dirty[0]&3&&k==="setup"&&w==="granted"&&ot()},[k,w,j,ke,c,a,B,A,b,K,q,H,ye,Se,Ee,je,ze,Pe,Oe,Xe,Fe,le,te,n,v,p,sn,Ze,yn,Dn,qn,Cn,kn,ge,Re,bo]}class is extends Do{constructor(t){super(t),qo(this,t,Yo,Wt,wo,{},null,[-1,-1,-1,-1]),ee("SvelteRegisterComponent",{component:this,tagName:"Page",options:t,id:Wt.name})}}export{is as component,cs as universal};
