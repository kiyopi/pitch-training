import{S as de,i as ve,s as he,n as oe,d as h,K as q,y as m,b as F,c as u,e as p,f as $,h as w,j as _,k as E,I as Ve,Q as ke,a as Q,z as ne,G as U,g as T,t as P,C as Y,m as O,o as X,D as Z,H as Ne,E as x,F as ee,J as Me,p as Te,q as Pe,L as Ie,r as pe}from"../chunks/Dh4MrDnZ.js";import{e as ce}from"../chunks/D6YF6ztN.js";import"../chunks/IHki7fMi.js";import{P as He,C as le}from"../chunks/BIrZeKHn.js";import{B as fe}from"../chunks/CyYDdAyA.js";const Be=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function Ae(r){let e,t,a,l,s,n;return{c(){e=_("div"),t=_("div"),a=_("div"),l=E(),s=_("div"),this.h()},l(i){e=p(i,"DIV",{class:!0});var o=$(e);t=p(o,"DIV",{class:!0,style:!0});var v=$(t);a=p(v,"DIV",{class:!0,style:!0}),$(a).forEach(h),v.forEach(h),l=w(o),s=p(o,"DIV",{class:!0,style:!0}),$(s).forEach(h),o.forEach(h),this.h()},h(){m(a,"class","volume-bar-fill"),q(a,"position","absolute"),q(a,"top","0"),q(a,"left","0"),q(a,"height","100%"),m(t,"class","volume-bar-bg"),q(t,"height",r[1]),q(t,"border-radius","9999px"),q(t,"background-color","#e2e8f0"),q(t,"position","relative"),q(t,"overflow","hidden"),m(s,"class","threshold-indicator svelte-13z7ppf"),q(s,"position","absolute"),q(s,"top","0"),q(s,"left",r[0]+"%"),q(s,"width","2px"),q(s,"height",r[1]),q(s,"background-color","#64748b"),q(s,"border-radius","1px"),m(e,"class",n="volume-bar-container "+r[2]+" svelte-13z7ppf")},m(i,o){F(i,e,o),u(e,t),u(t,a),r[5](a),u(e,l),u(e,s)},p(i,[o]){o&2&&q(t,"height",i[1]),o&1&&q(s,"left",i[0]+"%"),o&2&&q(s,"height",i[1]),o&4&&n!==(n="volume-bar-container "+i[2]+" svelte-13z7ppf")&&m(e,"class",n)},i:oe,o:oe,d(i){i&&h(e),r[5](null)}}}function Se(r,e,t){let{volume:a=0}=e,{threshold:l=30}=e,{height:s="12px"}=e,{className:n=""}=e,i;function o(c){return c<l?"#94a3b8":c<60?"#10b981":c<80?"#f59e0b":"#ef4444"}function v(c){if(i){const d=Math.max(0,Math.min(100,c)),g=o(d);(!window.volumeBarLastUpdate||Math.abs(window.volumeBarLastUpdate-d)>10)&&(console.log("VolumeBar更新:",d.toFixed(1),"%","color:",g),window.volumeBarLastUpdate=d),t(3,i.style.width=`${d}%`,i),t(3,i.style.backgroundColor=g,i)}}Ve(()=>{i&&(t(3,i.style.width="0%",i),t(3,i.style.backgroundColor="#94a3b8",i),t(3,i.style.height=s,i),t(3,i.style.borderRadius="9999px",i),t(3,i.style.transition="all 0.1s ease-out",i))});function f(c){ke[c?"unshift":"push"](()=>{i=c,t(3,i)})}return r.$$set=c=>{"volume"in c&&t(4,a=c.volume),"threshold"in c&&t(0,l=c.threshold),"height"in c&&t(1,s=c.height),"className"in c&&t(2,n=c.className)},r.$$.update=()=>{r.$$.dirty&16&&v(a)},[l,s,n,i,a,f]}class qe extends de{constructor(e){super(),ve(this,e,Se,Ae,he,{volume:4,threshold:0,height:1,className:2})}}function _e(r){let e,t,a="精度",l,s,n,i,o,v,f,c=ge(r[3])+"",d,g,y,b=r[3]>0?"+":"",j,V=r[3].toFixed(1)+"",C,N;return{c(){e=_("div"),t=_("div"),t.textContent=a,l=E(),s=_("div"),n=_("div"),i=E(),o=_("div"),v=E(),f=_("div"),d=P(c),g=E(),y=_("div"),j=P(b),C=P(V),N=P("%"),this.h()},l(I){e=p(I,"DIV",{class:!0});var D=$(e);t=p(D,"DIV",{class:!0,"data-svelte-h":!0}),U(t)!=="svelte-4oi8f7"&&(t.textContent=a),l=w(D),s=p(D,"DIV",{class:!0});var S=$(s);n=p(S,"DIV",{class:!0,style:!0}),$(n).forEach(h),i=w(S),o=p(S,"DIV",{class:!0}),$(o).forEach(h),S.forEach(h),v=w(D),f=p(D,"DIV",{class:!0,style:!0});var R=$(f);d=T(R,c),R.forEach(h),g=w(D),y=p(D,"DIV",{class:!0});var H=$(y);j=T(H,b),C=T(H,V),N=T(H,"%"),H.forEach(h),D.forEach(h),this.h()},h(){m(t,"class","label svelte-17lpbmi"),m(n,"class","accuracy-bar svelte-17lpbmi"),q(n,"background-color",ie(r[3])),q(n,"width",Math.abs(r[3])+"%"),m(o,"class","accuracy-center svelte-17lpbmi"),m(s,"class","accuracy-bar-container svelte-17lpbmi"),m(f,"class","accuracy-text svelte-17lpbmi"),q(f,"color",ie(r[3])),m(y,"class","accuracy-value svelte-17lpbmi"),m(e,"class","accuracy-display svelte-17lpbmi")},m(I,D){F(I,e,D),u(e,t),u(e,l),u(e,s),u(s,n),u(s,i),u(s,o),u(e,v),u(e,f),u(f,d),u(e,g),u(e,y),u(y,j),u(y,C),u(y,N)},p(I,D){D&8&&q(n,"background-color",ie(I[3])),D&8&&q(n,"width",Math.abs(I[3])+"%"),D&8&&c!==(c=ge(I[3])+"")&&Q(d,c),D&8&&q(f,"color",ie(I[3])),D&8&&b!==(b=I[3]>0?"+":"")&&Q(j,b),D&8&&V!==(V=I[3].toFixed(1)+"")&&Q(C,V)},d(I){I&&h(e)}}}function Le(r){let e,t,a,l="目標音程",s,n,i=r[6](r[1])+"",o,v,f,c,d="現在の音程",g,y,b=(r[4]&&r[6](r[2])||"---")+"",j,V,C,N,I="周波数",D,S,R=be(r[0])+"",H,J,B,M=r[4]&&r[2]&&_e(r);return{c(){e=_("div"),t=_("div"),a=_("div"),a.textContent=l,s=E(),n=_("div"),o=P(i),v=E(),f=_("div"),c=_("div"),c.textContent=d,g=E(),y=_("div"),j=P(b),V=E(),C=_("div"),N=_("div"),N.textContent=I,D=E(),S=_("div"),H=P(R),J=E(),M&&M.c(),this.h()},l(A){e=p(A,"DIV",{class:!0});var L=$(e);t=p(L,"DIV",{class:!0});var G=$(t);a=p(G,"DIV",{class:!0,"data-svelte-h":!0}),U(a)!=="svelte-101q5wq"&&(a.textContent=l),s=w(G),n=p(G,"DIV",{class:!0});var k=$(n);o=T(k,i),k.forEach(h),G.forEach(h),v=w(L),f=p(L,"DIV",{class:!0});var z=$(f);c=p(z,"DIV",{class:!0,"data-svelte-h":!0}),U(c)!=="svelte-1p184h3"&&(c.textContent=d),g=w(z),y=p(z,"DIV",{class:!0});var K=$(y);j=T(K,b),K.forEach(h),z.forEach(h),V=w(L),C=p(L,"DIV",{class:!0});var te=$(C);N=p(te,"DIV",{class:!0,"data-svelte-h":!0}),U(N)!=="svelte-1iigar3"&&(N.textContent=I),D=w(te),S=p(te,"DIV",{class:!0});var W=$(S);H=T(W,R),W.forEach(h),te.forEach(h),J=w(L),M&&M.l(L),L.forEach(h),this.h()},h(){m(a,"class","label svelte-17lpbmi"),m(n,"class","note-name target svelte-17lpbmi"),m(t,"class","target-note svelte-17lpbmi"),m(c,"class","label svelte-17lpbmi"),m(y,"class","note-name current svelte-17lpbmi"),ne(y,"detecting",r[4]),m(f,"class","current-note svelte-17lpbmi"),m(N,"class","label svelte-17lpbmi"),m(S,"class","frequency-value svelte-17lpbmi"),m(C,"class","frequency-display svelte-17lpbmi"),m(e,"class",B="pitch-display "+r[5]+" svelte-17lpbmi")},m(A,L){F(A,e,L),u(e,t),u(t,a),u(t,s),u(t,n),u(n,o),u(e,v),u(e,f),u(f,c),u(f,g),u(f,y),u(y,j),u(e,V),u(e,C),u(C,N),u(C,D),u(C,S),u(S,H),u(e,J),M&&M.m(e,null)},p(A,[L]){L&2&&i!==(i=A[6](A[1])+"")&&Q(o,i),L&20&&b!==(b=(A[4]&&A[6](A[2])||"---")+"")&&Q(j,b),L&16&&ne(y,"detecting",A[4]),L&1&&R!==(R=be(A[0])+"")&&Q(H,R),A[4]&&A[2]?M?M.p(A,L):(M=_e(A),M.c(),M.m(e,null)):M&&(M.d(1),M=null),L&32&&B!==(B="pitch-display "+A[5]+" svelte-17lpbmi")&&m(e,"class",B)},i:oe,o:oe,d(A){A&&h(e),M&&M.d()}}}function ie(r){const e=Math.abs(r);return e<=10?"#10b981":e<=25?"#f59e0b":"#ef4444"}function ge(r){const e=Math.abs(r);return e<=10?"素晴らしい！":e<=25?"もう少し！":"調整が必要"}function be(r){return r>0?`${r.toFixed(1)} Hz`:"--.- Hz"}function ze(r,e,t){let{frequency:a=0}=e,{targetNote:l="C"}=e,{currentNote:s=""}=e,{accuracy:n=0}=e,{isDetecting:i=!1}=e,{className:o=""}=e;const v={C:"ド","C#":"ド#",Db:"レ♭",D:"レ","D#":"レ#",Eb:"ミ♭",E:"ミ",F:"ファ","F#":"ファ#",Gb:"ソ♭",G:"ソ","G#":"ソ#",Ab:"ラ♭",A:"ラ","A#":"ラ#",Bb:"シ♭",B:"シ"};function f(c){return v[c]||c}return r.$$set=c=>{"frequency"in c&&t(0,a=c.frequency),"targetNote"in c&&t(1,l=c.targetNote),"currentNote"in c&&t(2,s=c.currentNote),"accuracy"in c&&t(3,n=c.accuracy),"isDetecting"in c&&t(4,i=c.isDetecting),"className"in c&&t(5,o=c.className)},[a,l,s,n,i,o,f]}class Fe extends de{constructor(e){super(),ve(this,e,ze,Le,he,{frequency:0,targetNote:1,currentNote:2,accuracy:3,isDetecting:4,className:5})}}const{document:ye}=Be;function $e(r,e,t){const a=r.slice();return a[23]=e[t],a[25]=t,a}function Ce(r,e,t){const a=r.slice();return a[23]=e[t],a[25]=t,a}function Ge(r){let e,t,a;return t=new le({props:{variant:"default",padding:"lg",$$slots:{default:[Qe]},$$scope:{ctx:r}}}),{c(){e=_("div"),ee(t.$$.fragment),this.h()},l(l){e=p(l,"DIV",{class:!0});var s=$(e);x(t.$$.fragment,s),s.forEach(h),this.h()},h(){m(e,"class","results-screen")},m(l,s){F(l,e,s),Z(t,e,null),a=!0},p(l,s){const n={};s&134219779&&(n.$$scope={dirty:s,ctx:l}),t.$set(n)},i(l){a||(X(t.$$.fragment,l),a=!0)},o(l){O(t.$$.fragment,l),a=!1},d(l){l&&h(e),Y(t)}}}function Re(r){let e,t,a,l,s,n,i,o,v,f,c;return t=new le({props:{variant:"default",padding:"lg",$$slots:{default:[Oe]},$$scope:{ctx:r}}}),n=new le({props:{variant:"default",padding:"md",$$slots:{default:[Xe]},$$scope:{ctx:r}}}),o=new le({props:{variant:"default",padding:"md",$$slots:{default:[Ye]},$$scope:{ctx:r}}}),f=new le({props:{variant:"default",padding:"md",$$slots:{default:[Ze]},$$scope:{ctx:r}}}),{c(){e=_("div"),ee(t.$$.fragment),a=E(),l=_("div"),s=_("div"),ee(n.$$.fragment),i=E(),ee(o.$$.fragment),v=E(),ee(f.$$.fragment),this.h()},l(d){e=p(d,"DIV",{class:!0});var g=$(e);x(t.$$.fragment,g),a=w(g),l=p(g,"DIV",{class:!0});var y=$(l);s=p(y,"DIV",{class:!0});var b=$(s);x(n.$$.fragment,b),i=w(b),x(o.$$.fragment,b),b.forEach(h),y.forEach(h),v=w(g),x(f.$$.fragment,g),g.forEach(h),this.h()},h(){m(s,"class","display-grid svelte-1snjy30"),m(l,"class","realtime-display svelte-1snjy30"),m(e,"class","detection-screen")},m(d,g){F(d,e,g),Z(t,e,null),u(e,a),u(e,l),u(l,s),Z(n,s,null),u(s,i),Z(o,s,null),u(e,v),Z(f,e,null),c=!0},p(d,g){const y={};g&134217793&&(y.$$scope={dirty:g,ctx:d}),t.$set(y);const b={};g&134217984&&(b.$$scope={dirty:g,ctx:d}),n.$set(b);const j={};g&134219344&&(j.$$scope={dirty:g,ctx:d}),o.$set(j);const V={};g&134217794&&(V.$$scope={dirty:g,ctx:d}),f.$set(V)},i(d){c||(X(t.$$.fragment,d),X(n.$$.fragment,d),X(o.$$.fragment,d),X(f.$$.fragment,d),c=!0)},o(d){O(t.$$.fragment,d),O(n.$$.fragment,d),O(o.$$.fragment,d),O(f.$$.fragment,d),c=!1},d(d){d&&h(e),Y(t),Y(n),Y(o),Y(f)}}}function Ue(r){let e,t,a;return t=new le({props:{variant:"success",padding:"lg",$$slots:{default:[xe]},$$scope:{ctx:r}}}),{c(){e=_("div"),ee(t.$$.fragment),this.h()},l(l){e=p(l,"DIV",{class:!0});var s=$(e);x(t.$$.fragment,s),s.forEach(h),this.h()},h(){m(e,"class","playing-screen")},m(l,s){F(l,e,s),Z(t,e,null),a=!0},p(l,s){const n={};s&134217760&&(n.$$scope={dirty:s,ctx:l}),t.$set(n)},i(l){a||(X(t.$$.fragment,l),a=!0)},o(l){O(t.$$.fragment,l),a=!1},d(l){l&&h(e),Y(t)}}}function We(r){let e,t,a;return t=new le({props:{variant:"default",padding:"lg",$$slots:{default:[lt]},$$scope:{ctx:r}}}),{c(){e=_("div"),ee(t.$$.fragment),this.h()},l(l){e=p(l,"DIV",{class:!0});var s=$(e);x(t.$$.fragment,s),s.forEach(h),this.h()},h(){m(e,"class","start-screen")},m(l,s){F(l,e,s),Z(t,e,null),a=!0},p(l,s){const n={};s&134217732&&(n.$$scope={dirty:s,ctx:l}),t.$set(n)},i(l){a||(X(t.$$.fragment,l),a=!0)},o(l){O(t.$$.fragment,l),a=!1},d(l){l&&h(e),Y(t)}}}function je(r){let e,t,a=r[23]+"",l,s,n,i=r[0][r[25]]?"✓":"×",o,v,f;return{c(){e=_("div"),t=_("span"),l=P(a),s=E(),n=_("span"),o=P(i),f=E(),this.h()},l(c){e=p(c,"DIV",{class:!0});var d=$(e);t=p(d,"SPAN",{class:!0});var g=$(t);l=T(g,a),g.forEach(h),s=w(d),n=p(d,"SPAN",{class:!0});var y=$(n);o=T(y,i),y.forEach(h),f=w(d),d.forEach(h),this.h()},h(){m(t,"class","scale-note-name svelte-1snjy30"),m(n,"class",v="scale-result-icon "+(r[0][r[25]]?"correct":"incorrect")+" svelte-1snjy30"),m(e,"class","scale-result svelte-1snjy30")},m(c,d){F(c,e,d),u(e,t),u(t,l),u(e,s),u(e,n),u(n,o),u(e,f)},p(c,d){d&1&&i!==(i=c[0][c[25]]?"✓":"×")&&Q(o,i),d&1&&v!==(v="scale-result-icon "+(c[0][c[25]]?"correct":"incorrect")+" svelte-1snjy30")&&m(n,"class",v)},d(c){c&&h(e)}}}function Je(r){let e;return{c(){e=P("もう一度チャレンジ")},l(t){e=T(t,"もう一度チャレンジ")},m(t,a){F(t,e,a)},d(t){t&&h(e)}}}function Ke(r){let e;return{c(){e=P("結果を保存")},l(t){e=T(t,"結果を保存")},m(t,a){F(t,e,a)},d(t){t&&h(e)}}}function Qe(r){let e,t,a="トレーニング結果",l,s,n,i,o,v,f,c="点",d,g,y,b,j,V,C,N,I="音階別結果",D,S,R,H,J,B,M,A,L=ce(r[12]),G=[];for(let k=0;k<L.length;k+=1)G[k]=je($e(r,L,k));return J=new fe({props:{variant:"success",size:"lg",fullWidth:!0,$$slots:{default:[Je]},$$scope:{ctx:r}}}),J.$on("click",r[13]),M=new fe({props:{variant:"secondary",size:"md",fullWidth:!0,$$slots:{default:[Ke]},$$scope:{ctx:r}}}),{c(){e=_("div"),t=_("h2"),t.textContent=a,l=E(),s=_("div"),n=_("div"),i=_("span"),o=P(r[11]),v=E(),f=_("span"),f.textContent=c,d=E(),g=_("p"),y=P("8音階中 "),b=P(r[1]),j=P("音階 正解"),V=E(),C=_("div"),N=_("h3"),N.textContent=I,D=E(),S=_("div");for(let k=0;k<G.length;k+=1)G[k].c();R=E(),H=_("div"),ee(J.$$.fragment),B=E(),ee(M.$$.fragment),this.h()},l(k){e=p(k,"DIV",{class:!0});var z=$(e);t=p(z,"H2",{class:!0,"data-svelte-h":!0}),U(t)!=="svelte-1w4iqdy"&&(t.textContent=a),l=w(z),s=p(z,"DIV",{class:!0});var K=$(s);n=p(K,"DIV",{class:!0});var te=$(n);i=p(te,"SPAN",{class:!0});var W=$(i);o=T(W,r[11]),W.forEach(h),v=w(te),f=p(te,"SPAN",{class:!0,"data-svelte-h":!0}),U(f)!=="svelte-yaz7vv"&&(f.textContent=c),te.forEach(h),d=w(K),g=p(K,"P",{class:!0});var se=$(g);y=T(se,"8音階中 "),b=T(se,r[1]),j=T(se,"音階 正解"),se.forEach(h),K.forEach(h),V=w(z),C=p(z,"DIV",{class:!0});var ae=$(C);N=p(ae,"H3",{class:!0,"data-svelte-h":!0}),U(N)!=="svelte-140f1nw"&&(N.textContent=I),D=w(ae),S=p(ae,"DIV",{class:!0});var me=$(S);for(let ue=0;ue<G.length;ue+=1)G[ue].l(me);me.forEach(h),ae.forEach(h),R=w(z),H=p(z,"DIV",{class:!0});var re=$(H);x(J.$$.fragment,re),B=w(re),x(M.$$.fragment,re),re.forEach(h),z.forEach(h),this.h()},h(){m(t,"class","results-title svelte-1snjy30"),m(i,"class","score-value svelte-1snjy30"),m(f,"class","score-unit svelte-1snjy30"),m(n,"class","score-circle svelte-1snjy30"),m(g,"class","score-description svelte-1snjy30"),m(s,"class","score-display svelte-1snjy30"),m(N,"class","details-title svelte-1snjy30"),m(S,"class","scale-results svelte-1snjy30"),m(C,"class","detailed-results"),m(H,"class","action-buttons svelte-1snjy30"),m(e,"class","results-content svelte-1snjy30")},m(k,z){F(k,e,z),u(e,t),u(e,l),u(e,s),u(s,n),u(n,i),u(i,o),u(n,v),u(n,f),u(s,d),u(s,g),u(g,y),u(g,b),u(g,j),u(e,V),u(e,C),u(C,N),u(C,D),u(C,S);for(let K=0;K<G.length;K+=1)G[K]&&G[K].m(S,null);u(e,R),u(e,H),Z(J,H,null),u(H,B),Z(M,H,null),A=!0},p(k,z){if((!A||z&2048)&&Q(o,k[11]),(!A||z&2)&&Q(b,k[1]),z&4097){L=ce(k[12]);let W;for(W=0;W<L.length;W+=1){const se=$e(k,L,W);G[W]?G[W].p(se,z):(G[W]=je(se),G[W].c(),G[W].m(S,null))}for(;W<G.length;W+=1)G[W].d(1);G.length=L.length}const K={};z&134217728&&(K.$$scope={dirty:z,ctx:k}),J.$set(K);const te={};z&134217728&&(te.$$scope={dirty:z,ctx:k}),M.$set(te)},i(k){A||(X(J.$$.fragment,k),X(M.$$.fragment,k),A=!0)},o(k){O(J.$$.fragment,k),O(M.$$.fragment,k),A=!1},d(k){k&&h(e),Ie(G,k),Y(J),Y(M)}}}function De(r){let e,t=r[0][r[25]]?"✓":"×",a,l;return{c(){e=_("span"),a=P(t),this.h()},l(s){e=p(s,"SPAN",{class:!0});var n=$(e);a=T(n,t),n.forEach(h),this.h()},h(){m(e,"class",l="result-icon "+(r[0][r[25]]?"correct":"incorrect")+" svelte-1snjy30")},m(s,n){F(s,e,n),u(e,a)},p(s,n){n&1&&t!==(t=s[0][s[25]]?"✓":"×")&&Q(a,t),n&1&&l!==(l="result-icon "+(s[0][s[25]]?"correct":"incorrect")+" svelte-1snjy30")&&m(e,"class",l)},d(s){s&&h(e)}}}function we(r){let e,t,a=r[23]+"",l,s,n,i=r[0][r[25]]!==void 0&&De(r);return{c(){e=_("div"),t=_("span"),l=P(a),s=E(),i&&i.c(),n=E(),this.h()},l(o){e=p(o,"DIV",{class:!0});var v=$(e);t=p(v,"SPAN",{class:!0});var f=$(t);l=T(f,a),f.forEach(h),s=w(v),i&&i.l(v),n=w(v),v.forEach(h),this.h()},h(){m(t,"class","note-text svelte-1snjy30"),m(e,"class","scale-note svelte-1snjy30"),ne(e,"active",r[25]===r[6]),ne(e,"completed",r[0][r[25]]!==void 0)},m(o,v){F(o,e,v),u(e,t),u(t,l),u(e,s),i&&i.m(e,null),u(e,n)},p(o,v){o[0][o[25]]!==void 0?i?i.p(o,v):(i=De(o),i.c(),i.m(e,n)):i&&(i.d(1),i=null),v&64&&ne(e,"active",o[25]===o[6]),v&1&&ne(e,"completed",o[0][o[25]]!==void 0)},d(o){o&&h(e),i&&i.d()}}}function Oe(r){let e,t,a="ドレミファソラシドを歌ってください",l,s,n=ce(r[12]),i=[];for(let o=0;o<n.length;o+=1)i[o]=we(Ce(r,n,o));return{c(){e=_("div"),t=_("h2"),t.textContent=a,l=E(),s=_("div");for(let o=0;o<i.length;o+=1)i[o].c();this.h()},l(o){e=p(o,"DIV",{class:!0});var v=$(e);t=p(v,"H2",{class:!0,"data-svelte-h":!0}),U(t)!=="svelte-9l8glf"&&(t.textContent=a),l=w(v),s=p(v,"DIV",{class:!0});var f=$(s);for(let c=0;c<i.length;c+=1)i[c].l(f);f.forEach(h),v.forEach(h),this.h()},h(){m(t,"class","guide-title svelte-1snjy30"),m(s,"class","scale-guide svelte-1snjy30"),m(e,"class","guide-content svelte-1snjy30")},m(o,v){F(o,e,v),u(e,t),u(e,l),u(e,s);for(let f=0;f<i.length;f+=1)i[f]&&i[f].m(s,null)},p(o,v){if(v&4161){n=ce(o[12]);let f;for(f=0;f<n.length;f+=1){const c=Ce(o,n,f);i[f]?i[f].p(c,v):(i[f]=we(c),i[f].c(),i[f].m(s,null))}for(;f<i.length;f+=1)i[f].d(1);i.length=n.length}},d(o){o&&h(e),Ie(i,o)}}}function Xe(r){let e,t,a="音量レベル",l,s,n;return s=new qe({props:{volume:r[8],height:"20px"}}),{c(){e=_("div"),t=_("h3"),t.textContent=a,l=E(),ee(s.$$.fragment),this.h()},l(i){e=p(i,"DIV",{class:!0});var o=$(e);t=p(o,"H3",{class:!0,"data-svelte-h":!0}),U(t)!=="svelte-1nc8gri"&&(t.textContent=a),l=w(o),x(s.$$.fragment,o),o.forEach(h),this.h()},h(){m(t,"class","display-title svelte-1snjy30"),m(e,"class","volume-display")},m(i,o){F(i,e,o),u(e,t),u(e,l),Z(s,e,null),n=!0},p(i,o){const v={};o&256&&(v.volume=i[8]),s.$set(v)},i(i){n||(X(s.$$.fragment,i),n=!0)},o(i){O(s.$$.fragment,i),n=!1},d(i){i&&h(e),Y(s)}}}function Ye(r){let e,t;return e=new Fe({props:{frequency:r[9],targetNote:r[12][r[6]],currentNote:r[10],accuracy:0,isDetecting:r[4]}}),{c(){ee(e.$$.fragment)},l(a){x(e.$$.fragment,a)},m(a,l){Z(e,a,l),t=!0},p(a,l){const s={};l&512&&(s.frequency=a[9]),l&64&&(s.targetNote=a[12][a[6]]),l&1024&&(s.currentNote=a[10]),l&16&&(s.isDetecting=a[4]),e.$set(s)},i(a){t||(X(e.$$.fragment,a),t=!0)},o(a){O(e.$$.fragment,a),t=!1},d(a){Y(e,a)}}}function Ze(r){let e,t,a="進行状況",l,s,n,i,o=r[12][r[6]]+"",v,f,c=r[6]+1+"",d,g,y,b,j,V,C,N;return{c(){e=_("div"),t=_("h3"),t.textContent=a,l=E(),s=_("div"),n=_("span"),i=P("現在: "),v=P(o),f=P(" ("),d=P(c),g=P("/8)"),y=E(),b=_("span"),j=P("正解: "),V=P(r[1]),C=P("/"),N=P(r[6]),this.h()},l(I){e=p(I,"DIV",{class:!0});var D=$(e);t=p(D,"H3",{class:!0,"data-svelte-h":!0}),U(t)!=="svelte-v1qnd4"&&(t.textContent=a),l=w(D),s=p(D,"DIV",{class:!0});var S=$(s);n=p(S,"SPAN",{});var R=$(n);i=T(R,"現在: "),v=T(R,o),f=T(R," ("),d=T(R,c),g=T(R,"/8)"),R.forEach(h),y=w(S),b=p(S,"SPAN",{});var H=$(b);j=T(H,"正解: "),V=T(H,r[1]),C=T(H,"/"),N=T(H,r[6]),H.forEach(h),S.forEach(h),D.forEach(h),this.h()},h(){m(t,"class","progress-title svelte-1snjy30"),m(s,"class","progress-details svelte-1snjy30"),m(e,"class","progress-info svelte-1snjy30")},m(I,D){F(I,e,D),u(e,t),u(e,l),u(e,s),u(s,n),u(n,i),u(n,v),u(n,f),u(n,d),u(n,g),u(s,y),u(s,b),u(b,j),u(b,V),u(b,C),u(b,N)},p(I,D){D&64&&o!==(o=I[12][I[6]]+"")&&Q(v,o),D&64&&c!==(c=I[6]+1+"")&&Q(d,c),D&2&&Q(V,I[1]),D&64&&Q(N,I[6])},d(I){I&&h(e)}}}function xe(r){let e,t,a='<svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"></circle><polygon points="10,8 16,12 10,16"></polygon></svg>',l,s,n="基音再生中",i,o,v,f,c,d,g="この音を覚えて「ド」として認識してください",y,b,j='<div class="progress-bar svelte-1snjy30"><div class="progress-fill svelte-1snjy30"></div></div>';return{c(){e=_("div"),t=_("div"),t.innerHTML=a,l=E(),s=_("h2"),s.textContent=n,i=E(),o=_("p"),v=P("基音: "),f=P(r[5]),c=E(),d=_("p"),d.textContent=g,y=E(),b=_("div"),b.innerHTML=j,this.h()},l(V){e=p(V,"DIV",{class:!0});var C=$(e);t=p(C,"DIV",{class:!0,"data-svelte-h":!0}),U(t)!=="svelte-11l4yoz"&&(t.innerHTML=a),l=w(C),s=p(C,"H2",{class:!0,"data-svelte-h":!0}),U(s)!=="svelte-1maueo6"&&(s.textContent=n),i=w(C),o=p(C,"P",{class:!0});var N=$(o);v=T(N,"基音: "),f=T(N,r[5]),N.forEach(h),c=w(C),d=p(C,"P",{class:!0,"data-svelte-h":!0}),U(d)!=="svelte-1hcrx2z"&&(d.textContent=g),y=w(C),b=p(C,"DIV",{class:!0,"data-svelte-h":!0}),U(b)!=="svelte-4yu433"&&(b.innerHTML=j),C.forEach(h),this.h()},h(){m(t,"class","playing-icon svelte-1snjy30"),m(s,"class","playing-title svelte-1snjy30"),m(o,"class","playing-note svelte-1snjy30"),m(d,"class","playing-instruction svelte-1snjy30"),m(b,"class","playing-progress svelte-1snjy30"),m(e,"class","playing-content svelte-1snjy30")},m(V,C){F(V,e,C),u(e,t),u(e,l),u(e,s),u(e,i),u(e,o),u(o,v),u(o,f),u(e,c),u(e,d),u(e,y),u(e,b)},p(V,C){C&32&&Q(f,V[5])},d(V){V&&h(e)}}}function et(r){let e;return{c(){e=P("トレーニング開始")},l(t){e=T(t,"トレーニング開始")},m(t,a){F(t,e,a)},d(t){t&&h(e)}}}function tt(r){let e;return{c(){e=P("ピアノ音源読み込み中...")},l(t){e=T(t,"ピアノ音源読み込み中...")},m(t,a){F(t,e,a)},d(t){t&&h(e)}}}function st(r){let e;function t(s,n){return s[2]?et:tt}let a=t(r),l=a(r);return{c(){l.c(),e=pe()},l(s){l.l(s),e=pe()},m(s,n){l.m(s,n),F(s,e,n)},p(s,n){a!==(a=t(s))&&(l.d(1),l=a(s),l&&(l.c(),l.m(e.parentNode,e)))},d(s){s&&h(e),l.d(s)}}}function Ee(r){let e,t="Salamander Grand Piano 音源を読み込んでいます";return{c(){e=_("p"),e.textContent=t,this.h()},l(a){e=p(a,"P",{class:!0,"data-svelte-h":!0}),U(e)!=="svelte-1j6c2dk"&&(e.textContent=t),this.h()},h(){m(e,"class","loading-message svelte-1snjy30")},m(a,l){F(a,e,l)},d(a){a&&h(e)}}}function lt(r){let e,t,a="トレーニング開始",l,s,n=`基音を聞いた後、その音を「ド」として<br/>
              ドレミファソラシドを連続して歌ってください`,i,o,v='<div class="instruction-item svelte-1snjy30"><span class="step-number svelte-1snjy30">1</span> <div><h3 class="svelte-1snjy30">基音を聞く</h3> <p class="svelte-1snjy30">ランダムに選ばれた基音をピアノで再生します</p></div></div> <div class="instruction-item svelte-1snjy30"><span class="step-number svelte-1snjy30">2</span> <div><h3 class="svelte-1snjy30">連続歌唱</h3> <p class="svelte-1snjy30">基音を「ド」として、ドレミファソラシドを連続して歌います</p></div></div> <div class="instruction-item svelte-1snjy30"><span class="step-number svelte-1snjy30">3</span> <div><h3 class="svelte-1snjy30">自動判定</h3> <p class="svelte-1snjy30">歌唱中にリアルタイムで各音階を自動判定します</p></div></div>',f,c,d,g;c=new fe({props:{variant:"success",size:"lg",fullWidth:!0,disabled:!r[2],$$slots:{default:[st]},$$scope:{ctx:r}}}),c.$on("click",r[13]);let y=!r[2]&&Ee();return{c(){e=_("div"),t=_("h2"),t.textContent=a,l=E(),s=_("p"),s.innerHTML=n,i=E(),o=_("div"),o.innerHTML=v,f=E(),ee(c.$$.fragment),d=E(),y&&y.c(),this.h()},l(b){e=p(b,"DIV",{class:!0});var j=$(e);t=p(j,"H2",{class:!0,"data-svelte-h":!0}),U(t)!=="svelte-177yn6"&&(t.textContent=a),l=w(j),s=p(j,"P",{class:!0,"data-svelte-h":!0}),U(s)!=="svelte-c83iab"&&(s.innerHTML=n),i=w(j),o=p(j,"DIV",{class:!0,"data-svelte-h":!0}),U(o)!=="svelte-u1n8ly"&&(o.innerHTML=v),f=w(j),x(c.$$.fragment,j),d=w(j),y&&y.l(j),j.forEach(h),this.h()},h(){m(t,"class","start-title svelte-1snjy30"),m(s,"class","start-description svelte-1snjy30"),m(o,"class","instructions svelte-1snjy30"),m(e,"class","start-content svelte-1snjy30")},m(b,j){F(b,e,j),u(e,t),u(e,l),u(e,s),u(e,i),u(e,o),u(e,f),Z(c,e,null),u(e,d),y&&y.m(e,null),g=!0},p(b,j){const V={};j&4&&(V.disabled=!b[2]),j&134217732&&(V.$$scope={dirty:j,ctx:b}),c.$set(V),b[2]?y&&(y.d(1),y=null):y||(y=Ee(),y.c(),y.m(e,null))},i(b){g||(X(c.$$.fragment,b),g=!0)},o(b){O(c.$$.fragment,b),g=!1},d(b){b&&h(e),Y(c),y&&y.d()}}}function nt(r){let e,t,a='<div class="mode-header svelte-1snjy30"><div class="mode-icon svelte-1snjy30"><svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 18V5l12-2v13"></path><circle cx="6" cy="18" r="3"></circle><circle cx="18" cy="16" r="3"></circle></svg></div> <div><h1 class="mode-title svelte-1snjy30">ランダム基音モード</h1> <p class="mode-description svelte-1snjy30">10種類の基音からランダムに選択してトレーニング</p></div></div>',l,s,n,i;const o=[We,Ue,Re,Ge],v=[];function f(c,d){return!c[3]&&!c[4]&&!c[7]?0:c[3]?1:c[4]?2:c[7]?3:-1}return~(s=f(r))&&(n=v[s]=o[s](r)),{c(){e=_("div"),t=_("div"),t.innerHTML=a,l=E(),n&&n.c(),this.h()},l(c){e=p(c,"DIV",{class:!0});var d=$(e);t=p(d,"DIV",{class:!0,"data-svelte-h":!0}),U(t)!=="svelte-1oabx6r"&&(t.innerHTML=a),l=w(d),n&&n.l(d),d.forEach(h),this.h()},h(){m(t,"class","header svelte-1snjy30"),m(e,"class","random-training svelte-1snjy30")},m(c,d){F(c,e,d),u(e,t),u(e,l),~s&&v[s].m(e,null),i=!0},p(c,d){let g=s;s=f(c),s===g?~s&&v[s].p(c,d):(n&&(Te(),O(v[g],1,1,()=>{v[g]=null}),Pe()),~s?(n=v[s],n?n.p(c,d):(n=v[s]=o[s](c),n.c()),X(n,1),n.m(e,null)):n=null)},i(c){i||(X(n),i=!0)},o(c){O(n),i=!1},d(c){c&&h(e),~s&&v[s].d()}}}function at(r){let e,t,a;return t=new He({props:{showBackButton:!0,$$slots:{default:[nt]},$$scope:{ctx:r}}}),{c(){e=E(),ee(t.$$.fragment),this.h()},l(l){Ne("svelte-1nfe5e4",ye.head).forEach(h),e=w(l),x(t.$$.fragment,l),this.h()},h(){ye.title="ランダム基音モード - 相対音感トレーニング"},m(l,s){F(l,e,s),Z(t,l,s),a=!0},p(l,[s]){const n={};s&134221823&&(n.$$scope={dirty:s,ctx:l}),t.$set(n)},i(l){a||(X(t.$$.fragment,l),a=!0)},o(l){O(t.$$.fragment,l),a=!1},d(l){l&&h(e),Y(t,l)}}}function rt(r,e,t){let a,l,s=null,n=null,i=!1,o=!1,v=!1,f="",c=0,d=[],g=!1,y=0,b=0,j="";const V=["ド","レ","ミ","ファ","ソ","ラ","シ","ド"],C=["Bb3","B3","C4","Db4","D4","Eb4","E4","F4","Gb4","Ab4"];async function N(){try{if(typeof window<"u"&&!window.Tone){const B=document.createElement("script");B.src="https://unpkg.com/tone@14.7.77/build/Tone.js",B.onload=async()=>{window.Tone=window.Tone,s=window.Tone,await I()},document.head.appendChild(B)}else window.Tone&&(s=window.Tone,await I())}catch(B){console.error("Tone.js初期化エラー:",B)}}async function I(){try{if(!s)return;s.context.state!=="running"&&await s.start(),n=new s.Sampler({urls:{C4:"C4.mp3"},baseUrl:"https://tonejs.github.io/audio/salamander/",release:1.5,onload:()=>{t(2,i=!0),console.log("Salamander Grand Piano読み込み完了")}}).toDestination()}catch(B){console.error("サンプラー設定エラー:",B)}}Ve(()=>{N()}),Me(()=>{n&&n.dispose()});function D(){const B=Math.floor(Math.random()*C.length);return t(5,f=C[B]),f}function S(){t(6,c=0),t(0,d=[]),t(7,g=!1);const B=D();R(B)}async function R(B){t(3,o=!0),console.log(`基音再生: ${B}`);try{if(!i||!n){console.warn("Tone.js または Sampler が未初期化"),setTimeout(()=>{t(3,o=!1),H()},2500);return}s.context.state!=="running"&&await s.start(),n.triggerAttackRelease(B,"2.5"),console.log(`Salamander Grand Piano で ${B} 再生開始`),setTimeout(()=>{t(3,o=!1),H()},2500)}catch(M){console.error("基音再生エラー:",M),setTimeout(()=>{t(3,o=!1),H()},2500)}}function H(){t(4,v=!0);const B=setInterval(()=>{if(!v){clearInterval(B);return}t(8,y=Math.random()*100);const M=[261.63,293.66,329.63,349.23,392,440,493.88,523.25];if(t(9,b=M[Math.floor(Math.random()*M.length)]),t(10,j=V[Math.floor(Math.random()*V.length)]),Math.random()>.7){const A=Math.random()>.3;t(0,d[c]=A,d),t(6,c++,c),c>=8&&J()}},500)}function J(){t(4,v=!1),t(7,g=!0)}return r.$$.update=()=>{r.$$.dirty&1&&t(1,a=d.filter(B=>B).length),r.$$.dirty&2&&t(11,l=Math.round(a/8*100))},[d,a,i,o,v,f,c,g,y,b,j,l,V,S]}class dt extends de{constructor(e){super(),ve(this,e,rt,at,he,{})}}export{dt as component};
