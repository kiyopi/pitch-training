import{S as Ct,i as kt,d as I,s as qt,v as $t,c as Pt,a as wt,D as at,b as m,q as G,r as Z,u as J,f as q,w as K,E as Dt,m as T,x as Q,p as V,y as W,F as Et,g as y,z as f,h as _,j,k as P,B as z,A as S,o as b,C as F,n as X,G as it,l as Y,t as tt,H as rt}from"../chunks/DmID7u62.js";import{g as Mt}from"../chunks/D0QH3NT1.js";import"../chunks/DfcMgxLU.js";import{p as et}from"../chunks/C4MYl3ik.js";import{b as lt,g as ut}from"../chunks/DyuMuffa.js";import{P as ft,B as Bt,C as nt}from"../chunks/DZc1Xqji.js";import{a as dt,V as Tt,P as mt}from"../chunks/CyxJY5dZ.js";const{console:Vt}=Mt,g="src/routes/microphone-test/+page.svelte";function ht(u){let t,e="„Éû„Ç§„ÇØ„ÅÆ„ÉÜ„Çπ„Éà„ÇíÈñãÂßã„Åó„Åæ„Åô",c,n,s="„Éû„Ç§„ÇØ„ÉÜ„Çπ„ÉàÈñãÂßã„Éú„Çø„É≥„ÇíÊäº„Åó„Å¶„Éû„Ç§„ÇØ„ÅÆ‰ΩøÁî®„ÇíË®±ÂèØ„Åó„Å¶„Åè„Å†„Åï„ÅÑ",o,i;function a(p,h){if(p[0]==="pending")return gt;if(p[0]==="denied")return _t;if(p[0]==="initial")return vt}let d=a(u),l=d&&d(u);const r={c:function(){t=b("h3"),t.textContent=e,c=V(),n=b("p"),n.textContent=s,o=V(),l&&l.c(),i=rt(),this.h()},l:function(h){t=j(h,"H3",{class:!0,"data-svelte-h":!0}),S(t)!=="svelte-gfi16f"&&(t.textContent=e),c=T(h),n=j(h,"P",{class:!0,"data-svelte-h":!0}),S(n)!=="svelte-1w19y1h"&&(n.textContent=s),o=T(h),l&&l.l(h),i=rt(),this.h()},h:function(){f(t,"class","instructions-title svelte-1mjpxqj"),_(t,g,176,12,5317),f(n,"class","instructions-description svelte-1mjpxqj"),_(n,g,177,12,5379)},m:function(h,$){q(h,t,$),q(h,c,$),q(h,n,$),q(h,o,$),l&&l.m(h,$),q(h,i,$)},p:function(h,$){d===(d=a(h))&&l?l.p(h,$):(l&&l.d(1),l=d&&d(h),l&&(l.c(),l.m(i.parentNode,i)))},d:function(h){h&&(m(t),m(c),m(n),m(o),m(i)),l&&l.d(h)}};return I("SvelteRegisterBlock",{block:r,id:ht.name,type:"else",source:"(175:10) {:else}",ctx:u}),r}function pt(u){let t,e="„Éû„Ç§„ÇØÊ∫ñÂÇôÂÆå‰∫Ü",c,n,s,o=u[2].name+"",i,a,d,l,r,p="„Éà„É¨„Éº„Éã„É≥„Ç∞ÈñãÂßã",h,$;const D={c:function(){t=b("h3"),t.textContent=e,c=V(),n=b("p"),s=tt("„Éà„É¨„Éº„Éã„É≥„Ç∞ÈñãÂßã„Éú„Çø„É≥„ÇíÊäº„Åó„Å¶"),i=tt(o),a=tt("„Å∏ÈÄ≤„Çì„Åß„Åè„Å†„Åï„ÅÑ"),d=V(),l=b("div"),r=b("button"),r.textContent=p,this.h()},l:function(x){t=j(x,"H3",{class:!0,"data-svelte-h":!0}),S(t)!=="svelte-11dam81"&&(t.textContent=e),c=T(x),n=j(x,"P",{class:!0});var C=P(n);s=Y(C,"„Éà„É¨„Éº„Éã„É≥„Ç∞ÈñãÂßã„Éú„Çø„É≥„ÇíÊäº„Åó„Å¶"),i=Y(C,o),a=Y(C,"„Å∏ÈÄ≤„Çì„Åß„Åè„Å†„Åï„ÅÑ"),C.forEach(m),d=T(x),l=j(x,"DIV",{class:!0});var E=P(l);r=j(E,"BUTTON",{class:!0,"data-svelte-h":!0}),S(r)!=="svelte-kae9rs"&&(r.textContent=p),E.forEach(m),this.h()},h:function(){f(t,"class","ready-title svelte-1mjpxqj"),_(t,g,166,12,4912),f(n,"class","ready-description svelte-1mjpxqj"),_(n,g,167,12,4961),f(r,"class","training-start-button enabled svelte-1mjpxqj"),_(r,g,170,14,5117),f(l,"class","training-start-button-area svelte-1mjpxqj"),_(l,g,169,12,5062)},m:function(x,C){q(x,t,C),q(x,c,C),q(x,n,C),y(n,s),y(n,i),y(n,a),q(x,d,C),q(x,l,C),y(l,r),h||($=it(r,"click",u[4],!1),h=!0)},p:X,d:function(x){x&&(m(t),m(c),m(n),m(d),m(l)),h=!1,$()}};return I("SvelteRegisterBlock",{block:D,id:pt.name,type:"if",source:"(165:10) {#if micPermission === 'granted'}",ctx:u}),D}function vt(u){let t,e,c="„Éû„Ç§„ÇØ„ÉÜ„Çπ„Éà„ÇíÈñãÂßã",n,s;const o={c:function(){t=b("div"),e=b("button"),e.textContent=c,this.h()},l:function(a){t=j(a,"DIV",{class:!0});var d=P(t);e=j(d,"BUTTON",{class:!0,"data-svelte-h":!0}),S(e)!=="svelte-caex95"&&(e.textContent=c),d.forEach(m),this.h()},h:function(){f(e,"class","mic-test-button start svelte-1mjpxqj"),_(e,g,189,16,5934),f(t,"class","mic-test-button-area svelte-1mjpxqj"),_(t,g,188,14,5883)},m:function(a,d){q(a,t,d),y(t,e),n||(s=it(e,"click",u[3],!1),n=!0)},p:X,d:function(a){a&&m(t),n=!1,s()}};return I("SvelteRegisterBlock",{block:o,id:vt.name,type:"if",source:"(188:50) ",ctx:u}),o}function _t(u){let t,e,c="„Éû„Ç§„ÇØË®±ÂèØ„ÇíÂÜçË©¶Ë°å",n,s;const o={c:function(){t=b("div"),e=b("button"),e.textContent=c,this.h()},l:function(a){t=j(a,"DIV",{class:!0});var d=P(t);e=j(d,"BUTTON",{class:!0,"data-svelte-h":!0}),S(e)!=="svelte-1p3n8nt"&&(e.textContent=c),d.forEach(m),this.h()},h:function(){f(e,"class","mic-test-button retry svelte-1mjpxqj"),_(e,g,183,16,5675),f(t,"class","mic-test-button-area svelte-1mjpxqj"),_(t,g,182,14,5624)},m:function(a,d){q(a,t,d),y(t,e),n||(s=it(e,"click",u[3],!1),n=!0)},p:X,d:function(a){a&&m(t),n=!1,s()}};return I("SvelteRegisterBlock",{block:o,id:_t.name,type:"if",source:"(182:49) ",ctx:u}),o}function gt(u){let t,e="„Éû„Ç§„ÇØÊ∫ñÂÇô‰∏≠...";const c={c:function(){t=b("p"),t.textContent=e,this.h()},l:function(s){t=j(s,"P",{class:!0,"data-svelte-h":!0}),S(t)!=="svelte-1vb5g92"&&(t.textContent=e),this.h()},h:function(){f(t,"class","status-text svelte-1mjpxqj"),_(t,g,180,14,5523)},m:function(s,o){q(s,t,o)},p:X,d:function(s){s&&m(t)}};return I("SvelteRegisterBlock",{block:c,id:gt.name,type:"if",source:"(180:12) {#if micPermission === 'pending'}",ctx:u}),c}function yt(u){let t;function e(o,i){return o[0]==="granted"?pt:ht}let c=e(u),n=c(u);const s={c:function(){t=b("div"),n.c(),this.h()},l:function(i){t=j(i,"DIV",{class:!0});var a=P(t);n.l(a),a.forEach(m),this.h()},h:function(){f(t,"class","training-mode-content svelte-1mjpxqj"),_(t,g,163,8,4791)},m:function(i,a){q(i,t,a),n.m(t,null)},p:function(i,a){c===(c=e(i))&&n?n.p(i,a):(n.d(1),n=c(i),n&&(n.c(),n.m(t,null)))},d:function(i){i&&m(t),n.d()}};return I("SvelteRegisterBlock",{block:s,id:yt.name,type:"slot",source:'(163:6) <Card variant=\\"default\\" padding=\\"lg\\">',ctx:u}),s}function jt(u){let t,e,c="üéôÔ∏è „É™„Ç¢„É´„Çø„Ç§„É†Èü≥Á®ãÊ§úÂá∫",n,s,o,i,a={isActive:u[0]==="granted",className:"pitch-detector-content",debugMode:!1};o=new mt({props:a,$$inline:!0}),u[7](o),o.$on("pitchUpdate",u[5]),o.$on("stateChange",xt),o.$on("error",u[6]);const d={c:function(){t=b("div"),e=b("h3"),e.textContent=c,n=V(),s=b("div"),W(o.$$.fragment),this.h()},l:function(r){t=j(r,"DIV",{class:!0});var p=P(t);e=j(p,"H3",{class:!0,"data-svelte-h":!0}),S(e)!=="svelte-1bj87i9"&&(e.textContent=c),p.forEach(m),n=T(r),s=j(r,"DIV",{class:!0});var h=P(s);Q(o.$$.fragment,h),h.forEach(m),this.h()},h:function(){f(e,"class","section-title svelte-1mjpxqj"),_(e,g,202,8,6254),f(t,"class","card-header svelte-1mjpxqj"),_(t,g,201,6,6220),f(s,"class","card-content svelte-1mjpxqj"),_(s,g,204,6,6319)},m:function(r,p){q(r,t,p),y(t,e),q(r,n,p),q(r,s,p),K(o,s,null),i=!0},p:function(r,p){const h={};p&1&&(h.isActive=r[0]==="granted"),o.$set(h)},i:function(r){i||(J(o.$$.fragment,r),i=!0)},o:function(r){Z(o.$$.fragment,r),i=!1},d:function(r){r&&(m(t),m(n),m(s)),u[7](null),G(o)}};return I("SvelteRegisterBlock",{block:d,id:jt.name,type:"slot",source:'(201:4) <Card class=\\"main-card\\">',ctx:u}),d}function bt(u){let t,e,c,n,s,o,i,a,d,l,r,p,h="„Éû„Ç§„ÇØ„ÉÜ„Çπ„Éà",$,D,B="Èü≥ÊÑü„Éà„É¨„Éº„Éã„É≥„Ç∞„ÇíÂßã„ÇÅ„ÇãÂâç„Å´„ÄÅ„Éû„Ç§„ÇØ„ÅÆÂãï‰Ωú„ÇíÁ¢∫Ë™ç„Åó„Åæ„Åô",x,C,E,v,k,N;E=new nt({props:{variant:"default",padding:"lg",$$slots:{default:[yt]},$$scope:{ctx:u}},$$inline:!0}),k=new nt({props:{class:"main-card",$$slots:{default:[jt]},$$scope:{ctx:u}},$$inline:!0});const A={c:function(){t=b("div"),e=b("div"),c=b("div"),n=b("div"),s=F("svg"),o=F("path"),i=F("path"),a=F("line"),d=F("line"),l=V(),r=b("div"),p=b("h1"),p.textContent=h,$=V(),D=b("p"),D.textContent=B,x=V(),C=b("div"),W(E.$$.fragment),v=V(),W(k.$$.fragment),this.h()},l:function(w){t=j(w,"DIV",{class:!0});var M=P(t);e=j(M,"DIV",{class:!0});var H=P(e);c=j(H,"DIV",{class:!0});var U=P(c);n=j(U,"DIV",{class:!0});var st=P(n);s=z(st,"svg",{width:!0,height:!0,viewBox:!0,fill:!0,stroke:!0,"stroke-width":!0});var O=P(s);o=z(O,"path",{d:!0}),P(o).forEach(m),i=z(O,"path",{d:!0}),P(i).forEach(m),a=z(O,"line",{x1:!0,x2:!0,y1:!0,y2:!0}),P(a).forEach(m),d=z(O,"line",{x1:!0,x2:!0,y1:!0,y2:!0}),P(d).forEach(m),O.forEach(m),st.forEach(m),l=T(U),r=j(U,"DIV",{});var L=P(r);p=j(L,"H1",{class:!0,"data-svelte-h":!0}),S(p)!=="svelte-z7m4lk"&&(p.textContent=h),$=T(L),D=j(L,"P",{class:!0,"data-svelte-h":!0}),S(D)!=="svelte-1vtv92f"&&(D.textContent=B),L.forEach(m),U.forEach(m),H.forEach(m),x=T(M),C=j(M,"DIV",{class:!0});var ct=P(C);Q(E.$$.fragment,ct),ct.forEach(m),v=T(M),Q(k.$$.fragment,M),M.forEach(m),this.h()},h:function(){f(o,"d","M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z"),_(o,g,147,12,4249),f(i,"d","M19 10v2a7 7 0 0 1-14 0v-2"),_(i,g,148,12,4326),f(a,"x1","12"),f(a,"x2","12"),f(a,"y1","19"),f(a,"y2","22"),_(a,g,149,12,4377),f(d,"x1","8"),f(d,"x2","16"),f(d,"y1","22"),f(d,"y2","22"),_(d,g,150,12,4429),f(s,"width","48"),f(s,"height","48"),f(s,"viewBox","0 0 24 24"),f(s,"fill","none"),f(s,"stroke","currentColor"),f(s,"stroke-width","2"),_(s,g,146,10,4137),f(n,"class","mic-icon svelte-1mjpxqj"),_(n,g,145,8,4104),f(p,"class","mic-test-title svelte-1mjpxqj"),_(p,g,154,10,4524),f(D,"class","mic-test-description svelte-1mjpxqj"),_(D,g,155,10,4573),_(r,g,153,8,4508),f(c,"class","mic-test-header svelte-1mjpxqj"),_(c,g,144,6,4066),f(e,"class","header svelte-1mjpxqj"),_(e,g,143,4,4039),f(C,"class","training-mode-info svelte-1mjpxqj"),_(C,g,161,4,4706),f(t,"class","microphone-test svelte-1mjpxqj"),_(t,g,141,2,3987)},m:function(w,M){q(w,t,M),y(t,e),y(e,c),y(c,n),y(n,s),y(s,o),y(s,i),y(s,a),y(s,d),y(c,l),y(c,r),y(r,p),y(r,$),y(r,D),y(t,x),y(t,C),K(E,C,null),y(t,v),K(k,t,null),N=!0},p:function(w,M){const H={};M&16385&&(H.$$scope={dirty:M,ctx:w}),E.$set(H);const U={};M&16387&&(U.$$scope={dirty:M,ctx:w}),k.$set(U)},i:function(w){N||(J(E.$$.fragment,w),J(k.$$.fragment,w),N=!0)},o:function(w){Z(E.$$.fragment,w),Z(k.$$.fragment,w),N=!1},d:function(w){w&&m(t),G(E),G(k)}};return I("SvelteRegisterBlock",{block:A,id:bt.name,type:"slot",source:"(141:0) <PageLayout showBackButton={true}>",ctx:u}),A}function ot(u){let t,e,c;e=new ft({props:{showBackButton:!0,$$slots:{default:[bt]},$$scope:{ctx:u}},$$inline:!0});const n={c:function(){t=V(),W(e.$$.fragment),this.h()},l:function(o){Dt("svelte-8st1fo",document.head).forEach(m),t=T(o),Q(e.$$.fragment,o),this.h()},h:function(){document.title="„Éû„Ç§„ÇØ„ÉÜ„Çπ„Éà - Áõ∏ÂØæÈü≥ÊÑü„Éà„É¨„Éº„Éã„É≥„Ç∞"},m:function(o,i){q(o,t,i),K(e,o,i),c=!0},p:function(o,[i]){const a={};i&16387&&(a.$$scope={dirty:i,ctx:o}),e.$set(a)},i:function(o){c||(J(e.$$.fragment,o),c=!0)},o:function(o){Z(e.$$.fragment,o),c=!1},d:function(o){o&&m(t),G(e,o)}};return I("SvelteRegisterBlock",{block:n,id:ot.name,type:"component",source:"",ctx:u}),n}function xt(u){}function St(u,t,e){let c;$t(et,"page"),Pt(u,et,v=>e(12,c=v));let{$$slots:n={},$$scope:s}=t;wt("Page",n,[]);let o="random";at(()=>{c.url.searchParams.has("mode")&&(o=c.url.searchParams.get("mode")||"random")});let i="initial",a=0,d=0,l="„Éº„Éº",r=null;const p={random:{name:"„É©„É≥„ÉÄ„É†Âü∫Èü≥„É¢„Éº„Éâ",description:"10Á®ÆÈ°û„ÅÆÂü∫Èü≥„Åã„Çâ„É©„É≥„ÉÄ„É†„Å´ÈÅ∏Êäû„Åó„Å¶„Éà„É¨„Éº„Éã„É≥„Ç∞",color:"green",path:"/training/random"},continuous:{name:"ÈÄ£Á∂ö„ÉÅ„É£„É¨„É≥„Ç∏„É¢„Éº„Éâ",description:"ÈÅ∏Êäû„Åó„ÅüÂõûÊï∞„Å†„ÅëÈÄ£Á∂ö„ÅßÂÆüË°å„Åó„ÄÅÁ∑èÂêàË©ï‰æ°„ÇíÁ¢∫Ë™ç",color:"orange",path:"/training/continuous"},chromatic:{name:"12Èü≥Èöé„É¢„Éº„Éâ",description:"„ÇØ„É≠„Éû„ÉÅ„ÉÉ„ÇØ„Çπ„Ç±„Éº„É´„ÅÆ‰∏äË°å„Éª‰∏ãË°å„ÅßÂÆåÂÖ®Âà∂Ë¶á",color:"purple",path:"/training/chromatic"}},h=p[o]||p.random;async function $(){var v;e(0,i="pending");try{if(console.log("üé§ [MicTest] „Éû„Ç§„ÇØË®±ÂèØ„É™„ÇØ„Ç®„Çπ„ÉàÈñãÂßã"),!((v=navigator.mediaDevices)!=null&&v.getUserMedia)){e(0,i="denied"),console.error("‚ùå [MicTest] getUserMedia„Åå„Çµ„Éù„Éº„Éà„Åï„Çå„Å¶„ÅÑ„Åæ„Åõ„Çì");return}const k=await dt.initialize();if(console.log("‚úÖ [MicTest] AudioManager „É™„ÇΩ„Éº„ÇπÂèñÂæóÂÆå‰∫Ü"),k.mediaStream&&k.audioContext)e(0,i="granted"),console.log("‚úÖ [MicTest] „Éû„Ç§„ÇØË®±ÂèØÂÆå‰∫Ü"),setTimeout(async()=>{r&&(console.log("üéôÔ∏è [MicTest] PitchDetectorÂàùÊúüÂåñÈñãÂßã"),await r.initialize(),console.log("‚úÖ [MicTest] PitchDetectorÂàùÊúüÂåñÂÆå‰∫Ü"))},200);else throw new Error("„É™„ÇΩ„Éº„ÇπÂèñÂæóÂ§±Êïó")}catch(k){console.error("‚ùå [MicTest] „Éû„Ç§„ÇØË®±ÂèØ„Ç®„É©„Éº:",k),e(0,i=((k==null?void 0:k.name)==="NotAllowedError","denied"))}}function D(){console.log("üöÄ [MicTest] „Éà„É¨„Éº„Éã„É≥„Ç∞ÈñãÂßã - „É©„É≥„ÉÄ„É†Âü∫Èü≥„É¢„Éº„Éâ„Å∏ÈÅ∑Áßª"),ut(`${lt}${h.path}?from=microphone-test`)}function B(v){const{frequency:k,note:N,volume:A,rawVolume:R,clarity:w}=v.detail;d=k,l=N,a=A}function x(v){console.error("‚ùå [MicTest] PitchDetector„Ç®„É©„Éº:",v.detail);const{error:k,reason:N,recovery:A}=v.detail;N==="mediastream_ended"&&A==="restart_required"&&(console.log("üîÑ [MicTest] MediaStreamÁµÇ‰∫ÜÊ§úÂá∫ - Ëá™ÂãïÂæ©ÊóßÈñãÂßã"),e(0,i="initial"),a=0,d=0,l="„Éº„Éº",console.log("‚ö†Ô∏è [MicTest] „Éû„Ç§„ÇØÂÜçË®±ÂèØ„ÅåÂøÖË¶Å„Åß„Åô"))}const C=[];Object.keys(t).forEach(v=>{!~C.indexOf(v)&&v.slice(0,2)!=="$$"&&v!=="slot"&&Vt.warn(`<Page> was created with unknown prop '${v}'`)});function E(v){Et[v?"unshift":"push"](()=>{r=v,e(1,r)})}return u.$capture_state=()=>({onMount:at,page:et,goto:ut,base:lt,Card:nt,Button:Bt,PageLayout:ft,PitchDetector:mt,VolumeBar:Tt,audioManager:dt,mode:o,micPermission:i,currentVolume:a,currentFrequency:d,detectedNote:l,pitchDetectorComponent:r,trainingModes:p,selectedMode:h,requestMicrophone:$,startTraining:D,handlePitchUpdate:B,handlePitchDetectorStateChange:xt,handlePitchDetectorError:x,$page:c}),u.$inject_state=v=>{"mode"in v&&(o=v.mode),"micPermission"in v&&e(0,i=v.micPermission),"currentVolume"in v&&(a=v.currentVolume),"currentFrequency"in v&&(d=v.currentFrequency),"detectedNote"in v&&(l=v.detectedNote),"pitchDetectorComponent"in v&&e(1,r=v.pitchDetectorComponent)},t&&"$$inject"in t&&u.$inject_state(t.$$inject),[i,r,h,$,D,B,x,E]}class zt extends Ct{constructor(t){super(t),kt(this,t,St,ot,qt,{}),I("SvelteRegisterComponent",{component:this,tagName:"Page",options:t,id:ot.name})}}export{zt as component};
