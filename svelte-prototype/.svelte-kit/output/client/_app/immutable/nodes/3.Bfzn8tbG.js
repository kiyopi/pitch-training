import{S as qt,i as Mt,d as j,s as Rt,v as Nt,c as Ft,a as xt,D as at,b as m,q as X,r as J,u as T,f as W,w as Y,E as At,m as M,x as tt,p as R,y as et,g as r,z as c,h,j as y,k as E,B as ot,A as O,o as b,C as lt,F as wt,G as Ct,l as K,t as Q,e as yt,H as bt}from"../chunks/5yvZxQZi.js";import"../chunks/CYbRtnWi.js";import{p as rt}from"../chunks/CrrjRTBp.js";import{P as $t,B as ht,C as ct}from"../chunks/CViyojGP.js";import{P as Ht,V as Dt}from"../chunks/CENLBrA0.js";const _="src/routes/microphone-test/+page.svelte";function ut(i){let t,e,o,s="音量レベル",n,l,u,v,k,d,f,w="音程検出",N,$,z,F=i[4].toFixed(1)+"",V,C,D,a,S,L,A,Z,x,I;l=new Dt({props:{volume:i[3],height:"16px",className:"volume-bar-wrapper"},$$inline:!0});let p=!i[1]&&ft(i),P=!i[2]&&dt(i),B=i[1]&&!i[2]&&mt(i);const nt={c:function(){t=b("div"),e=b("div"),o=b("h3"),o.textContent=s,n=R(),et(l.$$.fragment),u=R(),v=b("div"),p&&p.c(),k=R(),d=b("div"),f=b("h3"),f.textContent=w,N=R(),$=b("div"),z=b("div"),V=Q(F),C=Q(" Hz"),D=R(),a=b("div"),S=Q(i[5]),L=R(),A=b("div"),P&&P.c(),Z=R(),B&&B.c(),x=bt(),this.h()},l:function(g){t=y(g,"DIV",{class:!0});var q=E(t);e=y(q,"DIV",{class:!0});var G=E(e);o=y(G,"H3",{class:!0,"data-svelte-h":!0}),O(o)!=="svelte-1nc8gri"&&(o.textContent=s),n=M(G),tt(l.$$.fragment,G),u=M(G),v=y(G,"DIV",{class:!0});var _t=E(v);p&&p.l(_t),_t.forEach(m),G.forEach(m),k=M(q),d=y(q,"DIV",{class:!0});var U=E(d);f=y(U,"H3",{class:!0,"data-svelte-h":!0}),O(f)!=="svelte-1ofzoy2"&&(f.textContent=w),N=M(U),$=y(U,"DIV",{class:!0});var st=E($);z=y(st,"DIV",{class:!0});var it=E(z);V=K(it,F),C=K(it," Hz"),it.forEach(m),D=M(st),a=y(st,"DIV",{class:!0});var gt=E(a);S=K(gt,i[5]),gt.forEach(m),st.forEach(m),L=M(U),A=y(U,"DIV",{class:!0});var pt=E(A);P&&P.l(pt),pt.forEach(m),U.forEach(m),q.forEach(m),Z=M(g),B&&B.l(g),x=bt(),this.h()},h:function(){c(o,"class","display-title svelte-1ltz1dw"),h(o,_,153,16,4468),c(v,"class","volume-status svelte-1ltz1dw"),h(v,_,155,16,4619),c(e,"class","volume-section svelte-1ltz1dw"),h(e,_,152,14,4423),c(f,"class","display-title svelte-1ltz1dw"),h(f,_,164,16,4925),c(z,"class","frequency-value svelte-1ltz1dw"),h(z,_,166,18,5027),c(a,"class","note-value svelte-1ltz1dw"),h(a,_,167,18,5113),c($,"class","frequency-display svelte-1ltz1dw"),h($,_,165,16,4977),c(A,"class","frequency-status svelte-1ltz1dw"),h(A,_,169,16,5196),c(d,"class","frequency-section"),h(d,_,163,14,4877),c(t,"class","realtime-display svelte-1ltz1dw"),h(t,_,150,12,4349)},m:function(g,q){W(g,t,q),r(t,e),r(e,o),r(e,n),Y(l,e,null),r(e,u),r(e,v),p&&p.m(v,null),r(t,k),r(t,d),r(d,f),r(d,N),r(d,$),r($,z),r(z,V),r(z,C),r($,D),r($,a),r(a,S),r(d,L),r(d,A),P&&P.m(A,null),W(g,Z,q),B&&B.m(g,q),W(g,x,q),I=!0},p:function(g,q){const G={};q&8&&(G.volume=g[3]),l.$set(G),g[1]?p&&(p.d(1),p=null):p||(p=ft(g),p.c(),p.m(v,null)),(!I||q&16)&&F!==(F=g[4].toFixed(1)+"")&&yt(V,F),(!I||q&32)&&yt(S,g[5]),g[2]?P&&(P.d(1),P=null):P||(P=dt(g),P.c(),P.m(A,null)),g[1]&&!g[2]?B||(B=mt(g),B.c(),B.m(x.parentNode,x)):B&&(B.d(1),B=null)},i:function(g){I||(T(l.$$.fragment,g),I=!0)},o:function(g){J(l.$$.fragment,g),I=!1},d:function(g){g&&(m(t),m(Z),m(x)),X(l),p&&p.d(),P&&P.d(),B&&B.d(g)}};return j("SvelteRegisterBlock",{block:nt,id:ut.name,type:"if",source:"(150:10) {#if micPermission === 'granted'}",ctx:i}),nt}function ft(i){let t,e="⏳ 声を出して音量を確認してください";const o={c:function(){t=b("span"),t.textContent=e,this.h()},l:function(n){t=y(n,"SPAN",{class:!0,"data-svelte-h":!0}),O(t)!=="svelte-7eexnn"&&(t.textContent=e),this.h()},h:function(){c(t,"class","status-pending svelte-1ltz1dw"),h(t,_,157,20,4707)},m:function(n,l){W(n,t,l)},d:function(n){n&&m(t)}};return j("SvelteRegisterBlock",{block:o,id:ft.name,type:"if",source:"(157:18) {#if !volumeDetected}",ctx:i}),o}function dt(i){let t,e="⏳ 「ド」を発声して音程を確認してください";const o={c:function(){t=b("span"),t.textContent=e,this.h()},l:function(n){t=y(n,"SPAN",{class:!0,"data-svelte-h":!0}),O(t)!=="svelte-lvftl7"&&(t.textContent=e),this.h()},h:function(){c(t,"class","status-pending svelte-1ltz1dw"),h(t,_,171,20,5290)},m:function(n,l){W(n,t,l)},d:function(n){n&&m(t)}};return j("SvelteRegisterBlock",{block:o,id:dt.name,type:"if",source:"(171:18) {#if !frequencyDetected}",ctx:i}),o}function mt(i){let t,e,o,s="「ド」を発声してください",n,l,u="任意の高さで「ドー」と歌うように発声してください";const v={c:function(){t=b("div"),e=b("div"),o=b("h3"),o.textContent=s,n=R(),l=b("p"),l.textContent=u,this.h()},l:function(d){t=y(d,"DIV",{class:!0});var f=E(t);e=y(f,"DIV",{class:!0});var w=E(e);o=y(w,"H3",{class:!0,"data-svelte-h":!0}),O(o)!=="svelte-xe90gt"&&(o.textContent=s),n=M(w),l=y(w,"P",{class:!0,"data-svelte-h":!0}),O(l)!=="svelte-1rtajtc"&&(l.textContent=u),w.forEach(m),f.forEach(m),this.h()},h:function(){c(o,"class","svelte-1ltz1dw"),h(o,_,181,18,5620),c(l,"class","svelte-1ltz1dw"),h(l,_,182,18,5660),c(e,"class","guidance-content svelte-1ltz1dw"),h(e,_,180,16,5571),c(t,"class","guidance svelte-1ltz1dw"),h(t,_,179,14,5532)},m:function(d,f){W(d,t,f),r(t,e),r(e,o),r(e,n),r(e,l)},d:function(d){d&&m(t)}};return j("SvelteRegisterBlock",{block:v,id:mt.name,type:"if",source:"(179:12) {#if volumeDetected && !frequencyDetected}",ctx:i}),v}function Et(i){let t,e,o=i[0]==="granted"&&ut(i);const s={c:function(){t=b("div"),o&&o.c(),this.h()},l:function(l){t=y(l,"DIV",{class:!0});var u=E(t);o&&o.l(u),u.forEach(m),this.h()},h:function(){c(t,"class","mic-test-content svelte-1ltz1dw"),h(t,_,146,8,4233)},m:function(l,u){W(l,t,u),o&&o.m(t,null),e=!0},p:function(l,u){l[0]==="granted"?o?(o.p(l,u),u&1&&T(o,1)):(o=ut(l),o.c(),T(o,1),o.m(t,null)):o&&(wt(),J(o,1,1,()=>{o=null}),Ct())},i:function(l){e||(T(o),e=!0)},o:function(l){J(o),e=!1},d:function(l){l&&m(t),o&&o.d()}};return j("SvelteRegisterBlock",{block:s,id:Et.name,type:"slot",source:'(146:6) <Card variant=\\"default\\" padding=\\"lg\\">',ctx:i}),s}function zt(i){let t,e;t=new ht({props:{variant:"disabled",size:"lg",fullWidth:!0,disabled:!0,$$slots:{default:[Vt]},$$scope:{ctx:i}},$$inline:!0});const o={c:function(){et(t.$$.fragment)},l:function(n){tt(t.$$.fragment,n)},m:function(n,l){Y(t,n,l),e=!0},p:function(n,l){const u={};l&16384&&(u.$$scope={dirty:l,ctx:n}),t.$set(u)},i:function(n){e||(T(t.$$.fragment,n),e=!0)},o:function(n){J(t.$$.fragment,n),e=!1},d:function(n){X(t,n)}};return j("SvelteRegisterBlock",{block:o,id:zt.name,type:"else",source:"(210:10) {:else}",ctx:i}),o}function Bt(i){let t,e;t=new ht({props:{href:i[7].path,variant:"primary",size:"lg",fullWidth:!0,$$slots:{default:[It]},$$scope:{ctx:i}},$$inline:!0});const o={c:function(){et(t.$$.fragment)},l:function(n){tt(t.$$.fragment,n)},m:function(n,l){Y(t,n,l),e=!0},p:function(n,l){const u={};l&16384&&(u.$$scope={dirty:l,ctx:n}),t.$set(u)},i:function(n){e||(T(t.$$.fragment,n),e=!0)},o:function(n){J(t.$$.fragment,n),e=!1},d:function(n){X(t,n)}};return j("SvelteRegisterBlock",{block:o,id:Bt.name,type:"if",source:"(201:10) {#if startButtonEnabled}",ctx:i}),o}function Vt(i){let t;const e={c:function(){t=Q("マイクテスト完了後に開始")},l:function(s){t=K(s,"マイクテスト完了後に開始")},m:function(s,n){W(s,t,n)},d:function(s){s&&m(t)}};return j("SvelteRegisterBlock",{block:e,id:Vt.name,type:"slot",source:'(211:12) <Button                variant=\\"disabled\\"                size=\\"lg\\"                fullWidth                disabled             >',ctx:i}),e}function It(i){let t;const e={c:function(){t=Q("トレーニング開始")},l:function(s){t=K(s,"トレーニング開始")},m:function(s,n){W(s,t,n)},d:function(s){s&&m(t)}};return j("SvelteRegisterBlock",{block:e,id:It.name,type:"slot",source:'(202:12) <Button                href={selectedMode.path}                variant=\\"primary\\"                size=\\"lg\\"                fullWidth             >',ctx:i}),e}function Pt(i){let t,e,o=i[7].name+"",s,n,l,u=i[7].description+"",v,k,d,f,w;const N=[Bt,zt],$=[];function z(V,C){return V[6]?0:1}d=z(i),f=$[d]=N[d](i);const F={c:function(){t=b("div"),e=b("h3"),s=Q(o),n=R(),l=b("p"),v=Q(u),k=R(),f.c(),this.h()},l:function(C){t=y(C,"DIV",{class:!0});var D=E(t);e=y(D,"H3",{class:!0});var a=E(e);s=K(a,o),a.forEach(m),n=M(D),l=y(D,"P",{class:!0});var S=E(l);v=K(S,u),S.forEach(m),k=M(D),f.l(D),D.forEach(m),this.h()},h:function(){c(e,"class","start-title svelte-1ltz1dw"),h(e,_,195,10,5954),c(l,"class","start-description svelte-1ltz1dw"),h(l,_,196,10,6013),c(t,"class","start-content svelte-1ltz1dw"),h(t,_,194,8,5916)},m:function(C,D){W(C,t,D),r(t,e),r(e,s),r(t,n),r(t,l),r(l,v),r(t,k),$[d].m(t,null),w=!0},p:function(C,D){let a=d;d=z(C),d===a?$[d].p(C,D):(wt(),J($[a],1,1,()=>{$[a]=null}),Ct(),f=$[d],f?f.p(C,D):(f=$[d]=N[d](C),f.c()),T(f,1),f.m(t,null))},i:function(C){w||(T(f),w=!0)},o:function(C){J(f),w=!1},d:function(C){C&&m(t),$[d].d()}};return j("SvelteRegisterBlock",{block:F,id:Pt.name,type:"slot",source:'(194:6) <Card variant=\\"default\\" padding=\\"lg\\">',ctx:i}),F}function St(i){let t,e,o,s,n,l,u,v,k,d,f,w,N="マイクテスト",$,z,F="音感トレーニングを始める前に、マイクの動作を確認します",V,C,D,a,S,L,A;D=new ct({props:{variant:"default",padding:"lg",$$slots:{default:[Et]},$$scope:{ctx:i}},$$inline:!0}),L=new ct({props:{variant:"default",padding:"lg",$$slots:{default:[Pt]},$$scope:{ctx:i}},$$inline:!0});const Z={c:function(){t=b("div"),e=b("div"),o=b("div"),s=b("div"),n=lt("svg"),l=lt("path"),u=lt("path"),v=lt("line"),k=lt("line"),d=R(),f=b("div"),w=b("h1"),w.textContent=N,$=R(),z=b("p"),z.textContent=F,V=R(),C=b("div"),et(D.$$.fragment),a=R(),S=b("div"),et(L.$$.fragment),this.h()},l:function(I){t=y(I,"DIV",{class:!0});var p=E(t);e=y(p,"DIV",{class:!0});var P=E(e);o=y(P,"DIV",{class:!0});var B=E(o);s=y(B,"DIV",{class:!0});var nt=E(s);n=ot(nt,"svg",{width:!0,height:!0,viewBox:!0,fill:!0,stroke:!0,"stroke-width":!0});var H=E(n);l=ot(H,"path",{d:!0}),E(l).forEach(m),u=ot(H,"path",{d:!0}),E(u).forEach(m),v=ot(H,"line",{x1:!0,x2:!0,y1:!0,y2:!0}),E(v).forEach(m),k=ot(H,"line",{x1:!0,x2:!0,y1:!0,y2:!0}),E(k).forEach(m),H.forEach(m),nt.forEach(m),d=M(B),f=y(B,"DIV",{});var g=E(f);w=y(g,"H1",{class:!0,"data-svelte-h":!0}),O(w)!=="svelte-z7m4lk"&&(w.textContent=N),$=M(g),z=y(g,"P",{class:!0,"data-svelte-h":!0}),O(z)!=="svelte-1vtv92f"&&(z.textContent=F),g.forEach(m),B.forEach(m),P.forEach(m),V=M(p),C=y(p,"DIV",{class:!0});var q=E(C);tt(D.$$.fragment,q),q.forEach(m),a=M(p),S=y(p,"DIV",{class:!0});var G=E(S);tt(L.$$.fragment,G),G.forEach(m),p.forEach(m),this.h()},h:function(){c(l,"d","M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z"),h(l,_,130,12,3697),c(u,"d","M19 10v2a7 7 0 0 1-14 0v-2"),h(u,_,131,12,3774),c(v,"x1","12"),c(v,"x2","12"),c(v,"y1","19"),c(v,"y2","22"),h(v,_,132,12,3825),c(k,"x1","8"),c(k,"x2","16"),c(k,"y1","22"),c(k,"y2","22"),h(k,_,133,12,3877),c(n,"width","48"),c(n,"height","48"),c(n,"viewBox","0 0 24 24"),c(n,"fill","none"),c(n,"stroke","currentColor"),c(n,"stroke-width","2"),h(n,_,129,10,3585),c(s,"class","mic-icon svelte-1ltz1dw"),h(s,_,128,8,3552),c(w,"class","mic-test-title svelte-1ltz1dw"),h(w,_,137,10,3972),c(z,"class","mic-test-description svelte-1ltz1dw"),h(z,_,138,10,4021),h(f,_,136,8,3956),c(o,"class","mic-test-header svelte-1ltz1dw"),h(o,_,127,6,3514),c(e,"class","header svelte-1ltz1dw"),h(e,_,126,4,3487),c(C,"class","test-section"),h(C,_,144,4,4154),c(S,"class","start-section"),h(S,_,192,4,5836),c(t,"class","microphone-test svelte-1ltz1dw"),h(t,_,124,2,3435)},m:function(I,p){W(I,t,p),r(t,e),r(e,o),r(o,s),r(s,n),r(n,l),r(n,u),r(n,v),r(n,k),r(o,d),r(o,f),r(f,w),r(f,$),r(f,z),r(t,V),r(t,C),Y(D,C,null),r(t,a),r(t,S),Y(L,S,null),A=!0},p:function(I,p){const P={};p&16447&&(P.$$scope={dirty:p,ctx:I}),D.$set(P);const B={};p&16448&&(B.$$scope={dirty:p,ctx:I}),L.$set(B)},i:function(I){A||(T(D.$$.fragment,I),T(L.$$.fragment,I),A=!0)},o:function(I){J(D.$$.fragment,I),J(L.$$.fragment,I),A=!1},d:function(I){I&&m(t),X(D),X(L)}};return j("SvelteRegisterBlock",{block:Z,id:St.name,type:"slot",source:"(124:0) <PageLayout showBackButton={true}>",ctx:i}),Z}function vt(i){let t,e,o;e=new $t({props:{showBackButton:!0,$$slots:{default:[St]},$$scope:{ctx:i}},$$inline:!0});const s={c:function(){t=R(),et(e.$$.fragment),this.h()},l:function(l){At("svelte-8st1fo",document.head).forEach(m),t=M(l),tt(e.$$.fragment,l),this.h()},h:function(){document.title="マイクテスト - 相対音感トレーニング"},m:function(l,u){W(l,t,u),Y(e,l,u),o=!0},p:function(l,[u]){const v={};u&16511&&(v.$$scope={dirty:u,ctx:l}),e.$set(v)},i:function(l){o||(T(e.$$.fragment,l),o=!0)},o:function(l){J(e.$$.fragment,l),o=!1},d:function(l){l&&m(t),X(e,l)}};return j("SvelteRegisterBlock",{block:s,id:vt.name,type:"component",source:"",ctx:i}),s}function kt(i){if(i<=0)return"C4（ド4）";const e=Math.round(12*Math.log2(i/440)),o=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],s=((e+9)%12+12)%12,n=Math.floor((e+9)/12)+4,l=o[s];return`${l}${n}（${{C:"ド","C#":"ド#",D:"レ","D#":"レ#",E:"ミ",F:"ファ","F#":"ファ#",G:"ソ","G#":"ソ#",A:"ラ","A#":"ラ#",B:"シ"}[l]}${n}）`}function jt(i,t,e){let o,s;Nt(rt,"page"),Ft(i,rt,a=>e(10,s=a));let{$$slots:n={},$$scope:l}=t;xt("Page",n,[]);let u="random";at(()=>{s.url.searchParams.has("mode")&&(u=s.url.searchParams.get("mode")||"random")});let v="pending",k=!1,d=!1,f=0,w=0,N="",$=!1;const z={random:{name:"ランダム基音モード",description:"10種類の基音からランダムに選択してトレーニング",color:"green",path:"./training/random"},continuous:{name:"連続チャレンジモード",description:"選択した回数だけ連続で実行し、総合評価を確認",color:"orange",path:"./training/continuous"},chromatic:{name:"12音階モード",description:"クロマチックスケールの上行・下行で完全制覇",color:"purple",path:"./training/chromatic"}},F=z[u]||z.random;function V(){e(0,v="pending"),setTimeout(()=>{e(0,v="granted"),C()},1e3)}function C(){if(v!=="granted")return;$=!0;const a=setInterval(()=>{if(!$){clearInterval(a);return}e(3,f=Math.random()*100),f>20&&e(1,k=!0);const S=[130.81,146.83,164.81,174.61,196,220,246.94,261.63,293.66,329.63];e(4,w=S[Math.floor(Math.random()*S.length)]),e(5,N=kt(w)),w>0&&e(2,d=!0)},200)}at(()=>{setTimeout(()=>{V()},500)});const D=[];return Object.keys(t).forEach(a=>{!~D.indexOf(a)&&a.slice(0,2)!=="$$"&&a!=="slot"&&console.warn(`<Page> was created with unknown prop '${a}'`)}),i.$capture_state=()=>({onMount:at,page:rt,Card:ct,Button:ht,PageLayout:$t,VolumeBar:Dt,PitchDisplay:Ht,mode:u,micPermission:v,volumeDetected:k,frequencyDetected:d,currentVolume:f,currentFrequency:w,currentNote:N,isListening:$,trainingModes:z,selectedMode:F,frequencyToNote:kt,requestMicrophone:V,startListening:C,startButtonEnabled:o,$page:s}),i.$inject_state=a=>{"mode"in a&&(u=a.mode),"micPermission"in a&&e(0,v=a.micPermission),"volumeDetected"in a&&e(1,k=a.volumeDetected),"frequencyDetected"in a&&e(2,d=a.frequencyDetected),"currentVolume"in a&&e(3,f=a.currentVolume),"currentFrequency"in a&&e(4,w=a.currentFrequency),"currentNote"in a&&e(5,N=a.currentNote),"isListening"in a&&($=a.isListening),"startButtonEnabled"in a&&e(6,o=a.startButtonEnabled)},t&&"$$inject"in t&&i.$inject_state(t.$$inject),i.$$.update=()=>{i.$$.dirty&7&&e(6,o=v==="granted"&&k&&d)},[v,k,d,f,w,N,o,F]}class Ot extends qt{constructor(t){super(t),Mt(this,t,jt,vt,Rt,{}),j("SvelteRegisterComponent",{component:this,tagName:"Page",options:t,id:vt.name})}}export{Ot as component};
