import{S as gt,i as kt,d as D,s as yt,v as bt,c as Ct,a as xt,D as X,b as d,q as st,r as ot,u as it,f as w,w as at,E as zt,m as T,x as lt,p as S,y as ct,g as k,z as u,h as v,j as y,k as z,B as N,A as M,o as b,C as O,n as H,F as J,l as L,t as F,G as Y}from"../chunks/DxMxmjET.js";import{g as wt}from"../chunks/D0QH3NT1.js";import"../chunks/znuVYW7z.js";import{p as G}from"../chunks/8DaiwDu5.js";import{b as tt,g as et}from"../chunks/C8l3PaXe.js";import{P as rt,B as Et,C as ut}from"../chunks/DS6cJVWq.js";import{a as nt}from"../chunks/Bu4OVIMA.js";const{console:$t}=wt,h="src/routes/microphone-test/+page.svelte";function dt(m){let t,n="マイクのテストを開始します",a,e,i="マイクテスト開始ボタンを押してマイクの使用を許可してください",o,s;function l(_,c){if(_[0]==="pending")return ht;if(_[0]==="denied")return vt;if(_[0]==="initial")return mt}let r=l(m),f=r&&r(m);const p={c:function(){t=b("h3"),t.textContent=n,a=S(),e=b("p"),e.textContent=i,o=S(),f&&f.c(),s=Y(),this.h()},l:function(c){t=y(c,"H3",{class:!0,"data-svelte-h":!0}),M(t)!=="svelte-gfi16f"&&(t.textContent=n),a=T(c),e=y(c,"P",{class:!0,"data-svelte-h":!0}),M(e)!=="svelte-1w19y1h"&&(e.textContent=i),o=T(c),f&&f.l(c),s=Y(),this.h()},h:function(){u(t,"class","instructions-title svelte-1vu9kze"),v(t,h,124,12,3795),u(e,"class","instructions-description svelte-1vu9kze"),v(e,h,125,12,3857)},m:function(c,g){w(c,t,g),w(c,a,g),w(c,e,g),w(c,o,g),f&&f.m(c,g),w(c,s,g)},p:function(c,g){r===(r=l(c))&&f?f.p(c,g):(f&&f.d(1),f=r&&r(c),f&&(f.c(),f.m(s.parentNode,s)))},d:function(c){c&&(d(t),d(a),d(e),d(o),d(s)),f&&f.d(c)}};return D("SvelteRegisterBlock",{block:p,id:dt.name,type:"else",source:"(123:10) {:else}",ctx:m}),p}function ft(m){let t,n="マイク準備完了",a,e,i,o=m[1].name+"",s,l,r,f,p,_="トレーニング開始",c,g;const E={c:function(){t=b("h3"),t.textContent=n,a=S(),e=b("p"),i=F("トレーニング開始ボタンを押して"),s=F(o),l=F("へ進んでください"),r=S(),f=b("div"),p=b("button"),p.textContent=_,this.h()},l:function(x){t=y(x,"H3",{class:!0,"data-svelte-h":!0}),M(t)!=="svelte-11dam81"&&(t.textContent=n),a=T(x),e=y(x,"P",{class:!0});var C=z(e);i=L(C,"トレーニング開始ボタンを押して"),s=L(C,o),l=L(C,"へ進んでください"),C.forEach(d),r=T(x),f=y(x,"DIV",{class:!0});var $=z(f);p=y($,"BUTTON",{class:!0,"data-svelte-h":!0}),M(p)!=="svelte-kae9rs"&&(p.textContent=_),$.forEach(d),this.h()},h:function(){u(t,"class","ready-title svelte-1vu9kze"),v(t,h,114,12,3390),u(e,"class","ready-description svelte-1vu9kze"),v(e,h,115,12,3439),u(p,"class","training-start-button enabled svelte-1vu9kze"),v(p,h,118,14,3595),u(f,"class","training-start-button-area svelte-1vu9kze"),v(f,h,117,12,3540)},m:function(x,C){w(x,t,C),w(x,a,C),w(x,e,C),k(e,i),k(e,s),k(e,l),w(x,r,C),w(x,f,C),k(f,p),c||(g=J(p,"click",m[3],!1),c=!0)},p:H,d:function(x){x&&(d(t),d(a),d(e),d(r),d(f)),c=!1,g()}};return D("SvelteRegisterBlock",{block:E,id:ft.name,type:"if",source:"(113:10) {#if micPermission === 'granted'}",ctx:m}),E}function mt(m){let t,n,a="マイクテストを開始",e,i;const o={c:function(){t=b("div"),n=b("button"),n.textContent=a,this.h()},l:function(l){t=y(l,"DIV",{class:!0});var r=z(t);n=y(r,"BUTTON",{class:!0,"data-svelte-h":!0}),M(n)!=="svelte-caex95"&&(n.textContent=a),r.forEach(d),this.h()},h:function(){u(n,"class","mic-test-button start svelte-1vu9kze"),v(n,h,137,16,4412),u(t,"class","mic-test-button-area svelte-1vu9kze"),v(t,h,136,14,4361)},m:function(l,r){w(l,t,r),k(t,n),e||(i=J(n,"click",m[2],!1),e=!0)},p:H,d:function(l){l&&d(t),e=!1,i()}};return D("SvelteRegisterBlock",{block:o,id:mt.name,type:"if",source:"(136:50) ",ctx:m}),o}function vt(m){let t,n,a="マイク許可を再試行",e,i;const o={c:function(){t=b("div"),n=b("button"),n.textContent=a,this.h()},l:function(l){t=y(l,"DIV",{class:!0});var r=z(t);n=y(r,"BUTTON",{class:!0,"data-svelte-h":!0}),M(n)!=="svelte-1p3n8nt"&&(n.textContent=a),r.forEach(d),this.h()},h:function(){u(n,"class","mic-test-button retry svelte-1vu9kze"),v(n,h,131,16,4153),u(t,"class","mic-test-button-area svelte-1vu9kze"),v(t,h,130,14,4102)},m:function(l,r){w(l,t,r),k(t,n),e||(i=J(n,"click",m[2],!1),e=!0)},p:H,d:function(l){l&&d(t),e=!1,i()}};return D("SvelteRegisterBlock",{block:o,id:vt.name,type:"if",source:"(130:49) ",ctx:m}),o}function ht(m){let t,n="マイク準備中...";const a={c:function(){t=b("p"),t.textContent=n,this.h()},l:function(i){t=y(i,"P",{class:!0,"data-svelte-h":!0}),M(t)!=="svelte-1vb5g92"&&(t.textContent=n),this.h()},h:function(){u(t,"class","status-text svelte-1vu9kze"),v(t,h,128,14,4001)},m:function(i,o){w(i,t,o)},p:H,d:function(i){i&&d(t)}};return D("SvelteRegisterBlock",{block:a,id:ht.name,type:"if",source:"(128:12) {#if micPermission === 'pending'}",ctx:m}),a}function pt(m){let t;function n(o,s){return o[0]==="granted"?ft:dt}let a=n(m),e=a(m);const i={c:function(){t=b("div"),e.c(),this.h()},l:function(s){t=y(s,"DIV",{class:!0});var l=z(t);e.l(l),l.forEach(d),this.h()},h:function(){u(t,"class","training-mode-content svelte-1vu9kze"),v(t,h,111,8,3269)},m:function(s,l){w(s,t,l),e.m(t,null)},p:function(s,l){a===(a=n(s))&&e?e.p(s,l):(e.d(1),e=a(s),e&&(e.c(),e.m(t,null)))},d:function(s){s&&d(t),e.d()}};return D("SvelteRegisterBlock",{block:i,id:pt.name,type:"slot",source:'(111:6) <Card variant=\\"default\\" padding=\\"lg\\">',ctx:m}),i}function _t(m){let t,n,a,e,i,o,s,l,r,f,p,_,c="マイクテスト",g,E,V="音感トレーニングを始める前に、マイクの動作を確認します",x,C,$,U;$=new ut({props:{variant:"default",padding:"lg",$$slots:{default:[pt]},$$scope:{ctx:m}},$$inline:!0});const K={c:function(){t=b("div"),n=b("div"),a=b("div"),e=b("div"),i=O("svg"),o=O("path"),s=O("path"),l=O("line"),r=O("line"),f=S(),p=b("div"),_=b("h1"),_.textContent=c,g=S(),E=b("p"),E.textContent=V,x=S(),C=b("div"),ct($.$$.fragment),this.h()},l:function(B){t=y(B,"DIV",{class:!0});var P=z(t);n=y(P,"DIV",{class:!0});var R=z(n);a=y(R,"DIV",{class:!0});var q=z(a);e=y(q,"DIV",{class:!0});var Q=z(e);i=N(Q,"svg",{width:!0,height:!0,viewBox:!0,fill:!0,stroke:!0,"stroke-width":!0});var j=z(i);o=N(j,"path",{d:!0}),z(o).forEach(d),s=N(j,"path",{d:!0}),z(s).forEach(d),l=N(j,"line",{x1:!0,x2:!0,y1:!0,y2:!0}),z(l).forEach(d),r=N(j,"line",{x1:!0,x2:!0,y1:!0,y2:!0}),z(r).forEach(d),j.forEach(d),Q.forEach(d),f=T(q),p=y(q,"DIV",{});var A=z(p);_=y(A,"H1",{class:!0,"data-svelte-h":!0}),M(_)!=="svelte-z7m4lk"&&(_.textContent=c),g=T(A),E=y(A,"P",{class:!0,"data-svelte-h":!0}),M(E)!=="svelte-1vtv92f"&&(E.textContent=V),A.forEach(d),q.forEach(d),R.forEach(d),x=T(P),C=y(P,"DIV",{class:!0});var W=z(C);lt($.$$.fragment,W),W.forEach(d),P.forEach(d),this.h()},h:function(){u(o,"d","M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z"),v(o,h,95,12,2727),u(s,"d","M19 10v2a7 7 0 0 1-14 0v-2"),v(s,h,96,12,2804),u(l,"x1","12"),u(l,"x2","12"),u(l,"y1","19"),u(l,"y2","22"),v(l,h,97,12,2855),u(r,"x1","8"),u(r,"x2","16"),u(r,"y1","22"),u(r,"y2","22"),v(r,h,98,12,2907),u(i,"width","48"),u(i,"height","48"),u(i,"viewBox","0 0 24 24"),u(i,"fill","none"),u(i,"stroke","currentColor"),u(i,"stroke-width","2"),v(i,h,94,10,2615),u(e,"class","mic-icon svelte-1vu9kze"),v(e,h,93,8,2582),u(_,"class","mic-test-title svelte-1vu9kze"),v(_,h,102,10,3002),u(E,"class","mic-test-description svelte-1vu9kze"),v(E,h,103,10,3051),v(p,h,101,8,2986),u(a,"class","mic-test-header svelte-1vu9kze"),v(a,h,92,6,2544),u(n,"class","header svelte-1vu9kze"),v(n,h,91,4,2517),u(C,"class","training-mode-info svelte-1vu9kze"),v(C,h,109,4,3184),u(t,"class","microphone-test svelte-1vu9kze"),v(t,h,89,2,2465)},m:function(B,P){w(B,t,P),k(t,n),k(n,a),k(a,e),k(e,i),k(i,o),k(i,s),k(i,l),k(i,r),k(a,f),k(a,p),k(p,_),k(p,g),k(p,E),k(t,x),k(t,C),at($,C,null),U=!0},p:function(B,P){const R={};P&129&&(R.$$scope={dirty:P,ctx:B}),$.$set(R)},i:function(B){U||(it($.$$.fragment,B),U=!0)},o:function(B){ot($.$$.fragment,B),U=!1},d:function(B){B&&d(t),st($)}};return D("SvelteRegisterBlock",{block:K,id:_t.name,type:"slot",source:"(89:0) <PageLayout showBackButton={true}>",ctx:m}),K}function Z(m){let t,n,a;n=new rt({props:{showBackButton:!0,$$slots:{default:[_t]},$$scope:{ctx:m}},$$inline:!0});const e={c:function(){t=S(),ct(n.$$.fragment),this.h()},l:function(o){zt("svelte-8st1fo",document.head).forEach(d),t=T(o),lt(n.$$.fragment,o),this.h()},h:function(){document.title="マイクテスト - 相対音感トレーニング"},m:function(o,s){w(o,t,s),at(n,o,s),a=!0},p:function(o,[s]){const l={};s&129&&(l.$$scope={dirty:s,ctx:o}),n.$set(l)},i:function(o){a||(it(n.$$.fragment,o),a=!0)},o:function(o){ot(n.$$.fragment,o),a=!1},d:function(o){o&&d(t),st(n,o)}};return D("SvelteRegisterBlock",{block:e,id:Z.name,type:"component",source:"",ctx:m}),e}function Bt(m,t,n){let a;bt(G,"page"),Ct(m,G,c=>n(5,a=c));let{$$slots:e={},$$scope:i}=t;xt("Page",e,[]);let o="random";X(()=>{a.url.searchParams.has("mode")&&(o=a.url.searchParams.get("mode")||"random")});let s="initial";const l={random:{name:"ランダム基音モード",description:"10種類の基音からランダムに選択してトレーニング",color:"green",path:"/training/random"},continuous:{name:"連続チャレンジモード",description:"選択した回数だけ連続で実行し、総合評価を確認",color:"orange",path:"/training/continuous"},chromatic:{name:"12音階モード",description:"クロマチックスケールの上行・下行で完全制覇",color:"purple",path:"/training/chromatic"}},r=l[o]||l.random;async function f(){var c;n(0,s="pending");try{if(console.log("🎤 [MicTest] マイク許可リクエスト開始"),!((c=navigator.mediaDevices)!=null&&c.getUserMedia)){n(0,s="denied"),console.error("❌ [MicTest] getUserMediaがサポートされていません");return}const g=await nt.initialize();if(console.log("✅ [MicTest] AudioManager リソース取得完了"),g.mediaStream&&g.audioContext)n(0,s="granted"),console.log("✅ [MicTest] マイク許可完了");else throw new Error("リソース取得失敗")}catch(g){console.error("❌ [MicTest] マイク許可エラー:",g),n(0,s=((g==null?void 0:g.name)==="NotAllowedError","denied"))}}function p(){console.log("🚀 [MicTest] トレーニング開始 - ランダム基音モードへ遷移"),et(`${tt}${r.path}?from=microphone-test`)}const _=[];return Object.keys(t).forEach(c=>{!~_.indexOf(c)&&c.slice(0,2)!=="$$"&&c!=="slot"&&$t.warn(`<Page> was created with unknown prop '${c}'`)}),m.$capture_state=()=>({onMount:X,page:G,goto:et,base:tt,Card:ut,Button:Et,PageLayout:rt,audioManager:nt,mode:o,micPermission:s,trainingModes:l,selectedMode:r,requestMicrophone:f,startTraining:p,$page:a}),m.$inject_state=c=>{"mode"in c&&(o=c.mode),"micPermission"in c&&n(0,s=c.micPermission)},t&&"$$inject"in t&&m.$inject_state(t.$$inject),[s,r,f,p]}class Rt extends gt{constructor(t){super(t),kt(this,t,Bt,Z,yt,{}),D("SvelteRegisterComponent",{component:this,tagName:"Page",options:t,id:Z.name})}}export{Rt as component};
