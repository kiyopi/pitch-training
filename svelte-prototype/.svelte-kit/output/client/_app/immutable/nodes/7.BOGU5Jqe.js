import{S as xe,i as $e,s as et,d as K,n as Be,a as tt,D as Me,b as g,G as $,z as m,f as Q,g as r,h as p,j as w,k as D,m as I,o as b,p as S,Z as Tt,e as re,O as Ne,A as ee,l as z,t as M,E as ot,q as ve,r as fe,u as ae,w as ge,F as Rt,x as pe,y as _e,L as nt,M as st,B as ke,C as Ve,J as He,K as it,H as lt}from"../chunks/Dujr-1LT.js";import{g as ut}from"../chunks/D0QH3NT1.js";import"../chunks/B_rl9Jj9.js";import{P as ft,B as Ie,C as Ce}from"../chunks/BlOhcc-l.js";const{console:At}=ut,Fe="src/lib/components/VolumeBar.svelte";function Le(o){let e,t,c,i,s,n;const a={c:function(){e=b("div"),t=b("div"),c=b("div"),i=S(),s=b("div"),this.h()},l:function(f){e=w(f,"DIV",{class:!0});var u=D(e);t=w(u,"DIV",{class:!0,style:!0});var y=D(t);c=w(y,"DIV",{class:!0,style:!0}),D(c).forEach(g),y.forEach(g),i=I(u),s=w(u,"DIV",{class:!0,style:!0}),D(s).forEach(g),u.forEach(g),this.h()},h:function(){m(c,"class","volume-bar-fill"),$(c,"position","absolute"),$(c,"top","0"),$(c,"left","0"),$(c,"height","100%"),p(c,Fe,52,4,1646),m(t,"class","volume-bar-bg"),$(t,"height",o[1]),$(t,"border-radius","9999px"),$(t,"background-color","#e2e8f0"),$(t,"position","relative"),$(t,"overflow","hidden"),p(t,Fe,51,2,1500),m(s,"class","threshold-indicator svelte-13z7ppf"),$(s,"position","absolute"),$(s,"top","0"),$(s,"left",o[0]+"%"),$(s,"width","2px"),$(s,"height",o[1]),$(s,"background-color","#64748b"),$(s,"border-radius","1px"),p(s,Fe,60,2,1825),m(e,"class",n="volume-bar-container "+o[2]+" svelte-13z7ppf"),p(e,Fe,50,0,1451)},m:function(f,u){Q(f,e,u),r(e,t),r(t,c),o[5](c),r(e,i),r(e,s)},p:function(f,[u]){u&2&&$(t,"height",f[1]),u&1&&$(s,"left",f[0]+"%"),u&2&&$(s,"height",f[1]),u&4&&n!==(n="volume-bar-container "+f[2]+" svelte-13z7ppf")&&m(e,"class",n)},i:Be,o:Be,d:function(f){f&&g(e),o[5](null)}};return K("SvelteRegisterBlock",{block:a,id:Le.name,type:"component",source:"",ctx:o}),a}function qt(o,e,t){let{$$slots:c={},$$scope:i}=e;tt("VolumeBar",c,[]);let{volume:s=0}=e,{threshold:n=30}=e,{height:a="12px"}=e,{className:d=""}=e,f;function u(l){return l<n?"#94a3b8":l<60?"#10b981":l<80?"#f59e0b":"#ef4444"}function y(l){if(f){const v=Math.max(0,Math.min(100,l)),k=u(v);(!window.volumeBarLastUpdate||Math.abs(window.volumeBarLastUpdate-v)>10)&&(console.log("VolumeBar更新:",v.toFixed(1),"%","color:",k),window.volumeBarLastUpdate=v),t(3,f.style.width=`${v}%`,f),t(3,f.style.backgroundColor=k,f)}}Me(()=>{f&&(t(3,f.style.width="0%",f),t(3,f.style.backgroundColor="#94a3b8",f),t(3,f.style.height=a,f),t(3,f.style.borderRadius="9999px",f),t(3,f.style.transition="all 0.1s ease-out",f))});const _=["volume","threshold","height","className"];Object.keys(e).forEach(l=>{!~_.indexOf(l)&&l.slice(0,2)!=="$$"&&l!=="slot"&&At.warn(`<VolumeBar> was created with unknown prop '${l}'`)});function E(l){Tt[l?"unshift":"push"](()=>{f=l,t(3,f)})}return o.$$set=l=>{"volume"in l&&t(4,s=l.volume),"threshold"in l&&t(0,n=l.threshold),"height"in l&&t(1,a=l.height),"className"in l&&t(2,d=l.className)},o.$capture_state=()=>({onMount:Me,volume:s,threshold:n,height:a,className:d,barElement:f,getVolumeColor:u,updateVolumeBar:y}),o.$inject_state=l=>{"volume"in l&&t(4,s=l.volume),"threshold"in l&&t(0,n=l.threshold),"height"in l&&t(1,a=l.height),"className"in l&&t(2,d=l.className),"barElement"in l&&t(3,f=l.barElement)},e&&"$$inject"in e&&o.$inject_state(e.$$inject),o.$$.update=()=>{o.$$.dirty&16&&y(s)},[n,a,d,f,s,E]}class dt extends xe{constructor(e){super(e),$e(this,e,qt,Le,et,{volume:4,threshold:0,height:1,className:2}),K("SvelteRegisterComponent",{component:this,tagName:"VolumeBar",options:e,id:Le.name})}get volume(){throw new Error("<VolumeBar>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set volume(e){throw new Error("<VolumeBar>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get threshold(){throw new Error("<VolumeBar>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set threshold(e){throw new Error("<VolumeBar>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get height(){throw new Error("<VolumeBar>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set height(e){throw new Error("<VolumeBar>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get className(){throw new Error("<VolumeBar>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set className(e){throw new Error("<VolumeBar>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}const he="src/lib/components/PitchDisplay.svelte";function Ge(o){let e,t,c="精度",i,s,n,a,d,f,u,y=We(o[3])+"",_,E,l,v=o[3]>0?"+":"",k,P=o[3].toFixed(1)+"",V,R;const W={c:function(){e=b("div"),t=b("div"),t.textContent=c,i=S(),s=b("div"),n=b("div"),a=S(),d=b("div"),f=S(),u=b("div"),_=M(y),E=S(),l=b("div"),k=M(v),V=M(P),R=M("%"),this.h()},l:function(B){e=w(B,"DIV",{class:!0});var N=D(e);t=w(N,"DIV",{class:!0,"data-svelte-h":!0}),ee(t)!=="svelte-4oi8f7"&&(t.textContent=c),i=I(N),s=w(N,"DIV",{class:!0});var A=D(s);n=w(A,"DIV",{class:!0,style:!0}),D(n).forEach(g),a=I(A),d=w(A,"DIV",{class:!0}),D(d).forEach(g),A.forEach(g),f=I(N),u=w(N,"DIV",{class:!0,style:!0});var F=D(u);_=z(F,y),F.forEach(g),E=I(N),l=w(N,"DIV",{class:!0});var T=D(l);k=z(T,v),V=z(T,P),R=z(T,"%"),T.forEach(g),N.forEach(g),this.h()},h:function(){m(t,"class","label svelte-17lpbmi"),p(t,he,70,6,1917),m(n,"class","accuracy-bar svelte-17lpbmi"),$(n,"background-color",Pe(o[3])),$(n,"width",Math.abs(o[3])+"%"),p(n,he,72,8,1996),m(d,"class","accuracy-center svelte-17lpbmi"),p(d,he,73,8,2122),m(s,"class","accuracy-bar-container svelte-17lpbmi"),p(s,he,71,6,1951),m(u,"class","accuracy-text svelte-17lpbmi"),$(u,"color",Pe(o[3])),p(u,he,75,6,2177),m(l,"class","accuracy-value svelte-17lpbmi"),p(l,he,78,6,2307),m(e,"class","accuracy-display svelte-17lpbmi"),p(e,he,69,4,1880)},m:function(B,N){Q(B,e,N),r(e,t),r(e,i),r(e,s),r(s,n),r(s,a),r(s,d),r(e,f),r(e,u),r(u,_),r(e,E),r(e,l),r(l,k),r(l,V),r(l,R)},p:function(B,N){N&8&&$(n,"background-color",Pe(B[3])),N&8&&$(n,"width",Math.abs(B[3])+"%"),N&8&&y!==(y=We(B[3])+"")&&re(_,y),N&8&&$(u,"color",Pe(B[3])),N&8&&v!==(v=B[3]>0?"+":"")&&re(k,v),N&8&&P!==(P=B[3].toFixed(1)+"")&&re(V,P)},d:function(B){B&&g(e)}};return K("SvelteRegisterBlock",{block:W,id:Ge.name,type:"if",source:"(69:2) {#if isDetecting && currentNote}",ctx:o}),W}function Oe(o){let e,t,c,i="目標音程",s,n,a=o[6](o[1])+"",d,f,u,y,_="現在の音程",E,l,v=(o[4]&&o[6](o[2])||"---")+"",k,P,V,R,W="周波数",H,B,N=Ue(o[0])+"",A,F,T,q=o[4]&&o[2]&&Ge(o);const X={c:function(){e=b("div"),t=b("div"),c=b("div"),c.textContent=i,s=S(),n=b("div"),d=M(a),f=S(),u=b("div"),y=b("div"),y.textContent=_,E=S(),l=b("div"),k=M(v),P=S(),V=b("div"),R=b("div"),R.textContent=W,H=S(),B=b("div"),A=M(N),F=S(),q&&q.c(),this.h()},l:function(j){e=w(j,"DIV",{class:!0});var O=D(e);t=w(O,"DIV",{class:!0});var Y=D(t);c=w(Y,"DIV",{class:!0,"data-svelte-h":!0}),ee(c)!=="svelte-101q5wq"&&(c.textContent=i),s=I(Y),n=w(Y,"DIV",{class:!0});var J=D(n);d=z(J,a),J.forEach(g),Y.forEach(g),f=I(O),u=w(O,"DIV",{class:!0});var ne=D(u);y=w(ne,"DIV",{class:!0,"data-svelte-h":!0}),ee(y)!=="svelte-1p184h3"&&(y.textContent=_),E=I(ne),l=w(ne,"DIV",{class:!0});var ie=D(l);k=z(ie,v),ie.forEach(g),ne.forEach(g),P=I(O),V=w(O,"DIV",{class:!0});var te=D(V);R=w(te,"DIV",{class:!0,"data-svelte-h":!0}),ee(R)!=="svelte-1iigar3"&&(R.textContent=W),H=I(te),B=w(te,"DIV",{class:!0});var ce=D(B);A=z(ce,N),ce.forEach(g),te.forEach(g),F=I(O),q&&q.l(O),O.forEach(g),this.h()},h:function(){m(c,"class","label svelte-17lpbmi"),p(c,he,49,4,1306),m(n,"class","note-name target svelte-17lpbmi"),p(n,he,50,4,1340),m(t,"class","target-note svelte-17lpbmi"),p(t,he,48,2,1276),m(y,"class","label svelte-17lpbmi"),p(y,he,55,4,1469),m(l,"class","note-name current svelte-17lpbmi"),Ne(l,"detecting",o[4]),p(l,he,56,4,1504),m(u,"class","current-note svelte-17lpbmi"),p(u,he,54,2,1438),m(R,"class","label svelte-17lpbmi"),p(R,he,63,4,1711),m(B,"class","frequency-value svelte-17lpbmi"),p(B,he,64,4,1744),m(V,"class","frequency-display svelte-17lpbmi"),p(V,he,62,2,1675),m(e,"class",T="pitch-display "+o[5]+" svelte-17lpbmi"),p(e,he,46,0,1216)},m:function(j,O){Q(j,e,O),r(e,t),r(t,c),r(t,s),r(t,n),r(n,d),r(e,f),r(e,u),r(u,y),r(u,E),r(u,l),r(l,k),r(e,P),r(e,V),r(V,R),r(V,H),r(V,B),r(B,A),r(e,F),q&&q.m(e,null)},p:function(j,[O]){O&2&&a!==(a=j[6](j[1])+"")&&re(d,a),O&20&&v!==(v=(j[4]&&j[6](j[2])||"---")+"")&&re(k,v),O&16&&Ne(l,"detecting",j[4]),O&1&&N!==(N=Ue(j[0])+"")&&re(A,N),j[4]&&j[2]?q?q.p(j,O):(q=Ge(j),q.c(),q.m(e,null)):q&&(q.d(1),q=null),O&32&&T!==(T="pitch-display "+j[5]+" svelte-17lpbmi")&&m(e,"class",T)},i:Be,o:Be,d:function(j){j&&g(e),q&&q.d()}};return K("SvelteRegisterBlock",{block:X,id:Oe.name,type:"component",source:"",ctx:o}),X}function Pe(o){const e=Math.abs(o);return e<=10?"#10b981":e<=25?"#f59e0b":"#ef4444"}function We(o){const e=Math.abs(o);return e<=10?"素晴らしい！":e<=25?"もう少し！":"調整が必要"}function Ue(o){return o>0?`${o.toFixed(1)} Hz`:"--.- Hz"}function jt(o,e,t){let{$$slots:c={},$$scope:i}=e;tt("PitchDisplay",c,[]);let{frequency:s=0}=e,{targetNote:n="C"}=e,{currentNote:a=""}=e,{accuracy:d=0}=e,{isDetecting:f=!1}=e,{className:u=""}=e;const y={C:"ド","C#":"ド#",Db:"レ♭",D:"レ","D#":"レ#",Eb:"ミ♭",E:"ミ",F:"ファ","F#":"ファ#",Gb:"ソ♭",G:"ソ","G#":"ソ#",Ab:"ラ♭",A:"ラ","A#":"ラ#",Bb:"シ♭",B:"シ"};function _(l){return y[l]||l}const E=["frequency","targetNote","currentNote","accuracy","isDetecting","className"];return Object.keys(e).forEach(l=>{!~E.indexOf(l)&&l.slice(0,2)!=="$$"&&l!=="slot"&&console.warn(`<PitchDisplay> was created with unknown prop '${l}'`)}),o.$$set=l=>{"frequency"in l&&t(0,s=l.frequency),"targetNote"in l&&t(1,n=l.targetNote),"currentNote"in l&&t(2,a=l.currentNote),"accuracy"in l&&t(3,d=l.accuracy),"isDetecting"in l&&t(4,f=l.isDetecting),"className"in l&&t(5,u=l.className)},o.$capture_state=()=>({frequency:s,targetNote:n,currentNote:a,accuracy:d,isDetecting:f,className:u,noteNames:y,getAccuracyColor:Pe,getAccuracyMessage:We,formatFrequency:Ue,formatNoteName:_}),o.$inject_state=l=>{"frequency"in l&&t(0,s=l.frequency),"targetNote"in l&&t(1,n=l.targetNote),"currentNote"in l&&t(2,a=l.currentNote),"accuracy"in l&&t(3,d=l.accuracy),"isDetecting"in l&&t(4,f=l.isDetecting),"className"in l&&t(5,u=l.className)},e&&"$$inject"in e&&o.$inject_state(e.$$inject),[s,n,a,d,f,u,_]}class mt extends xe{constructor(e){super(e),$e(this,e,jt,Oe,et,{frequency:0,targetNote:1,currentNote:2,accuracy:3,isDetecting:4,className:5}),K("SvelteRegisterComponent",{component:this,tagName:"PitchDisplay",options:e,id:Oe.name})}get frequency(){throw new Error("<PitchDisplay>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set frequency(e){throw new Error("<PitchDisplay>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get targetNote(){throw new Error("<PitchDisplay>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set targetNote(e){throw new Error("<PitchDisplay>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get currentNote(){throw new Error("<PitchDisplay>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set currentNote(e){throw new Error("<PitchDisplay>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get accuracy(){throw new Error("<PitchDisplay>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set accuracy(e){throw new Error("<PitchDisplay>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get isDetecting(){throw new Error("<PitchDisplay>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set isDetecting(e){throw new Error("<PitchDisplay>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get className(){throw new Error("<PitchDisplay>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set className(e){throw new Error("<PitchDisplay>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}const{console:Ft,document:rt}=ut,C="src/routes/training/random/+page.svelte";function at(o,e,t){const c=o.slice();return c[35]=e[t],c[37]=t,c}function ct(o,e,t){const c=o.slice();return c[35]=e[t],c[37]=t,c}function ht(o){let e,t,c;t=new Ce({props:{variant:"default",padding:"lg",$$slots:{default:[bt]},$$scope:{ctx:o}},$$inline:!0});const i={c:function(){e=b("div"),_e(t.$$.fragment),this.h()},l:function(n){e=w(n,"DIV",{class:!0});var a=D(e);pe(t.$$.fragment,a),a.forEach(g),this.h()},h:function(){m(e,"class","results-screen"),p(e,C,582,6,17525)},m:function(n,a){Q(n,e,a),ge(t,e,null),c=!0},p:function(n,a){const d={};a[0]&49159|a[1]&256&&(d.$$scope={dirty:a,ctx:n}),t.$set(d)},i:function(n){c||(ae(t.$$.fragment,n),c=!0)},o:function(n){fe(t.$$.fragment,n),c=!1},d:function(n){n&&g(e),ve(t)}};return K("SvelteRegisterBlock",{block:i,id:ht.name,type:"if",source:"(581:26) ",ctx:o}),i}function vt(o){let e,t,c,i,s,n,a,d,f,u,y;t=new Ce({props:{variant:"default",padding:"lg",$$slots:{default:[yt]},$$scope:{ctx:o}},$$inline:!0}),n=new Ce({props:{variant:"default",padding:"md",$$slots:{default:[Et]},$$scope:{ctx:o}},$$inline:!0}),d=new Ce({props:{variant:"default",padding:"md",$$slots:{default:[Ct]},$$scope:{ctx:o}},$$inline:!0}),u=new Ce({props:{variant:"default",padding:"md",$$slots:{default:[Dt]},$$scope:{ctx:o}},$$inline:!0});const _={c:function(){e=b("div"),_e(t.$$.fragment),c=S(),i=b("div"),s=b("div"),_e(n.$$.fragment),a=S(),_e(d.$$.fragment),f=S(),_e(u.$$.fragment),this.h()},l:function(l){e=w(l,"DIV",{class:!0});var v=D(e);pe(t.$$.fragment,v),c=I(v),i=w(v,"DIV",{class:!0});var k=D(i);s=w(k,"DIV",{class:!0});var P=D(s);pe(n.$$.fragment,P),a=I(P),pe(d.$$.fragment,P),P.forEach(g),k.forEach(g),f=I(v),pe(u.$$.fragment,v),v.forEach(g),this.h()},h:function(){m(s,"class","display-grid svelte-1samlw1"),p(s,C,547,10,16352),m(i,"class","realtime-display svelte-1samlw1"),p(i,C,546,8,16311),m(e,"class","detection-screen"),p(e,C,524,6,15338)},m:function(l,v){Q(l,e,v),ge(t,e,null),r(e,c),r(e,i),r(i,s),ge(n,s,null),r(s,a),ge(d,s,null),r(e,f),ge(u,e,null),y=!0},p:function(l,v){const k={};v[0]&769|v[1]&256&&(k.$$scope={dirty:v,ctx:l}),t.$set(k);const P={};v[0]&2048|v[1]&256&&(P.$$scope={dirty:v,ctx:l}),n.$set(P);const V={};v[0]&12928|v[1]&256&&(V.$$scope={dirty:v,ctx:l}),d.$set(V);const R={};v[0]&516|v[1]&256&&(R.$$scope={dirty:v,ctx:l}),u.$set(R)},i:function(l){y||(ae(t.$$.fragment,l),ae(n.$$.fragment,l),ae(d.$$.fragment,l),ae(u.$$.fragment,l),y=!0)},o:function(l){fe(t.$$.fragment,l),fe(n.$$.fragment,l),fe(d.$$.fragment,l),fe(u.$$.fragment,l),y=!1},d:function(l){l&&g(e),ve(t),ve(n),ve(d),ve(u)}};return K("SvelteRegisterBlock",{block:_,id:vt.name,type:"if",source:"(523:26) ",ctx:o}),_}function gt(o){let e,t,c;t=new Ce({props:{variant:"success",padding:"lg",$$slots:{default:[kt]},$$scope:{ctx:o}},$$inline:!0});const i={c:function(){e=b("div"),_e(t.$$.fragment),this.h()},l:function(n){e=w(n,"DIV",{class:!0});var a=D(e);pe(t.$$.fragment,a),a.forEach(g),this.h()},h:function(){m(e,"class","playing-screen"),p(e,C,498,6,14341)},m:function(n,a){Q(n,e,a),ge(t,e,null),c=!0},p:function(n,a){const d={};a[0]&256|a[1]&256&&(d.$$scope={dirty:a,ctx:n}),t.$set(d)},i:function(n){c||(ae(t.$$.fragment,n),c=!0)},o:function(n){fe(t.$$.fragment,n),c=!1},d:function(n){n&&g(e),ve(t)}};return K("SvelteRegisterBlock",{block:i,id:gt.name,type:"if",source:"(497:24) ",ctx:o}),i}function pt(o){let e,t,c;t=new Ce({props:{variant:"default",padding:"lg",$$slots:{default:[It]},$$scope:{ctx:o}},$$inline:!0});const i={c:function(){e=b("div"),_e(t.$$.fragment),this.h()},l:function(n){e=w(n,"DIV",{class:!0});var a=D(e);pe(t.$$.fragment,a),a.forEach(g),this.h()},h:function(){m(e,"class","start-screen"),p(e,C,430,6,12121)},m:function(n,a){Q(n,e,a),ge(t,e,null),c=!0},p:function(n,a){const d={};a[0]&56|a[1]&256&&(d.$$scope={dirty:a,ctx:n}),t.$set(d)},i:function(n){c||(ae(t.$$.fragment,n),c=!0)},o:function(n){fe(t.$$.fragment,n),c=!1},d:function(n){n&&g(e),ve(t)}};return K("SvelteRegisterBlock",{block:i,id:pt.name,type:"if",source:"(429:4) {#if !isPlaying && !isDetecting && !showResults}",ctx:o}),i}function Je(o){let e,t,c=o[35]+"",i,s,n,a=o[0][o[37]]?"✓":"×",d,f,u;const y={c:function(){e=b("div"),t=b("span"),i=M(c),s=S(),n=b("span"),d=M(a),u=S(),this.h()},l:function(E){e=w(E,"DIV",{class:!0});var l=D(e);t=w(l,"SPAN",{class:!0});var v=D(t);i=z(v,c),v.forEach(g),s=I(l),n=w(l,"SPAN",{class:!0});var k=D(n);d=z(k,a),k.forEach(g),u=I(l),l.forEach(g),this.h()},h:function(){m(t,"class","scale-note-name svelte-1samlw1"),p(t,C,610,20,18579),m(n,"class",f="scale-result-icon "+(o[0][o[37]]?"correct":"incorrect")+" svelte-1samlw1"),p(n,C,611,20,18643),m(e,"class","scale-result svelte-1samlw1"),p(e,C,609,18,18532)},m:function(E,l){Q(E,e,l),r(e,t),r(t,i),r(e,s),r(e,n),r(n,d),r(e,u)},p:function(E,l){l[0]&1&&a!==(a=E[0][E[37]]?"✓":"×")&&re(d,a),l[0]&1&&f!==(f="scale-result-icon "+(E[0][E[37]]?"correct":"incorrect")+" svelte-1samlw1")&&m(n,"class",f)},d:function(E){E&&g(e)}};return K("SvelteRegisterBlock",{block:y,id:Je.name,type:"each",source:"(609:16) {#each scaleNotes as note, index}",ctx:o}),y}function _t(o){let e;const t={c:function(){e=M("もう一度チャレンジ")},l:function(i){e=z(i,"もう一度チャレンジ")},m:function(i,s){Q(i,e,s)},d:function(i){i&&g(e)}};return K("SvelteRegisterBlock",{block:t,id:_t.name,type:"slot",source:'(622:14) <Button variant=\\"success\\" size=\\"lg\\" fullWidth on:click={startTraining}>',ctx:o}),t}function wt(o){let e;const t={c:function(){e=M("結果を保存")},l:function(i){e=z(i,"結果を保存")},m:function(i,s){Q(i,e,s)},d:function(i){i&&g(e)}};return K("SvelteRegisterBlock",{block:t,id:wt.name,type:"slot",source:'(625:14) <Button variant=\\"secondary\\" size=\\"md\\" fullWidth>',ctx:o}),t}function bt(o){let e,t,c="トレーニング結果",i,s,n,a,d,f,u,y="点",_,E,l,v,k,P,V,R,W,H,B,N,A,F,T,q,X="音階別結果",G,j,O,Y,J,ne,ie,te,ce=He(o[16]),Z=[];for(let de=0;de<ce.length;de+=1)Z[de]=Je(at(o,ce,de));J=new Ie({props:{variant:"success",size:"lg",fullWidth:!0,$$slots:{default:[_t]},$$scope:{ctx:o}},$$inline:!0}),J.$on("click",o[20]),ie=new Ie({props:{variant:"secondary",size:"md",fullWidth:!0,$$slots:{default:[wt]},$$scope:{ctx:o}},$$inline:!0});const Ee={c:function(){e=b("div"),t=b("h2"),t.textContent=c,i=S(),s=b("div"),n=b("div"),a=b("span"),d=M(o[1]),f=S(),u=b("span"),u.textContent=y,E=S(),l=b("div"),v=b("h3"),k=M(o[15]),P=S(),V=b("p"),R=M("8音階中 "),W=M(o[2]),H=M("音階 正解"),B=S(),N=b("p"),A=M(o[14]),F=S(),T=b("div"),q=b("h3"),q.textContent=X,G=S(),j=b("div");for(let h=0;h<Z.length;h+=1)Z[h].c();O=S(),Y=b("div"),_e(J.$$.fragment),ne=S(),_e(ie.$$.fragment),this.h()},l:function(h){e=w(h,"DIV",{class:!0});var L=D(e);t=w(L,"H2",{class:!0,"data-svelte-h":!0}),ee(t)!=="svelte-1w4iqdy"&&(t.textContent=c),i=I(L),s=w(L,"DIV",{class:!0});var U=D(s);n=w(U,"DIV",{class:!0});var x=D(n);a=w(x,"SPAN",{class:!0});var oe=D(a);d=z(oe,o[1]),oe.forEach(g),f=I(x),u=w(x,"SPAN",{class:!0,"data-svelte-h":!0}),ee(u)!=="svelte-yaz7vv"&&(u.textContent=y),x.forEach(g),E=I(U),l=w(U,"DIV",{class:!0});var me=D(l);v=w(me,"H3",{class:!0});var se=D(v);k=z(se,o[15]),se.forEach(g),P=I(me),V=w(me,"P",{class:!0});var De=D(V);R=z(De,"8音階中 "),W=z(De,o[2]),H=z(De,"音階 正解"),De.forEach(g),B=I(me),N=w(me,"P",{class:!0});var be=D(N);A=z(be,o[14]),be.forEach(g),me.forEach(g),U.forEach(g),F=I(L),T=w(L,"DIV",{class:!0});var ue=D(T);q=w(ue,"H3",{class:!0,"data-svelte-h":!0}),ee(q)!=="svelte-140f1nw"&&(q.textContent=X),G=I(ue),j=w(ue,"DIV",{class:!0});var le=D(j);for(let ye=0;ye<Z.length;ye+=1)Z[ye].l(le);le.forEach(g),ue.forEach(g),O=I(L),Y=w(L,"DIV",{class:!0});var we=D(Y);pe(J.$$.fragment,we),ne=I(we),pe(ie.$$.fragment,we),we.forEach(g),L.forEach(g),this.h()},h:function(){m(t,"class","results-title svelte-1samlw1"),p(t,C,585,12,17652),m(a,"class","score-value svelte-1samlw1"),p(a,C,590,16,17851),m(u,"class","score-unit svelte-1samlw1"),p(u,C,591,16,17908),m(n,"class",_="score-circle "+o[15].toLowerCase()+" svelte-1samlw1"),p(n,C,589,14,17786),m(v,"class","grade-title svelte-1samlw1"),p(v,C,594,16,18018),m(V,"class","score-description svelte-1samlw1"),p(V,C,595,16,18071),m(N,"class","feedback-message svelte-1samlw1"),p(N,C,598,16,18181),m(l,"class","grade-info svelte-1samlw1"),p(l,C,593,14,17977),m(s,"class","score-display svelte-1samlw1"),p(s,C,588,12,17744),m(q,"class","details-title svelte-1samlw1"),p(q,C,606,14,18385),m(j,"class","scale-results svelte-1samlw1"),p(j,C,607,14,18436),m(T,"class","detailed-results"),p(T,C,605,12,18340),m(Y,"class","action-buttons svelte-1samlw1"),p(Y,C,620,12,18940),m(e,"class","results-content svelte-1samlw1"),p(e,C,584,10,17610)},m:function(h,L){Q(h,e,L),r(e,t),r(e,i),r(e,s),r(s,n),r(n,a),r(a,d),r(n,f),r(n,u),r(s,E),r(s,l),r(l,v),r(v,k),r(l,P),r(l,V),r(V,R),r(V,W),r(V,H),r(l,B),r(l,N),r(N,A),r(e,F),r(e,T),r(T,q),r(T,G),r(T,j);for(let U=0;U<Z.length;U+=1)Z[U]&&Z[U].m(j,null);r(e,O),r(e,Y),ge(J,Y,null),r(Y,ne),ge(ie,Y,null),te=!0},p:function(h,L){if((!te||L[0]&2)&&re(d,h[1]),(!te||L[0]&32768&&_!==(_="score-circle "+h[15].toLowerCase()+" svelte-1samlw1"))&&m(n,"class",_),(!te||L[0]&32768)&&re(k,h[15]),(!te||L[0]&4)&&re(W,h[2]),(!te||L[0]&16384)&&re(A,h[14]),L[0]&65537){ce=He(h[16]);let oe;for(oe=0;oe<ce.length;oe+=1){const me=at(h,ce,oe);Z[oe]?Z[oe].p(me,L):(Z[oe]=Je(me),Z[oe].c(),Z[oe].m(j,null))}for(;oe<Z.length;oe+=1)Z[oe].d(1);Z.length=ce.length}const U={};L[1]&256&&(U.$$scope={dirty:L,ctx:h}),J.$set(U);const x={};L[1]&256&&(x.$$scope={dirty:L,ctx:h}),ie.$set(x)},i:function(h){te||(ae(J.$$.fragment,h),ae(ie.$$.fragment,h),te=!0)},o:function(h){fe(J.$$.fragment,h),fe(ie.$$.fragment,h),te=!1},d:function(h){h&&g(e),it(Z,h),ve(J),ve(ie)}};return K("SvelteRegisterBlock",{block:Ee,id:bt.name,type:"slot",source:'(584:8) <Card variant=\\"default\\" padding=\\"lg\\">',ctx:o}),Ee}function Ke(o){let e,t=o[0][o[37]]?"✓":"×",c,i;const s={c:function(){e=b("span"),c=M(t),this.h()},l:function(a){e=w(a,"SPAN",{class:!0});var d=D(e);c=z(d,t),d.forEach(g),this.h()},h:function(){m(e,"class",i="result-icon "+(o[0][o[37]]?"correct":"incorrect")+" svelte-1samlw1"),p(e,C,535,20,15996)},m:function(a,d){Q(a,e,d),r(e,c)},p:function(a,d){d[0]&1&&t!==(t=a[0][a[37]]?"✓":"×")&&re(c,t),d[0]&1&&i!==(i="result-icon "+(a[0][a[37]]?"correct":"incorrect")+" svelte-1samlw1")&&m(e,"class",i)},d:function(a){a&&g(e)}};return K("SvelteRegisterBlock",{block:s,id:Ke.name,type:"if",source:"(535:18) {#if scaleResults[index] !== undefined}",ctx:o}),s}function Ze(o){let e,t,c=o[35]+"",i,s,n,a=o[18](o[8],o[37])+"",d,f,u,y,_=o[0][o[37]]!==void 0&&Ke(o);const E={c:function(){e=b("div"),t=b("span"),i=M(c),s=S(),n=b("span"),d=M(a),f=M("Hz"),u=S(),_&&_.c(),y=S(),this.h()},l:function(v){e=w(v,"DIV",{class:!0});var k=D(e);t=w(k,"SPAN",{class:!0});var P=D(t);i=z(P,c),P.forEach(g),s=I(k),n=w(k,"SPAN",{class:!0});var V=D(n);d=z(V,a),f=z(V,"Hz"),V.forEach(g),u=I(k),_&&_.l(k),y=I(k),k.forEach(g),this.h()},h:function(){m(t,"class","note-text svelte-1samlw1"),p(t,C,532,18,15780),m(n,"class","note-frequency svelte-1samlw1"),p(n,C,533,18,15836),m(e,"class","scale-note svelte-1samlw1"),Ne(e,"active",o[37]===o[9]),Ne(e,"completed",o[0][o[37]]!==void 0),p(e,C,531,16,15642)},m:function(v,k){Q(v,e,k),r(e,t),r(t,i),r(e,s),r(e,n),r(n,d),r(n,f),r(e,u),_&&_.m(e,null),r(e,y)},p:function(v,k){k[0]&256&&a!==(a=v[18](v[8],v[37])+"")&&re(d,a),v[0][v[37]]!==void 0?_?_.p(v,k):(_=Ke(v),_.c(),_.m(e,y)):_&&(_.d(1),_=null),k[0]&512&&Ne(e,"active",v[37]===v[9]),k[0]&1&&Ne(e,"completed",v[0][v[37]]!==void 0)},d:function(v){v&&g(e),_&&_.d()}};return K("SvelteRegisterBlock",{block:E,id:Ze.name,type:"each",source:"(531:14) {#each scaleNotes as note, index}",ctx:o}),E}function yt(o){let e,t,c="ドレミファソラシドを歌ってください",i,s,n=He(o[16]),a=[];for(let f=0;f<n.length;f+=1)a[f]=Ze(ct(o,n,f));const d={c:function(){e=b("div"),t=b("h2"),t.textContent=c,i=S(),s=b("div");for(let u=0;u<a.length;u+=1)a[u].c();this.h()},l:function(u){e=w(u,"DIV",{class:!0});var y=D(e);t=w(y,"H2",{class:!0,"data-svelte-h":!0}),ee(t)!=="svelte-9l8glf"&&(t.textContent=c),i=I(y),s=w(y,"DIV",{class:!0});var _=D(s);for(let E=0;E<a.length;E+=1)a[E].l(_);_.forEach(g),y.forEach(g),this.h()},h:function(){m(t,"class","guide-title svelte-1samlw1"),p(t,C,528,12,15493),m(s,"class","scale-guide svelte-1samlw1"),p(s,C,529,12,15552),m(e,"class","guide-content svelte-1samlw1"),p(e,C,527,10,15453)},m:function(u,y){Q(u,e,y),r(e,t),r(e,i),r(e,s);for(let _=0;_<a.length;_+=1)a[_]&&a[_].m(s,null)},p:function(u,y){if(y[0]&328449){n=He(u[16]);let _;for(_=0;_<n.length;_+=1){const E=ct(u,n,_);a[_]?a[_].p(E,y):(a[_]=Ze(E),a[_].c(),a[_].m(s,null))}for(;_<a.length;_+=1)a[_].d(1);a.length=n.length}},d:function(u){u&&g(e),it(a,u)}};return K("SvelteRegisterBlock",{block:d,id:yt.name,type:"slot",source:'(527:8) <Card variant=\\"default\\" padding=\\"lg\\">',ctx:o}),d}function Et(o){let e,t,c="音量レベル",i,s,n;s=new dt({props:{volume:o[11],height:"20px"},$$inline:!0});const a={c:function(){e=b("div"),t=b("h3"),t.textContent=c,i=S(),_e(s.$$.fragment),this.h()},l:function(f){e=w(f,"DIV",{class:!0});var u=D(e);t=w(u,"H3",{class:!0,"data-svelte-h":!0}),ee(t)!=="svelte-1nc8gri"&&(t.textContent=c),i=I(u),pe(s.$$.fragment,u),u.forEach(g),this.h()},h:function(){m(t,"class","display-title svelte-1samlw1"),p(t,C,551,16,16514),m(e,"class","volume-display"),p(e,C,550,14,16469)},m:function(f,u){Q(f,e,u),r(e,t),r(e,i),ge(s,e,null),n=!0},p:function(f,u){const y={};u[0]&2048&&(y.volume=f[11]),s.$set(y)},i:function(f){n||(ae(s.$$.fragment,f),n=!0)},o:function(f){fe(s.$$.fragment,f),n=!1},d:function(f){f&&g(e),ve(s)}};return K("SvelteRegisterBlock",{block:a,id:Et.name,type:"slot",source:'(550:12) <Card variant=\\"default\\" padding=\\"md\\">',ctx:o}),a}function Ct(o){let e,t;e=new mt({props:{frequency:o[12],targetNote:o[16][o[9]],currentNote:o[13],accuracy:0,isDetecting:o[7]},$$inline:!0});const c={c:function(){_e(e.$$.fragment)},l:function(s){pe(e.$$.fragment,s)},m:function(s,n){ge(e,s,n),t=!0},p:function(s,n){const a={};n[0]&4096&&(a.frequency=s[12]),n[0]&512&&(a.targetNote=s[16][s[9]]),n[0]&8192&&(a.currentNote=s[13]),n[0]&128&&(a.isDetecting=s[7]),e.$set(a)},i:function(s){t||(ae(e.$$.fragment,s),t=!0)},o:function(s){fe(e.$$.fragment,s),t=!1},d:function(s){ve(e,s)}};return K("SvelteRegisterBlock",{block:c,id:Ct.name,type:"slot",source:'(558:12) <Card variant=\\"default\\" padding=\\"md\\">',ctx:o}),c}function Dt(o){let e,t,c="進行状況",i,s,n,a,d=o[16][o[9]]+"",f,u,y=o[9]+1+"",_,E,l,v,k,P,V,R;const W={c:function(){e=b("div"),t=b("h3"),t.textContent=c,i=S(),s=b("div"),n=b("span"),a=M("現在: "),f=M(d),u=M(" ("),_=M(y),E=M("/8)"),l=S(),v=b("span"),k=M("正解: "),P=M(o[2]),V=M("/"),R=M(o[9]),this.h()},l:function(B){e=w(B,"DIV",{class:!0});var N=D(e);t=w(N,"H3",{class:!0,"data-svelte-h":!0}),ee(t)!=="svelte-v1qnd4"&&(t.textContent=c),i=I(N),s=w(N,"DIV",{class:!0});var A=D(s);n=w(A,"SPAN",{});var F=D(n);a=z(F,"現在: "),f=z(F,d),u=z(F," ("),_=z(F,y),E=z(F,"/8)"),F.forEach(g),l=I(A),v=w(A,"SPAN",{});var T=D(v);k=z(T,"正解: "),P=z(T,o[2]),V=z(T,"/"),R=z(T,o[9]),T.forEach(g),A.forEach(g),N.forEach(g),this.h()},h:function(){m(t,"class","progress-title svelte-1samlw1"),p(t,C,572,12,17170),p(n,C,574,14,17264),p(v,C,575,14,17355),m(s,"class","progress-details svelte-1samlw1"),p(s,C,573,12,17219),m(e,"class","progress-info svelte-1samlw1"),p(e,C,571,10,17130)},m:function(B,N){Q(B,e,N),r(e,t),r(e,i),r(e,s),r(s,n),r(n,a),r(n,f),r(n,u),r(n,_),r(n,E),r(s,l),r(s,v),r(v,k),r(v,P),r(v,V),r(v,R)},p:function(B,N){N[0]&512&&d!==(d=B[16][B[9]]+"")&&re(f,d),N[0]&512&&y!==(y=B[9]+1+"")&&re(_,y),N[0]&4&&re(P,B[2]),N[0]&512&&re(R,B[9])},d:function(B){B&&g(e)}};return K("SvelteRegisterBlock",{block:W,id:Dt.name,type:"slot",source:'(571:8) <Card variant=\\"default\\" padding=\\"md\\">',ctx:o}),W}function kt(o){let e,t,c,i,s,n,a,d="基音再生中",f,u,y,_,E,l,v,k=o[17](o[8])+"",P,V,R,W,H="この音を覚えて「ド」として認識してください",B,N,A,F;const T={c:function(){e=b("div"),t=b("div"),c=Ve("svg"),i=Ve("circle"),s=Ve("polygon"),n=S(),a=b("h2"),a.textContent=d,f=S(),u=b("p"),y=M("基音: "),_=M(o[8]),E=S(),l=b("p"),v=M("周波数: "),P=M(k),V=M("Hz"),R=S(),W=b("p"),W.textContent=H,B=S(),N=b("div"),A=b("div"),F=b("div"),this.h()},l:function(X){e=w(X,"DIV",{class:!0});var G=D(e);t=w(G,"DIV",{class:!0});var j=D(t);c=ke(j,"svg",{width:!0,height:!0,viewBox:!0,fill:!0,stroke:!0,"stroke-width":!0});var O=D(c);i=ke(O,"circle",{cx:!0,cy:!0,r:!0}),D(i).forEach(g),s=ke(O,"polygon",{points:!0}),D(s).forEach(g),O.forEach(g),j.forEach(g),n=I(G),a=w(G,"H2",{class:!0,"data-svelte-h":!0}),ee(a)!=="svelte-1maueo6"&&(a.textContent=d),f=I(G),u=w(G,"P",{class:!0});var Y=D(u);y=z(Y,"基音: "),_=z(Y,o[8]),Y.forEach(g),E=I(G),l=w(G,"P",{class:!0});var J=D(l);v=z(J,"周波数: "),P=z(J,k),V=z(J,"Hz"),J.forEach(g),R=I(G),W=w(G,"P",{class:!0,"data-svelte-h":!0}),ee(W)!=="svelte-1hcrx2z"&&(W.textContent=H),B=I(G),N=w(G,"DIV",{class:!0});var ne=D(N);A=w(ne,"DIV",{class:!0});var ie=D(A);F=w(ie,"DIV",{class:!0}),D(F).forEach(g),ie.forEach(g),ne.forEach(g),G.forEach(g),this.h()},h:function(){m(i,"cx","12"),m(i,"cy","12"),m(i,"r","10"),p(i,C,503,16,14625),m(s,"points","10,8 16,12 10,16"),p(s,C,504,16,14674),m(c,"width","48"),m(c,"height","48"),m(c,"viewBox","0 0 24 24"),m(c,"fill","none"),m(c,"stroke","currentColor"),m(c,"stroke-width","2"),p(c,C,502,14,14509),m(t,"class","playing-icon svelte-1samlw1"),p(t,C,501,12,14468),m(a,"class","playing-title svelte-1samlw1"),p(a,C,507,12,14763),m(u,"class","playing-note svelte-1samlw1"),p(u,C,508,12,14812),m(l,"class","playing-frequency svelte-1samlw1"),p(l,C,509,12,14874),m(W,"class","playing-instruction svelte-1samlw1"),p(W,C,510,12,14966),m(F,"class","progress-fill svelte-1samlw1"),p(F,C,516,16,15164),m(A,"class","progress-bar svelte-1samlw1"),p(A,C,515,14,15121),m(N,"class","playing-progress svelte-1samlw1"),p(N,C,514,12,15076),m(e,"class","playing-content svelte-1samlw1"),p(e,C,500,10,14426)},m:function(X,G){Q(X,e,G),r(e,t),r(t,c),r(c,i),r(c,s),r(e,n),r(e,a),r(e,f),r(e,u),r(u,y),r(u,_),r(e,E),r(e,l),r(l,v),r(l,P),r(l,V),r(e,R),r(e,W),r(e,B),r(e,N),r(N,A),r(A,F)},p:function(X,G){G[0]&256&&re(_,X[8]),G[0]&256&&k!==(k=X[17](X[8])+"")&&re(P,k)},d:function(X){X&&g(e)}};return K("SvelteRegisterBlock",{block:T,id:kt.name,type:"slot",source:'(500:8) <Card variant=\\"success\\" padding=\\"lg\\">',ctx:o}),T}function Vt(o){let e;const t={c:function(){e=M("トレーニング開始")},l:function(i){e=z(i,"トレーニング開始")},m:function(i,s){Q(i,e,s)},p:Be,d:function(i){i&&g(e)}};return K("SvelteRegisterBlock",{block:t,id:Vt.name,type:"else",source:"(469:14) {:else}",ctx:o}),t}function Nt(o){let e;const t={c:function(){e=M(o[5])},l:function(i){e=z(i,o[5])},m:function(i,s){Q(i,e,s)},p:function(i,s){s[0]&32&&re(e,i[5])},d:function(i){i&&g(e)}};return K("SvelteRegisterBlock",{block:t,id:Nt.name,type:"if",source:"(467:14) {#if !isToneLoaded}",ctx:o}),t}function Pt(o){let e;function t(n,a){return n[3]?Vt:Nt}let c=t(o),i=c(o);const s={c:function(){i.c(),e=lt()},l:function(a){i.l(a),e=lt()},m:function(a,d){i.m(a,d),Q(a,e,d)},p:function(a,d){c===(c=t(a))&&i?i.p(a,d):(i.d(1),i=c(a),i&&(i.c(),i.m(e.parentNode,e)))},d:function(a){a&&g(e),i.d(a)}};return K("SvelteRegisterBlock",{block:s,id:Pt.name,type:"slot",source:'(466:12) <Button variant=\\"success\\" size=\\"lg\\" fullWidth on:click={startTraining} disabled={!isToneLoaded}>',ctx:o}),s}function Qe(o){let e,t,c,i,s,n=o[4]&&Xe(o);const a={c:function(){e=b("div"),t=b("p"),c=M(o[5]),i=S(),n&&n.c(),this.h()},l:function(f){e=w(f,"DIV",{class:!0});var u=D(e);t=w(u,"P",{class:!0});var y=D(t);c=z(y,o[5]),y.forEach(g),i=I(u),n&&n.l(u),u.forEach(g),this.h()},h:function(){m(t,"class","loading-message svelte-1samlw1"),p(t,C,475,16,13614),m(e,"class","loading-info svelte-1samlw1"),p(e,C,474,14,13571)},m:function(f,u){Q(f,e,u),r(e,t),r(t,c),r(e,i),n&&n.m(e,null),s=!0},p:function(f,u){(!s||u[0]&32)&&re(c,f[5]),f[4]?n?(n.p(f,u),u[0]&16&&ae(n,1)):(n=Xe(f),n.c(),ae(n,1),n.m(e,null)):n&&(nt(),fe(n,1,1,()=>{n=null}),st())},i:function(f){s||(ae(n),s=!0)},o:function(f){fe(n),s=!1},d:function(f){f&&g(e),n&&n.d()}};return K("SvelteRegisterBlock",{block:a,id:Qe.name,type:"if",source:"(474:12) {#if !isToneLoaded}",ctx:o}),a}function Xe(o){let e,t,c,i,s,n,a,d,f="または、ページを再読み込みしてみてください",u;n=new Ie({props:{variant:"secondary",size:"sm",$$slots:{default:[Bt]},$$scope:{ctx:o}},$$inline:!0}),n.$on("click",o[19]);const y={c:function(){e=b("p"),t=M("❌ "),c=M(o[4]),i=S(),s=b("div"),_e(n.$$.fragment),a=S(),d=b("p"),d.textContent=f,this.h()},l:function(E){e=w(E,"P",{class:!0});var l=D(e);t=z(l,"❌ "),c=z(l,o[4]),l.forEach(g),i=I(E),s=w(E,"DIV",{class:!0});var v=D(s);pe(n.$$.fragment,v),a=I(v),d=w(v,"P",{class:!0,"data-svelte-h":!0}),ee(d)!=="svelte-1o5h8se"&&(d.textContent=f),v.forEach(g),this.h()},h:function(){m(e,"class","error-message svelte-1samlw1"),p(e,C,479,18,13754),m(d,"class","retry-message svelte-1samlw1"),p(d,C,486,20,14062),m(s,"class","fallback-options svelte-1samlw1"),p(s,C,482,18,13862)},m:function(E,l){Q(E,e,l),r(e,t),r(e,c),Q(E,i,l),Q(E,s,l),ge(n,s,null),r(s,a),r(s,d),u=!0},p:function(E,l){(!u||l[0]&16)&&re(c,E[4]);const v={};l[1]&256&&(v.$$scope={dirty:l,ctx:E}),n.$set(v)},i:function(E){u||(ae(n.$$.fragment,E),u=!0)},o:function(E){fe(n.$$.fragment,E),u=!1},d:function(E){E&&(g(e),g(i),g(s)),ve(n)}};return K("SvelteRegisterBlock",{block:y,id:Xe.name,type:"if",source:"(479:16) {#if toneLoadingError}",ctx:o}),y}function Bt(o){let e;const t={c:function(){e=M("シンプル音源で開始")},l:function(i){e=z(i,"シンプル音源で開始")},m:function(i,s){Q(i,e,s)},d:function(i){i&&g(e)}};return K("SvelteRegisterBlock",{block:t,id:Bt.name,type:"slot",source:'(484:20) <Button variant=\\"secondary\\" size=\\"sm\\" on:click={forceSimpleAudio}>',ctx:o}),t}function It(o){let e,t,c="トレーニング開始",i,s,n,a,d,f,u,y,_,E="1",l,v,k,P="基音を聞く",V,R,W="ランダムに選ばれた基音をピアノで再生します",H,B,N,A="2",F,T,q,X="連続歌唱",G,j,O="基音を「ド」として、ドレミファソラシドを連続して歌います",Y,J,ne,ie="3",te,ce,Z,Ee="自動判定",de,h,L="歌唱中にリアルタイムで各音階を自動判定します",U,x,oe,me;x=new Ie({props:{variant:"success",size:"lg",fullWidth:!0,disabled:!o[3],$$slots:{default:[Pt]},$$scope:{ctx:o}},$$inline:!0}),x.$on("click",o[20]);let se=!o[3]&&Qe(o);const De={c:function(){e=b("div"),t=b("h2"),t.textContent=c,i=S(),s=b("p"),n=M("基音を聞いた後、その音を「ド」として"),a=b("br"),d=M(`
              ドレミファソラシドを連続して歌ってください`),f=S(),u=b("div"),y=b("div"),_=b("span"),_.textContent=E,l=S(),v=b("div"),k=b("h3"),k.textContent=P,V=S(),R=b("p"),R.textContent=W,H=S(),B=b("div"),N=b("span"),N.textContent=A,F=S(),T=b("div"),q=b("h3"),q.textContent=X,G=S(),j=b("p"),j.textContent=O,Y=S(),J=b("div"),ne=b("span"),ne.textContent=ie,te=S(),ce=b("div"),Z=b("h3"),Z.textContent=Ee,de=S(),h=b("p"),h.textContent=L,U=S(),_e(x.$$.fragment),oe=S(),se&&se.c(),this.h()},l:function(ue){e=w(ue,"DIV",{class:!0});var le=D(e);t=w(le,"H2",{class:!0,"data-svelte-h":!0}),ee(t)!=="svelte-177yn6"&&(t.textContent=c),i=I(le),s=w(le,"P",{class:!0});var we=D(s);n=z(we,"基音を聞いた後、その音を「ド」として"),a=w(we,"BR",{}),d=z(we,`
              ドレミファソラシドを連続して歌ってください`),we.forEach(g),f=I(le),u=w(le,"DIV",{class:!0});var ye=D(u);y=w(ye,"DIV",{class:!0});var Se=D(y);_=w(Se,"SPAN",{class:!0,"data-svelte-h":!0}),ee(_)!=="svelte-1gvrwis"&&(_.textContent=E),l=I(Se),v=w(Se,"DIV",{});var Te=D(v);k=w(Te,"H3",{class:!0,"data-svelte-h":!0}),ee(k)!=="svelte-3o2umq"&&(k.textContent=P),V=I(Te),R=w(Te,"P",{class:!0,"data-svelte-h":!0}),ee(R)!=="svelte-r15f9m"&&(R.textContent=W),Te.forEach(g),Se.forEach(g),H=I(ye),B=w(ye,"DIV",{class:!0});var Re=D(B);N=w(Re,"SPAN",{class:!0,"data-svelte-h":!0}),ee(N)!=="svelte-1lllrxb"&&(N.textContent=A),F=I(Re),T=w(Re,"DIV",{});var Ae=D(T);q=w(Ae,"H3",{class:!0,"data-svelte-h":!0}),ee(q)!=="svelte-1lldj7q"&&(q.textContent=X),G=I(Ae),j=w(Ae,"P",{class:!0,"data-svelte-h":!0}),ee(j)!=="svelte-1n1vdfq"&&(j.textContent=O),Ae.forEach(g),Re.forEach(g),Y=I(ye),J=w(ye,"DIV",{class:!0});var qe=D(J);ne=w(qe,"SPAN",{class:!0,"data-svelte-h":!0}),ee(ne)!=="svelte-1swoen2"&&(ne.textContent=ie),te=I(qe),ce=w(qe,"DIV",{});var je=D(ce);Z=w(je,"H3",{class:!0,"data-svelte-h":!0}),ee(Z)!=="svelte-wm6hg7"&&(Z.textContent=Ee),de=I(je),h=w(je,"P",{class:!0,"data-svelte-h":!0}),ee(h)!=="svelte-1tyv544"&&(h.textContent=L),je.forEach(g),qe.forEach(g),ye.forEach(g),U=I(le),pe(x.$$.fragment,le),oe=I(le),se&&se.l(le),le.forEach(g),this.h()},h:function(){m(t,"class","start-title svelte-1samlw1"),p(t,C,433,12,12244),p(a,C,435,32,12356),m(s,"class","start-description svelte-1samlw1"),p(s,C,434,12,12294),m(_,"class","step-number svelte-1samlw1"),p(_,C,441,16,12527),m(k,"class","svelte-1samlw1"),p(k,C,443,18,12602),m(R,"class","svelte-1samlw1"),p(R,C,444,18,12635),p(v,C,442,16,12578),m(y,"class","instruction-item svelte-1samlw1"),p(y,C,440,14,12480),m(N,"class","step-number svelte-1samlw1"),p(N,C,449,16,12784),m(q,"class","svelte-1samlw1"),p(q,C,451,18,12859),m(j,"class","svelte-1samlw1"),p(j,C,452,18,12891),p(T,C,450,16,12835),m(B,"class","instruction-item svelte-1samlw1"),p(B,C,448,14,12737),m(ne,"class","step-number svelte-1samlw1"),p(ne,C,457,16,13047),m(Z,"class","svelte-1samlw1"),p(Z,C,459,18,13122),m(h,"class","svelte-1samlw1"),p(h,C,460,18,13154),p(ce,C,458,16,13098),m(J,"class","instruction-item svelte-1samlw1"),p(J,C,456,14,13e3),m(u,"class","instructions svelte-1samlw1"),p(u,C,439,12,12439),m(e,"class","start-content svelte-1samlw1"),p(e,C,432,10,12204)},m:function(ue,le){Q(ue,e,le),r(e,t),r(e,i),r(e,s),r(s,n),r(s,a),r(s,d),r(e,f),r(e,u),r(u,y),r(y,_),r(y,l),r(y,v),r(v,k),r(v,V),r(v,R),r(u,H),r(u,B),r(B,N),r(B,F),r(B,T),r(T,q),r(T,G),r(T,j),r(u,Y),r(u,J),r(J,ne),r(J,te),r(J,ce),r(ce,Z),r(ce,de),r(ce,h),r(e,U),ge(x,e,null),r(e,oe),se&&se.m(e,null),me=!0},p:function(ue,le){const we={};le[0]&8&&(we.disabled=!ue[3]),le[0]&40|le[1]&256&&(we.$$scope={dirty:le,ctx:ue}),x.$set(we),ue[3]?se&&(nt(),fe(se,1,1,()=>{se=null}),st()):se?(se.p(ue,le),le[0]&8&&ae(se,1)):(se=Qe(ue),se.c(),ae(se,1),se.m(e,null))},i:function(ue){me||(ae(x.$$.fragment,ue),ae(se),me=!0)},o:function(ue){fe(x.$$.fragment,ue),fe(se),me=!1},d:function(ue){ue&&g(e),ve(x),se&&se.d()}};return K("SvelteRegisterBlock",{block:De,id:It.name,type:"slot",source:'(432:8) <Card variant=\\"default\\" padding=\\"lg\\">',ctx:o}),De}function St(o){let e,t,c,i,s,n,a,d,f,u,y,_="ランダム基音モード",E,l,v="10種類の基音からランダムに選択してトレーニング",k,P,V,R;const W=[pt,gt,vt,ht],H=[];function B(A,F){return!A[6]&&!A[7]&&!A[10]?0:A[6]?1:A[7]?2:A[10]?3:-1}~(P=B(o))&&(V=H[P]=W[P](o));const N={c:function(){e=b("div"),t=b("div"),c=b("div"),i=b("div"),s=Ve("svg"),n=Ve("path"),a=Ve("circle"),d=Ve("circle"),f=S(),u=b("div"),y=b("h1"),y.textContent=_,E=S(),l=b("p"),l.textContent=v,k=S(),V&&V.c(),this.h()},l:function(F){e=w(F,"DIV",{class:!0});var T=D(e);t=w(T,"DIV",{class:!0});var q=D(t);c=w(q,"DIV",{class:!0});var X=D(c);i=w(X,"DIV",{class:!0});var G=D(i);s=ke(G,"svg",{width:!0,height:!0,viewBox:!0,fill:!0,stroke:!0,"stroke-width":!0});var j=D(s);n=ke(j,"path",{d:!0}),D(n).forEach(g),a=ke(j,"circle",{cx:!0,cy:!0,r:!0}),D(a).forEach(g),d=ke(j,"circle",{cx:!0,cy:!0,r:!0}),D(d).forEach(g),j.forEach(g),G.forEach(g),f=I(X),u=w(X,"DIV",{});var O=D(u);y=w(O,"H1",{class:!0,"data-svelte-h":!0}),ee(y)!=="svelte-4p7mnf"&&(y.textContent=_),E=I(O),l=w(O,"P",{class:!0,"data-svelte-h":!0}),ee(l)!=="svelte-hq31uv"&&(l.textContent=v),O.forEach(g),X.forEach(g),q.forEach(g),k=I(T),V&&V.l(T),T.forEach(g),this.h()},h:function(){m(n,"d","M9 18V5l12-2v13"),p(n,C,416,12,11726),m(a,"cx","6"),m(a,"cy","18"),m(a,"r","3"),p(a,C,417,12,11766),m(d,"cx","18"),m(d,"cy","16"),m(d,"r","3"),p(d,C,418,12,11809),m(s,"width","32"),m(s,"height","32"),m(s,"viewBox","0 0 24 24"),m(s,"fill","none"),m(s,"stroke","currentColor"),m(s,"stroke-width","2"),p(s,C,415,10,11614),m(i,"class","mode-icon svelte-1samlw1"),p(i,C,414,8,11580),m(y,"class","mode-title svelte-1samlw1"),p(y,C,422,10,11897),m(l,"class","mode-description svelte-1samlw1"),p(l,C,423,10,11945),p(u,C,421,8,11881),m(c,"class","mode-header svelte-1samlw1"),p(c,C,413,6,11546),m(t,"class","header svelte-1samlw1"),p(t,C,412,4,11519),m(e,"class","random-training svelte-1samlw1"),p(e,C,410,2,11467)},m:function(F,T){Q(F,e,T),r(e,t),r(t,c),r(c,i),r(i,s),r(s,n),r(s,a),r(s,d),r(c,f),r(c,u),r(u,y),r(u,E),r(u,l),r(e,k),~P&&H[P].m(e,null),R=!0},p:function(F,T){let q=P;P=B(F),P===q?~P&&H[P].p(F,T):(V&&(nt(),fe(H[q],1,1,()=>{H[q]=null}),st()),~P?(V=H[P],V?V.p(F,T):(V=H[P]=W[P](F),V.c()),ae(V,1),V.m(e,null)):V=null)},i:function(F){R||(ae(V),R=!0)},o:function(F){fe(V),R=!1},d:function(F){F&&g(e),~P&&H[P].d()}};return K("SvelteRegisterBlock",{block:N,id:St.name,type:"slot",source:"(410:0) <PageLayout showBackButton={true}>",ctx:o}),N}function Ye(o){let e,t,c;t=new ft({props:{showBackButton:!0,$$slots:{default:[St]},$$scope:{ctx:o}},$$inline:!0});const i={c:function(){e=S(),_e(t.$$.fragment),this.h()},l:function(n){Rt("svelte-1nfe5e4",rt.head).forEach(g),e=I(n),pe(t.$$.fragment,n),this.h()},h:function(){rt.title="ランダム基音モード - 相対音感トレーニング"},m:function(n,a){Q(n,e,a),ge(t,n,a),c=!0},p:function(n,a){const d={};a[0]&65535|a[1]&256&&(d.$$scope={dirty:a,ctx:n}),t.$set(d)},i:function(n){c||(ae(t.$$.fragment,n),c=!0)},o:function(n){fe(t.$$.fragment,n),c=!1},d:function(n){n&&g(e),ve(t,n)}};return K("SvelteRegisterBlock",{block:i,id:Ye.name,type:"component",source:"",ctx:o}),i}function ze(o){try{const e=new(window.AudioContext||window.webkitAudioContext),t=e.createOscillator(),c=e.createGain();t.connect(c),c.connect(e.destination),t.frequency.setValueAtTime(o,e.currentTime),t.type="sine",c.gain.setValueAtTime(.3,e.currentTime),c.gain.exponentialRampToValueAtTime(.01,e.currentTime+2.5),t.start(e.currentTime),t.stop(e.currentTime+2.5),console.log(`シンプル音源で ${o}Hz 再生中`)}catch(e){console.error("シンプル音源エラー:",e)}}function zt(o,e,t){let c,i,s,n,{$$slots:a={},$$scope:d}=e;tt("Page",a,[]);let f=null,u=null,y=!1,_=null,E="Tone.js読み込み中...",l=!1,v=!1,k=!1,P="",V=0,R=[],W=!1,H=0,B=0,N="";const A=["ド","レ","ミ","ファ","ソ","ラ","シ","ド"],F=["Bb3","B3","C4","Db4","D4","Eb4","E4","F4","Gb4","Ab4"],T={Bb3:233.08,B3:246.94,C4:261.63,Db4:277.18,D4:293.66,Eb4:311.13,E4:329.63,F4:349.23,Gb4:369.99,Ab4:415.3},q=[1,9/8,5/4,4/3,3/2,5/3,15/8,2];async function X(){try{t(5,E="Tone.js CDN読み込み中..."),console.log("🔄 Tone.js初期化開始"),typeof window<"u"&&!window.Tone?(console.log("📥 Tone.js CDN読み込み開始..."),await new Promise((h,L)=>{const U=document.createElement("script");U.src="https://unpkg.com/tone@14.7.77/build/Tone.js",U.async=!0,U.onload=()=>{console.log("✅ Tone.js CDNスクリプト読み込み完了"),window.Tone?(console.log("✅ window.Tone利用可能"),h()):(console.error("❌ window.Toneが未定義"),L(new Error("window.Toneが利用できません")))},U.onerror=x=>{console.error("❌ Tone.js CDN読み込みエラー:",x),L(new Error("Tone.js CDNの読み込みに失敗しました"))},setTimeout(()=>{window.Tone||(console.warn("⚠️ Tone.js CDN読み込みタイムアウト"),L(new Error("Tone.js読み込みタイムアウト")))},5e3),document.head.appendChild(U)}),t(5,E="Tone.js初期化中..."),f=window.Tone,console.log("🎵 Tone.js変数設定完了"),await G()):window.Tone?(console.log("✅ Tone.js既に読み込み済み"),f=window.Tone,await G()):(console.warn("⚠️ window未定義 - SSR環境の可能性"),setTimeout(()=>X(),1e3))}catch(h){console.error("❌ Tone.js初期化エラー:",h),t(4,_=`初期化エラー: ${h.message}`),t(5,E="エラー"),setTimeout(()=>{console.log("🔧 自動フォールバックモード切り替え"),Y()},3e3)}}async function G(){try{if(!f)throw console.error("❌ Tone.js未初期化"),new Error("Tone.js未初期化");if(console.log("🎹 サンプラー設定開始"),t(5,E="AudioContext初期化中..."),console.log(`📊 AudioContext状態: ${f.context.state}`),f.context.state!=="running"){console.log("🔊 AudioContext開始中...");try{await f.start(),console.log("✅ AudioContext開始完了")}catch(L){throw console.error("❌ AudioContext開始失敗:",L),L}}t(5,E="ローカルピアノ音源読み込み中..."),console.log("🎵 ローカル Salamander Grand Piano サンプラー作成中...");const h={Bb3:"Bb3.mp3",B3:"B3.mp3",C4:"C4.mp3",Db4:"Db4.mp3",D4:"D4.mp3",Eb4:"Eb4.mp3",E4:"E4.mp3",F4:"F4.mp3",Gb4:"Gb4.mp3",Ab4:"Ab4.mp3"};await new Promise((L,U)=>{u=new f.Sampler({urls:h,baseUrl:"/audio/piano/",release:1.5,onload:()=>{console.log("✅ ローカル Salamander Grand Piano音源読み込み完了"),t(3,y=!0),t(5,E="読み込み完了"),L()},onerror:x=>{console.error("❌ ローカル Salamander Grand Piano音源読み込みエラー:",x),U(new Error("ローカル音源読み込み失敗"))}}).toDestination(),console.log("🔗 サンプラーをDestinationに接続完了"),setTimeout(()=>{y||(console.warn("⚠️ ローカルピアノ音源読み込みタイムアウト（5秒）"),U(new Error("ローカル音源読み込みタイムアウト")))},5e3)})}catch(h){console.error("❌ サンプラー設定エラー:",h),console.log("🔧 フォールバックモードに切り替え"),l=!0,t(3,y=!0),t(4,_=`音源エラー: ${h.message}（シンプル音源使用）`),t(5,E="シンプル音源で開始")}}Me(()=>{X()}),ot(()=>{u&&u.dispose()});function j(h){return Math.round(T[h]||0)}function O(h,L){const U=T[h];return U?Math.round(U*q[L]):0}function Y(){console.log("🔧 手動でシンプル音源モードに切り替え"),l=!0,t(3,y=!0),t(4,_=null),t(5,E="シンプル音源モード")}function J(){const h=Math.floor(Math.random()*F.length);return t(8,P=F[h]),P}function ne(){t(9,V=0),t(0,R=[]),t(10,W=!1);const h=J();ie(h)}async function ie(h){t(6,v=!0),console.log(`基音再生: ${h} (フォールバック: ${l})`);try{if(l){ze(j(h)),setTimeout(()=>{t(6,v=!1),te()},2500);return}if(!y||!u){console.warn("Tone.js または Sampler が未初期化 - フォールバックに切り替え"),l=!0,ze(j(h)),setTimeout(()=>{t(6,v=!1),te()},2500);return}f.context.state!=="running"&&await f.start(),u.triggerAttackRelease(h,"2.5"),console.log(`Salamander Grand Piano で ${h} 再生開始`),setTimeout(()=>{t(6,v=!1),te()},2500)}catch(L){console.error("基音再生エラー:",L),l=!0,ze(j(h)),setTimeout(()=>{t(6,v=!1),te()},2500)}}function te(){t(7,k=!0);const h=A.map((U,x)=>O(P,x)),L=setInterval(()=>{if(!k){clearInterval(L);return}t(11,H=40+Math.random()*50);const U=h[V],x=(Math.random()-.5)*40;t(12,B=U+x);const oe=Math.max(0,100-Math.abs(x)*2);if(t(13,N=A[V]),Math.random()>.6){const me=oe>70;t(0,R[V]=me,R),t(9,V++,V),console.log(`${N}: ${oe.toFixed(1)}% 精度, ${me?"正解":"不正解"}`),V>=8&&ce()}},300)}function ce(){t(7,k=!1),t(10,W=!0)}function Z(h){return h>=90?"Excellent":h>=70?"Good":h>=50?"Practice":"Needs Work"}function Ee(h){return h>=90?"素晴らしい相対音感です！完璧な演奏でした。":h>=70?"良好な相対音感です。もう少し練習すれば完璧になります。":h>=50?"基本的な相対音感は身についています。継続練習で向上できます。":"相対音感の基礎練習から始めましょう。毎日少しずつ練習することが大切です。"}const de=[];return Object.keys(e).forEach(h=>{!~de.indexOf(h)&&h.slice(0,2)!=="$$"&&h!=="slot"&&Ft.warn(`<Page> was created with unknown prop '${h}'`)}),o.$capture_state=()=>({onMount:Me,onDestroy:ot,Card:Ce,Button:Ie,PageLayout:ft,VolumeBar:dt,PitchDisplay:mt,Tone:f,sampler:u,isToneLoaded:y,toneLoadingError:_,loadingStatus:E,useSimpleAudio:l,isPlaying:v,isDetecting:k,currentBaseNote:P,currentScaleIndex:V,scaleResults:R,showResults:W,currentVolume:H,currentFrequency:B,currentNote:N,scaleNotes:A,baseNotes:F,baseNoteFrequencies:T,scaleRatios:q,initializeTone:X,setupSampler:G,getBaseNoteFrequency:j,getScaleFrequency:O,forceSimpleAudio:Y,selectRandomBase:J,startTraining:ne,playBaseNote:ie,playSimpleBeep:ze,startDetection:te,finishTraining:ce,getGrade:Z,getFeedback:Ee,score:i,feedback:n,grade:s,correctCount:c}),o.$inject_state=h=>{"Tone"in h&&(f=h.Tone),"sampler"in h&&(u=h.sampler),"isToneLoaded"in h&&t(3,y=h.isToneLoaded),"toneLoadingError"in h&&t(4,_=h.toneLoadingError),"loadingStatus"in h&&t(5,E=h.loadingStatus),"useSimpleAudio"in h&&(l=h.useSimpleAudio),"isPlaying"in h&&t(6,v=h.isPlaying),"isDetecting"in h&&t(7,k=h.isDetecting),"currentBaseNote"in h&&t(8,P=h.currentBaseNote),"currentScaleIndex"in h&&t(9,V=h.currentScaleIndex),"scaleResults"in h&&t(0,R=h.scaleResults),"showResults"in h&&t(10,W=h.showResults),"currentVolume"in h&&t(11,H=h.currentVolume),"currentFrequency"in h&&t(12,B=h.currentFrequency),"currentNote"in h&&t(13,N=h.currentNote),"score"in h&&t(1,i=h.score),"feedback"in h&&t(14,n=h.feedback),"grade"in h&&t(15,s=h.grade),"correctCount"in h&&t(2,c=h.correctCount)},e&&"$$inject"in e&&o.$inject_state(e.$$inject),o.$$.update=()=>{o.$$.dirty[0]&1&&t(2,c=R.filter(h=>h).length),o.$$.dirty[0]&4&&t(1,i=Math.round(c/8*100)),o.$$.dirty[0]&2&&t(15,s=Z(i)),o.$$.dirty[0]&2&&t(14,n=Ee(i))},[R,i,c,y,_,E,v,k,P,V,W,H,B,N,n,s,A,j,O,Y,ne]}class Ot extends xe{constructor(e){super(e),$e(this,e,zt,Ye,et,{},null,[-1,-1]),K("SvelteRegisterComponent",{component:this,tagName:"Page",options:e,id:Ye.name})}}export{Ot as component};
