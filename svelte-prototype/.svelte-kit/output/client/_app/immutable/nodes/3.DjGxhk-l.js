import{S as Ct,i as kt,d as I,s as qt,v as Pt,c as $t,a as Dt,D as at,b as m,q as G,r as Z,u as J,f as q,w as K,E as wt,m as T,x as Q,p as V,y as W,F as Et,g as y,z as f,h as _,j,k as $,B as A,A as S,o as x,C as F,n as X,G as it,l as Y,t as tt,H as rt}from"../chunks/DmID7u62.js";import{g as Mt}from"../chunks/D0QH3NT1.js";import"../chunks/DfcMgxLU.js";import{p as et}from"../chunks/BeA_6CTV.js";import{b as lt,g as ut}from"../chunks/lD56am-j.js";import{P as ft,B as Bt,C as nt}from"../chunks/DZc1Xqji.js";import{a as dt,V as Tt,P as mt}from"../chunks/uCkoW3h2.js";const{console:Vt}=Mt,g="src/routes/microphone-test/+page.svelte";function ht(u){let t,e="„Éû„Ç§„ÇØ„ÅÆ„ÉÜ„Çπ„Éà„ÇíÈñãÂßã„Åó„Åæ„Åô",c,n,s="„Éû„Ç§„ÇØ„ÉÜ„Çπ„ÉàÈñãÂßã„Éú„Çø„É≥„ÇíÊäº„Åó„Å¶„Éû„Ç§„ÇØ„ÅÆ‰ΩøÁî®„ÇíË®±ÂèØ„Åó„Å¶„Åè„Å†„Åï„ÅÑ",o,i;function r(v,h){if(v[0]==="pending")return gt;if(v[0]==="denied")return _t;if(v[0]==="initial")return vt}let d=r(u),l=d&&d(u);const a={c:function(){t=x("h3"),t.textContent=e,c=V(),n=x("p"),n.textContent=s,o=V(),l&&l.c(),i=rt(),this.h()},l:function(h){t=j(h,"H3",{class:!0,"data-svelte-h":!0}),S(t)!=="svelte-gfi16f"&&(t.textContent=e),c=T(h),n=j(h,"P",{class:!0,"data-svelte-h":!0}),S(n)!=="svelte-1w19y1h"&&(n.textContent=s),o=T(h),l&&l.l(h),i=rt(),this.h()},h:function(){f(t,"class","instructions-title svelte-1mjpxqj"),_(t,g,185,12,5666),f(n,"class","instructions-description svelte-1mjpxqj"),_(n,g,186,12,5728)},m:function(h,P){q(h,t,P),q(h,c,P),q(h,n,P),q(h,o,P),l&&l.m(h,P),q(h,i,P)},p:function(h,P){d===(d=r(h))&&l?l.p(h,P):(l&&l.d(1),l=d&&d(h),l&&(l.c(),l.m(i.parentNode,i)))},d:function(h){h&&(m(t),m(c),m(n),m(o),m(i)),l&&l.d(h)}};return I("SvelteRegisterBlock",{block:a,id:ht.name,type:"else",source:"(184:10) {:else}",ctx:u}),a}function pt(u){let t,e="„Éû„Ç§„ÇØÊ∫ñÂÇôÂÆå‰∫Ü",c,n,s,o=u[2].name+"",i,r,d,l,a,v="„Éà„É¨„Éº„Éã„É≥„Ç∞ÈñãÂßã",h,P;const w={c:function(){t=x("h3"),t.textContent=e,c=V(),n=x("p"),s=tt("„Éà„É¨„Éº„Éã„É≥„Ç∞ÈñãÂßã„Éú„Çø„É≥„ÇíÊäº„Åó„Å¶"),i=tt(o),r=tt("„Å∏ÈÄ≤„Çì„Åß„Åè„Å†„Åï„ÅÑ"),d=V(),l=x("div"),a=x("button"),a.textContent=v,this.h()},l:function(b){t=j(b,"H3",{class:!0,"data-svelte-h":!0}),S(t)!=="svelte-11dam81"&&(t.textContent=e),c=T(b),n=j(b,"P",{class:!0});var C=$(n);s=Y(C,"„Éà„É¨„Éº„Éã„É≥„Ç∞ÈñãÂßã„Éú„Çø„É≥„ÇíÊäº„Åó„Å¶"),i=Y(C,o),r=Y(C,"„Å∏ÈÄ≤„Çì„Åß„Åè„Å†„Åï„ÅÑ"),C.forEach(m),d=T(b),l=j(b,"DIV",{class:!0});var E=$(l);a=j(E,"BUTTON",{class:!0,"data-svelte-h":!0}),S(a)!=="svelte-kae9rs"&&(a.textContent=v),E.forEach(m),this.h()},h:function(){f(t,"class","ready-title svelte-1mjpxqj"),_(t,g,175,12,5261),f(n,"class","ready-description svelte-1mjpxqj"),_(n,g,176,12,5310),f(a,"class","training-start-button enabled svelte-1mjpxqj"),_(a,g,179,14,5466),f(l,"class","training-start-button-area svelte-1mjpxqj"),_(l,g,178,12,5411)},m:function(b,C){q(b,t,C),q(b,c,C),q(b,n,C),y(n,s),y(n,i),y(n,r),q(b,d,C),q(b,l,C),y(l,a),h||(P=it(a,"click",u[4],!1),h=!0)},p:X,d:function(b){b&&(m(t),m(c),m(n),m(d),m(l)),h=!1,P()}};return I("SvelteRegisterBlock",{block:w,id:pt.name,type:"if",source:"(174:10) {#if micPermission === 'granted'}",ctx:u}),w}function vt(u){let t,e,c="„Éû„Ç§„ÇØ„ÉÜ„Çπ„Éà„ÇíÈñãÂßã",n,s;const o={c:function(){t=x("div"),e=x("button"),e.textContent=c,this.h()},l:function(r){t=j(r,"DIV",{class:!0});var d=$(t);e=j(d,"BUTTON",{class:!0,"data-svelte-h":!0}),S(e)!=="svelte-caex95"&&(e.textContent=c),d.forEach(m),this.h()},h:function(){f(e,"class","mic-test-button start svelte-1mjpxqj"),_(e,g,198,16,6283),f(t,"class","mic-test-button-area svelte-1mjpxqj"),_(t,g,197,14,6232)},m:function(r,d){q(r,t,d),y(t,e),n||(s=it(e,"click",u[3],!1),n=!0)},p:X,d:function(r){r&&m(t),n=!1,s()}};return I("SvelteRegisterBlock",{block:o,id:vt.name,type:"if",source:"(197:50) ",ctx:u}),o}function _t(u){let t,e,c="„Éû„Ç§„ÇØË®±ÂèØ„ÇíÂÜçË©¶Ë°å",n,s;const o={c:function(){t=x("div"),e=x("button"),e.textContent=c,this.h()},l:function(r){t=j(r,"DIV",{class:!0});var d=$(t);e=j(d,"BUTTON",{class:!0,"data-svelte-h":!0}),S(e)!=="svelte-1p3n8nt"&&(e.textContent=c),d.forEach(m),this.h()},h:function(){f(e,"class","mic-test-button retry svelte-1mjpxqj"),_(e,g,192,16,6024),f(t,"class","mic-test-button-area svelte-1mjpxqj"),_(t,g,191,14,5973)},m:function(r,d){q(r,t,d),y(t,e),n||(s=it(e,"click",u[3],!1),n=!0)},p:X,d:function(r){r&&m(t),n=!1,s()}};return I("SvelteRegisterBlock",{block:o,id:_t.name,type:"if",source:"(191:49) ",ctx:u}),o}function gt(u){let t,e="„Éû„Ç§„ÇØÊ∫ñÂÇô‰∏≠...";const c={c:function(){t=x("p"),t.textContent=e,this.h()},l:function(s){t=j(s,"P",{class:!0,"data-svelte-h":!0}),S(t)!=="svelte-1vb5g92"&&(t.textContent=e),this.h()},h:function(){f(t,"class","status-text svelte-1mjpxqj"),_(t,g,189,14,5872)},m:function(s,o){q(s,t,o)},p:X,d:function(s){s&&m(t)}};return I("SvelteRegisterBlock",{block:c,id:gt.name,type:"if",source:"(189:12) {#if micPermission === 'pending'}",ctx:u}),c}function yt(u){let t;function e(o,i){return o[0]==="granted"?pt:ht}let c=e(u),n=c(u);const s={c:function(){t=x("div"),n.c(),this.h()},l:function(i){t=j(i,"DIV",{class:!0});var r=$(t);n.l(r),r.forEach(m),this.h()},h:function(){f(t,"class","training-mode-content svelte-1mjpxqj"),_(t,g,172,8,5140)},m:function(i,r){q(i,t,r),n.m(t,null)},p:function(i,r){c===(c=e(i))&&n?n.p(i,r):(n.d(1),n=c(i),n&&(n.c(),n.m(t,null)))},d:function(i){i&&m(t),n.d()}};return I("SvelteRegisterBlock",{block:s,id:yt.name,type:"slot",source:'(172:6) <Card variant=\\"default\\" padding=\\"lg\\">',ctx:u}),s}function jt(u){let t,e,c="üéôÔ∏è „É™„Ç¢„É´„Çø„Ç§„É†Èü≥Á®ãÊ§úÂá∫",n,s,o,i,r={isActive:!1,className:"pitch-detector-content",debugMode:!1};o=new mt({props:r,$$inline:!0}),u[7](o),o.$on("pitchUpdate",u[5]),o.$on("stateChange",bt),o.$on("error",u[6]);const d={c:function(){t=x("div"),e=x("h3"),e.textContent=c,n=V(),s=x("div"),W(o.$$.fragment),this.h()},l:function(a){t=j(a,"DIV",{class:!0});var v=$(t);e=j(v,"H3",{class:!0,"data-svelte-h":!0}),S(e)!=="svelte-1bj87i9"&&(e.textContent=c),v.forEach(m),n=T(a),s=j(a,"DIV",{class:!0});var h=$(s);Q(o.$$.fragment,h),h.forEach(m),this.h()},h:function(){f(e,"class","section-title svelte-1mjpxqj"),_(e,g,211,8,6603),f(t,"class","card-header svelte-1mjpxqj"),_(t,g,210,6,6569),f(s,"class","card-content svelte-1mjpxqj"),_(s,g,213,6,6668)},m:function(a,v){q(a,t,v),y(t,e),q(a,n,v),q(a,s,v),K(o,s,null),i=!0},p:function(a,v){const h={};o.$set(h)},i:function(a){i||(J(o.$$.fragment,a),i=!0)},o:function(a){Z(o.$$.fragment,a),i=!1},d:function(a){a&&(m(t),m(n),m(s)),u[7](null),G(o)}};return I("SvelteRegisterBlock",{block:d,id:jt.name,type:"slot",source:'(210:4) <Card class=\\"main-card\\">',ctx:u}),d}function xt(u){let t,e,c,n,s,o,i,r,d,l,a,v,h="„Éû„Ç§„ÇØ„ÉÜ„Çπ„Éà",P,w,B="Èü≥ÊÑü„Éà„É¨„Éº„Éã„É≥„Ç∞„ÇíÂßã„ÇÅ„ÇãÂâç„Å´„ÄÅ„Éû„Ç§„ÇØ„ÅÆÂãï‰Ωú„ÇíÁ¢∫Ë™ç„Åó„Åæ„Åô",b,C,E,p,k,N;E=new nt({props:{variant:"default",padding:"lg",$$slots:{default:[yt]},$$scope:{ctx:u}},$$inline:!0}),k=new nt({props:{class:"main-card",$$slots:{default:[jt]},$$scope:{ctx:u}},$$inline:!0});const H={c:function(){t=x("div"),e=x("div"),c=x("div"),n=x("div"),s=F("svg"),o=F("path"),i=F("path"),r=F("line"),d=F("line"),l=V(),a=x("div"),v=x("h1"),v.textContent=h,P=V(),w=x("p"),w.textContent=B,b=V(),C=x("div"),W(E.$$.fragment),p=V(),W(k.$$.fragment),this.h()},l:function(D){t=j(D,"DIV",{class:!0});var M=$(t);e=j(M,"DIV",{class:!0});var O=$(e);c=j(O,"DIV",{class:!0});var U=$(c);n=j(U,"DIV",{class:!0});var st=$(n);s=A(st,"svg",{width:!0,height:!0,viewBox:!0,fill:!0,stroke:!0,"stroke-width":!0});var z=$(s);o=A(z,"path",{d:!0}),$(o).forEach(m),i=A(z,"path",{d:!0}),$(i).forEach(m),r=A(z,"line",{x1:!0,x2:!0,y1:!0,y2:!0}),$(r).forEach(m),d=A(z,"line",{x1:!0,x2:!0,y1:!0,y2:!0}),$(d).forEach(m),z.forEach(m),st.forEach(m),l=T(U),a=j(U,"DIV",{});var L=$(a);v=j(L,"H1",{class:!0,"data-svelte-h":!0}),S(v)!=="svelte-z7m4lk"&&(v.textContent=h),P=T(L),w=j(L,"P",{class:!0,"data-svelte-h":!0}),S(w)!=="svelte-1vtv92f"&&(w.textContent=B),L.forEach(m),U.forEach(m),O.forEach(m),b=T(M),C=j(M,"DIV",{class:!0});var ct=$(C);Q(E.$$.fragment,ct),ct.forEach(m),p=T(M),Q(k.$$.fragment,M),M.forEach(m),this.h()},h:function(){f(o,"d","M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z"),_(o,g,156,12,4598),f(i,"d","M19 10v2a7 7 0 0 1-14 0v-2"),_(i,g,157,12,4675),f(r,"x1","12"),f(r,"x2","12"),f(r,"y1","19"),f(r,"y2","22"),_(r,g,158,12,4726),f(d,"x1","8"),f(d,"x2","16"),f(d,"y1","22"),f(d,"y2","22"),_(d,g,159,12,4778),f(s,"width","48"),f(s,"height","48"),f(s,"viewBox","0 0 24 24"),f(s,"fill","none"),f(s,"stroke","currentColor"),f(s,"stroke-width","2"),_(s,g,155,10,4486),f(n,"class","mic-icon svelte-1mjpxqj"),_(n,g,154,8,4453),f(v,"class","mic-test-title svelte-1mjpxqj"),_(v,g,163,10,4873),f(w,"class","mic-test-description svelte-1mjpxqj"),_(w,g,164,10,4922),_(a,g,162,8,4857),f(c,"class","mic-test-header svelte-1mjpxqj"),_(c,g,153,6,4415),f(e,"class","header svelte-1mjpxqj"),_(e,g,152,4,4388),f(C,"class","training-mode-info svelte-1mjpxqj"),_(C,g,170,4,5055),f(t,"class","microphone-test svelte-1mjpxqj"),_(t,g,150,2,4336)},m:function(D,M){q(D,t,M),y(t,e),y(e,c),y(c,n),y(n,s),y(s,o),y(s,i),y(s,r),y(s,d),y(c,l),y(c,a),y(a,v),y(a,P),y(a,w),y(t,b),y(t,C),K(E,C,null),y(t,p),K(k,t,null),N=!0},p:function(D,M){const O={};M&16385&&(O.$$scope={dirty:M,ctx:D}),E.$set(O);const U={};M&16386&&(U.$$scope={dirty:M,ctx:D}),k.$set(U)},i:function(D){N||(J(E.$$.fragment,D),J(k.$$.fragment,D),N=!0)},o:function(D){Z(E.$$.fragment,D),Z(k.$$.fragment,D),N=!1},d:function(D){D&&m(t),G(E),G(k)}};return I("SvelteRegisterBlock",{block:H,id:xt.name,type:"slot",source:"(150:0) <PageLayout showBackButton={true}>",ctx:u}),H}function ot(u){let t,e,c;e=new ft({props:{showBackButton:!0,$$slots:{default:[xt]},$$scope:{ctx:u}},$$inline:!0});const n={c:function(){t=V(),W(e.$$.fragment),this.h()},l:function(o){wt("svelte-8st1fo",document.head).forEach(m),t=T(o),Q(e.$$.fragment,o),this.h()},h:function(){document.title="„Éû„Ç§„ÇØ„ÉÜ„Çπ„Éà - Áõ∏ÂØæÈü≥ÊÑü„Éà„É¨„Éº„Éã„É≥„Ç∞"},m:function(o,i){q(o,t,i),K(e,o,i),c=!0},p:function(o,[i]){const r={};i&16387&&(r.$$scope={dirty:i,ctx:o}),e.$set(r)},i:function(o){c||(J(e.$$.fragment,o),c=!0)},o:function(o){Z(e.$$.fragment,o),c=!1},d:function(o){o&&m(t),G(e,o)}};return I("SvelteRegisterBlock",{block:n,id:ot.name,type:"component",source:"",ctx:u}),n}function bt(u){}function St(u,t,e){let c;Pt(et,"page"),$t(u,et,p=>e(12,c=p));let{$$slots:n={},$$scope:s}=t;Dt("Page",n,[]);let o="random";at(()=>{c.url.searchParams.has("mode")&&(o=c.url.searchParams.get("mode")||"random")});let i="initial",r=0,d=0,l="„Éº„Éº",a=null;const v={random:{name:"„É©„É≥„ÉÄ„É†Âü∫Èü≥„É¢„Éº„Éâ",description:"10Á®ÆÈ°û„ÅÆÂü∫Èü≥„Åã„Çâ„É©„É≥„ÉÄ„É†„Å´ÈÅ∏Êäû„Åó„Å¶„Éà„É¨„Éº„Éã„É≥„Ç∞",color:"green",path:"/training/random"},continuous:{name:"ÈÄ£Á∂ö„ÉÅ„É£„É¨„É≥„Ç∏„É¢„Éº„Éâ",description:"ÈÅ∏Êäû„Åó„ÅüÂõûÊï∞„Å†„ÅëÈÄ£Á∂ö„ÅßÂÆüË°å„Åó„ÄÅÁ∑èÂêàË©ï‰æ°„ÇíÁ¢∫Ë™ç",color:"orange",path:"/training/continuous"},chromatic:{name:"12Èü≥Èöé„É¢„Éº„Éâ",description:"„ÇØ„É≠„Éû„ÉÅ„ÉÉ„ÇØ„Çπ„Ç±„Éº„É´„ÅÆ‰∏äË°å„Éª‰∏ãË°å„ÅßÂÆåÂÖ®Âà∂Ë¶á",color:"purple",path:"/training/chromatic"}},h=v[o]||v.random;async function P(){var p;e(0,i="pending");try{if(console.log("üé§ [MicTest] „Éû„Ç§„ÇØË®±ÂèØ„É™„ÇØ„Ç®„Çπ„ÉàÈñãÂßã"),!((p=navigator.mediaDevices)!=null&&p.getUserMedia)){e(0,i="denied"),console.error("‚ùå [MicTest] getUserMedia„Åå„Çµ„Éù„Éº„Éà„Åï„Çå„Å¶„ÅÑ„Åæ„Åõ„Çì");return}const k=await dt.initialize();if(console.log("‚úÖ [MicTest] AudioManager „É™„ÇΩ„Éº„ÇπÂèñÂæóÂÆå‰∫Ü"),k.mediaStream&&k.audioContext)e(0,i="granted"),console.log("‚úÖ [MicTest] „Éû„Ç§„ÇØË®±ÂèØÂÆå‰∫Ü"),setTimeout(async()=>{a&&(console.log("üéôÔ∏è [MicTest] PitchDetectorÂàùÊúüÂåñÈñãÂßã"),await a.initialize(),console.log("‚úÖ [MicTest] PitchDetectorÂàùÊúüÂåñÂÆå‰∫Ü"),setTimeout(()=>{a&&(console.log("üéØ [MicTest] PitchDetectorÊ§úÂá∫ÈñãÂßãÔºàSafariÂØæÂøúÔºâ"),a.startDetection())},2e3))},1e3);else throw new Error("„É™„ÇΩ„Éº„ÇπÂèñÂæóÂ§±Êïó")}catch(k){console.error("‚ùå [MicTest] „Éû„Ç§„ÇØË®±ÂèØ„Ç®„É©„Éº:",k),e(0,i=((k==null?void 0:k.name)==="NotAllowedError","denied"))}}function w(){console.log("üöÄ [MicTest] „Éà„É¨„Éº„Éã„É≥„Ç∞ÈñãÂßã - „É©„É≥„ÉÄ„É†Âü∫Èü≥„É¢„Éº„Éâ„Å∏ÈÅ∑Áßª"),ut(`${lt}${h.path}?from=microphone-test`)}function B(p){const{frequency:k,note:N,volume:H,rawVolume:R,clarity:D}=p.detail;d=k,l=N,r=H}function b(p){console.error("‚ùå [MicTest] PitchDetector„Ç®„É©„Éº:",p.detail);const{error:k,reason:N,recovery:H}=p.detail;N==="mediastream_ended"&&H==="restart_required"&&(console.log("üîÑ [MicTest] MediaStreamÁµÇ‰∫ÜÊ§úÂá∫ - Ëá™ÂãïÂæ©ÊóßÈñãÂßã"),e(0,i="initial"),r=0,d=0,l="„Éº„Éº",console.log("‚ö†Ô∏è [MicTest] „Éû„Ç§„ÇØÂÜçË®±ÂèØ„ÅåÂøÖË¶Å„Åß„Åô"))}const C=[];Object.keys(t).forEach(p=>{!~C.indexOf(p)&&p.slice(0,2)!=="$$"&&p!=="slot"&&Vt.warn(`<Page> was created with unknown prop '${p}'`)});function E(p){Et[p?"unshift":"push"](()=>{a=p,e(1,a)})}return u.$capture_state=()=>({onMount:at,page:et,goto:ut,base:lt,Card:nt,Button:Bt,PageLayout:ft,PitchDetector:mt,VolumeBar:Tt,audioManager:dt,mode:o,micPermission:i,currentVolume:r,currentFrequency:d,detectedNote:l,pitchDetectorComponent:a,trainingModes:v,selectedMode:h,requestMicrophone:P,startTraining:w,handlePitchUpdate:B,handlePitchDetectorStateChange:bt,handlePitchDetectorError:b,$page:c}),u.$inject_state=p=>{"mode"in p&&(o=p.mode),"micPermission"in p&&e(0,i=p.micPermission),"currentVolume"in p&&(r=p.currentVolume),"currentFrequency"in p&&(d=p.currentFrequency),"detectedNote"in p&&(l=p.detectedNote),"pitchDetectorComponent"in p&&e(1,a=p.pitchDetectorComponent)},t&&"$$inject"in t&&u.$inject_state(t.$$inject),[i,a,h,P,w,B,b,E]}class At extends Ct{constructor(t){super(t),kt(this,t,St,ot,qt,{}),I("SvelteRegisterComponent",{component:this,tagName:"Page",options:t,id:ot.name})}}export{At as component};
