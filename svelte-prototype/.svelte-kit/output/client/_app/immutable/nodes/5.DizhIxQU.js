const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["../chunks/COGgd1ld.js","../chunks/BbQtw8CC.js","../chunks/D6YF6ztN.js","../chunks/IHki7fMi.js","../chunks/DToEmvX0.js","../assets/sessionStorage.2zs4CtXT.css"])))=>i.map(i=>d[i]);
import{_ as st}from"../chunks/C1FmrZbK.js";import{S as on,i as an,s as cn,d as h,C as ce,m as B,o as F,b as $,D as le,N as ln,h as O,E as ie,k as G,F as ue,l as we,I as un,Q as fn,p as De,q as Ce,c as g,y as k,L as $e,e as A,f as H,G as pe,g as z,r as Ie,j as T,t as j,M as mn,a as _e,O as It,n as ot}from"../chunks/BbQtw8CC.js";import{e as Ue}from"../chunks/D6YF6ztN.js";import"../chunks/IHki7fMi.js";import{b as Je,g as at}from"../chunks/DToEmvX0.js";import{p as dn}from"../chunks/jGt1E1Xm.js";import{P as gn,C as He}from"../chunks/DNmPTphr.js";import{B as Ke}from"../chunks/CB02h6m0.js";import{l as te,a as Ee,b as pn,P as hn,h as ct}from"../chunks/DjSLRzt-.js";import{l as lt,s as je,S as vn,E as yn,A as Nt,n as it,M as _n,U as Rt,a as Oe,b as Sn,c as bn,u as wn,i as Dn,r as Cn,d as An,e as Tn,f as Mn,t as kn,g as In}from"../chunks/COGgd1ld.js";const Nn=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global,Rn=!1,Fn=!1,pr=Object.freeze(Object.defineProperty({__proto__:null,prerender:Fn,ssr:Rn},Symbol.toStringTag,{value:"Module"})),{document:ut}=Nn;function ft(o,e,t){const n=o.slice();return n[98]=e[t],n[100]=t,n}function mt(o,e,t){const n=o.slice();return n[101]=e[t],n}function dt(o){var x,Q,X;let e,t,n,r,s=(((x=o[24])==null?void 0:x.length)||0)+"",i,m,f,c,u,p=8-(((Q=o[24])==null?void 0:Q.length)||0)+"",d,S,_,C,M,q,Y,w,b=Math.round((((X=o[24])==null?void 0:X.length)||0)/8*100)+"",V,U,v,I,R,P=o[0]==="results"&&gt(o);return{c(){e=T("div"),t=T("div"),n=T("div"),r=T("span"),i=j(s),m=j("/8"),f=G(),c=T("span"),u=j("æ®‹ã‚Š "),d=j(p),S=j(" ã‚»ãƒƒã‚·ãƒ§ãƒ³"),_=G(),C=T("div"),M=T("div"),q=T("div"),Y=G(),w=T("span"),V=j(b),U=j("%"),v=G(),P&&P.c(),I=Ie(),this.h()},l(L){e=A(L,"DIV",{class:!0});var re=H(e);t=A(re,"DIV",{class:!0});var Se=H(t);n=A(Se,"DIV",{class:!0});var se=H(n);r=A(se,"SPAN",{class:!0});var de=H(r);i=z(de,s),m=z(de,"/8"),de.forEach(h),f=O(se),c=A(se,"SPAN",{class:!0});var oe=H(c);u=z(oe,"æ®‹ã‚Š "),d=z(oe,p),S=z(oe," ã‚»ãƒƒã‚·ãƒ§ãƒ³"),oe.forEach(h),se.forEach(h),_=O(Se),C=A(Se,"DIV",{class:!0});var he=H(C);M=A(he,"DIV",{class:!0});var Me=H(M);q=A(Me,"DIV",{class:!0,style:!0}),H(q).forEach(h),Me.forEach(h),Y=O(he),w=A(he,"SPAN",{class:!0});var Ne=H(w);V=z(Ne,b),U=z(Ne,"%"),Ne.forEach(h),he.forEach(h),Se.forEach(h),re.forEach(h),v=O(L),P&&P.l(L),I=Ie(),this.h()},h(){var L;k(r,"class","completed-count svelte-rt5px1"),k(c,"class","remaining-text svelte-rt5px1"),k(n,"class","session-info svelte-rt5px1"),k(q,"class","progress-fill svelte-rt5px1"),$e(q,"width",(((L=o[24])==null?void 0:L.length)||0)/8*100+"%"),k(M,"class","progress-bar svelte-rt5px1"),k(w,"class","progress-text svelte-rt5px1"),k(C,"class","progress-section svelte-rt5px1"),k(t,"class","session-status svelte-rt5px1"),k(e,"class","session-progress svelte-rt5px1")},m(L,re){$(L,e,re),g(e,t),g(t,n),g(n,r),g(r,i),g(r,m),g(n,f),g(n,c),g(c,u),g(c,d),g(c,S),g(t,_),g(t,C),g(C,M),g(M,q),g(C,Y),g(C,w),g(w,V),g(w,U),$(L,v,re),P&&P.m(L,re),$(L,I,re),R=!0},p(L,re){var Se,se,de,oe;(!R||re[0]&16777216)&&s!==(s=(((Se=L[24])==null?void 0:Se.length)||0)+"")&&_e(i,s),(!R||re[0]&16777216)&&p!==(p=8-(((se=L[24])==null?void 0:se.length)||0)+"")&&_e(d,p),(!R||re[0]&16777216)&&$e(q,"width",(((de=L[24])==null?void 0:de.length)||0)/8*100+"%"),(!R||re[0]&16777216)&&b!==(b=Math.round((((oe=L[24])==null?void 0:oe.length)||0)/8*100)+"")&&_e(V,b),L[0]==="results"?P?(P.p(L,re),re[0]&1&&F(P,1)):(P=gt(L),P.c(),F(P,1),P.m(I.parentNode,I)):P&&(De(),B(P,1,1,()=>{P=null}),Ce())},i(L){R||(F(P),R=!0)},o(L){B(P),R=!1},d(L){L&&(h(e),h(v),h(I)),P&&P.d(L)}}}function gt(o){let e,t,n;return t=new Nt({props:{isCompleted:o[5],position:"top"}}),t.$on("action",o[29]),{c(){e=T("div"),ue(t.$$.fragment),this.h()},l(r){e=A(r,"DIV",{class:!0});var s=H(e);ie(t.$$.fragment,s),s.forEach(h),this.h()},h(){k(e,"class","top-action-buttons svelte-rt5px1")},m(r,s){$(r,e,s),le(t,e,null),n=!0},p(r,s){const i={};s[0]&32&&(i.isCompleted=r[5]),t.$set(i)},i(r){n||(F(t.$$.fragment,r),n=!0)},o(r){B(t.$$.fragment,r),n=!1},d(r){r&&h(e),ce(t)}}}function En(o){let e,t;return e=new He({props:{class:"error-card",$$slots:{default:[xn]},$$scope:{ctx:o}}}),{c(){ue(e.$$.fragment)},l(n){ie(e.$$.fragment,n)},m(n,r){le(e,n,r),t=!0},p(n,r){const s={};r[3]&2048&&(s.$$scope={dirty:r,ctx:n}),e.$set(s)},i(n){t||(F(e.$$.fragment,n),t=!0)},o(n){B(e.$$.fragment,n),t=!1},d(n){ce(e,n)}}}function $n(o){let e,t,n,r,s,i,m,f={isActive:o[1]==="granted",trainingPhase:o[0],className:"pitch-detector-content",debugMode:!0,disableHarmonicCorrection:!1};t=new pn({props:f}),o[34](t),t.$on("pitchUpdate",o[28]),t.$on("stateChange",nr),t.$on("error",rr),t.$on("microphoneHealthChange",o[31]);let c=o[0]!=="results"&&pt(o),u=o[0]!=="results"&&_t(o),p=o[0]==="results"&&wt(o);return{c(){e=T("div"),ue(t.$$.fragment),n=G(),c&&c.c(),r=G(),u&&u.c(),s=G(),p&&p.c(),i=Ie(),this.h()},l(d){e=A(d,"DIV",{style:!0});var S=H(e);ie(t.$$.fragment,S),S.forEach(h),n=O(d),c&&c.l(d),r=O(d),u&&u.l(d),s=O(d),p&&p.l(d),i=Ie(),this.h()},h(){$e(e,"display","none")},m(d,S){$(d,e,S),le(t,e,null),$(d,n,S),c&&c.m(d,S),$(d,r,S),u&&u.m(d,S),$(d,s,S),p&&p.m(d,S),$(d,i,S),m=!0},p(d,S){const _={};S[0]&2&&(_.isActive=d[1]==="granted"),S[0]&1&&(_.trainingPhase=d[0]),t.$set(_),d[0]!=="results"?c?(c.p(d,S),S[0]&1&&F(c,1)):(c=pt(d),c.c(),F(c,1),c.m(r.parentNode,r)):c&&(De(),B(c,1,1,()=>{c=null}),Ce()),d[0]!=="results"?u?(u.p(d,S),S[0]&1&&F(u,1)):(u=_t(d),u.c(),F(u,1),u.m(s.parentNode,s)):u&&(De(),B(u,1,1,()=>{u=null}),Ce()),d[0]==="results"?p?(p.p(d,S),S[0]&1&&F(p,1)):(p=wt(d),p.c(),F(p,1),p.m(i.parentNode,i)):p&&(De(),B(p,1,1,()=>{p=null}),Ce())},i(d){m||(F(t.$$.fragment,d),F(c),F(u),F(p),m=!0)},o(d){B(t.$$.fragment,d),B(c),B(u),B(p),m=!1},d(d){d&&(h(e),h(n),h(r),h(s),h(i)),o[34](null),ce(t),c&&c.d(d),u&&u.d(d),p&&p.d(d)}}}function qn(o){let e;return{c(){e=j("ğŸ¤ ãƒã‚¤ã‚¯ãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸ã¸ç§»å‹•")},l(t){e=z(t,"ğŸ¤ ãƒã‚¤ã‚¯ãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸ã¸ç§»å‹•")},m(t,n){$(t,e,n)},d(t){t&&h(e)}}}function Pn(o){let e;return{c(){e=j("ğŸ  ãƒ›ãƒ¼ãƒ ã«æˆ»ã‚‹")},l(t){e=z(t,"ğŸ  ãƒ›ãƒ¼ãƒ ã«æˆ»ã‚‹")},m(t,n){$(t,e,n)},d(t){t&&h(e)}}}function xn(o){let e,t,n="ğŸ¤",r,s,i="ãƒã‚¤ã‚¯ãƒ†ã‚¹ãƒˆãŒå¿…è¦ã§ã™",m,f,c="é€£ç¶šãƒãƒ£ãƒ¬ãƒ³ã‚¸ãƒ¢ãƒ¼ãƒ‰ã‚’é–‹å§‹ã™ã‚‹å‰ã«ã€ãƒã‚¤ã‚¯ãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸ã§éŸ³å£°å…¥åŠ›ã®ç¢ºèªã‚’ãŠé¡˜ã„ã—ã¾ã™ã€‚",u,p,d='<p class="svelte-rt5px1">ã“ã®ãƒšãƒ¼ã‚¸ã¯<strong>ãƒã‚¤ã‚¯ãƒ†ã‚¹ãƒˆå®Œäº†å¾Œ</strong>ã«ã”åˆ©ç”¨ã„ãŸã ã‘ã¾ã™ã€‚</p> <p class="svelte-rt5px1">ã¾ãšã¯ãƒã‚¤ã‚¯ãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸ã§éŸ³å£°ç¢ºèªã‚’è¡Œã£ã¦ãã ã•ã„ã€‚</p>',S,_,C,M,q,Y;return C=new Ke({props:{variant:"primary",$$slots:{default:[qn]},$$scope:{ctx:o}}}),C.$on("click",o[26]),q=new Ke({props:{variant:"secondary",$$slots:{default:[Pn]},$$scope:{ctx:o}}}),q.$on("click",o[27]),{c(){e=T("div"),t=T("div"),t.textContent=n,r=G(),s=T("h3"),s.textContent=i,m=G(),f=T("p"),f.textContent=c,u=G(),p=T("div"),p.innerHTML=d,S=G(),_=T("div"),ue(C.$$.fragment),M=G(),ue(q.$$.fragment),this.h()},l(w){e=A(w,"DIV",{class:!0});var b=H(e);t=A(b,"DIV",{class:!0,"data-svelte-h":!0}),pe(t)!=="svelte-15rbx8n"&&(t.textContent=n),r=O(b),s=A(b,"H3",{class:!0,"data-svelte-h":!0}),pe(s)!=="svelte-17kvze2"&&(s.textContent=i),m=O(b),f=A(b,"P",{class:!0,"data-svelte-h":!0}),pe(f)!=="svelte-1t09god"&&(f.textContent=c),u=O(b),p=A(b,"DIV",{class:!0,"data-svelte-h":!0}),pe(p)!=="svelte-13ge0u9"&&(p.innerHTML=d),S=O(b),_=A(b,"DIV",{class:!0});var V=H(_);ie(C.$$.fragment,V),M=O(V),ie(q.$$.fragment,V),V.forEach(h),b.forEach(h),this.h()},h(){k(t,"class","error-icon svelte-rt5px1"),k(s,"class","svelte-rt5px1"),k(f,"class","svelte-rt5px1"),k(p,"class","recommendation svelte-rt5px1"),k(_,"class","action-buttons"),k(e,"class","error-content svelte-rt5px1")},m(w,b){$(w,e,b),g(e,t),g(e,r),g(e,s),g(e,m),g(e,f),g(e,u),g(e,p),g(e,S),g(e,_),le(C,_,null),g(_,M),le(q,_,null),Y=!0},p(w,b){const V={};b[3]&2048&&(V.$$scope={dirty:b,ctx:w}),C.$set(V);const U={};b[3]&2048&&(U.$$scope={dirty:b,ctx:w}),q.$set(U)},i(w){Y||(F(C.$$.fragment,w),F(q.$$.fragment,w),Y=!0)},o(w){B(C.$$.fragment,w),B(q.$$.fragment,w),Y=!1},d(w){w&&h(e),ce(C),ce(q)}}}function pt(o){let e,t,n,r,s,i,m=!o[2]&&o[6].length>0&&ht(o);return n=new He({props:{class:"main-card half-width",$$slots:{default:[Un]},$$scope:{ctx:o}}}),s=new hn({props:{frequency:o[14],note:o[15],volume:o[13],isMuted:o[0]!=="guiding",muteMessage:"åŸºéŸ³å†ç”Ÿå¾Œã«é–‹å§‹",className:"half-width",showGuidance:!1}}),{c(){m&&m.c(),e=G(),t=T("div"),ue(n.$$.fragment),r=G(),ue(s.$$.fragment),this.h()},l(f){m&&m.l(f),e=O(f),t=A(f,"DIV",{class:!0});var c=H(t);ie(n.$$.fragment,c),r=O(c),ie(s.$$.fragment,c),c.forEach(h),this.h()},h(){k(t,"class","side-by-side-container svelte-rt5px1")},m(f,c){m&&m.m(f,c),$(f,e,c),$(f,t,c),le(n,t,null),g(t,r),le(s,t,null),i=!0},p(f,c){!f[2]&&f[6].length>0?m?(m.p(f,c),c[0]&68&&F(m,1)):(m=ht(f),m.c(),F(m,1),m.m(e.parentNode,e)):m&&(De(),B(m,1,1,()=>{m=null}),Ce());const u={};c[0]&8395649|c[3]&2048&&(u.$$scope={dirty:c,ctx:f}),n.$set(u);const p={};c[0]&16384&&(p.frequency=f[14]),c[0]&32768&&(p.note=f[15]),c[0]&8192&&(p.volume=f[13]),c[0]&1&&(p.isMuted=f[0]!=="guiding"),s.$set(p)},i(f){i||(F(m),F(n.$$.fragment,f),F(s.$$.fragment,f),i=!0)},o(f){B(m),B(n.$$.fragment,f),B(s.$$.fragment,f),i=!1},d(f){f&&(h(e),h(t)),m&&m.d(f),ce(n),ce(s)}}}function ht(o){let e,t;return e=new He({props:{class:"warning-card",$$slots:{default:[Vn]},$$scope:{ctx:o}}}),{c(){ue(e.$$.fragment)},l(n){ie(e.$$.fragment,n)},m(n,r){le(e,n,r),t=!0},p(n,r){const s={};r[0]&64|r[3]&2048&&(s.$$scope={dirty:r,ctx:n}),e.$set(s)},i(n){t||(F(e.$$.fragment,n),t=!0)},o(n){B(e.$$.fragment,n),t=!1},d(n){ce(e,n)}}}function vt(o){let e,t=o[101]+"",n;return{c(){e=T("li"),n=j(t),this.h()},l(r){e=A(r,"LI",{class:!0});var s=H(e);n=z(s,t),s.forEach(h),this.h()},h(){k(e,"class","svelte-rt5px1")},m(r,s){$(r,e,s),g(e,n)},p(r,s){s[0]&64&&t!==(t=r[101]+"")&&_e(n,t)},d(r){r&&h(e)}}}function Vn(o){let e,t='<h3 class="section-title svelte-rt5px1">âš ï¸ ãƒã‚¤ã‚¯æ¥ç¶šã«å•é¡ŒãŒã‚ã‚Šã¾ã™</h3>',n,r,s,i="ãƒã‚¤ã‚¯ãŒæ­£å¸¸ã«å‹•ä½œã—ã¦ã„ã¾ã›ã‚“ã€‚ä»¥ä¸‹ã®å•é¡ŒãŒæ¤œå‡ºã•ã‚Œã¾ã—ãŸï¼š",m,f,c,u,p="<strong>è§£æ±ºæ–¹æ³•:</strong> ãƒšãƒ¼ã‚¸ã‚’å†èª­ã¿è¾¼ã¿ã—ã¦ãƒã‚¤ã‚¯è¨±å¯ã‚’å†åº¦å–å¾—ã—ã¦ãã ã•ã„ã€‚",d=Ue(o[6]),S=[];for(let _=0;_<d.length;_+=1)S[_]=vt(mt(o,d,_));return{c(){e=T("div"),e.innerHTML=t,n=G(),r=T("div"),s=T("p"),s.textContent=i,m=G(),f=T("ul");for(let _=0;_<S.length;_+=1)S[_].c();c=G(),u=T("p"),u.innerHTML=p,this.h()},l(_){e=A(_,"DIV",{class:!0,"data-svelte-h":!0}),pe(e)!=="svelte-1mob8td"&&(e.innerHTML=t),n=O(_),r=A(_,"DIV",{class:!0});var C=H(r);s=A(C,"P",{class:!0,"data-svelte-h":!0}),pe(s)!=="svelte-171o2p0"&&(s.textContent=i),m=O(C),f=A(C,"UL",{class:!0});var M=H(f);for(let q=0;q<S.length;q+=1)S[q].l(M);M.forEach(h),c=O(C),u=A(C,"P",{class:!0,"data-svelte-h":!0}),pe(u)!=="svelte-1o4df0k"&&(u.innerHTML=p),C.forEach(h),this.h()},h(){k(e,"class","card-header svelte-rt5px1"),k(s,"class","warning-message svelte-rt5px1"),k(f,"class","error-list svelte-rt5px1"),k(u,"class","fix-instruction svelte-rt5px1"),k(r,"class","card-content svelte-rt5px1")},m(_,C){$(_,e,C),$(_,n,C),$(_,r,C),g(r,s),g(r,m),g(r,f);for(let M=0;M<S.length;M+=1)S[M]&&S[M].m(f,null);g(r,c),g(r,u)},p(_,C){if(C[0]&64){d=Ue(_[6]);let M;for(M=0;M<d.length;M+=1){const q=mt(_,d,M);S[M]?S[M].p(q,C):(S[M]=vt(q),S[M].c(),S[M].m(f,null))}for(;M<S.length;M+=1)S[M].d(1);S.length=d.length}},d(_){_&&(h(e),h(n),h(r)),It(S,_)}}}function Hn(o){let e;function t(s,i){return s[9]?On:s[0]==="guiding"?jn:s[0]==="results"?zn:Ln}let n=t(o),r=n(o);return{c(){e=T("div"),r.c(),this.h()},l(s){e=A(s,"DIV",{class:!0});var i=H(e);r.l(i),i.forEach(h),this.h()},h(){k(e,"class","continuous-status svelte-rt5px1")},m(s,i){$(s,e,i),r.m(e,null)},p(s,i){n===(n=t(s))&&r?r.p(s,i):(r.d(1),r=n(s),r&&(r.c(),r.m(e,null)))},i:ot,o:ot,d(s){s&&h(e),r.d()}}}function Bn(o){let e,t;return e=new Ke({props:{variant:"primary",$$slots:{default:[Gn]},$$scope:{ctx:o}}}),e.$on("click",o[30]),{c(){ue(e.$$.fragment)},l(n){ie(e.$$.fragment,n)},m(n,r){le(e,n,r),t=!0},p(n,r){const s={};r[3]&2048&&(s.$$scope={dirty:r,ctx:n}),e.$set(s)},i(n){t||(F(e.$$.fragment,n),t=!0)},o(n){B(e.$$.fragment,n),t=!1},d(n){ce(e,n)}}}function Ln(o){let e,t,n,r;return{c(){e=T("div"),t=j("âš¡ é€£ç¶šãƒ¢ãƒ¼ãƒ‰é€²è¡Œä¸­ ("),n=j(o[23]),r=j("/8)"),this.h()},l(s){e=A(s,"DIV",{class:!0});var i=H(e);t=z(i,"âš¡ é€£ç¶šãƒ¢ãƒ¼ãƒ‰é€²è¡Œä¸­ ("),n=z(i,o[23]),r=z(i,"/8)"),i.forEach(h),this.h()},h(){k(e,"class","status-text svelte-rt5px1")},m(s,i){$(s,e,i),g(e,t),g(e,n),g(e,r)},p(s,i){i[0]&8388608&&_e(n,s[23])},d(s){s&&h(e)}}}function zn(o){let e,t,n,r;return{c(){e=T("div"),t=j("âœ… ã‚»ãƒƒã‚·ãƒ§ãƒ³ "),n=j(o[23]),r=j("/8 å®Œäº†"),this.h()},l(s){e=A(s,"DIV",{class:!0});var i=H(e);t=z(i,"âœ… ã‚»ãƒƒã‚·ãƒ§ãƒ³ "),n=z(i,o[23]),r=z(i,"/8 å®Œäº†"),i.forEach(h),this.h()},h(){k(e,"class","status-text svelte-rt5px1")},m(s,i){$(s,e,i),g(e,t),g(e,n),g(e,r)},p(s,i){i[0]&8388608&&_e(n,s[23])},d(s){s&&h(e)}}}function jn(o){let e,t,n,r;return{c(){e=T("div"),t=j("ğŸ¤ ã‚»ãƒƒã‚·ãƒ§ãƒ³ "),n=j(o[23]),r=j("/8: ãƒ‰ãƒ¬ãƒŸç™ºå£°ä¸­"),this.h()},l(s){e=A(s,"DIV",{class:!0});var i=H(e);t=z(i,"ğŸ¤ ã‚»ãƒƒã‚·ãƒ§ãƒ³ "),n=z(i,o[23]),r=z(i,"/8: ãƒ‰ãƒ¬ãƒŸç™ºå£°ä¸­"),i.forEach(h),this.h()},h(){k(e,"class","status-text svelte-rt5px1")},m(s,i){$(s,e,i),g(e,t),g(e,n),g(e,r)},p(s,i){i[0]&8388608&&_e(n,s[23])},d(s){s&&h(e)}}}function On(o){let e,t,n,r;return{c(){e=T("div"),t=j("ğŸµ åŸºéŸ³ "),n=j(o[23]),r=j("/8 å†ç”Ÿä¸­..."),this.h()},l(s){e=A(s,"DIV",{class:!0});var i=H(e);t=z(i,"ğŸµ åŸºéŸ³ "),n=z(i,o[23]),r=z(i,"/8 å†ç”Ÿä¸­..."),i.forEach(h),this.h()},h(){k(e,"class","status-text svelte-rt5px1")},m(s,i){$(s,e,i),g(e,t),g(e,n),g(e,r)},p(s,i){i[0]&8388608&&_e(n,s[23])},d(s){s&&h(e)}}}function Gn(o){let e;return{c(){e=j("âš¡ é€£ç¶šãƒãƒ£ãƒ¬ãƒ³ã‚¸é–‹å§‹ï¼ˆ8ã‚»ãƒƒã‚·ãƒ§ãƒ³ï¼‰")},l(t){e=z(t,"âš¡ é€£ç¶šãƒãƒ£ãƒ¬ãƒ³ã‚¸é–‹å§‹ï¼ˆ8ã‚»ãƒƒã‚·ãƒ§ãƒ³ï¼‰")},m(t,n){$(t,e,n)},d(t){t&&h(e)}}}function yt(o){let e,t,n,r,s,i=o[8].toFixed(1)+"",m,f;return{c(){e=T("div"),t=j("ç¾åœ¨ã®åŸºéŸ³: "),n=T("strong"),r=j(o[7]),s=j(" ("),m=j(i),f=j("Hz)"),this.h()},l(c){e=A(c,"DIV",{class:!0});var u=H(e);t=z(u,"ç¾åœ¨ã®åŸºéŸ³: "),n=A(u,"STRONG",{});var p=H(n);r=z(p,o[7]),p.forEach(h),s=z(u," ("),m=z(u,i),f=z(u,"Hz)"),u.forEach(h),this.h()},h(){k(e,"class","base-note-info svelte-rt5px1")},m(c,u){$(c,e,u),g(e,t),g(e,n),g(n,r),g(e,s),g(e,m),g(e,f)},p(c,u){u[0]&128&&_e(r,c[7]),u[0]&256&&i!==(i=c[8].toFixed(1)+"")&&_e(m,i)},d(c){c&&h(e)}}}function Un(o){let e,t='<h3 class="section-title svelte-rt5px1">ğŸ¹ åŸºéŸ³å†ç”Ÿ</h3>',n,r,s,i,m,f,c,u,p="ã‚¬ã‚¤ãƒ‰é–‹å§‹ã¾ã§",d,S,_,C,M,q,Y,w;const b=[Bn,Hn],V=[];function U(I,R){return I[0]==="setup"&&!I[9]&&!(I[23]>1)?0:1}s=U(o),i=V[s]=b[s](o);let v=o[7]&&yt(o);return q=new _n({props:{size:"20"}}),{c(){e=T("div"),e.innerHTML=t,n=G(),r=T("div"),i.c(),m=G(),v&&v.c(),f=G(),c=T("div"),u=T("div"),u.textContent=p,d=G(),S=T("div"),_=T("div"),C=G(),M=T("div"),ue(q.$$.fragment),this.h()},l(I){e=A(I,"DIV",{class:!0,"data-svelte-h":!0}),pe(e)!=="svelte-o46h1v"&&(e.innerHTML=t),n=O(I),r=A(I,"DIV",{class:!0});var R=H(r);i.l(R),m=O(R),v&&v.l(R),f=O(R),c=A(R,"DIV",{class:!0});var P=H(c);u=A(P,"DIV",{class:!0,"data-svelte-h":!0}),pe(u)!=="svelte-1dufnpv"&&(u.textContent=p),d=O(P),S=A(P,"DIV",{class:!0});var x=H(S);_=A(x,"DIV",{class:!0,style:!0}),H(_).forEach(h),C=O(x),M=A(x,"DIV",{class:!0});var Q=H(M);ie(q.$$.fragment,Q),Q.forEach(h),x.forEach(h),P.forEach(h),R.forEach(h),this.h()},h(){k(e,"class","card-header svelte-rt5px1"),k(u,"class","guide-start-label svelte-rt5px1"),k(_,"class","guide-progress-fill svelte-rt5px1"),$e(_,"width",o[11]+"%"),k(M,"class",Y="guide-music-icon "+(o[12]?"glowing":"")+" svelte-rt5px1"),k(S,"class","guide-start-bar svelte-rt5px1"),k(c,"class","guide-start-bar-container svelte-rt5px1"),k(r,"class","card-content svelte-rt5px1")},m(I,R){$(I,e,R),$(I,n,R),$(I,r,R),V[s].m(r,null),g(r,m),v&&v.m(r,null),g(r,f),g(r,c),g(c,u),g(c,d),g(c,S),g(S,_),g(S,C),g(S,M),le(q,M,null),w=!0},p(I,R){let P=s;s=U(I),s===P?V[s].p(I,R):(De(),B(V[P],1,1,()=>{V[P]=null}),Ce(),i=V[s],i?i.p(I,R):(i=V[s]=b[s](I),i.c()),F(i,1),i.m(r,m)),I[7]?v?v.p(I,R):(v=yt(I),v.c(),v.m(r,f)):v&&(v.d(1),v=null),(!w||R[0]&2048)&&$e(_,"width",I[11]+"%"),(!w||R[0]&4096&&Y!==(Y="guide-music-icon "+(I[12]?"glowing":"")+" svelte-rt5px1"))&&k(M,"class",Y)},i(I){w||(F(i),F(q.$$.fragment,I),w=!0)},o(I){B(i),B(q.$$.fragment,I),w=!1},d(I){I&&(h(e),h(n),h(r)),V[s].d(),v&&v.d(),ce(q)}}}function _t(o){let e,t;return e=new He({props:{class:"main-card",$$slots:{default:[Qn]},$$scope:{ctx:o}}}),{c(){ue(e.$$.fragment)},l(n){ie(e.$$.fragment,n)},m(n,r){le(e,n,r),t=!0},p(n,r){const s={};r[0]&1025|r[3]&2048&&(s.$$scope={dirty:r,ctx:n}),e.$set(s)},i(n){t||(F(e.$$.fragment,n),t=!0)},o(n){B(e.$$.fragment,n),t=!1},d(n){ce(e,n)}}}function St(o){let e,t=o[98].name+"",n,r,s;return{c(){e=T("div"),n=j(t),r=G(),this.h()},l(i){e=A(i,"DIV",{class:!0});var m=H(e);n=z(m,t),r=O(m),m.forEach(h),this.h()},h(){k(e,"class",s="scale-item "+o[98].state+" svelte-rt5px1")},m(i,m){$(i,e,m),g(e,n),g(e,r)},p(i,m){m[0]&1024&&t!==(t=i[98].name+"")&&_e(n,t),m[0]&1024&&s!==(s="scale-item "+i[98].state+" svelte-rt5px1")&&k(e,"class",s)},d(i){i&&h(e)}}}function bt(o){let e,t="ã‚¬ã‚¤ãƒ‰ã«åˆã‚ã›ã¦ <strong>ãƒ‰ãƒ¬ãƒŸãƒ•ã‚¡ã‚½ãƒ©ã‚·ãƒ‰</strong> ã‚’æ­Œã£ã¦ãã ã•ã„";return{c(){e=T("div"),e.innerHTML=t,this.h()},l(n){e=A(n,"DIV",{class:!0,"data-svelte-h":!0}),pe(e)!=="svelte-sgc3nk"&&(e.innerHTML=t),this.h()},h(){k(e,"class","guide-instruction svelte-rt5px1")},m(n,r){$(n,e,r)},d(n){n&&h(e)}}}function Qn(o){let e,t='<h3 class="section-title svelte-rt5px1">ğŸµ ãƒ‰ãƒ¬ãƒŸéŸ³éšã‚¬ã‚¤ãƒ‰</h3>',n,r,s,i,m=Ue(o[10]),f=[];for(let u=0;u<m.length;u+=1)f[u]=St(ft(o,m,u));let c=o[0]==="guiding"&&bt();return{c(){e=T("div"),e.innerHTML=t,n=G(),r=T("div"),s=T("div");for(let u=0;u<f.length;u+=1)f[u].c();i=G(),c&&c.c(),this.h()},l(u){e=A(u,"DIV",{class:!0,"data-svelte-h":!0}),pe(e)!=="svelte-z1jpw4"&&(e.innerHTML=t),n=O(u),r=A(u,"DIV",{class:!0});var p=H(r);s=A(p,"DIV",{class:!0});var d=H(s);for(let S=0;S<f.length;S+=1)f[S].l(d);d.forEach(h),i=O(p),c&&c.l(p),p.forEach(h),this.h()},h(){k(e,"class","card-header svelte-rt5px1"),k(s,"class","scale-guide svelte-rt5px1"),k(r,"class","card-content svelte-rt5px1")},m(u,p){$(u,e,p),$(u,n,p),$(u,r,p),g(r,s);for(let d=0;d<f.length;d+=1)f[d]&&f[d].m(s,null);g(r,i),c&&c.m(r,null)},p(u,p){if(p[0]&1024){m=Ue(u[10]);let d;for(d=0;d<m.length;d+=1){const S=ft(u,m,d);f[d]?f[d].p(S,p):(f[d]=St(S),f[d].c(),f[d].m(s,null))}for(;d<f.length;d+=1)f[d].d(1);f.length=m.length}u[0]==="guiding"?c||(c=bt(),c.c(),c.m(r,null)):c&&(c.d(1),c=null)},d(u){u&&(h(e),h(n),h(r)),It(f,u),c&&c.d()}}}function wt(o){let e,t,n,r,s;const i=[Jn,Xn],m=[];function f(u,p){return u[4]&&u[5]?0:u[21]?1:-1}~(e=f(o))&&(t=m[e]=i[e](o));let c=o[0]==="results"&&Dt(o);return{c(){t&&t.c(),n=G(),c&&c.c(),r=Ie()},l(u){t&&t.l(u),n=O(u),c&&c.l(u),r=Ie()},m(u,p){~e&&m[e].m(u,p),$(u,n,p),c&&c.m(u,p),$(u,r,p),s=!0},p(u,p){let d=e;e=f(u),e===d?~e&&m[e].p(u,p):(t&&(De(),B(m[d],1,1,()=>{m[d]=null}),Ce()),~e?(t=m[e],t?t.p(u,p):(t=m[e]=i[e](u),t.c()),F(t,1),t.m(n.parentNode,n)):t=null),u[0]==="results"?c?(c.p(u,p),p[0]&1&&F(c,1)):(c=Dt(u),c.c(),F(c,1),c.m(r.parentNode,r)):c&&(De(),B(c,1,1,()=>{c=null}),Ce())},i(u){s||(F(t),F(c),s=!0)},o(u){B(t),B(c),s=!1},d(u){u&&(h(n),h(r)),~e&&m[e].d(u),c&&c.d(u)}}}function Xn(o){let e,t;return e=new Rt({props:{scoreData:o[21],showDetails:!1,className:"mb-6 iphone-no-margin",currentScoreData:o[16],intervalData:o[3],consistencyData:o[17],feedbackData:o[18],technicalFeedbackData:o[19],sessionStatistics:o[20]}}),{c(){ue(e.$$.fragment)},l(n){ie(e.$$.fragment,n)},m(n,r){le(e,n,r),t=!0},p(n,r){const s={};r[0]&2097152&&(s.scoreData=n[21]),r[0]&65536&&(s.currentScoreData=n[16]),r[0]&8&&(s.intervalData=n[3]),r[0]&131072&&(s.consistencyData=n[17]),r[0]&262144&&(s.feedbackData=n[18]),r[0]&524288&&(s.technicalFeedbackData=n[19]),r[0]&1048576&&(s.sessionStatistics=n[20]),e.$set(s)},i(n){t||(F(e.$$.fragment,n),t=!0)},o(n){B(e.$$.fragment,n),t=!1},d(n){ce(e,n)}}}function Jn(o){let e,t;return e=new Rt({props:{scoreData:o[4],showDetails:!1,className:"mb-6 iphone-no-margin",currentScoreData:o[16],intervalData:o[3],consistencyData:o[17],feedbackData:o[18],technicalFeedbackData:o[19],sessionStatistics:o[20]}}),{c(){ue(e.$$.fragment)},l(n){ie(e.$$.fragment,n)},m(n,r){le(e,n,r),t=!0},p(n,r){const s={};r[0]&16&&(s.scoreData=n[4]),r[0]&65536&&(s.currentScoreData=n[16]),r[0]&8&&(s.intervalData=n[3]),r[0]&131072&&(s.consistencyData=n[17]),r[0]&262144&&(s.feedbackData=n[18]),r[0]&524288&&(s.technicalFeedbackData=n[19]),r[0]&1048576&&(s.sessionStatistics=n[20]),e.$set(s)},i(n){t||(F(e.$$.fragment,n),t=!0)},o(n){B(e.$$.fragment,n),t=!1},d(n){ce(e,n)}}}function Dt(o){let e,t;return e=new He({props:{class:"main-card bottom-action-card",$$slots:{default:[Kn]},$$scope:{ctx:o}}}),{c(){ue(e.$$.fragment)},l(n){ie(e.$$.fragment,n)},m(n,r){le(e,n,r),t=!0},p(n,r){const s={};r[0]&32|r[3]&2048&&(s.$$scope={dirty:r,ctx:n}),e.$set(s)},i(n){t||(F(e.$$.fragment,n),t=!0)},o(n){B(e.$$.fragment,n),t=!1},d(n){ce(e,n)}}}function Kn(o){let e,t,n;return t=new Nt({props:{isCompleted:o[5],position:"bottom"}}),t.$on("action",o[29]),{c(){e=T("div"),ue(t.$$.fragment),this.h()},l(r){e=A(r,"DIV",{class:!0});var s=H(e);ie(t.$$.fragment,s),s.forEach(h),this.h()},h(){k(e,"class","card-content svelte-rt5px1")},m(r,s){$(r,e,s),le(t,e,null),n=!0},p(r,s){const i={};s[0]&32&&(i.isCompleted=r[5]),t.$set(i)},i(r){n||(F(t.$$.fragment,r),n=!0)},o(r){B(t.$$.fragment,r),n=!1},d(r){r&&h(e),ce(t)}}}function Wn(o){let e,t,n="âš¡ é€£ç¶šãƒãƒ£ãƒ¬ãƒ³ã‚¸ãƒ¢ãƒ¼ãƒ‰",r,s,i="ä¸­ç´šè€…å‘ã‘ï¼š8ã‚»ãƒƒã‚·ãƒ§ãƒ³é€£ç¶šã§åŸºéŸ³ãŒè‡ªå‹•å†ç”Ÿã•ã‚Œã‚‹é›†ä¸­ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°",m,f,c,u,p,d,S,_,C,M,q,Y,w,b,V,U,v=o[1]==="granted"&&!o[25]&&dt(o);const I=[$n,En],R=[];function P(x,Q){return x[1]==="granted"?0:1}return w=P(o),b=R[w]=I[w](o),{c(){e=T("div"),t=T("h1"),t.textContent=n,r=G(),s=T("p"),s.textContent=i,m=G(),v&&v.c(),f=G(),c=T("div"),u=j("ğŸ“± "),p=j(Ct),d=j(" | "),S=j(At),_=T("br"),C=G(),M=T("small"),q=j(Tt),Y=G(),b.c(),V=Ie(),this.h()},l(x){e=A(x,"DIV",{class:!0});var Q=H(e);t=A(Q,"H1",{class:!0,"data-svelte-h":!0}),pe(t)!=="svelte-1nub9gt"&&(t.textContent=n),r=O(Q),s=A(Q,"P",{class:!0,"data-svelte-h":!0}),pe(s)!=="svelte-gneggn"&&(s.textContent=i),m=O(Q),v&&v.l(Q),f=O(Q),c=A(Q,"DIV",{class:!0});var X=H(c);u=z(X,"ğŸ“± "),p=z(X,Ct),d=z(X," | "),S=z(X,At),_=A(X,"BR",{}),C=O(X),M=A(X,"SMALL",{style:!0});var L=H(M);q=z(L,Tt),L.forEach(h),X.forEach(h),Q.forEach(h),Y=O(x),b.l(x),V=Ie(),this.h()},h(){k(t,"class","page-title svelte-rt5px1"),k(s,"class","page-description svelte-rt5px1"),$e(M,"font-size","0.6rem"),k(c,"class","debug-info svelte-rt5px1"),k(e,"class","header-section svelte-rt5px1")},m(x,Q){$(x,e,Q),g(e,t),g(e,r),g(e,s),g(e,m),v&&v.m(e,null),g(e,f),g(e,c),g(c,u),g(c,p),g(c,d),g(c,S),g(c,_),g(c,C),g(c,M),g(M,q),$(x,Y,Q),R[w].m(x,Q),$(x,V,Q),U=!0},p(x,Q){x[1]==="granted"&&!x[25]?v?(v.p(x,Q),Q[0]&33554434&&F(v,1)):(v=dt(x),v.c(),F(v,1),v.m(e,f)):v&&(De(),B(v,1,1,()=>{v=null}),Ce());let X=w;w=P(x),w===X?R[w].p(x,Q):(De(),B(R[X],1,1,()=>{R[X]=null}),Ce(),b=R[w],b?b.p(x,Q):(b=R[w]=I[w](x),b.c()),F(b,1),b.m(V.parentNode,V))},i(x){U||(F(v),F(b),U=!0)},o(x){B(v),B(b),U=!1},d(x){x&&(h(e),h(Y),h(V)),v&&v.d(),R[w].d(x)}}}function Yn(o){let e,t,n;return t=new gn({props:{$$slots:{default:[Wn]},$$scope:{ctx:o}}}),{c(){e=G(),ue(t.$$.fragment),this.h()},l(r){ln("svelte-13kpo59",ut.head).forEach(h),e=O(r),ie(t.$$.fragment,r),this.h()},h(){ut.title="é€£ç¶šãƒãƒ£ãƒ¬ãƒ³ã‚¸ãƒ¢ãƒ¼ãƒ‰ - ç›¸å¯¾éŸ³æ„Ÿãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°"},m(r,s){$(r,e,s),le(t,r,s),n=!0},p(r,s){const i={};s[0]&67108863|s[3]&2048&&(i.$$scope={dirty:s,ctx:r}),t.$set(i)},i(r){n||(F(t.$$.fragment,r),n=!0)},o(r){B(t.$$.fragment,r),n=!1},d(r){r&&h(e),ce(t,r)}}}const Ct="v2.3.1-ANIMATED",At="07/29 04:15",Tt="ğŸ¬ è©•ä¾¡åˆ†å¸ƒã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè£…ãƒ»UXå‘ä¸Š";function Zn(){const o=/iPhone/.test(navigator.userAgent),e=/iPad/.test(navigator.userAgent),t=/Macintosh/.test(navigator.userAgent)&&"ontouchend"in document;return o||e||t?(console.log("ğŸ”Š [RandomTraining] iOS/iPadOSæ¤œå‡º - éŸ³é‡35dBè¨­å®š"),35):(console.log("ğŸ”Š [RandomTraining] PCæ¤œå‡º - éŸ³é‡-6dBè¨­å®š"),-6)}function Mt(o){return[{scale:"ãƒ‰",interval:"unison",intervalName:"ãƒ¦ãƒ‹ã‚¾ãƒ³"},{scale:"ãƒ¬",interval:"major_second",intervalName:"é•·2åº¦"},{scale:"ãƒŸ",interval:"major_third",intervalName:"é•·3åº¦"},{scale:"ãƒ•ã‚¡",interval:"perfect_fourth",intervalName:"å®Œå…¨4åº¦"},{scale:"ã‚½",interval:"perfect_fifth",intervalName:"å®Œå…¨5åº¦"},{scale:"ãƒ©",interval:"major_sixth",intervalName:"é•·6åº¦"},{scale:"ã‚·",interval:"major_seventh",intervalName:"é•·7åº¦"},{scale:"ãƒ‰ï¼ˆé«˜ï¼‰",interval:"octave",intervalName:"ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–"}].map((t,n)=>{const r=o.find(s=>s.targetNote&&s.targetNote.includes(t.scale))||o[n];if(r&&r.accuracy!=="notMeasured"){const s=parseFloat(r.accuracy)||0,i=Math.round((100-s)*.5);return{type:t.interval,scale:t.scale,intervalName:t.intervalName,attempts:1,averageError:i,accuracy:s}}else return{type:t.interval,scale:t.scale,intervalName:t.intervalName,attempts:0,averageError:null,accuracy:0}})}function er(o){if(!o||!Array.isArray(o))return console.warn("âš ï¸ [RandomTraining] sessionHistory ãŒç„¡åŠ¹ã§ã™"),[];const e=[{type:"unison",scale:"ãƒ‰",intervalName:"ãƒ¦ãƒ‹ã‚¾ãƒ³",noteIndex:0},{type:"major_second",scale:"ãƒ¬",intervalName:"é•·2åº¦",noteIndex:1},{type:"major_third",scale:"ãƒŸ",intervalName:"é•·3åº¦",noteIndex:2},{type:"perfect_fourth",scale:"ãƒ•ã‚¡",intervalName:"å®Œå…¨4åº¦",noteIndex:3},{type:"perfect_fifth",scale:"ã‚½",intervalName:"å®Œå…¨5åº¦",noteIndex:4},{type:"major_sixth",scale:"ãƒ©",intervalName:"é•·6åº¦",noteIndex:5},{type:"major_seventh",scale:"ã‚·",intervalName:"é•·7åº¦",noteIndex:6},{type:"octave",scale:"ãƒ‰ï¼ˆé«˜ï¼‰",intervalName:"ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–",noteIndex:7}],t={};return e.forEach(n=>{t[n.type]={type:n.type,scale:n.scale,intervalName:n.intervalName,attempts:0,successCount:0,accuracySum:0,accuracyValues:[],errorValues:[]}}),o.forEach(n=>{!n.noteResults||!Array.isArray(n.noteResults)||n.noteResults.forEach((r,s)=>{if(s>=e.length)return;const i=e[s].type,m=t[i];if(m.attempts++,r.accuracy!=="notMeasured"&&typeof r.accuracy=="number"){m.accuracyValues.push(r.accuracy),m.accuracySum+=r.accuracy;const f=Math.round((100-r.accuracy)*.5);m.errorValues.push(f),r.accuracy>=70&&m.successCount++}})}),e.map(n=>{const r=t[n.type];if(r.attempts===0)return{type:n.type,scale:n.scale,intervalName:n.intervalName,attempts:0,averageError:null,accuracy:0};const s=r.accuracyValues.length>0?Math.round(r.accuracySum/r.accuracyValues.length):0,i=r.errorValues.length>0?Math.round(r.errorValues.reduce((f,c)=>f+c,0)/r.errorValues.length):null,m=r.accuracyValues.length>0?Math.round(r.successCount/r.accuracyValues.length*100):0;return{type:n.type,scale:n.scale,intervalName:n.intervalName,mastery:m,attempts:r.attempts,averageError:i,accuracy:s}})}function tr(o){const e=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];if(o<=0)return"ãƒ¼ãƒ¼";const n=Math.round(12*Math.log2(o/440)),r=(n+9+120)%12,s=Math.floor((n+9)/12)+4;return e[r]+s}function kt(o,e){const t=[{factor:4,freq:o*4,description:"2ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–ä¸Š"},{factor:3,freq:o*3,description:"1.5ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–ä¸Š"},{factor:2.5,freq:o*2.5,description:"1.3ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–ä¸Š"},{factor:2,freq:o*2,description:"1ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–ä¸Š"},{factor:1.5,freq:o*1.5,description:"0.5ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–ä¸Š"},{factor:1,freq:o,description:"è£œæ­£ãªã—"},{factor:.75,freq:o*.75,description:"0.33ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–ä¸‹"},{factor:.67,freq:o*.67,description:"0.5ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–ä¸‹"},{factor:.5,freq:o*.5,description:"1ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–ä¸‹"},{factor:.4,freq:o*.4,description:"1.3ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–ä¸‹"},{factor:.33,freq:o*.33,description:"1.5ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–ä¸‹"},{factor:.25,freq:o*.25,description:"2ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–ä¸‹"}];let n=null,r=1/0;const s=e*.5,i=e*1.5,m=t.filter(f=>f.freq>=s&&f.freq<=i);for(const f of m){const c=Math.abs(f.freq-e);c<r&&(r=c,n=f)}if(!n)for(const f of t){const c=Math.abs(f.freq-e);c<r&&(r=c,n=f)}return n?{correctedFrequency:n.freq,factor:n.factor,description:n.description,error:r}:{correctedFrequency:o,factor:1,description:"è£œæ­£ãªã—ï¼ˆãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼‰",error:Math.abs(o-e)}}function Ge(){try{"scrollTo"in window&&"behavior"in document.documentElement.style?window.scrollTo({top:0,behavior:"smooth"}):window.scrollTo(0,0),document.body&&(document.body.scrollTop=0),document.documentElement&&(document.documentElement.scrollTop=0),document.querySelectorAll("[data-scroll-container], .scroll-container, main").forEach(e=>{e.scrollTo?e.scrollTo(0,0):e.scrollTop=0})}catch(o){console.warn("ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã‚¨ãƒ©ãƒ¼:",o);try{window.scroll(0,0)}catch(e){console.error("ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«å®Œå…¨å¤±æ•—:",e)}}}function nr(o){}function rr(o){console.error("âŒ PitchDetectorã‚¨ãƒ©ãƒ¼:",o.detail)}function sr(o,e,t){let n,r,s,i,m,f,c,u,p,d;we(o,bn,a=>t(23,n=a)),we(o,wn,a=>t(4,r=a)),we(o,Dn,a=>t(5,s=a)),we(o,dn,a=>t(53,i=a)),we(o,Cn,a=>t(54,m=a)),we(o,An,a=>t(55,f=a)),we(o,Tn,a=>t(56,c=a)),we(o,Mn,a=>t(24,u=a)),we(o,kn,a=>t(57,p=a)),we(o,In,a=>t(25,d=a));function S(a){return Oe.evaluateOverall(a)}let _="setup",C=typeof window<"u"?new URLSearchParams(window.location.search).get("from")==="microphone-test"?(te.info("[RandomTraining] ãƒã‚¤ã‚¯ãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸ã‹ã‚‰ã®é·ç§»ã‚’æ¤œå‡º"),"granted"):(te.info("[RandomTraining] ãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã‚¢ã‚¯ã‚»ã‚¹ã‚’æ¤œå‡º"),"checking"):"checking",M=!0,q=[];const Y=["ãƒ‰","ãƒ¬","ãƒŸ","ãƒ•ã‚¡","ã‚½","ãƒ©","ã‚·","ãƒ‰ï¼ˆé«˜ï¼‰"];let w="",b=0,V=!1,U=0,v=Y.map(a=>({name:a,state:"inactive",completed:!1})),I=null,R=!1,P=0,x=null,Q=!1,X=[],L=0,re=0,Se="ãƒ¼ãƒ¼",se=null,de={totalScore:0,grade:"C",componentScores:{pitchAccuracy:0,recognitionSpeed:0,intervalMastery:0,directionAccuracy:0,consistency:0}},oe=[],he=[],Me={},Ne={},ke={totalAttempts:0,successRate:0,averageScore:0,bestScore:0,sessionDuration:0,streakCount:0,fatigueLevel:"fresh",mostDifficultInterval:"-",mostSuccessfulInterval:"-",averageResponseTime:0,sessionStart:Date.now()},K=[],ne=null,Ae=null,Fe=!0,ae=null,Re=null,We=null,Ye=null,Be=null;const qe=[{note:"C4",name:"ãƒ‰ï¼ˆä¸­ï¼‰",frequency:261.63,semitonesFromC:0},{note:"Db4",name:"ãƒ‰#ï¼ˆä¸­ï¼‰",frequency:277.18,semitonesFromC:1},{note:"D4",name:"ãƒ¬ï¼ˆä¸­ï¼‰",frequency:293.66,semitonesFromC:2},{note:"Eb4",name:"ãƒ¬#ï¼ˆä¸­ï¼‰",frequency:311.13,semitonesFromC:3},{note:"E4",name:"ãƒŸï¼ˆä¸­ï¼‰",frequency:329.63,semitonesFromC:4},{note:"F4",name:"ãƒ•ã‚¡ï¼ˆä¸­ï¼‰",frequency:349.23,semitonesFromC:5},{note:"Gb4",name:"ãƒ•ã‚¡#ï¼ˆä¸­ï¼‰",frequency:369.99,semitonesFromC:6},{note:"Ab4",name:"ãƒ©bï¼ˆä¸­ï¼‰",frequency:415.3,semitonesFromC:8},{note:"Bb3",name:"ã‚·bï¼ˆä½ï¼‰",frequency:233.08,semitonesFromC:-2},{note:"B3",name:"ã‚·ï¼ˆä½ï¼‰",frequency:246.94,semitonesFromC:-1}];async function Pe(){var a;t(1,C="checking");try{if(console.log("ğŸ¤ [RandomTraining] AudioManagerçµŒç”±ã§ãƒã‚¤ã‚¯è¨±å¯ç¢ºèªé–‹å§‹"),!((a=navigator.mediaDevices)!=null&&a.getUserMedia)){t(1,C="error");return}const l=await Ee.initialize();We=l.audioContext,Re=l.mediaStream,Ye=l.sourceNode,console.log("âœ… [RandomTraining] AudioManager ãƒªã‚½ãƒ¼ã‚¹å–å¾—å®Œäº†"),t(1,C="granted"),t(0,_="setup"),setTimeout(async()=>{if(ae){te.audio("[RandomTraining] PitchDetectoråˆæœŸåŒ–é–‹å§‹");const y=/iPhone/.test(navigator.userAgent),D=/iPad/.test(navigator.userAgent),N=/Macintosh/.test(navigator.userAgent)&&"ontouchend"in document;(D||N)&&(console.log("ğŸ”§ [RandomTraining] iPadæ¤œå‡º - ãƒã‚¤ã‚¯æ„Ÿåº¦7.0xè‡ªå‹•è¨­å®šé–‹å§‹"),Ee.setSensitivity(7),console.log("âœ… [RandomTraining] iPad ãƒã‚¤ã‚¯æ„Ÿåº¦7.0xè‡ªå‹•è¨­å®šå®Œäº†"));try{console.log("ğŸ¤ [RandomTraining] AudioManagerå†åˆæœŸåŒ–é–‹å§‹ï¼ˆiPadå¯¾å¿œï¼‰"),await Ee.initialize(),console.log("âœ… [RandomTraining] AudioManagerå†åˆæœŸåŒ–å®Œäº†")}catch(E){console.warn("âš ï¸ AudioManagerå†åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼:",E)}await ae.initialize(),te.audio("[RandomTraining] PitchDetectoråˆæœŸåŒ–å®Œäº†")}},200)}catch(l){te.error("[RandomTraining] ãƒã‚¤ã‚¯è¨±å¯ã‚¨ãƒ©ãƒ¼:",l),t(1,C=(l==null?void 0:l.name)==="NotAllowedError"?"denied":"error")}}function Ze(){const a=c,l=f,y=qe.find(D=>D.note===a)||qe.find(D=>D.name===l)||qe[0];if(t(7,w=y.name),t(8,b=y.frequency),te.info(`[BaseNote] åŸºéŸ³è¨­å®šï¼ˆlocalStorageé€£æºï¼‰: ${w} = ${b}Hz`),te.info(`[BaseNote] localStorageåŸºéŸ³æƒ…å ±: note=${a}, name=${l}`),!b||b<=0)throw te.error("[BaseNote] åŸºéŸ³å‘¨æ³¢æ•°è¨­å®šã‚¨ãƒ©ãƒ¼:",y),new Error(`Invalid base frequency: ${b}`)}async function Ft(){if(V||!Ae||Fe)return;if(C!=="granted"){console.log("ğŸ¤ [RandomTraining] ãƒã‚¤ã‚¯è¨±å¯ãŒå¿…è¦ã§ã™ã€‚è¨±å¯å–å¾—ã‚’é–‹å§‹...");try{await Pe(),console.log("ğŸ¤ [RandomTraining] ãƒã‚¤ã‚¯è¨±å¯å–å¾—å®Œäº†")}catch(l){console.error("âŒ ãƒã‚¤ã‚¯è¨±å¯ã‚¨ãƒ©ãƒ¼:",l);return}}if(!Re&&C==="granted"){console.log("ğŸ¤ [RandomTraining] AudioManagerãƒªã‚½ãƒ¼ã‚¹æœªåˆæœŸåŒ–ã®ãŸã‚å–å¾—ã—ã¾ã™");try{await Pe()}catch(l){console.error("âŒ AudioManagerãƒªã‚½ãƒ¼ã‚¹åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼:",l);return}}else Re&&console.log("ğŸ¤ [RandomTraining] AudioManagerãƒªã‚½ãƒ¼ã‚¹æ—¢å­˜ã®ãŸã‚å†åˆ©ç”¨");t(9,V=!0),t(0,_="listening"),Be=Date.now(),Ze();const a=qe.find(l=>l.name===w).note;Ae.triggerAttackRelease(a,2,it(),.7),setTimeout(()=>{t(9,V=!1),t(0,_="waiting"),setTimeout(()=>et(),500)},2e3)}async function Et(){if(V||!Ae||d||!w)return;if(C!=="granted"){console.log("ğŸ¤ [RandomTraining] ãƒã‚¤ã‚¯è¨±å¯ãŒå¿…è¦ã§ã™ã€‚è¨±å¯å–å¾—ã‚’é–‹å§‹...");try{await Pe(),console.log("ğŸ¤ [RandomTraining] ãƒã‚¤ã‚¯è¨±å¯å–å¾—å®Œäº†")}catch(l){console.error("âŒ ãƒã‚¤ã‚¯è¨±å¯ã‚¨ãƒ©ãƒ¼:",l);return}}if(!Re&&C==="granted"){console.log("ğŸ¤ [RandomTraining] AudioManagerãƒªã‚½ãƒ¼ã‚¹æœªåˆæœŸåŒ–ã®ãŸã‚å–å¾—ã—ã¾ã™");try{await Pe()}catch(l){console.error("âŒ AudioManagerãƒªã‚½ãƒ¼ã‚¹åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼:",l);return}}else Re&&console.log("ğŸ¤ [RandomTraining] AudioManagerãƒªã‚½ãƒ¼ã‚¹æ—¢å­˜ã®ãŸã‚å†åˆ©ç”¨");if(t(9,V=!0),t(0,_="listening"),Be=Date.now(),typeof window<"u"&&window.Tone){const l=window.Tone.context||window.Tone.getContext();l&&l.state==="suspended"&&(console.log("ğŸ”„ [RandomTraining] AudioContext suspendedæ¤œå‡º - å†é–‹ä¸­..."),await l.resume(),console.log("âœ… [RandomTraining] AudioContextå†é–‹å®Œäº†"))}const a=qe.find(l=>l.name===w).note;Ae.triggerAttackRelease(a,2,it(),.7),setTimeout(()=>{t(9,V=!1),t(0,_="waiting"),setTimeout(()=>et(),500)},2e3)}function $t(){w&&b>0?Et():Ft(),qt()}function qt(){x&&clearInterval(x),t(11,P=0),t(12,Q=!1),console.log("ğŸµ [GuideStartBar] ã‚¬ã‚¤ãƒ‰ã‚¹ã‚¿ãƒ¼ãƒˆãƒãƒ¼é–‹å§‹"),x=setInterval(()=>{t(11,P+=2.5),P>=100&&(t(11,P=100),t(12,Q=!0),console.log("ğŸµ [GuideStartBar] ã‚¬ã‚¤ãƒ‰é–‹å§‹ã‚¿ã‚¤ãƒŸãƒ³ã‚°ï¼"),setTimeout(()=>{t(12,Q=!1),t(11,P=0)},800),clearInterval(x),x=null)},50)}function Le(a,l){const D=[0,2,4,5,7,9,11,12][l],N=a*Math.pow(2,D/12);return te.debug(`[calculateExpectedFrequency] ${v[l].name}: åŸºéŸ³${a.toFixed(1)}Hz + ${D}åŠéŸ³ = ${N.toFixed(1)}Hz`),N}function Pt(a,l){return Le(a,l)}function et(){t(0,_="guiding"),U=0,R=!0,X=[],console.log(`ğŸ¬ ã‚¬ã‚¤ãƒ‰é–‹å§‹: ${w} (${b.toFixed(1)}Hz)`);function a(){if(U<v.length){U>0&&t(10,v[U-1].state="inactive",v),t(10,v[U].state="active",v);const l=Pt(b,U);ct.setScaleContext({baseFrequency:b,currentScale:v[U].name,targetFrequency:l}),console.log(`ğŸµ [Scale] åŸºéŸ³:${w}(${b.toFixed(0)}Hz) ç¾åœ¨:${v[U].name} ç›®æ¨™:${l.toFixed(0)}Hz`),U>=4&&console.log(`ğŸ” [ãƒ‡ãƒãƒƒã‚°] Step ${U}: currentBaseFrequency=${b}, currentBaseNote='${w}'`),U++,I=setTimeout(()=>{a()},600)}else xt()}a()}function xt(){R=!1,console.log(`ğŸ ã‚¬ã‚¤ãƒ‰å®Œäº†: ${X.length}/${v.length}ã‚¹ãƒ†ãƒƒãƒ—è©•ä¾¡`),v.length>0&&t(10,v[v.length-1].state="inactive",v),ae&&ae.stopDetection(),ct.clearContext(),Vt(),jt(),K=Y.map(a=>{const l=X.find(y=>y.stepName===a);return l?{name:l.stepName,cents:l.adjustedFrequency?Math.round(l.centDifference):null,targetFreq:l.expectedFrequency,detectedFreq:l.adjustedFrequency||null,diff:l.adjustedFrequency?l.adjustedFrequency-l.expectedFrequency:null,accuracy:l.accuracy}:{name:a,cents:null,targetFreq:null,detectedFreq:null,diff:null,accuracy:"notMeasured"}}),Gt(),Qt(),t(0,_="results")}function Vt(){let a=0,l=0;X.forEach((N,E)=>{N.isCorrect&&a++,l+=N.accuracy});const y=X.length>0?Math.round(l/X.length):0,D=Math.round(a/v.length*100);v.length,console.log(`ğŸ¯ çµæœ: ${a}/${v.length}æ­£è§£ (${D}%) å¹³å‡ç²¾åº¦${y}%`),X.length>0&&[...X]}function Ht(){at(`${Je}/microphone-test`)}function ze(){at(`${Je}/`)}async function Bt(){try{t(33,Fe=!0),t(32,Ae=new vn({urls:{C4:"C4.mp3"},baseUrl:`${Je}/audio/piano/`,release:1.5,volume:Zn(),onload:()=>{t(33,Fe=!1)},onerror:N=>{console.error("âŒ Salamander PianoéŸ³æºèª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:",N),t(33,Fe=!1)}}).toDestination());const a=/iPhone/.test(navigator.userAgent),l=/iPad/.test(navigator.userAgent),y=/Macintosh/.test(navigator.userAgent)&&"ontouchend"in document,D=a||l||y;console.log(l?"ğŸ” [RandomTraining] iPadæ¤œå‡º:":y?"ğŸ” [RandomTraining] iPadOSæ¤œå‡º:":a?"ğŸ” [RandomTraining] iPhoneæ¤œå‡º:":"ğŸ” [RandomTraining] ãã®ä»–ãƒ‡ãƒã‚¤ã‚¹æ¤œå‡º:",navigator.userAgent),console.log("ğŸ”Š [RandomTraining] éŸ³é‡è¨­å®šç¶­æŒ: 35dB")}catch(a){console.error("ã‚µãƒ³ãƒ—ãƒ©ãƒ¼åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼:",a),t(33,Fe=!1)}}async function Qe(){try{(await navigator.permissions.query({name:"microphone"})).state==="granted"?await Pe():t(1,C="denied")}catch{t(1,C="denied")}}function Lt(){try{se=new yn,te.info("[RandomTraining] æ¡ç‚¹ã‚¨ãƒ³ã‚¸ãƒ³åˆæœŸåŒ–å®Œäº†")}catch(a){te.error("[RandomTraining] æ¡ç‚¹ã‚¨ãƒ³ã‚¸ãƒ³åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼:",a)}}function zt(a,l){if(!se||!R)return;const y=U-1;if(y<0||y>=v.length)return;const D=Le(b,y),N={baseFrequency:b,targetFrequency:D,detectedFrequency:a,detectedNote:l,volume:L,timestamp:Date.now(),scaleIndex:y,scaleName:v[y].name};try{se.processAttempt(N)}catch(E){te.error("[RandomTraining] æ¡ç‚¹ã‚¨ãƒ³ã‚¸ãƒ³ã‚¨ãƒ©ãƒ¼:",E)}}function jt(){if(!se){te.error("[RandomTraining] æ¡ç‚¹ã‚¨ãƒ³ã‚¸ãƒ³ãŒåˆæœŸåŒ–ã•ã‚Œã¦ã„ã¾ã›ã‚“"),Ot();return}try{const a=se.generateDetailedReport();t(16,de={totalScore:a.totalScore,grade:a.grade,componentScores:a.componentScores}),a.intervalAnalysis&&a.intervalAnalysis.masteryLevels?t(3,oe=Object.entries(a.intervalAnalysis.masteryLevels).map(([l,y])=>{var D,N;return{type:l,mastery:Math.round(y),attempts:((D=a.intervalAnalysis.attemptCounts)==null?void 0:D[l])||0,accuracy:((N=a.intervalAnalysis.accuracyRates)==null?void 0:N[l])||0}})):(console.warn("âš ï¸ [RandomTraining] intervalAnalysis.masteryLevels ãŒæœªå®šç¾©ã§ã™"),t(3,oe=[])),a.consistencyHistory&&Array.isArray(a.consistencyHistory)?t(17,he=a.consistencyHistory.map((l,y)=>({score:Math.round(l),timestamp:Date.now()-(a.consistencyHistory.length-y)*1e3}))):(console.warn("âš ï¸ [RandomTraining] consistencyHistory ãŒæœªå®šç¾©ã¾ãŸã¯é…åˆ—ã§ã¯ã‚ã‚Šã¾ã›ã‚“"),t(17,he=[])),t(18,Me=a.feedback||{primary:"æ¡ç‚¹çµæœã‚’ç”Ÿæˆä¸­ã§ã™...",detailed:[],suggestions:[]}),t(20,ke={totalAttempts:a.totalAttempts||0,successRate:a.successRate||0,averageScore:a.totalScore||0,bestScore:Math.max(a.totalScore||0,ke.bestScore||0),sessionDuration:Math.round((Date.now()-ke.sessionStart)/6e4)||0,streakCount:a.streak||0,fatigueLevel:a.fatigueLevel||"normal",mostDifficultInterval:a.mostDifficultInterval||"-",mostSuccessfulInterval:a.mostSuccessfulInterval||"-",averageResponseTime:a.averageResponseTime||0}),te.info("[RandomTraining] æ¡ç‚¹çµæœç”Ÿæˆå®Œäº†:",de)}catch(a){te.error("[RandomTraining] æ¡ç‚¹çµæœç”Ÿæˆã‚¨ãƒ©ãƒ¼:",a)}}function Ot(){te.info("[RandomTraining] ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã§æ¡ç‚¹çµæœã‚’ç”Ÿæˆ"),t(16,de={totalScore:78,grade:"B+",componentScores:{pitchAccuracy:82,recognitionSpeed:75,intervalMastery:80,directionAccuracy:85,consistency:70}}),t(3,oe=[{type:"unison",mastery:95,attempts:8,accuracy:98},{type:"major_second",mastery:82,attempts:8,accuracy:85},{type:"major_third",mastery:78,attempts:8,accuracy:80},{type:"perfect_fourth",mastery:65,attempts:8,accuracy:68},{type:"perfect_fifth",mastery:88,attempts:8,accuracy:90},{type:"major_sixth",mastery:72,attempts:8,accuracy:75},{type:"major_seventh",mastery:58,attempts:8,accuracy:62},{type:"octave",mastery:92,attempts:8,accuracy:94}]),t(17,he=[{score:65,timestamp:Date.now()-42e4},{score:72,timestamp:Date.now()-36e4},{score:68,timestamp:Date.now()-3e5},{score:75,timestamp:Date.now()-24e4},{score:78,timestamp:Date.now()-18e4},{score:82,timestamp:Date.now()-12e4},{score:80,timestamp:Date.now()-6e4},{score:85,timestamp:Date.now()}]),t(18,Me={type:"improvement",primary:"è‰¯ã„é€²æ­©ãŒè¦‹ã‚‰ã‚Œã¾ã™ï¼",summary:"éŸ³ç¨‹ã®èªè­˜ç²¾åº¦ãŒå‘ä¸Šã—ã¦ã„ã¾ã™ã€‚ç‰¹ã«å®Œå…¨5åº¦ã¨ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–ã®ç¿’å¾—åº¦ãŒé«˜ãã€åŸºæœ¬çš„ãªéŸ³æ„ŸãŒèº«ã«ã¤ã„ã¦ãã¦ã„ã¾ã™ã€‚",details:[{category:"strengths",text:"ãƒ¦ãƒ‹ã‚¾ãƒ³ã¨ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–ã®èªè­˜ãŒã»ã¼å®Œç’§ã§ã™"},{category:"strengths",text:"å®Œå…¨5åº¦ã®å®‰å®šæ€§ãŒå„ªç§€ã§ã™"},{category:"improvements",text:"å®Œå…¨4åº¦ã®ç·´ç¿’ã‚’ã‚‚ã†å°‘ã—å¢—ã‚„ã—ã¾ã—ã‚‡ã†"},{category:"improvements",text:"é•·7åº¦ã®èªè­˜ç²¾åº¦ã‚’å‘ä¸Šã•ã›ã¾ã—ã‚‡ã†"},{category:"tips",text:"4åº¦ã¯ã€Œã‚½ãƒ¼ãƒ•ã‚¡ãƒ¼ã€ã®éŸ³ç¨‹ã§ã™"},{category:"practice",text:"æ¯æ—¥15åˆ†ã®ç¶™ç¶šç·´ç¿’ã‚’å¿ƒãŒã‘ã¾ã—ã‚‡ã†"}],nextSteps:["å®Œå…¨4åº¦ã®é›†ä¸­ç·´ç¿’ã‚’è¡Œã„ã¾ã—ã‚‡ã†","é€£ç¶šãƒãƒ£ãƒ¬ãƒ³ã‚¸ãƒ¢ãƒ¼ãƒ‰ã§å®Ÿè·µç·´ç¿’ã‚’","1æ—¥15åˆ†ã®ç¶™ç¶šç·´ç¿’ã‚’å¿ƒãŒã‘ã¾ã—ã‚‡ã†"],motivation:"ç¶™ç¶šã¯åŠ›ãªã‚Šï¼ã‚ãªãŸã®ç›¸å¯¾éŸ³æ„Ÿã¯ç¢ºå®Ÿã«å‘ä¸Šã—ã¦ã„ã¾ã™ï¼"}),t(20,ke={totalAttempts:32,successRate:68.8,averageScore:78,bestScore:85,sessionDuration:8,streakCount:4,fatigueLevel:"normal",mostDifficultInterval:"å®Œå…¨4åº¦",mostSuccessfulInterval:"ãƒ¦ãƒ‹ã‚¾ãƒ³",averageResponseTime:2.1,sessionStart:Date.now()-48e4}),te.info("[RandomTraining] ãƒ†ã‚¹ãƒˆæ¡ç‚¹çµæœç”Ÿæˆå®Œäº†")}function Gt(){if(!K||K.length===0){console.warn("[UnifiedScore] noteResultsForDisplay ãŒç©ºã§ã™");return}const a=K.filter(J=>J.accuracy!=="notMeasured").length,l=K.length,y=K.filter(J=>J.accuracy!=="notMeasured"&&typeof J.accuracy=="number").map(J=>J.accuracy),D=y.length>0?Math.round(y.reduce((J,be)=>J+be,0)/y.length):0,N=w||"Unknown",E=b||0,Z=K.map(J=>({name:J.name,note:J.note||J.name,frequency:J.targetFreq||J.expectedFrequency,detectedFrequency:J.detectedFreq,cents:J.cents,grade:Oe.evaluateNote(J.cents),targetFreq:J.targetFreq,diff:J.diff})),ee=p,W=(ee==null?void 0:ee.sessionHistory)||[],ve={timestamp:new Date,baseNote:N,baseFrequency:E,noteResults:Z,measuredNotes:a,accuracy:D,grade:Oe.evaluateSession(K)},Te=[...W,ve];t(21,ne={mode:"continuous",timestamp:new Date,duration:60,totalNotes:l,measuredNotes:a,averageAccuracy:D,baseNote:N,baseFrequency:E,noteResults:Z,distribution:Oe.calculateDistribution(K),sessionHistory:Te,unifiedGrade:S(Te)}),console.log("[UnifiedScore] çµ±åˆæ¡ç‚¹ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆå®Œäº†ï¼ˆå®Œå…¨ç‰ˆï¼‰:",ne),Ut()}async function Ut(){if(!K||K.length===0){console.warn("ğŸ“Š [SessionStorage] ä¿å­˜ãƒ‡ãƒ¼ã‚¿ãªã—");return}try{console.log("ğŸ“Š [SessionStorage] ã‚»ãƒƒã‚·ãƒ§ãƒ³çµæœä¿å­˜é–‹å§‹");const a=K.map(E=>({name:E.name,cents:E.cents,targetFreq:E.targetFreq||E.expectedFrequency,detectedFreq:E.detectedFreq,diff:E.diff,accuracy:typeof E.accuracy=="number"?E.accuracy:0})),l=Be?Math.round((Date.now()-Be)/1e3):60;await Sn(a,l,c,f)?(console.log("ğŸ“Š [SessionStorage] ã‚»ãƒƒã‚·ãƒ§ãƒ³çµæœä¿å­˜å®Œäº†"),console.log("ğŸ“Š [SessionStorage] ä¿å­˜å¾Œã®çŠ¶æ³:",{currentSession:n,totalSessions:u.length,isCompleted:s,nextBaseNote:c,nextBaseName:f})):console.error("ğŸ“Š [SessionStorage] ã‚»ãƒƒã‚·ãƒ§ãƒ³çµæœä¿å­˜å¤±æ•—")}catch(a){console.error("ğŸ“Š [SessionStorage] ã‚»ãƒƒã‚·ãƒ§ãƒ³ä¿å­˜ã‚¨ãƒ©ãƒ¼:",a)}}async function Qt(){try{if(se){const a=u||[];for(const[y,D]of a.entries())if(D.noteResults&&D.noteResults.length>0){const N=D.baseFrequency||262;for(const E of D.noteResults)E.detectedFreq&&E.targetFreq&&await se.analyzePerformance({baseFreq:N,targetFreq:E.targetFreq,detectedFreq:E.detectedFreq,responseTime:2e3,volume:50,harmonicCorrection:null})}const l=se.generateDetailedReport();t(16,de={totalScore:l.totalScore||0,grade:l.grade||"C",componentScores:l.componentScores||{accuracy:0,speed:0,consistency:0}}),l.intervalAnalysis&&l.intervalAnalysis.masteryLevels?t(3,oe=Object.entries(l.intervalAnalysis.masteryLevels).map(([y,D])=>{var N;return{type:y,mastery:Math.round(D),attempts:((N=l.intervalAnalysis.attemptCounts)==null?void 0:N[y])||0,accuracy:Math.round(D*.9)}})):t(3,oe=Mt(K)),l.consistencyHistory&&Array.isArray(l.consistencyHistory)?t(17,he=l.consistencyHistory.map((y,D)=>({score:Math.round(y),timestamp:Date.now()-(l.consistencyHistory.length-D)*1e3}))):t(17,he=nt(K)),t(18,Me=rt(K)||l.feedback),console.log("ğŸ¯ [generateEnhancedScoringData] æŠ€è¡“åˆ†æçµæœç”Ÿæˆã‚’é–‹å§‹"),console.log("ğŸ¯ [generateEnhancedScoringData] results:",l),t(19,Ne=Xt(l)),console.log("ğŸ¯ [generateEnhancedScoringData] technicalFeedbackDataçµæœ:",Ne),t(20,ke={totalAttempts:l.totalAttempts||K.length,successRate:l.successRate||K.filter(y=>y.accuracy!=="notMeasured").length/K.length*100,averageScore:l.totalScore||(ne==null?void 0:ne.averageAccuracy)||0,bestScore:Math.max(l.totalScore||0,ke.bestScore||0),sessionDuration:Math.round(60),streakCount:l.streak||0,fatigueLevel:l.fatigueLevel||"normal",mostDifficultInterval:l.mostDifficultInterval||"æœªç‰¹å®š",mostSuccessfulInterval:l.mostSuccessfulInterval||"æœªç‰¹å®š",averageResponseTime:l.averageResponseTime||2.5,sessionStart:Date.now()-6e4})}else tt();console.log("[EnhancedScoring] è¿½åŠ æ¡ç‚¹ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆå®Œäº†")}catch(a){console.error("[EnhancedScoring] ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆã‚¨ãƒ©ãƒ¼:",a),tt()}}function tt(){const a=K.filter(y=>y.accuracy!=="notMeasured"),l=(ne==null?void 0:ne.averageAccuracy)||0;t(16,de={totalScore:Math.round(l*.8),grade:l>=90?"A":l>=80?"B":l>=70?"C":"D",componentScores:{accuracy:l,speed:85,consistency:Math.max(60,l-10)}}),t(3,oe=Mt(K)),t(17,he=nt()),t(18,Me=rt(K)),t(20,ke={totalAttempts:K.length,successRate:a.length/K.length*100,averageScore:l,bestScore:l,sessionDuration:60,streakCount:0,fatigueLevel:"normal",mostDifficultInterval:"æœªåˆ†æ",mostSuccessfulInterval:"æœªåˆ†æ",averageResponseTime:2.5,sessionStart:Date.now()-6e4})}function nt(a){const l=(ne==null?void 0:ne.averageAccuracy)||70;return Array.from({length:8},(y,D)=>({score:Math.max(30,Math.min(100,l+(Math.random()-.5)*20)),timestamp:Date.now()-(8-D)*7500}))}function rt(a){const l=a.filter(Ve=>Ve.accuracy!=="notMeasured").length,y=(ne==null?void 0:ne.averageAccuracy)||0,D=8,N=u||[],E=N.length,Z={type:"info",categories:[{name:"éŸ³ç¨‹ç²¾åº¦",icon:"Target",score:y,message:`${y}%ã®ç²¾åº¦ã§éŸ³ç¨‹ã‚’æ‰ãˆã¦ã„ã¾ã™`},{name:"æ¸¬å®šæˆåŠŸç‡",icon:"Mic",score:Math.round(l/a.length*100),message:`${a.length}éŸ³ä¸­${l}éŸ³ã‚’æ­£å¸¸ã«æ¸¬å®š`}]};if(E<D)return Z;let ee,W,ve;const Te=(ne==null?void 0:ne.unifiedGrade)||"E",J=N.length;let be=0,fe=0,me=0;N.forEach(Ve=>{Ve.grade==="excellent"?be++:Ve.grade==="good"?fe++:Ve.grade==="pass"&&me++});const ge=J>0?Math.round(be/J*100):0,xe=J>0?Math.round((be+fe+me)/J*100):0,ye=J>0?Math.round((be+fe+me)/J*100):0;switch(Te){case"S":ee="excellent",W="éŸ³æ¥½å®¶ãƒ¬ãƒ™ãƒ«ã®ç›¸å¯¾éŸ³æ„Ÿã‚’é”æˆï¼",ve=`å„ªç§€ç‡${ge}%è¶…ãˆã®å®ŸåŠ›ã‚’è¨¼æ˜ã•ã‚Œã¾ã—ãŸã€‚`;break;case"A":ee="excellent",W="ã‚¨ã‚­ã‚¹ãƒ‘ãƒ¼ãƒˆãƒ¬ãƒ™ãƒ«åˆ°é”ï¼",ve=`å„ªç§€ç‡${ge}%ã®å®‰å®šã—ãŸéŸ³æ„Ÿèƒ½åŠ›ã§ã™ã€‚`;break;case"B":ee="improvement",W="ãƒ—ãƒ­ãƒ•ã‚£ã‚·ã‚¨ãƒ³ãƒˆç´šé”æˆï¼",ve=`è‰¯å¥½ç‡${xe}%ã®ç¢ºå®Ÿãªé€²æ­©ã‚’ç¤ºã—ã¦ã„ã¾ã™ã€‚`;break;case"C":ee="improvement",W="ã‚¢ãƒ‰ãƒãƒ³ã‚¹ç´šåˆ°é”ï¼",ve=`åˆæ ¼ç‡${ye}%ã§ç€å®Ÿã«æˆé•·ä¸­ã§ã™ã€‚`;break;case"D":ee="practice",W="ç¶™ç¶šç·´ç¿’ã§å¿…ãšä¸Šé”ï¼",ve=`ç¾åœ¨ã®åˆæ ¼ç‡${ye}%ã‹ã‚‰ç›®æ¨™70%ã¸å‘ã‘ã¦ç·´ç¿’ã‚’ç¶šã‘ã¾ã—ã‚‡ã†ã€‚`;break;case"E":default:ee="encouragement",W="Eç´šãƒ“ã‚®ãƒŠãƒ¼",ve="ç·´ç¿’é–‹å§‹æ®µéšã§ã™ã€‚ç¶™ç¶šçš„ãªç·´ç¿’ã§å¿…ãšä¸Šé”ã—ã¾ã™ã€‚";break}return{...Z,type:ee,primary:W,summary:ve}}function Xt(a){var Te,J,be;if((u||[]).length<8||!a)return null;const N=a.improvements||[];(Te=a.detailed)!=null&&Te.statistics;const E=[];let Z=0,ee=0;if((J=a.detailed)!=null&&J.intervals){const fe=a.detailed.intervals;if(fe.totalAnalyses>0){let me=0,ge=0;for(const[xe,ye]of Object.entries(fe.masteryLevels))ye.attempts>0&&(me+=ye.averageAccuracy*ye.attempts,ge+=ye.attempts);Z=ge>0?me/ge:0}}if((be=a.detailed)!=null&&be.directions){const fe=a.detailed.directions;if(fe.totalAnalyses>0){let me=0,ge=0;for(const[xe,ye]of Object.entries(fe.masteryData))ye.attempts>0&&(me+=ye.averageAccuracy*ye.attempts,ge+=ye.attempts);ee=ge>0?me/ge:0}}E.push({category:"improvements",text:`éŸ³ç¨‹ç²¾åº¦: ${Math.round(Z)}%ã€€ï¼ˆéŸ³ã®é«˜ã•ã‚’æ‰ãˆã‚‹æ­£ç¢ºæ€§ã€€ç›®æ¨™åŸºæº–ï¼š70ã€œ85%ï¼‰`}),E.push({category:"improvements",text:`æ–¹å‘æ€§: ${Math.round(ee)}%ã€€ï¼ˆéŸ³ç¨‹ã®ä¸Šä¸‹åˆ¤æ–­ã®ç²¾åº¦ã€€ç›®æ¨™åŸºæº–ï¼š80ã€œ90%ï¼‰`});const W=N.map(fe=>({category:"tips",text:fe.message})),ve=N.flatMap(fe=>(fe.actions||[]).map(me=>({category:"practice",text:me})));return[...E,...W,...ve],{type:"info",primary:"è©³ç´°åˆ†æçµæœ",summary:"éŸ³ç¨‹ç²¾åº¦ãƒ»ä¸€è²«æ€§ãƒ»æ–¹å‘æ€§ã®ç·åˆåˆ†æ",details:E}}un(async()=>{if(!(typeof localStorage<"u"?localStorage.getItem("mic-test-completed"):null)){console.log("ğŸš« [RandomTraining] ãƒã‚¤ã‚¯ãƒ†ã‚¹ãƒˆæœªå®Œäº† - æº–å‚™ç”»é¢è¡¨ç¤º"),Qe();return}console.log("ğŸ“Š [SessionStorage] ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†åˆæœŸåŒ–é–‹å§‹");try{if(await lt()){if(console.log("ğŸ“Š [SessionStorage] ã‚»ãƒƒã‚·ãƒ§ãƒ³é€²è¡ŒçŠ¶æ³ã®èª­ã¿è¾¼ã¿å®Œäº†"),console.log("ğŸ“Š [SessionStorage] ç¾åœ¨ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³:",n,"/ 8"),console.log("ğŸ“Š [SessionStorage] æ¬¡ã®åŸºéŸ³:",c,"(",f,")"),console.log("ğŸ“Š [SessionStorage] å®Œäº†çŠ¶æ³:",s?"8ã‚»ãƒƒã‚·ãƒ§ãƒ³å®Œäº†":`æ®‹ã‚Š${m}ã‚»ãƒƒã‚·ãƒ§ãƒ³`),s&&(console.log("ğŸ”„ [SessionStorage] 8ã‚»ãƒƒã‚·ãƒ§ãƒ³å®Œäº†æ¤œå‡º - æ–°ã‚µã‚¤ã‚¯ãƒ«é–‹å§‹å‡¦ç†"),await je()?console.log("âœ… [SessionStorage] æ–°ã‚µã‚¤ã‚¯ãƒ«é–‹å§‹å®Œäº† - ã‚»ãƒƒã‚·ãƒ§ãƒ³1/8ã‹ã‚‰å†é–‹"):console.warn("âš ï¸ [SessionStorage] æ–°ã‚µã‚¤ã‚¯ãƒ«é–‹å§‹å‡¦ç†ãŒå¤±æ•—")),n>1&&!s){console.warn("ğŸ”„ [SessionStorage] ã‚»ãƒƒã‚·ãƒ§ãƒ³é€”ä¸­ã§ã®ãƒªãƒ­ãƒ¼ãƒ‰æ¤œå‡º - ã‚»ãƒƒã‚·ãƒ§ãƒ³1ã‹ã‚‰å†é–‹"),console.warn("ğŸ”„ [SessionStorage] ç¾åœ¨:",n,"ã‚»ãƒƒã‚·ãƒ§ãƒ³ç›® â†’ ãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã‚¢ã‚¯ã‚»ã‚¹èª˜å°");const{SessionStorageManager:y}=await st(async()=>{const{SessionStorageManager:E}=await import("../chunks/COGgd1ld.js").then(Z=>Z.h);return{SessionStorageManager:E}},__vite__mapDeps([0,1,2,3,4,5]),import.meta.url),D=y.getInstance();typeof localStorage<"u"&&(localStorage.removeItem("random-training-progress"),localStorage.removeItem("random-training-progress-backup"));const{resetProgress:N}=await st(async()=>{const{resetProgress:E}=await import("../chunks/COGgd1ld.js").then(Z=>Z.j);return{resetProgress:E}},__vite__mapDeps([0,1,2,3,4,5]),import.meta.url);await N(),console.log("ğŸ”„ [SessionStorage] localStorage + ã‚¹ãƒˆã‚¢çŠ¶æ…‹å®Œå…¨ãƒªã‚»ãƒƒãƒˆå®Œäº†"),Qe();return}}else console.log("ğŸ“Š [SessionStorage] æ–°è¦ã‚»ãƒƒã‚·ãƒ§ãƒ³é–‹å§‹")}catch(l){console.error("ğŸ“Š [SessionStorage] åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼:",l)}if(Bt(),Lt(),i.url.searchParams.get("from")==="microphone-test"){console.log("ğŸ¤ [RandomTraining] ãƒã‚¤ã‚¯ãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸ã‹ã‚‰ã®é·ç§»ã‚’æ¤œå‡º");const l=new URL(window.location);if(l.searchParams.delete("from"),window.history.replaceState({},"",l),t(1,C="granted"),t(0,_="setup"),console.log('ğŸ¤ [RandomTraining] microphoneState="granted", trainingPhase="setup" ã«è¨­å®š'),!Re){console.log("ğŸ¤ [RandomTraining] AudioManagerãƒªã‚½ãƒ¼ã‚¹å–å¾—é–‹å§‹");try{const y=await Ee.initialize();We=y.audioContext,Re=y.mediaStream,Ye=y.sourceNode,console.log("ğŸ¤ [RandomTraining] AudioManagerãƒªã‚½ãƒ¼ã‚¹å–å¾—å®Œäº†")}catch(y){console.warn("âš ï¸ AudioManagerãƒªã‚½ãƒ¼ã‚¹å–å¾—å¤±æ•—ï¼ˆå¾Œã§å†è©¦è¡Œï¼‰:",y)}}if(await new Promise(y=>setTimeout(y,300)),ae&&ae.getIsInitialized&&!ae.getIsInitialized())try{console.log("ğŸ™ï¸ [RandomTraining] PitchDetectoråˆæœŸåŒ–é–‹å§‹");const y=Ee.getStatus();console.log("ğŸ” [RandomTraining] AudioManagerçŠ¶æ…‹:",y),(!y.isInitialized||!y.mediaStreamActive)&&(console.log("ğŸ”„ [RandomTraining] AudioManagerçŠ¶æ…‹ä¸è‰¯ - å†åˆæœŸåŒ–å®Ÿè¡Œ"),await Ee.initialize()),await ae.initialize(),console.log("âœ… [RandomTraining] PitchDetectoråˆæœŸåŒ–å®Œäº†")}catch(y){console.warn("âš ï¸ PitchDetectoråˆæœŸåŒ–å¤±æ•—:",y)}}else await new Promise(l=>setTimeout(l,100)),Qe()});function Jt(a){const{frequency:l,note:y,volume:D,rawVolume:N,clarity:E}=a.detail;let Z=l,ee=y;if(_==="guiding"&&R&&b>0&&l>0){const W=Kt(l);W&&(Z=W.frequency,ee=W.note)}t(14,re=Z),t(15,Se=ee),t(13,L=D),Wt(l),se&&l>0&&b>0&&zt(l,y)}function Kt(a){if(!a||a<=0||!R||!b||L<25)return null;const y=U-1;if(y<0||y>=v.length)return null;const D=Le(b,y);if(!D||D<=0)return null;const E=kt(a,D).correctedFrequency,Z=tr(E);return{frequency:Math.round(E),note:Z}}function Wt(a,l){if(!a||a<=0||!R)return;if(!b||b<=0){console.error(`âŒ [æ¡ç‚¹ã‚¨ãƒ©ãƒ¼] åŸºéŸ³å‘¨æ³¢æ•°ãŒç„¡åŠ¹: ${b}Hz`),console.error(`âŒ [æ¡ç‚¹ã‚¨ãƒ©ãƒ¼] åŸºéŸ³å: ${w}`),console.error(`âŒ [æ¡ç‚¹ã‚¨ãƒ©ãƒ¼] activeStepIndex: ${U-1}`),console.error(`âŒ [æ¡ç‚¹ã‚¨ãƒ©ãƒ¼] trainingPhase: ${_}`),console.error(`âŒ [æ¡ç‚¹ã‚¨ãƒ©ãƒ¼] isGuideAnimationActive: ${R}`);return}if(L<25)return;const D=U-1;if(D<0||D>=v.length)return;D>=4&&te.debug(`[æ¡ç‚¹ãƒ‡ãƒãƒƒã‚°] activeStepIndex=${D} (${v[D].name}), currentBaseFrequency=${b}Hz`);const N=Le(b,D);if(D>=0&&te.debug(`[éŸ³ç¨‹è¨ˆç®—ä¿®æ­£ç‰ˆ] ${v[D].name}: æœŸå¾…å‘¨æ³¢æ•° ${N.toFixed(1)}Hz`),!N||N<=0||!isFinite(N)){console.error("âŒ [æ¡ç‚¹ã‚¨ãƒ©ãƒ¼] æœŸå¾…å‘¨æ³¢æ•°è¨ˆç®—ã‚¨ãƒ©ãƒ¼:"),console.error(`   åŸºéŸ³å‘¨æ³¢æ•°: ${b}Hz`),console.error(`   éŸ³éšã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹: ${D}`),console.error(`   æœŸå¾…å‘¨æ³¢æ•°: ${N}Hz`);return}const E=kt(a,N),Z=E.correctedFrequency,ee=E.factor,W=Math.round(1200*Math.log2(Z/N));if((Math.abs(W)>200||ee!==1)&&(te.debug(`[ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—å¼è£œæ­£] ${v[D].name}:`),console.warn(`   æ¤œå‡ºå‘¨æ³¢æ•°: ${a.toFixed(1)}Hz`),console.warn(`   è£œæ­£å¾Œå‘¨æ³¢æ•°: ${Z.toFixed(1)}Hz`),console.warn(`   æœŸå¾…å‘¨æ³¢æ•°: ${N.toFixed(1)}Hz`),console.warn(`   ã‚»ãƒ³ãƒˆå·®: ${W}Â¢`),console.warn(`   è£œæ­£ä¿‚æ•°: ${ee} (${E.description})`),console.warn(`   åŸºéŸ³: ${w} (${b.toFixed(1)}Hz)`)),!isFinite(W)){console.error("âŒ [æ¡ç‚¹ã‚¨ãƒ©ãƒ¼] ã‚»ãƒ³ãƒˆè¨ˆç®—ã‚¨ãƒ©ãƒ¼:"),console.error(`   æ¤œå‡ºå‘¨æ³¢æ•°: ${a}Hz`),console.error(`   æœŸå¾…å‘¨æ³¢æ•°: ${N}Hz`),console.error(`   ã‚»ãƒ³ãƒˆå·®: ${W}`);return}const Te=Math.abs(W)<=50;if(L>=15){const fe=Math.max(0,Math.round(100-Math.abs(W))),me=X.findIndex(xe=>xe.stepIndex===D),ge={stepIndex:D,stepName:v[D].name,expectedFrequency:Math.round(N),detectedFrequency:Math.round(a),adjustedFrequency:Math.round(Z),centDifference:W,accuracy:fe,isCorrect:Te,correctionFactor:ee,correctionDescription:E.description,timestamp:Date.now()};me>=0?X[me]=ge:X.push(ge),X.length%4===0&&te.realtime(`æ¡ç‚¹é€²æ—: ${X.length}/${v.length}ã‚¹ãƒ†ãƒƒãƒ—å®Œäº†`)}}async function Yt(){if(s){console.warn("ğŸš« [RestartSame] 8ã‚»ãƒƒã‚·ãƒ§ãƒ³å®Œäº†çŠ¶æ…‹ã§ã¯å†æŒ‘æˆ¦ä¸å¯ - æ–°ã‚µã‚¤ã‚¯ãƒ«é–‹å§‹ãŒå¿…è¦"),await je()?(console.log("âœ… [RestartSame] æ–°ã‚µã‚¤ã‚¯ãƒ«é–‹å§‹å®Œäº† - ã‚»ãƒƒã‚·ãƒ§ãƒ³1/8ã‹ã‚‰å†é–‹"),window.location.reload()):console.error("âŒ [RestartSame] æ–°ã‚µã‚¤ã‚¯ãƒ«é–‹å§‹å¤±æ•—");return}Ge(),t(0,_="setup"),I&&(clearTimeout(I),I=null),ae&&ae.resetDisplayState&&ae.resetDisplayState(),Xe(),console.log("ğŸ”„ [RestartSame] åŒã˜åŸºéŸ³ã§å†æŒ‘æˆ¦:",w,b+"Hz"),console.log("ğŸ”„ [RestartSame] åŸºéŸ³æƒ…å ±ä¿æŒå®Œäº† - ãƒ¦ãƒ¼ã‚¶ãƒ¼æ“ä½œå¾…æ©Ÿ")}async function Zt(){if(s){console.warn("ğŸš« [RestartDifferent] 8ã‚»ãƒƒã‚·ãƒ§ãƒ³å®Œäº†çŠ¶æ…‹ã§ã¯å†æŒ‘æˆ¦ä¸å¯ - æ–°ã‚µã‚¤ã‚¯ãƒ«é–‹å§‹ãŒå¿…è¦"),await je()?(console.log("âœ… [RestartDifferent] æ–°ã‚µã‚¤ã‚¯ãƒ«é–‹å§‹å®Œäº† - ã‚»ãƒƒã‚·ãƒ§ãƒ³1/8ã‹ã‚‰å†é–‹"),window.location.reload()):console.error("âŒ [RestartDifferent] æ–°ã‚µã‚¤ã‚¯ãƒ«é–‹å§‹å¤±æ•—");return}Ge(),t(0,_="setup"),I&&(clearTimeout(I),I=null),t(7,w=""),t(8,b=0),console.log("ğŸ”„ [restartDifferentBaseNote] åŸºéŸ³æƒ…å ±ã‚’ãƒªã‚»ãƒƒãƒˆã—ã¾ã—ãŸ"),ae&&ae.resetDisplayState&&ae.resetDisplayState(),Xe()}function Xe(){U=0,R=!1,X=[],t(10,v=v.map(a=>({...a,state:"inactive",completed:!1})))}async function en(){console.log("ğŸš€ [StartNewCycle] 8ã‚»ãƒƒã‚·ãƒ§ãƒ³å®Œäº†å¾Œã®æœ€åˆã‹ã‚‰æŒ‘æˆ¦é–‹å§‹");try{await je()?(console.log("âœ… [StartNewCycle] æ–°ã‚µã‚¤ã‚¯ãƒ«é–‹å§‹å®Œäº†"),localStorage.getItem("mic-test-completed")?(console.log("âœ… [StartNewCycle] ãƒã‚¤ã‚¯ãƒ†ã‚¹ãƒˆå®Œäº†ãƒ•ãƒ©ã‚°ç¢ºèª - ãƒªãƒ­ãƒ¼ãƒ‰ãªã—ã§çŠ¶æ…‹ãƒªã‚»ãƒƒãƒˆ"),Ge(),await lt(),t(0,_="setup"),Xe(),Ze(),console.log("âœ… [StartNewCycle] çŠ¶æ…‹ãƒªã‚»ãƒƒãƒˆå®Œäº† - ã‚»ãƒƒã‚·ãƒ§ãƒ³1/8ã‹ã‚‰å†é–‹")):window.location.reload()):(console.error("âŒ [StartNewCycle] æ–°ã‚µã‚¤ã‚¯ãƒ«é–‹å§‹å¤±æ•—"),ze())}catch(a){console.error("âŒ [StartNewCycle] æ–°ã‚µã‚¤ã‚¯ãƒ«é–‹å§‹ã‚¨ãƒ©ãƒ¼:",a),ze()}}function tn(a){const{type:l}=a.detail;switch(l){case"same":Yt();break;case"different":Zt();break;case"restart":en();break;case"home":ze();break;default:console.warn("ğŸš« [ActionButtons] æœªçŸ¥ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚¿ã‚¤ãƒ—:",l)}}function nn(){console.log("âš¡ [ContinuousMode] 8ã‚»ãƒƒã‚·ãƒ§ãƒ³é€£ç¶šé–‹å§‹"),$t()}function rn(a){const{healthy:l,errors:y,details:D}=a.detail;t(2,M=l),t(6,q=y),l||(console.warn("âš ï¸ ãƒã‚¤ã‚¯ã®å¥åº·çŠ¶æ…‹ãŒæ‚ªåŒ–:",y),_==="guiding"&&(t(0,_="setup"),console.warn("ğŸ›‘ ãƒã‚¤ã‚¯å•é¡Œã«ã‚ˆã‚Šãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã‚’åœæ­¢")))}fn(()=>{console.log("ğŸ”„ [RandomTraining] onDestroy - AudioManagerãƒªã‚½ãƒ¼ã‚¹ã¯ä¿æŒ"),Ae&&(Ae.dispose(),t(32,Ae=null))});function sn(a){mn[a?"unshift":"push"](()=>{ae=a,t(22,ae)})}return o.$$.update=()=>{o.$$.dirty[0]&6|o.$$.dirty[1]&6,o.$$.dirty[0]&1,o.$$.dirty[0]&56&&r&&s&&r.sessionHistory&&(t(3,oe=er(r.sessionHistory)),console.log("ğŸµ [RandomTraining] intervalDataç”Ÿæˆå®Œäº†:",oe.length,"ä»¶")),o.$$.dirty[0]&3&&_==="setup"&&C==="granted"&&Ge()},[_,C,M,oe,r,s,q,w,b,V,v,P,Q,L,re,Se,de,he,Me,Ne,ke,ne,ae,n,u,d,Ht,ze,Jt,tn,nn,rn,Ae,Fe,sn]}class hr extends on{constructor(e){super(),an(this,e,sr,Yn,cn,{},null,[-1,-1,-1,-1])}}export{hr as component,pr as universal};
