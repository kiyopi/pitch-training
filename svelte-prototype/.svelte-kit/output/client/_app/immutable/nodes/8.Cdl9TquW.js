var _h=Object.defineProperty;var gh=(n,e,t)=>e in n?_h(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var ho=(n,e,t)=>gh(n,typeof e!="symbol"?e+"":e,t);import{_ as Sa}from"../chunks/C1FmrZbK.js";import{S as Be,i as He,s as Le,u as nt,T as he,d as v,L as dt,m as W,o as O,v as rt,w as it,x as ot,U as Di,b as H,c as p,V as Ns,f as $,r as Gt,W as Es,X as wa,Y as Ee,C as re,D as ie,E as de,F as oe,n as Et,y as S,e as N,G as pe,h as V,j as E,k as x,a as ee,J as st,g as R,t as P,Q as St,p as Ae,q as Ne,Z as Ca,_ as zc,$ as Ta,a0 as vh,a1 as yh,N as Gc,z as Ls,A as vs,K as Zc,R as Xc,l as Ut,a2 as Ds,a3 as Fs,a4 as ka,I as Yc,a5 as bh,M as Sh}from"../chunks/C89DxXZR.js";import{e as Ie}from"../chunks/D6YF6ztN.js";import"../chunks/IHki7fMi.js";import{w as _r,d as cn,b as fo,g as Aa}from"../chunks/D1SwwZrD.js";import{p as wh}from"../chunks/CZBAhPJ4.js";import{P as Ch,C as ii}from"../chunks/B6vuRUvI.js";import{B as vo}from"../chunks/DqaLHDKx.js";import{l as Mt,b as Na,a as Th,P as kh,h as Ea}from"../chunks/C8cyc_2a.js";import{E as Ah}from"../chunks/BhJJ7ryS.js";function at(n,e){const t={},s={},r={$$scope:1};let i=n.length;for(;i--;){const o=n[i],a=e[i];if(a){for(const l in o)l in a||(s[l]=1);for(const l in a)r[l]||(t[l]=a[l],r[l]=1);n[i]=a}else for(const l in o)r[l]=1}for(const o in s)o in t||(t[o]=void 0);return t}function pt(n){return typeof n=="object"&&n!==null?n:{}}/**
 * @license lucide-svelte v0.532.0 - ISC
 *
 * ISC License
 * 
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
 * 
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 * 
 */const Ia={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"};function Da(n,e,t){const s=n.slice();return s[11]=e[t][0],s[12]=e[t][1],s}function po(n){let e,t=[n[12]],s={};for(let r=0;r<t.length;r+=1)s=he(s,t[r]);return{c(){e=Es(n[11]),this.h()},l(r){e=Ns(r,n[11],{}),$(e).forEach(v),this.h()},h(){Di(e,s)},m(r,i){H(r,e,i)},p(r,i){Di(e,s=at(t,[i&32&&r[12]]))},d(r){r&&v(e)}}}function Ma(n){let e=n[11],t,s=n[11]&&po(n);return{c(){s&&s.c(),t=Gt()},l(r){s&&s.l(r),t=Gt()},m(r,i){s&&s.m(r,i),H(r,t,i)},p(r,i){r[11]?e?Le(e,r[11])?(s.d(1),s=po(r),e=r[11],s.c(),s.m(t.parentNode,t)):s.p(r,i):(s=po(r),e=r[11],s.c(),s.m(t.parentNode,t)):e&&(s.d(1),s=null,e=r[11])},d(r){r&&v(t),s&&s.d(r)}}}function Nh(n){let e,t,s,r,i,o=Ie(n[5]),a=[];for(let f=0;f<o.length;f+=1)a[f]=Ma(Da(n,o,f));const l=n[10].default,c=nt(l,n,n[9],null);let u=[Ia,n[7],{width:n[2]},{height:n[2]},{stroke:n[1]},{"stroke-width":s=n[4]?Number(n[3])*24/Number(n[2]):n[3]},{class:r=n[6]("lucide-icon","lucide",n[0]?`lucide-${n[0]}`:"",n[8].class)}],h={};for(let f=0;f<u.length;f+=1)h=he(h,u[f]);return{c(){e=Es("svg");for(let f=0;f<a.length;f+=1)a[f].c();t=Gt(),c&&c.c(),this.h()},l(f){e=Ns(f,"svg",{width:!0,height:!0,stroke:!0,"stroke-width":!0,class:!0});var d=$(e);for(let m=0;m<a.length;m+=1)a[m].l(d);t=Gt(),c&&c.l(d),d.forEach(v),this.h()},h(){Di(e,h)},m(f,d){H(f,e,d);for(let m=0;m<a.length;m+=1)a[m]&&a[m].m(e,null);p(e,t),c&&c.m(e,null),i=!0},p(f,[d]){if(d&32){o=Ie(f[5]);let m;for(m=0;m<o.length;m+=1){const _=Da(f,o,m);a[m]?a[m].p(_,d):(a[m]=Ma(_),a[m].c(),a[m].m(e,t))}for(;m<a.length;m+=1)a[m].d(1);a.length=o.length}c&&c.p&&(!i||d&512)&&rt(c,l,f,f[9],i?ot(l,f[9],d,null):it(f[9]),null),Di(e,h=at(u,[Ia,d&128&&f[7],(!i||d&4)&&{width:f[2]},(!i||d&4)&&{height:f[2]},(!i||d&2)&&{stroke:f[1]},(!i||d&28&&s!==(s=f[4]?Number(f[3])*24/Number(f[2]):f[3]))&&{"stroke-width":s},(!i||d&257&&r!==(r=f[6]("lucide-icon","lucide",f[0]?`lucide-${f[0]}`:"",f[8].class)))&&{class:r}]))},i(f){i||(O(c,f),i=!0)},o(f){W(c,f),i=!1},d(f){f&&v(e),dt(a,f),c&&c.d(f)}}}function Eh(n,e,t){const s=["name","color","size","strokeWidth","absoluteStrokeWidth","iconNode"];let r=wa(e,s),{$$slots:i={},$$scope:o}=e,{name:a=void 0}=e,{color:l="currentColor"}=e,{size:c=24}=e,{strokeWidth:u=2}=e,{absoluteStrokeWidth:h=!1}=e,{iconNode:f=[]}=e;const d=(...m)=>m.filter((_,g,y)=>!!_&&y.indexOf(_)===g).join(" ");return n.$$set=m=>{t(8,e=he(he({},e),Ee(m))),t(7,r=wa(e,s)),"name"in m&&t(0,a=m.name),"color"in m&&t(1,l=m.color),"size"in m&&t(2,c=m.size),"strokeWidth"in m&&t(3,u=m.strokeWidth),"absoluteStrokeWidth"in m&&t(4,h=m.absoluteStrokeWidth),"iconNode"in m&&t(5,f=m.iconNode),"$$scope"in m&&t(9,o=m.$$scope)},e=Ee(e),[a,l,c,u,h,f,d,r,e,o,i]}class mt extends Be{constructor(e){super(),He(this,e,Eh,Nh,Le,{name:0,color:1,size:2,strokeWidth:3,absoluteStrokeWidth:4,iconNode:5})}}function Ih(n){let e;const t=n[2].default,s=nt(t,n,n[3],null);return{c(){s&&s.c()},l(r){s&&s.l(r)},m(r,i){s&&s.m(r,i),e=!0},p(r,i){s&&s.p&&(!e||i&8)&&rt(s,t,r,r[3],e?ot(t,r[3],i,null):it(r[3]),null)},i(r){e||(O(s,r),e=!0)},o(r){W(s,r),e=!1},d(r){s&&s.d(r)}}}function Dh(n){let e,t;const s=[{name:"arrow-right"},n[1],{iconNode:n[0]}];let r={$$slots:{default:[Ih]},$$scope:{ctx:n}};for(let i=0;i<s.length;i+=1)r=he(r,s[i]);return e=new mt({props:r}),{c(){oe(e.$$.fragment)},l(i){de(e.$$.fragment,i)},m(i,o){ie(e,i,o),t=!0},p(i,[o]){const a=o&3?at(s,[s[0],o&2&&pt(i[1]),o&1&&{iconNode:i[0]}]):{};o&8&&(a.$$scope={dirty:o,ctx:i}),e.$set(a)},i(i){t||(O(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){re(e,i)}}}function Mh(n,e,t){let{$$slots:s={},$$scope:r}=e;const i=[["path",{d:"M5 12h14"}],["path",{d:"m12 5 7 7-7 7"}]];return n.$$set=o=>{t(1,e=he(he({},e),Ee(o))),"$$scope"in o&&t(3,r=o.$$scope)},e=Ee(e),[i,e,s,r]}class $h extends Be{constructor(e){super(),He(this,e,Mh,Dh,Le,{})}}function Oh(n){let e;const t=n[2].default,s=nt(t,n,n[3],null);return{c(){s&&s.c()},l(r){s&&s.l(r)},m(r,i){s&&s.m(r,i),e=!0},p(r,i){s&&s.p&&(!e||i&8)&&rt(s,t,r,r[3],e?ot(t,r[3],i,null):it(r[3]),null)},i(r){e||(O(s,r),e=!0)},o(r){W(s,r),e=!1},d(r){s&&s.d(r)}}}function Rh(n){let e,t;const s=[{name:"award"},n[1],{iconNode:n[0]}];let r={$$slots:{default:[Oh]},$$scope:{ctx:n}};for(let i=0;i<s.length;i+=1)r=he(r,s[i]);return e=new mt({props:r}),{c(){oe(e.$$.fragment)},l(i){de(e.$$.fragment,i)},m(i,o){ie(e,i,o),t=!0},p(i,[o]){const a=o&3?at(s,[s[0],o&2&&pt(i[1]),o&1&&{iconNode:i[0]}]):{};o&8&&(a.$$scope={dirty:o,ctx:i}),e.$set(a)},i(i){t||(O(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){re(e,i)}}}function Ph(n,e,t){let{$$slots:s={},$$scope:r}=e;const i=[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526"}],["circle",{cx:"12",cy:"8",r:"6"}]];return n.$$set=o=>{t(1,e=he(he({},e),Ee(o))),"$$scope"in o&&t(3,r=o.$$scope)},e=Ee(e),[i,e,s,r]}class Vh extends Be{constructor(e){super(),He(this,e,Ph,Rh,Le,{})}}function xh(n){let e;const t=n[2].default,s=nt(t,n,n[3],null);return{c(){s&&s.c()},l(r){s&&s.l(r)},m(r,i){s&&s.m(r,i),e=!0},p(r,i){s&&s.p&&(!e||i&8)&&rt(s,t,r,r[3],e?ot(t,r[3],i,null):it(r[3]),null)},i(r){e||(O(s,r),e=!0)},o(r){W(s,r),e=!1},d(r){s&&s.d(r)}}}function Fh(n){let e,t;const s=[{name:"chevron-down"},n[1],{iconNode:n[0]}];let r={$$slots:{default:[xh]},$$scope:{ctx:n}};for(let i=0;i<s.length;i+=1)r=he(r,s[i]);return e=new mt({props:r}),{c(){oe(e.$$.fragment)},l(i){de(e.$$.fragment,i)},m(i,o){ie(e,i,o),t=!0},p(i,[o]){const a=o&3?at(s,[s[0],o&2&&pt(i[1]),o&1&&{iconNode:i[0]}]):{};o&8&&(a.$$scope={dirty:o,ctx:i}),e.$set(a)},i(i){t||(O(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){re(e,i)}}}function qh(n,e,t){let{$$slots:s={},$$scope:r}=e;const i=[["path",{d:"m6 9 6 6 6-6"}]];return n.$$set=o=>{t(1,e=he(he({},e),Ee(o))),"$$scope"in o&&t(3,r=o.$$scope)},e=Ee(e),[i,e,s,r]}class Wh extends Be{constructor(e){super(),He(this,e,qh,Fh,Le,{})}}function Lh(n){let e;const t=n[2].default,s=nt(t,n,n[3],null);return{c(){s&&s.c()},l(r){s&&s.l(r)},m(r,i){s&&s.m(r,i),e=!0},p(r,i){s&&s.p&&(!e||i&8)&&rt(s,t,r,r[3],e?ot(t,r[3],i,null):it(r[3]),null)},i(r){e||(O(s,r),e=!0)},o(r){W(s,r),e=!1},d(r){s&&s.d(r)}}}function Bh(n){let e,t;const s=[{name:"chevron-left"},n[1],{iconNode:n[0]}];let r={$$slots:{default:[Lh]},$$scope:{ctx:n}};for(let i=0;i<s.length;i+=1)r=he(r,s[i]);return e=new mt({props:r}),{c(){oe(e.$$.fragment)},l(i){de(e.$$.fragment,i)},m(i,o){ie(e,i,o),t=!0},p(i,[o]){const a=o&3?at(s,[s[0],o&2&&pt(i[1]),o&1&&{iconNode:i[0]}]):{};o&8&&(a.$$scope={dirty:o,ctx:i}),e.$set(a)},i(i){t||(O(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){re(e,i)}}}function Hh(n,e,t){let{$$slots:s={},$$scope:r}=e;const i=[["path",{d:"m15 18-6-6 6-6"}]];return n.$$set=o=>{t(1,e=he(he({},e),Ee(o))),"$$scope"in o&&t(3,r=o.$$scope)},e=Ee(e),[i,e,s,r]}class jh extends Be{constructor(e){super(),He(this,e,Hh,Bh,Le,{})}}function Uh(n){let e;const t=n[2].default,s=nt(t,n,n[3],null);return{c(){s&&s.c()},l(r){s&&s.l(r)},m(r,i){s&&s.m(r,i),e=!0},p(r,i){s&&s.p&&(!e||i&8)&&rt(s,t,r,r[3],e?ot(t,r[3],i,null):it(r[3]),null)},i(r){e||(O(s,r),e=!0)},o(r){W(s,r),e=!1},d(r){s&&s.d(r)}}}function zh(n){let e,t;const s=[{name:"chevron-right"},n[1],{iconNode:n[0]}];let r={$$slots:{default:[Uh]},$$scope:{ctx:n}};for(let i=0;i<s.length;i+=1)r=he(r,s[i]);return e=new mt({props:r}),{c(){oe(e.$$.fragment)},l(i){de(e.$$.fragment,i)},m(i,o){ie(e,i,o),t=!0},p(i,[o]){const a=o&3?at(s,[s[0],o&2&&pt(i[1]),o&1&&{iconNode:i[0]}]):{};o&8&&(a.$$scope={dirty:o,ctx:i}),e.$set(a)},i(i){t||(O(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){re(e,i)}}}function Gh(n,e,t){let{$$slots:s={},$$scope:r}=e;const i=[["path",{d:"m9 18 6-6-6-6"}]];return n.$$set=o=>{t(1,e=he(he({},e),Ee(o))),"$$scope"in o&&t(3,r=o.$$scope)},e=Ee(e),[i,e,s,r]}class Qc extends Be{constructor(e){super(),He(this,e,Gh,zh,Le,{})}}function Zh(n){let e;const t=n[2].default,s=nt(t,n,n[3],null);return{c(){s&&s.c()},l(r){s&&s.l(r)},m(r,i){s&&s.m(r,i),e=!0},p(r,i){s&&s.p&&(!e||i&8)&&rt(s,t,r,r[3],e?ot(t,r[3],i,null):it(r[3]),null)},i(r){e||(O(s,r),e=!0)},o(r){W(s,r),e=!1},d(r){s&&s.d(r)}}}function Xh(n){let e,t;const s=[{name:"circle-alert"},n[1],{iconNode:n[0]}];let r={$$slots:{default:[Zh]},$$scope:{ctx:n}};for(let i=0;i<s.length;i+=1)r=he(r,s[i]);return e=new mt({props:r}),{c(){oe(e.$$.fragment)},l(i){de(e.$$.fragment,i)},m(i,o){ie(e,i,o),t=!0},p(i,[o]){const a=o&3?at(s,[s[0],o&2&&pt(i[1]),o&1&&{iconNode:i[0]}]):{};o&8&&(a.$$scope={dirty:o,ctx:i}),e.$set(a)},i(i){t||(O(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){re(e,i)}}}function Yh(n,e,t){let{$$slots:s={},$$scope:r}=e;const i=[["circle",{cx:"12",cy:"12",r:"10"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16"}]];return n.$$set=o=>{t(1,e=he(he({},e),Ee(o))),"$$scope"in o&&t(3,r=o.$$scope)},e=Ee(e),[i,e,s,r]}class Xs extends Be{constructor(e){super(),He(this,e,Yh,Xh,Le,{})}}function Qh(n){let e;const t=n[2].default,s=nt(t,n,n[3],null);return{c(){s&&s.c()},l(r){s&&s.l(r)},m(r,i){s&&s.m(r,i),e=!0},p(r,i){s&&s.p&&(!e||i&8)&&rt(s,t,r,r[3],e?ot(t,r[3],i,null):it(r[3]),null)},i(r){e||(O(s,r),e=!0)},o(r){W(s,r),e=!1},d(r){s&&s.d(r)}}}function Jh(n){let e,t;const s=[{name:"copy"},n[1],{iconNode:n[0]}];let r={$$slots:{default:[Qh]},$$scope:{ctx:n}};for(let i=0;i<s.length;i+=1)r=he(r,s[i]);return e=new mt({props:r}),{c(){oe(e.$$.fragment)},l(i){de(e.$$.fragment,i)},m(i,o){ie(e,i,o),t=!0},p(i,[o]){const a=o&3?at(s,[s[0],o&2&&pt(i[1]),o&1&&{iconNode:i[0]}]):{};o&8&&(a.$$scope={dirty:o,ctx:i}),e.$set(a)},i(i){t||(O(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){re(e,i)}}}function Kh(n,e,t){let{$$slots:s={},$$scope:r}=e;const i=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"}]];return n.$$set=o=>{t(1,e=he(he({},e),Ee(o))),"$$scope"in o&&t(3,r=o.$$scope)},e=Ee(e),[i,e,s,r]}class ef extends Be{constructor(e){super(),He(this,e,Kh,Jh,Le,{})}}function tf(n){let e;const t=n[2].default,s=nt(t,n,n[3],null);return{c(){s&&s.c()},l(r){s&&s.l(r)},m(r,i){s&&s.m(r,i),e=!0},p(r,i){s&&s.p&&(!e||i&8)&&rt(s,t,r,r[3],e?ot(t,r[3],i,null):it(r[3]),null)},i(r){e||(O(s,r),e=!0)},o(r){W(s,r),e=!1},d(r){s&&s.d(r)}}}function sf(n){let e,t;const s=[{name:"crown"},n[1],{iconNode:n[0]}];let r={$$slots:{default:[tf]},$$scope:{ctx:n}};for(let i=0;i<s.length;i+=1)r=he(r,s[i]);return e=new mt({props:r}),{c(){oe(e.$$.fragment)},l(i){de(e.$$.fragment,i)},m(i,o){ie(e,i,o),t=!0},p(i,[o]){const a=o&3?at(s,[s[0],o&2&&pt(i[1]),o&1&&{iconNode:i[0]}]):{};o&8&&(a.$$scope={dirty:o,ctx:i}),e.$set(a)},i(i){t||(O(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){re(e,i)}}}function nf(n,e,t){let{$$slots:s={},$$scope:r}=e;const i=[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z"}],["path",{d:"M5 21h14"}]];return n.$$set=o=>{t(1,e=he(he({},e),Ee(o))),"$$scope"in o&&t(3,r=o.$$scope)},e=Ee(e),[i,e,s,r]}class rf extends Be{constructor(e){super(),He(this,e,nf,sf,Le,{})}}function of(n){let e;const t=n[2].default,s=nt(t,n,n[3],null);return{c(){s&&s.c()},l(r){s&&s.l(r)},m(r,i){s&&s.m(r,i),e=!0},p(r,i){s&&s.p&&(!e||i&8)&&rt(s,t,r,r[3],e?ot(t,r[3],i,null):it(r[3]),null)},i(r){e||(O(s,r),e=!0)},o(r){W(s,r),e=!1},d(r){s&&s.d(r)}}}function af(n){let e,t;const s=[{name:"download"},n[1],{iconNode:n[0]}];let r={$$slots:{default:[of]},$$scope:{ctx:n}};for(let i=0;i<s.length;i+=1)r=he(r,s[i]);return e=new mt({props:r}),{c(){oe(e.$$.fragment)},l(i){de(e.$$.fragment,i)},m(i,o){ie(e,i,o),t=!0},p(i,[o]){const a=o&3?at(s,[s[0],o&2&&pt(i[1]),o&1&&{iconNode:i[0]}]):{};o&8&&(a.$$scope={dirty:o,ctx:i}),e.$set(a)},i(i){t||(O(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){re(e,i)}}}function lf(n,e,t){let{$$slots:s={},$$scope:r}=e;const i=[["path",{d:"M12 15V3"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}],["path",{d:"m7 10 5 5 5-5"}]];return n.$$set=o=>{t(1,e=he(he({},e),Ee(o))),"$$scope"in o&&t(3,r=o.$$scope)},e=Ee(e),[i,e,s,r]}class cf extends Be{constructor(e){super(),He(this,e,lf,af,Le,{})}}function uf(n){let e;const t=n[2].default,s=nt(t,n,n[3],null);return{c(){s&&s.c()},l(r){s&&s.l(r)},m(r,i){s&&s.m(r,i),e=!0},p(r,i){s&&s.p&&(!e||i&8)&&rt(s,t,r,r[3],e?ot(t,r[3],i,null):it(r[3]),null)},i(r){e||(O(s,r),e=!0)},o(r){W(s,r),e=!1},d(r){s&&s.d(r)}}}function hf(n){let e,t;const s=[{name:"file-text"},n[1],{iconNode:n[0]}];let r={$$slots:{default:[uf]},$$scope:{ctx:n}};for(let i=0;i<s.length;i+=1)r=he(r,s[i]);return e=new mt({props:r}),{c(){oe(e.$$.fragment)},l(i){de(e.$$.fragment,i)},m(i,o){ie(e,i,o),t=!0},p(i,[o]){const a=o&3?at(s,[s[0],o&2&&pt(i[1]),o&1&&{iconNode:i[0]}]):{};o&8&&(a.$$scope={dirty:o,ctx:i}),e.$set(a)},i(i){t||(O(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){re(e,i)}}}function ff(n,e,t){let{$$slots:s={},$$scope:r}=e;const i=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4"}],["path",{d:"M10 9H8"}],["path",{d:"M16 13H8"}],["path",{d:"M16 17H8"}]];return n.$$set=o=>{t(1,e=he(he({},e),Ee(o))),"$$scope"in o&&t(3,r=o.$$scope)},e=Ee(e),[i,e,s,r]}class df extends Be{constructor(e){super(),He(this,e,ff,hf,Le,{})}}function pf(n){let e;const t=n[2].default,s=nt(t,n,n[3],null);return{c(){s&&s.c()},l(r){s&&s.l(r)},m(r,i){s&&s.m(r,i),e=!0},p(r,i){s&&s.p&&(!e||i&8)&&rt(s,t,r,r[3],e?ot(t,r[3],i,null):it(r[3]),null)},i(r){e||(O(s,r),e=!0)},o(r){W(s,r),e=!1},d(r){s&&s.d(r)}}}function mf(n){let e,t;const s=[{name:"flame"},n[1],{iconNode:n[0]}];let r={$$slots:{default:[pf]},$$scope:{ctx:n}};for(let i=0;i<s.length;i+=1)r=he(r,s[i]);return e=new mt({props:r}),{c(){oe(e.$$.fragment)},l(i){de(e.$$.fragment,i)},m(i,o){ie(e,i,o),t=!0},p(i,[o]){const a=o&3?at(s,[s[0],o&2&&pt(i[1]),o&1&&{iconNode:i[0]}]):{};o&8&&(a.$$scope={dirty:o,ctx:i}),e.$set(a)},i(i){t||(O(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){re(e,i)}}}function _f(n,e,t){let{$$slots:s={},$$scope:r}=e;const i=[["path",{d:"M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"}]];return n.$$set=o=>{t(1,e=he(he({},e),Ee(o))),"$$scope"in o&&t(3,r=o.$$scope)},e=Ee(e),[i,e,s,r]}class gf extends Be{constructor(e){super(),He(this,e,_f,mf,Le,{})}}function vf(n){let e;const t=n[2].default,s=nt(t,n,n[3],null);return{c(){s&&s.c()},l(r){s&&s.l(r)},m(r,i){s&&s.m(r,i),e=!0},p(r,i){s&&s.p&&(!e||i&8)&&rt(s,t,r,r[3],e?ot(t,r[3],i,null):it(r[3]),null)},i(r){e||(O(s,r),e=!0)},o(r){W(s,r),e=!1},d(r){s&&s.d(r)}}}function yf(n){let e,t;const s=[{name:"frown"},n[1],{iconNode:n[0]}];let r={$$slots:{default:[vf]},$$scope:{ctx:n}};for(let i=0;i<s.length;i+=1)r=he(r,s[i]);return e=new mt({props:r}),{c(){oe(e.$$.fragment)},l(i){de(e.$$.fragment,i)},m(i,o){ie(e,i,o),t=!0},p(i,[o]){const a=o&3?at(s,[s[0],o&2&&pt(i[1]),o&1&&{iconNode:i[0]}]):{};o&8&&(a.$$scope={dirty:o,ctx:i}),e.$set(a)},i(i){t||(O(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){re(e,i)}}}function bf(n,e,t){let{$$slots:s={},$$scope:r}=e;const i=[["circle",{cx:"12",cy:"12",r:"10"}],["path",{d:"M16 16s-1.5-2-4-2-4 2-4 2"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9"}]];return n.$$set=o=>{t(1,e=he(he({},e),Ee(o))),"$$scope"in o&&t(3,r=o.$$scope)},e=Ee(e),[i,e,s,r]}class Jc extends Be{constructor(e){super(),He(this,e,bf,yf,Le,{})}}function Sf(n){let e;const t=n[2].default,s=nt(t,n,n[3],null);return{c(){s&&s.c()},l(r){s&&s.l(r)},m(r,i){s&&s.m(r,i),e=!0},p(r,i){s&&s.p&&(!e||i&8)&&rt(s,t,r,r[3],e?ot(t,r[3],i,null):it(r[3]),null)},i(r){e||(O(s,r),e=!0)},o(r){W(s,r),e=!1},d(r){s&&s.d(r)}}}function wf(n){let e,t;const s=[{name:"house"},n[1],{iconNode:n[0]}];let r={$$slots:{default:[Sf]},$$scope:{ctx:n}};for(let i=0;i<s.length;i+=1)r=he(r,s[i]);return e=new mt({props:r}),{c(){oe(e.$$.fragment)},l(i){de(e.$$.fragment,i)},m(i,o){ie(e,i,o),t=!0},p(i,[o]){const a=o&3?at(s,[s[0],o&2&&pt(i[1]),o&1&&{iconNode:i[0]}]):{};o&8&&(a.$$scope={dirty:o,ctx:i}),e.$set(a)},i(i){t||(O(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){re(e,i)}}}function Cf(n,e,t){let{$$slots:s={},$$scope:r}=e;const i=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}]];return n.$$set=o=>{t(1,e=he(he({},e),Ee(o))),"$$scope"in o&&t(3,r=o.$$scope)},e=Ee(e),[i,e,s,r]}class Tf extends Be{constructor(e){super(),He(this,e,Cf,wf,Le,{})}}function kf(n){let e;const t=n[2].default,s=nt(t,n,n[3],null);return{c(){s&&s.c()},l(r){s&&s.l(r)},m(r,i){s&&s.m(r,i),e=!0},p(r,i){s&&s.p&&(!e||i&8)&&rt(s,t,r,r[3],e?ot(t,r[3],i,null):it(r[3]),null)},i(r){e||(O(s,r),e=!0)},o(r){W(s,r),e=!1},d(r){s&&s.d(r)}}}function Af(n){let e,t;const s=[{name:"info"},n[1],{iconNode:n[0]}];let r={$$slots:{default:[kf]},$$scope:{ctx:n}};for(let i=0;i<s.length;i+=1)r=he(r,s[i]);return e=new mt({props:r}),{c(){oe(e.$$.fragment)},l(i){de(e.$$.fragment,i)},m(i,o){ie(e,i,o),t=!0},p(i,[o]){const a=o&3?at(s,[s[0],o&2&&pt(i[1]),o&1&&{iconNode:i[0]}]):{};o&8&&(a.$$scope={dirty:o,ctx:i}),e.$set(a)},i(i){t||(O(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){re(e,i)}}}function Nf(n,e,t){let{$$slots:s={},$$scope:r}=e;const i=[["circle",{cx:"12",cy:"12",r:"10"}],["path",{d:"M12 16v-4"}],["path",{d:"M12 8h.01"}]];return n.$$set=o=>{t(1,e=he(he({},e),Ee(o))),"$$scope"in o&&t(3,r=o.$$scope)},e=Ee(e),[i,e,s,r]}class Kc extends Be{constructor(e){super(),He(this,e,Nf,Af,Le,{})}}function Ef(n){let e;const t=n[2].default,s=nt(t,n,n[3],null);return{c(){s&&s.c()},l(r){s&&s.l(r)},m(r,i){s&&s.m(r,i),e=!0},p(r,i){s&&s.p&&(!e||i&8)&&rt(s,t,r,r[3],e?ot(t,r[3],i,null):it(r[3]),null)},i(r){e||(O(s,r),e=!0)},o(r){W(s,r),e=!1},d(r){s&&s.d(r)}}}function If(n){let e,t;const s=[{name:"lightbulb"},n[1],{iconNode:n[0]}];let r={$$slots:{default:[Ef]},$$scope:{ctx:n}};for(let i=0;i<s.length;i+=1)r=he(r,s[i]);return e=new mt({props:r}),{c(){oe(e.$$.fragment)},l(i){de(e.$$.fragment,i)},m(i,o){ie(e,i,o),t=!0},p(i,[o]){const a=o&3?at(s,[s[0],o&2&&pt(i[1]),o&1&&{iconNode:i[0]}]):{};o&8&&(a.$$scope={dirty:o,ctx:i}),e.$set(a)},i(i){t||(O(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){re(e,i)}}}function Df(n,e,t){let{$$slots:s={},$$scope:r}=e;const i=[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5"}],["path",{d:"M9 18h6"}],["path",{d:"M10 22h4"}]];return n.$$set=o=>{t(1,e=he(he({},e),Ee(o))),"$$scope"in o&&t(3,r=o.$$scope)},e=Ee(e),[i,e,s,r]}class eu extends Be{constructor(e){super(),He(this,e,Df,If,Le,{})}}function Mf(n){let e;const t=n[2].default,s=nt(t,n,n[3],null);return{c(){s&&s.c()},l(r){s&&s.l(r)},m(r,i){s&&s.m(r,i),e=!0},p(r,i){s&&s.p&&(!e||i&8)&&rt(s,t,r,r[3],e?ot(t,r[3],i,null):it(r[3]),null)},i(r){e||(O(s,r),e=!0)},o(r){W(s,r),e=!1},d(r){s&&s.d(r)}}}function $f(n){let e,t;const s=[{name:"music"},n[1],{iconNode:n[0]}];let r={$$slots:{default:[Mf]},$$scope:{ctx:n}};for(let i=0;i<s.length;i+=1)r=he(r,s[i]);return e=new mt({props:r}),{c(){oe(e.$$.fragment)},l(i){de(e.$$.fragment,i)},m(i,o){ie(e,i,o),t=!0},p(i,[o]){const a=o&3?at(s,[s[0],o&2&&pt(i[1]),o&1&&{iconNode:i[0]}]):{};o&8&&(a.$$scope={dirty:o,ctx:i}),e.$set(a)},i(i){t||(O(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){re(e,i)}}}function Of(n,e,t){let{$$slots:s={},$$scope:r}=e;const i=[["path",{d:"M9 18V5l12-2v13"}],["circle",{cx:"6",cy:"18",r:"3"}],["circle",{cx:"18",cy:"16",r:"3"}]];return n.$$set=o=>{t(1,e=he(he({},e),Ee(o))),"$$scope"in o&&t(3,r=o.$$scope)},e=Ee(e),[i,e,s,r]}class Rf extends Be{constructor(e){super(),He(this,e,Of,$f,Le,{})}}function Pf(n){let e;const t=n[2].default,s=nt(t,n,n[3],null);return{c(){s&&s.c()},l(r){s&&s.l(r)},m(r,i){s&&s.m(r,i),e=!0},p(r,i){s&&s.p&&(!e||i&8)&&rt(s,t,r,r[3],e?ot(t,r[3],i,null):it(r[3]),null)},i(r){e||(O(s,r),e=!0)},o(r){W(s,r),e=!1},d(r){s&&s.d(r)}}}function Vf(n){let e,t;const s=[{name:"piano"},n[1],{iconNode:n[0]}];let r={$$slots:{default:[Pf]},$$scope:{ctx:n}};for(let i=0;i<s.length;i+=1)r=he(r,s[i]);return e=new mt({props:r}),{c(){oe(e.$$.fragment)},l(i){de(e.$$.fragment,i)},m(i,o){ie(e,i,o),t=!0},p(i,[o]){const a=o&3?at(s,[s[0],o&2&&pt(i[1]),o&1&&{iconNode:i[0]}]):{};o&8&&(a.$$scope={dirty:o,ctx:i}),e.$set(a)},i(i){t||(O(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){re(e,i)}}}function xf(n,e,t){let{$$slots:s={},$$scope:r}=e;const i=[["path",{d:"M18.5 8c-1.4 0-2.6-.8-3.2-2A6.87 6.87 0 0 0 2 9v11a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-8.5C22 9.6 20.4 8 18.5 8"}],["path",{d:"M2 14h20"}],["path",{d:"M6 14v4"}],["path",{d:"M10 14v4"}],["path",{d:"M14 14v4"}],["path",{d:"M18 14v4"}]];return n.$$set=o=>{t(1,e=he(he({},e),Ee(o))),"$$scope"in o&&t(3,r=o.$$scope)},e=Ee(e),[i,e,s,r]}class Ff extends Be{constructor(e){super(),He(this,e,xf,Vf,Le,{})}}function qf(n){let e;const t=n[2].default,s=nt(t,n,n[3],null);return{c(){s&&s.c()},l(r){s&&s.l(r)},m(r,i){s&&s.m(r,i),e=!0},p(r,i){s&&s.p&&(!e||i&8)&&rt(s,t,r,r[3],e?ot(t,r[3],i,null):it(r[3]),null)},i(r){e||(O(s,r),e=!0)},o(r){W(s,r),e=!1},d(r){s&&s.d(r)}}}function Wf(n){let e,t;const s=[{name:"play"},n[1],{iconNode:n[0]}];let r={$$slots:{default:[qf]},$$scope:{ctx:n}};for(let i=0;i<s.length;i+=1)r=he(r,s[i]);return e=new mt({props:r}),{c(){oe(e.$$.fragment)},l(i){de(e.$$.fragment,i)},m(i,o){ie(e,i,o),t=!0},p(i,[o]){const a=o&3?at(s,[s[0],o&2&&pt(i[1]),o&1&&{iconNode:i[0]}]):{};o&8&&(a.$$scope={dirty:o,ctx:i}),e.$set(a)},i(i){t||(O(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){re(e,i)}}}function Lf(n,e,t){let{$$slots:s={},$$scope:r}=e;const i=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z"}]];return n.$$set=o=>{t(1,e=he(he({},e),Ee(o))),"$$scope"in o&&t(3,r=o.$$scope)},e=Ee(e),[i,e,s,r]}class Bf extends Be{constructor(e){super(),He(this,e,Lf,Wf,Le,{})}}function Hf(n){let e;const t=n[2].default,s=nt(t,n,n[3],null);return{c(){s&&s.c()},l(r){s&&s.l(r)},m(r,i){s&&s.m(r,i),e=!0},p(r,i){s&&s.p&&(!e||i&8)&&rt(s,t,r,r[3],e?ot(t,r[3],i,null):it(r[3]),null)},i(r){e||(O(s,r),e=!0)},o(r){W(s,r),e=!1},d(r){s&&s.d(r)}}}function jf(n){let e,t;const s=[{name:"refresh-cw"},n[1],{iconNode:n[0]}];let r={$$slots:{default:[Hf]},$$scope:{ctx:n}};for(let i=0;i<s.length;i+=1)r=he(r,s[i]);return e=new mt({props:r}),{c(){oe(e.$$.fragment)},l(i){de(e.$$.fragment,i)},m(i,o){ie(e,i,o),t=!0},p(i,[o]){const a=o&3?at(s,[s[0],o&2&&pt(i[1]),o&1&&{iconNode:i[0]}]):{};o&8&&(a.$$scope={dirty:o,ctx:i}),e.$set(a)},i(i){t||(O(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){re(e,i)}}}function Uf(n,e,t){let{$$slots:s={},$$scope:r}=e;const i=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"}],["path",{d:"M21 3v5h-5"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"}],["path",{d:"M8 16H3v5"}]];return n.$$set=o=>{t(1,e=he(he({},e),Ee(o))),"$$scope"in o&&t(3,r=o.$$scope)},e=Ee(e),[i,e,s,r]}class $a extends Be{constructor(e){super(),He(this,e,Uf,jf,Le,{})}}function zf(n){let e;const t=n[2].default,s=nt(t,n,n[3],null);return{c(){s&&s.c()},l(r){s&&s.l(r)},m(r,i){s&&s.m(r,i),e=!0},p(r,i){s&&s.p&&(!e||i&8)&&rt(s,t,r,r[3],e?ot(t,r[3],i,null):it(r[3]),null)},i(r){e||(O(s,r),e=!0)},o(r){W(s,r),e=!1},d(r){s&&s.d(r)}}}function Gf(n){let e,t;const s=[{name:"share-2"},n[1],{iconNode:n[0]}];let r={$$slots:{default:[zf]},$$scope:{ctx:n}};for(let i=0;i<s.length;i+=1)r=he(r,s[i]);return e=new mt({props:r}),{c(){oe(e.$$.fragment)},l(i){de(e.$$.fragment,i)},m(i,o){ie(e,i,o),t=!0},p(i,[o]){const a=o&3?at(s,[s[0],o&2&&pt(i[1]),o&1&&{iconNode:i[0]}]):{};o&8&&(a.$$scope={dirty:o,ctx:i}),e.$set(a)},i(i){t||(O(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){re(e,i)}}}function Zf(n,e,t){let{$$slots:s={},$$scope:r}=e;const i=[["circle",{cx:"18",cy:"5",r:"3"}],["circle",{cx:"6",cy:"12",r:"3"}],["circle",{cx:"18",cy:"19",r:"3"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49"}]];return n.$$set=o=>{t(1,e=he(he({},e),Ee(o))),"$$scope"in o&&t(3,r=o.$$scope)},e=Ee(e),[i,e,s,r]}class Xf extends Be{constructor(e){super(),He(this,e,Zf,Gf,Le,{})}}function Yf(n){let e;const t=n[2].default,s=nt(t,n,n[3],null);return{c(){s&&s.c()},l(r){s&&s.l(r)},m(r,i){s&&s.m(r,i),e=!0},p(r,i){s&&s.p&&(!e||i&8)&&rt(s,t,r,r[3],e?ot(t,r[3],i,null):it(r[3]),null)},i(r){e||(O(s,r),e=!0)},o(r){W(s,r),e=!1},d(r){s&&s.d(r)}}}function Qf(n){let e,t;const s=[{name:"star"},n[1],{iconNode:n[0]}];let r={$$slots:{default:[Yf]},$$scope:{ctx:n}};for(let i=0;i<s.length;i+=1)r=he(r,s[i]);return e=new mt({props:r}),{c(){oe(e.$$.fragment)},l(i){de(e.$$.fragment,i)},m(i,o){ie(e,i,o),t=!0},p(i,[o]){const a=o&3?at(s,[s[0],o&2&&pt(i[1]),o&1&&{iconNode:i[0]}]):{};o&8&&(a.$$scope={dirty:o,ctx:i}),e.$set(a)},i(i){t||(O(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){re(e,i)}}}function Jf(n,e,t){let{$$slots:s={},$$scope:r}=e;const i=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z"}]];return n.$$set=o=>{t(1,e=he(he({},e),Ee(o))),"$$scope"in o&&t(3,r=o.$$scope)},e=Ee(e),[i,e,s,r]}class $r extends Be{constructor(e){super(),He(this,e,Jf,Qf,Le,{})}}function Kf(n){let e;const t=n[2].default,s=nt(t,n,n[3],null);return{c(){s&&s.c()},l(r){s&&s.l(r)},m(r,i){s&&s.m(r,i),e=!0},p(r,i){s&&s.p&&(!e||i&8)&&rt(s,t,r,r[3],e?ot(t,r[3],i,null):it(r[3]),null)},i(r){e||(O(s,r),e=!0)},o(r){W(s,r),e=!1},d(r){s&&s.d(r)}}}function ed(n){let e,t;const s=[{name:"target"},n[1],{iconNode:n[0]}];let r={$$slots:{default:[Kf]},$$scope:{ctx:n}};for(let i=0;i<s.length;i+=1)r=he(r,s[i]);return e=new mt({props:r}),{c(){oe(e.$$.fragment)},l(i){de(e.$$.fragment,i)},m(i,o){ie(e,i,o),t=!0},p(i,[o]){const a=o&3?at(s,[s[0],o&2&&pt(i[1]),o&1&&{iconNode:i[0]}]):{};o&8&&(a.$$scope={dirty:o,ctx:i}),e.$set(a)},i(i){t||(O(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){re(e,i)}}}function td(n,e,t){let{$$slots:s={},$$scope:r}=e;const i=[["circle",{cx:"12",cy:"12",r:"10"}],["circle",{cx:"12",cy:"12",r:"6"}],["circle",{cx:"12",cy:"12",r:"2"}]];return n.$$set=o=>{t(1,e=he(he({},e),Ee(o))),"$$scope"in o&&t(3,r=o.$$scope)},e=Ee(e),[i,e,s,r]}class Oo extends Be{constructor(e){super(),He(this,e,td,ed,Le,{})}}function sd(n){let e;const t=n[2].default,s=nt(t,n,n[3],null);return{c(){s&&s.c()},l(r){s&&s.l(r)},m(r,i){s&&s.m(r,i),e=!0},p(r,i){s&&s.p&&(!e||i&8)&&rt(s,t,r,r[3],e?ot(t,r[3],i,null):it(r[3]),null)},i(r){e||(O(s,r),e=!0)},o(r){W(s,r),e=!1},d(r){s&&s.d(r)}}}function nd(n){let e,t;const s=[{name:"thumbs-up"},n[1],{iconNode:n[0]}];let r={$$slots:{default:[sd]},$$scope:{ctx:n}};for(let i=0;i<s.length;i+=1)r=he(r,s[i]);return e=new mt({props:r}),{c(){oe(e.$$.fragment)},l(i){de(e.$$.fragment,i)},m(i,o){ie(e,i,o),t=!0},p(i,[o]){const a=o&3?at(s,[s[0],o&2&&pt(i[1]),o&1&&{iconNode:i[0]}]):{};o&8&&(a.$$scope={dirty:o,ctx:i}),e.$set(a)},i(i){t||(O(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){re(e,i)}}}function rd(n,e,t){let{$$slots:s={},$$scope:r}=e;const i=[["path",{d:"M7 10v12"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z"}]];return n.$$set=o=>{t(1,e=he(he({},e),Ee(o))),"$$scope"in o&&t(3,r=o.$$scope)},e=Ee(e),[i,e,s,r]}class Ro extends Be{constructor(e){super(),He(this,e,rd,nd,Le,{})}}function id(n){let e;const t=n[2].default,s=nt(t,n,n[3],null);return{c(){s&&s.c()},l(r){s&&s.l(r)},m(r,i){s&&s.m(r,i),e=!0},p(r,i){s&&s.p&&(!e||i&8)&&rt(s,t,r,r[3],e?ot(t,r[3],i,null):it(r[3]),null)},i(r){e||(O(s,r),e=!0)},o(r){W(s,r),e=!1},d(r){s&&s.d(r)}}}function od(n){let e,t;const s=[{name:"trending-up"},n[1],{iconNode:n[0]}];let r={$$slots:{default:[id]},$$scope:{ctx:n}};for(let i=0;i<s.length;i+=1)r=he(r,s[i]);return e=new mt({props:r}),{c(){oe(e.$$.fragment)},l(i){de(e.$$.fragment,i)},m(i,o){ie(e,i,o),t=!0},p(i,[o]){const a=o&3?at(s,[s[0],o&2&&pt(i[1]),o&1&&{iconNode:i[0]}]):{};o&8&&(a.$$scope={dirty:o,ctx:i}),e.$set(a)},i(i){t||(O(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){re(e,i)}}}function ad(n,e,t){let{$$slots:s={},$$scope:r}=e;const i=[["path",{d:"M16 7h6v6"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17"}]];return n.$$set=o=>{t(1,e=he(he({},e),Ee(o))),"$$scope"in o&&t(3,r=o.$$scope)},e=Ee(e),[i,e,s,r]}class tu extends Be{constructor(e){super(),He(this,e,ad,od,Le,{})}}function ld(n){let e;const t=n[2].default,s=nt(t,n,n[3],null);return{c(){s&&s.c()},l(r){s&&s.l(r)},m(r,i){s&&s.m(r,i),e=!0},p(r,i){s&&s.p&&(!e||i&8)&&rt(s,t,r,r[3],e?ot(t,r[3],i,null):it(r[3]),null)},i(r){e||(O(s,r),e=!0)},o(r){W(s,r),e=!1},d(r){s&&s.d(r)}}}function cd(n){let e,t;const s=[{name:"triangle-alert"},n[1],{iconNode:n[0]}];let r={$$slots:{default:[ld]},$$scope:{ctx:n}};for(let i=0;i<s.length;i+=1)r=he(r,s[i]);return e=new mt({props:r}),{c(){oe(e.$$.fragment)},l(i){de(e.$$.fragment,i)},m(i,o){ie(e,i,o),t=!0},p(i,[o]){const a=o&3?at(s,[s[0],o&2&&pt(i[1]),o&1&&{iconNode:i[0]}]):{};o&8&&(a.$$scope={dirty:o,ctx:i}),e.$set(a)},i(i){t||(O(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){re(e,i)}}}function ud(n,e,t){let{$$slots:s={},$$scope:r}=e;const i=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3"}],["path",{d:"M12 9v4"}],["path",{d:"M12 17h.01"}]];return n.$$set=o=>{t(1,e=he(he({},e),Ee(o))),"$$scope"in o&&t(3,r=o.$$scope)},e=Ee(e),[i,e,s,r]}class su extends Be{constructor(e){super(),He(this,e,ud,cd,Le,{})}}function hd(n){let e;const t=n[2].default,s=nt(t,n,n[3],null);return{c(){s&&s.c()},l(r){s&&s.l(r)},m(r,i){s&&s.m(r,i),e=!0},p(r,i){s&&s.p&&(!e||i&8)&&rt(s,t,r,r[3],e?ot(t,r[3],i,null):it(r[3]),null)},i(r){e||(O(s,r),e=!0)},o(r){W(s,r),e=!1},d(r){s&&s.d(r)}}}function fd(n){let e,t;const s=[{name:"trophy"},n[1],{iconNode:n[0]}];let r={$$slots:{default:[hd]},$$scope:{ctx:n}};for(let i=0;i<s.length;i+=1)r=he(r,s[i]);return e=new mt({props:r}),{c(){oe(e.$$.fragment)},l(i){de(e.$$.fragment,i)},m(i,o){ie(e,i,o),t=!0},p(i,[o]){const a=o&3?at(s,[s[0],o&2&&pt(i[1]),o&1&&{iconNode:i[0]}]):{};o&8&&(a.$$scope={dirty:o,ctx:i}),e.$set(a)},i(i){t||(O(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){re(e,i)}}}function dd(n,e,t){let{$$slots:s={},$$scope:r}=e;const i=[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18"}],["path",{d:"M4 22h16"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6"}]];return n.$$set=o=>{t(1,e=he(he({},e),Ee(o))),"$$scope"in o&&t(3,r=o.$$scope)},e=Ee(e),[i,e,s,r]}class Or extends Be{constructor(e){super(),He(this,e,dd,fd,Le,{})}}function pd(n){let e;const t=n[2].default,s=nt(t,n,n[3],null);return{c(){s&&s.c()},l(r){s&&s.l(r)},m(r,i){s&&s.m(r,i),e=!0},p(r,i){s&&s.p&&(!e||i&8)&&rt(s,t,r,r[3],e?ot(t,r[3],i,null):it(r[3]),null)},i(r){e||(O(s,r),e=!0)},o(r){W(s,r),e=!1},d(r){s&&s.d(r)}}}function md(n){let e,t;const s=[{name:"twitter"},n[1],{iconNode:n[0]}];let r={$$slots:{default:[pd]},$$scope:{ctx:n}};for(let i=0;i<s.length;i+=1)r=he(r,s[i]);return e=new mt({props:r}),{c(){oe(e.$$.fragment)},l(i){de(e.$$.fragment,i)},m(i,o){ie(e,i,o),t=!0},p(i,[o]){const a=o&3?at(s,[s[0],o&2&&pt(i[1]),o&1&&{iconNode:i[0]}]):{};o&8&&(a.$$scope={dirty:o,ctx:i}),e.$set(a)},i(i){t||(O(e.$$.fragment,i),t=!0)},o(i){W(e.$$.fragment,i),t=!1},d(i){re(e,i)}}}function _d(n,e,t){let{$$slots:s={},$$scope:r}=e;const i=[["path",{d:"M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z"}]];return n.$$set=o=>{t(1,e=he(he({},e),Ee(o))),"$$scope"in o&&t(3,r=o.$$scope)},e=Ee(e),[i,e,s,r]}class gd extends Be{constructor(e){super(),He(this,e,_d,md,Le,{})}}const nu="15.1.22",Oa=(n,e,t)=>({endTime:e,insertTime:t,type:"exponentialRampToValue",value:n}),Ra=(n,e,t)=>({endTime:e,insertTime:t,type:"linearRampToValue",value:n}),yo=(n,e)=>({startTime:e,type:"setValue",value:n}),ru=(n,e,t)=>({duration:t,startTime:e,type:"setValueCurve",values:n}),iu=(n,e,{startTime:t,target:s,timeConstant:r})=>s+(e-s)*Math.exp((t-n)/r),Ar=n=>n.type==="exponentialRampToValue",Mi=n=>n.type==="linearRampToValue",Ln=n=>Ar(n)||Mi(n),Po=n=>n.type==="setValue",Mn=n=>n.type==="setValueCurve",$i=(n,e,t,s)=>{const r=n[e];return r===void 0?s:Ln(r)||Po(r)?r.value:Mn(r)?r.values[r.values.length-1]:iu(t,$i(n,e-1,r.startTime,s),r)},Pa=(n,e,t,s,r)=>t===void 0?[s.insertTime,r]:Ln(t)?[t.endTime,t.value]:Po(t)?[t.startTime,t.value]:Mn(t)?[t.startTime+t.duration,t.values[t.values.length-1]]:[t.startTime,$i(n,e-1,t.startTime,r)],bo=n=>n.type==="cancelAndHold",So=n=>n.type==="cancelScheduledValues",Wn=n=>bo(n)||So(n)?n.cancelTime:Ar(n)||Mi(n)?n.endTime:n.startTime,Va=(n,e,t,{endTime:s,value:r})=>t===r?r:0<t&&0<r||t<0&&r<0?t*(r/t)**((n-e)/(s-e)):0,xa=(n,e,t,{endTime:s,value:r})=>t+(n-e)/(s-e)*(r-t),vd=(n,e)=>{const t=Math.floor(e),s=Math.ceil(e);return t===s?n[t]:(1-(e-t))*n[t]+(1-(s-e))*n[s]},yd=(n,{duration:e,startTime:t,values:s})=>{const r=(n-t)/e*(s.length-1);return vd(s,r)},Si=n=>n.type==="setTarget";class bd{constructor(e){this._automationEvents=[],this._currenTime=0,this._defaultValue=e}[Symbol.iterator](){return this._automationEvents[Symbol.iterator]()}add(e){const t=Wn(e);if(bo(e)||So(e)){const s=this._automationEvents.findIndex(i=>So(e)&&Mn(i)?i.startTime+i.duration>=t:Wn(i)>=t),r=this._automationEvents[s];if(s!==-1&&(this._automationEvents=this._automationEvents.slice(0,s)),bo(e)){const i=this._automationEvents[this._automationEvents.length-1];if(r!==void 0&&Ln(r)){if(i!==void 0&&Si(i))throw new Error("The internal list is malformed.");const o=i===void 0?r.insertTime:Mn(i)?i.startTime+i.duration:Wn(i),a=i===void 0?this._defaultValue:Mn(i)?i.values[i.values.length-1]:i.value,l=Ar(r)?Va(t,o,a,r):xa(t,o,a,r),c=Ar(r)?Oa(l,t,this._currenTime):Ra(l,t,this._currenTime);this._automationEvents.push(c)}if(i!==void 0&&Si(i)&&this._automationEvents.push(yo(this.getValue(t),t)),i!==void 0&&Mn(i)&&i.startTime+i.duration>t){const o=t-i.startTime,a=(i.values.length-1)/i.duration,l=Math.max(2,1+Math.ceil(o*a)),c=o/(l-1)*a,u=i.values.slice(0,l);if(c<1)for(let h=1;h<l;h+=1){const f=c*h%1;u[h]=i.values[h-1]*(1-f)+i.values[h]*f}this._automationEvents[this._automationEvents.length-1]=ru(u,i.startTime,o)}}}else{const s=this._automationEvents.findIndex(o=>Wn(o)>t),r=s===-1?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[s-1];if(r!==void 0&&Mn(r)&&Wn(r)+r.duration>t)return!1;const i=Ar(e)?Oa(e.value,e.endTime,this._currenTime):Mi(e)?Ra(e.value,t,this._currenTime):e;if(s===-1)this._automationEvents.push(i);else{if(Mn(e)&&t+e.duration>Wn(this._automationEvents[s]))return!1;this._automationEvents.splice(s,0,i)}}return!0}flush(e){const t=this._automationEvents.findIndex(s=>Wn(s)>e);if(t>1){const s=this._automationEvents.slice(t-1),r=s[0];Si(r)&&s.unshift(yo($i(this._automationEvents,t-2,r.startTime,this._defaultValue),r.startTime)),this._automationEvents=s}}getValue(e){if(this._automationEvents.length===0)return this._defaultValue;const t=this._automationEvents.findIndex(o=>Wn(o)>e),s=this._automationEvents[t],r=(t===-1?this._automationEvents.length:t)-1,i=this._automationEvents[r];if(i!==void 0&&Si(i)&&(s===void 0||!Ln(s)||s.insertTime>e))return iu(e,$i(this._automationEvents,r-1,i.startTime,this._defaultValue),i);if(i!==void 0&&Po(i)&&(s===void 0||!Ln(s)))return i.value;if(i!==void 0&&Mn(i)&&(s===void 0||!Ln(s)||i.startTime+i.duration>e))return e<i.startTime+i.duration?yd(e,i):i.values[i.values.length-1];if(i!==void 0&&Ln(i)&&(s===void 0||!Ln(s)))return i.value;if(s!==void 0&&Ar(s)){const[o,a]=Pa(this._automationEvents,r,i,s,this._defaultValue);return Va(e,o,a,s)}if(s!==void 0&&Mi(s)){const[o,a]=Pa(this._automationEvents,r,i,s,this._defaultValue);return xa(e,o,a,s)}return this._defaultValue}}const Sd=n=>({cancelTime:n,type:"cancelAndHold"}),wd=n=>({cancelTime:n,type:"cancelScheduledValues"}),Cd=(n,e)=>({endTime:e,type:"exponentialRampToValue",value:n}),Td=(n,e)=>({endTime:e,type:"linearRampToValue",value:n}),kd=(n,e,t)=>({startTime:e,target:n,timeConstant:t,type:"setTarget"}),Ad=()=>new DOMException("","AbortError"),Nd=n=>(e,t,[s,r,i],o)=>{n(e[r],[t,s,i],a=>a[0]===t&&a[1]===s,o)},Ed=n=>(e,t,s)=>{const r=[];for(let i=0;i<s.numberOfInputs;i+=1)r.push(new Set);n.set(e,{activeInputs:r,outputs:new Set,passiveInputs:new WeakMap,renderer:t})},Id=n=>(e,t)=>{n.set(e,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:t})},Rr=new WeakSet,ou=new WeakMap,Vo=new WeakMap,au=new WeakMap,xo=new WeakMap,ji=new WeakMap,lu=new WeakMap,wo=new WeakMap,Co=new WeakMap,To=new WeakMap,cu={construct(){return cu}},Dd=n=>{try{const e=new Proxy(n,cu);new e}catch{return!1}return!0},Fa=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,qa=(n,e)=>{const t=[];let s=n.replace(/^[\s]+/,""),r=s.match(Fa);for(;r!==null;){const i=r[1].slice(1,-1),o=r[0].replace(/([\s]+)?;?$/,"").replace(i,new URL(i,e).toString());t.push(o),s=s.slice(r[0].length).replace(/^[\s]+/,""),r=s.match(Fa)}return[t.join(";"),s]},Wa=n=>{if(n!==void 0&&!Array.isArray(n))throw new TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},La=n=>{if(!Dd(n))throw new TypeError("The given value for processorCtor should be a constructor.");if(n.prototype===null||typeof n.prototype!="object")throw new TypeError("The given value for processorCtor should have a prototype.")},Md=(n,e,t,s,r,i,o,a,l,c,u,h,f)=>{let d=0;return(m,_,g={credentials:"omit"})=>{const y=u.get(m);if(y!==void 0&&y.has(_))return Promise.resolve();const b=c.get(m);if(b!==void 0){const T=b.get(_);if(T!==void 0)return T}const k=i(m),I=k.audioWorklet===void 0?r(_).then(([T,C])=>{const[A,w]=qa(T,C),D=`${A};((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{${w}
})})(window,'_AWGS')`;return t(D)}).then(()=>{const T=f._AWGS.pop();if(T===void 0)throw new SyntaxError;s(k.currentTime,k.sampleRate,()=>T(class{},void 0,(C,A)=>{if(C.trim()==="")throw e();const w=Co.get(k);if(w!==void 0){if(w.has(C))throw e();La(A),Wa(A.parameterDescriptors),w.set(C,A)}else La(A),Wa(A.parameterDescriptors),Co.set(k,new Map([[C,A]]))},k.sampleRate,void 0,void 0))}):Promise.all([r(_),Promise.resolve(n(h,h))]).then(([[T,C],A])=>{const w=d+1;d=w;const[D,M]=qa(T,C),G=`${D};((AudioWorkletProcessor,registerProcessor)=>{${M}
})(${A?"AudioWorkletProcessor":"class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}"},(n,p)=>registerProcessor(n,class extends p{${A?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));"}process(i,o,p){${A?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));"}return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}));registerProcessor('__sac${w}',class extends AudioWorkletProcessor{process(){return !1}})`,Y=new Blob([G],{type:"application/javascript; charset=utf-8"}),U=URL.createObjectURL(Y);return k.audioWorklet.addModule(U,g).then(()=>{if(a(k))return k;const L=o(k);return L.audioWorklet.addModule(U,g).then(()=>L)}).then(L=>{if(l===null)throw new SyntaxError;try{new l(L,`__sac${w}`)}catch{throw new SyntaxError}}).finally(()=>URL.revokeObjectURL(U))});return b===void 0?c.set(m,new Map([[_,I]])):b.set(_,I),I.then(()=>{const T=u.get(m);T===void 0?u.set(m,new Set([_])):T.add(_)}).finally(()=>{const T=c.get(m);T!==void 0&&T.delete(_)}),I}},Ys=(n,e)=>{const t=n.get(e);if(t===void 0)throw new Error("A value with the given key could not be found.");return t},Ui=(n,e)=>{const t=Array.from(n).filter(e);if(t.length>1)throw Error("More than one element was found.");if(t.length===0)throw Error("No element was found.");const[s]=t;return n.delete(s),s},uu=(n,e,t,s)=>{const r=Ys(n,e),i=Ui(r,o=>o[0]===t&&o[1]===s);return r.size===0&&n.delete(e),i},oi=n=>Ys(lu,n),Pr=n=>{if(Rr.has(n))throw new Error("The AudioNode is already stored.");Rr.add(n),oi(n).forEach(e=>e(!0))},hu=n=>"port"in n,ai=n=>{if(!Rr.has(n))throw new Error("The AudioNode is not stored.");Rr.delete(n),oi(n).forEach(e=>e(!1))},ko=(n,e)=>{!hu(n)&&e.every(t=>t.size===0)&&ai(n)},$d=(n,e,t,s,r,i,o,a,l,c,u,h,f)=>{const d=new WeakMap;return(m,_,g,y,b)=>{const{activeInputs:k,passiveInputs:I}=i(_),{outputs:T}=i(m),C=a(m),A=w=>{const D=l(_),M=l(m);if(w){const F=uu(I,m,g,y);n(k,m,F,!1),!b&&!h(m)&&t(M,D,g,y),f(_)&&Pr(_)}else{const F=s(k,m,g,y);e(I,y,F,!1),!b&&!h(m)&&r(M,D,g,y);const q=o(_);if(q===0)u(_)&&ko(_,k);else{const B=d.get(_);B!==void 0&&clearTimeout(B),d.set(_,setTimeout(()=>{u(_)&&ko(_,k)},q*1e3))}}};return c(T,[_,g,y],w=>w[0]===_&&w[1]===g&&w[2]===y,!0)?(C.add(A),u(m)?n(k,m,[g,y,A],!0):e(I,y,[m,g,A],!0),!0):!1}},Od=n=>(e,t,[s,r,i],o)=>{const a=e.get(s);a===void 0?e.set(s,new Set([[r,t,i]])):n(a,[r,t,i],l=>l[0]===r&&l[1]===t,o)},Rd=n=>(e,t)=>{const s=n(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});t.connect(s).connect(e.destination);const r=()=>{t.removeEventListener("ended",r),t.disconnect(s),s.disconnect()};t.addEventListener("ended",r)},Pd=n=>(e,t)=>{n(e).add(t)},Vd={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},xd=(n,e,t,s,r,i)=>class extends n{constructor(a,l){const c=r(a),u={...Vd,...l},h=s(c,u),f=i(c)?e():null;super(a,!1,h,f),this._nativeAnalyserNode=h}get fftSize(){return this._nativeAnalyserNode.fftSize}set fftSize(a){this._nativeAnalyserNode.fftSize=a}get frequencyBinCount(){return this._nativeAnalyserNode.frequencyBinCount}get maxDecibels(){return this._nativeAnalyserNode.maxDecibels}set maxDecibels(a){const l=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=a,!(a>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=l,t()}get minDecibels(){return this._nativeAnalyserNode.minDecibels}set minDecibels(a){const l=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=a,!(this._nativeAnalyserNode.maxDecibels>a))throw this._nativeAnalyserNode.minDecibels=l,t()}get smoothingTimeConstant(){return this._nativeAnalyserNode.smoothingTimeConstant}set smoothingTimeConstant(a){this._nativeAnalyserNode.smoothingTimeConstant=a}getByteFrequencyData(a){this._nativeAnalyserNode.getByteFrequencyData(a)}getByteTimeDomainData(a){this._nativeAnalyserNode.getByteTimeDomainData(a)}getFloatFrequencyData(a){this._nativeAnalyserNode.getFloatFrequencyData(a)}getFloatTimeDomainData(a){this._nativeAnalyserNode.getFloatTimeDomainData(a)}},os=(n,e)=>n.context===e,Fd=(n,e,t)=>()=>{const s=new WeakMap,r=async(i,o)=>{let a=e(i);if(!os(a,o)){const c={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,fftSize:a.fftSize,maxDecibels:a.maxDecibels,minDecibels:a.minDecibels,smoothingTimeConstant:a.smoothingTimeConstant};a=n(o,c)}return s.set(o,a),await t(i,o,a),a};return{render(i,o){const a=s.get(o);return a!==void 0?Promise.resolve(a):r(i,o)}}},Oi=n=>{try{n.copyToChannel(new Float32Array(1),0,-1)}catch{return!1}return!0},un=()=>new DOMException("","IndexSizeError"),Fo=n=>{n.getChannelData=(e=>t=>{try{return e.call(n,t)}catch(s){throw s.code===12?un():s}})(n.getChannelData)},qd={numberOfChannels:1},Wd=(n,e,t,s,r,i,o,a)=>{let l=null;return class fu{constructor(u){if(r===null)throw new Error("Missing the native OfflineAudioContext constructor.");const{length:h,numberOfChannels:f,sampleRate:d}={...qd,...u};l===null&&(l=new r(1,1,44100));const m=s!==null&&e(i,i)?new s({length:h,numberOfChannels:f,sampleRate:d}):l.createBuffer(f,h,d);if(m.numberOfChannels===0)throw t();return typeof m.copyFromChannel!="function"?(o(m),Fo(m)):e(Oi,()=>Oi(m))||a(m),n.add(m),m}static[Symbol.hasInstance](u){return u!==null&&typeof u=="object"&&Object.getPrototypeOf(u)===fu.prototype||n.has(u)}}},gs=-34028234663852886e22,us=-gs,On=n=>Rr.has(n),Ld={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},Bd=(n,e,t,s,r,i,o,a)=>class extends n{constructor(c,u){const h=i(c),f={...Ld,...u},d=r(h,f),m=o(h),_=m?e():null;super(c,!1,d,_),this._audioBufferSourceNodeRenderer=_,this._isBufferNullified=!1,this._isBufferSet=f.buffer!==null,this._nativeAudioBufferSourceNode=d,this._onended=null,this._playbackRate=t(this,m,d.playbackRate,us,gs)}get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer}set buffer(c){if(this._nativeAudioBufferSourceNode.buffer=c,c!==null){if(this._isBufferSet)throw s();this._isBufferSet=!0}}get loop(){return this._nativeAudioBufferSourceNode.loop}set loop(c){this._nativeAudioBufferSourceNode.loop=c}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd}set loopEnd(c){this._nativeAudioBufferSourceNode.loopEnd=c}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart}set loopStart(c){this._nativeAudioBufferSourceNode.loopStart=c}get onended(){return this._onended}set onended(c){const u=typeof c=="function"?a(this,c):null;this._nativeAudioBufferSourceNode.onended=u;const h=this._nativeAudioBufferSourceNode.onended;this._onended=h!==null&&h===u?c:h}get playbackRate(){return this._playbackRate}start(c=0,u=0,h){if(this._nativeAudioBufferSourceNode.start(c,u,h),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.start=h===void 0?[c,u]:[c,u,h]),this.context.state!=="closed"){Pr(this);const f=()=>{this._nativeAudioBufferSourceNode.removeEventListener("ended",f),On(this)&&ai(this)};this._nativeAudioBufferSourceNode.addEventListener("ended",f)}}stop(c=0){this._nativeAudioBufferSourceNode.stop(c),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.stop=c)}},Hd=(n,e,t,s,r)=>()=>{const i=new WeakMap;let o=null,a=null;const l=async(c,u)=>{let h=t(c);const f=os(h,u);if(!f){const d={buffer:h.buffer,channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,loop:h.loop,loopEnd:h.loopEnd,loopStart:h.loopStart,playbackRate:h.playbackRate.value};h=e(u,d),o!==null&&h.start(...o),a!==null&&h.stop(a)}return i.set(u,h),f?await n(u,c.playbackRate,h.playbackRate):await s(u,c.playbackRate,h.playbackRate),await r(c,u,h),h};return{set start(c){o=c},set stop(c){a=c},render(c,u){const h=i.get(u);return h!==void 0?Promise.resolve(h):l(c,u)}}},jd=n=>"playbackRate"in n,Ud=n=>"frequency"in n&&"gain"in n,zd=n=>"offset"in n,Gd=n=>!("frequency"in n)&&"gain"in n,Zd=n=>"detune"in n&&"frequency"in n&&!("gain"in n),Xd=n=>"pan"in n,hs=n=>Ys(ou,n),li=n=>Ys(au,n),Ao=(n,e)=>{const{activeInputs:t}=hs(n);t.forEach(r=>r.forEach(([i])=>{e.includes(n)||Ao(i,[...e,n])}));const s=jd(n)?[n.playbackRate]:hu(n)?Array.from(n.parameters.values()):Ud(n)?[n.Q,n.detune,n.frequency,n.gain]:zd(n)?[n.offset]:Gd(n)?[n.gain]:Zd(n)?[n.detune,n.frequency]:Xd(n)?[n.pan]:[];for(const r of s){const i=li(r);i!==void 0&&i.activeInputs.forEach(([o])=>Ao(o,e))}On(n)&&ai(n)},du=n=>{Ao(n.destination,[])},Yd=n=>n===void 0||typeof n=="number"||typeof n=="string"&&(n==="balanced"||n==="interactive"||n==="playback"),Qd=(n,e,t,s,r,i,o,a,l)=>class extends n{constructor(u={}){if(l===null)throw new Error("Missing the native AudioContext constructor.");let h;try{h=new l(u)}catch(m){throw m.code===12&&m.message==="sampleRate is not in range"?t():m}if(h===null)throw s();if(!Yd(u.latencyHint))throw new TypeError(`The provided value '${u.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(u.sampleRate!==void 0&&h.sampleRate!==u.sampleRate)throw t();super(h,2);const{latencyHint:f}=u,{sampleRate:d}=h;if(this._baseLatency=typeof h.baseLatency=="number"?h.baseLatency:f==="balanced"?512/d:f==="interactive"||f===void 0?256/d:f==="playback"?1024/d:Math.max(2,Math.min(128,Math.round(f*d/128)))*128/d,this._nativeAudioContext=h,l.name==="webkitAudioContext"?(this._nativeGainNode=h.createGain(),this._nativeOscillatorNode=h.createOscillator(),this._nativeGainNode.gain.value=1e-37,this._nativeOscillatorNode.connect(this._nativeGainNode).connect(h.destination),this._nativeOscillatorNode.start()):(this._nativeGainNode=null,this._nativeOscillatorNode=null),this._state=null,h.state==="running"){this._state="suspended";const m=()=>{this._state==="suspended"&&(this._state=null),h.removeEventListener("statechange",m)};h.addEventListener("statechange",m)}}get baseLatency(){return this._baseLatency}get state(){return this._state!==null?this._state:this._nativeAudioContext.state}close(){return this.state==="closed"?this._nativeAudioContext.close().then(()=>{throw e()}):(this._state==="suspended"&&(this._state=null),this._nativeAudioContext.close().then(()=>{this._nativeGainNode!==null&&this._nativeOscillatorNode!==null&&(this._nativeOscillatorNode.stop(),this._nativeGainNode.disconnect(),this._nativeOscillatorNode.disconnect()),du(this)}))}createMediaElementSource(u){return new r(this,{mediaElement:u})}createMediaStreamDestination(){return new i(this)}createMediaStreamSource(u){return new o(this,{mediaStream:u})}createMediaStreamTrackSource(u){return new a(this,{mediaStreamTrack:u})}resume(){return this._state==="suspended"?new Promise((u,h)=>{const f=()=>{this._nativeAudioContext.removeEventListener("statechange",f),this._nativeAudioContext.state==="running"?u():this.resume().then(u,h)};this._nativeAudioContext.addEventListener("statechange",f)}):this._nativeAudioContext.resume().catch(u=>{throw u===void 0||u.code===15?e():u})}suspend(){return this._nativeAudioContext.suspend().catch(u=>{throw u===void 0?e():u})}},Jd=(n,e,t,s,r,i,o,a)=>class extends n{constructor(c,u){const h=i(c),f=o(h),d=r(h,u,f),m=f?e(a):null;super(c,!1,d,m),this._isNodeOfNativeOfflineAudioContext=f,this._nativeAudioDestinationNode=d}get channelCount(){return this._nativeAudioDestinationNode.channelCount}set channelCount(c){if(this._isNodeOfNativeOfflineAudioContext)throw s();if(c>this._nativeAudioDestinationNode.maxChannelCount)throw t();this._nativeAudioDestinationNode.channelCount=c}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode}set channelCountMode(c){if(this._isNodeOfNativeOfflineAudioContext)throw s();this._nativeAudioDestinationNode.channelCountMode=c}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount}},Kd=n=>{const e=new WeakMap,t=async(s,r)=>{const i=r.destination;return e.set(r,i),await n(s,r,i),i};return{render(s,r){const i=e.get(r);return i!==void 0?Promise.resolve(i):t(s,r)}}},ep=(n,e,t,s,r,i,o,a)=>(l,c)=>{const u=c.listener,h=()=>{const T=new Float32Array(1),C=e(c,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),A=o(c);let w=!1,D=[0,0,-1,0,1,0],M=[0,0,0];const F=()=>{if(w)return;w=!0;const Y=s(c,256,9,0);Y.onaudioprocess=({inputBuffer:U})=>{const L=[i(U,T,0),i(U,T,1),i(U,T,2),i(U,T,3),i(U,T,4),i(U,T,5)];L.some((z,Q)=>z!==D[Q])&&(u.setOrientation(...L),D=L);const K=[i(U,T,6),i(U,T,7),i(U,T,8)];K.some((z,Q)=>z!==M[Q])&&(u.setPosition(...K),M=K)},C.connect(Y)},q=Y=>U=>{U!==D[Y]&&(D[Y]=U,u.setOrientation(...D))},B=Y=>U=>{U!==M[Y]&&(M[Y]=U,u.setPosition(...M))},G=(Y,U,L)=>{const K=t(c,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:U});K.connect(C,0,Y),K.start(),Object.defineProperty(K.offset,"defaultValue",{get(){return U}});const z=n({context:l},A,K.offset,us,gs);return a(z,"value",Q=>()=>Q.call(z),Q=>te=>{try{Q.call(z,te)}catch(ce){if(ce.code!==9)throw ce}F(),A&&L(te)}),z.cancelAndHoldAtTime=(Q=>A?()=>{throw r()}:(...te)=>{const ce=Q.apply(z,te);return F(),ce})(z.cancelAndHoldAtTime),z.cancelScheduledValues=(Q=>A?()=>{throw r()}:(...te)=>{const ce=Q.apply(z,te);return F(),ce})(z.cancelScheduledValues),z.exponentialRampToValueAtTime=(Q=>A?()=>{throw r()}:(...te)=>{const ce=Q.apply(z,te);return F(),ce})(z.exponentialRampToValueAtTime),z.linearRampToValueAtTime=(Q=>A?()=>{throw r()}:(...te)=>{const ce=Q.apply(z,te);return F(),ce})(z.linearRampToValueAtTime),z.setTargetAtTime=(Q=>A?()=>{throw r()}:(...te)=>{const ce=Q.apply(z,te);return F(),ce})(z.setTargetAtTime),z.setValueAtTime=(Q=>A?()=>{throw r()}:(...te)=>{const ce=Q.apply(z,te);return F(),ce})(z.setValueAtTime),z.setValueCurveAtTime=(Q=>A?()=>{throw r()}:(...te)=>{const ce=Q.apply(z,te);return F(),ce})(z.setValueCurveAtTime),z};return{forwardX:G(0,0,q(0)),forwardY:G(1,0,q(1)),forwardZ:G(2,-1,q(2)),positionX:G(6,0,B(0)),positionY:G(7,0,B(1)),positionZ:G(8,0,B(2)),upX:G(3,0,q(3)),upY:G(4,1,q(4)),upZ:G(5,0,q(5))}},{forwardX:f,forwardY:d,forwardZ:m,positionX:_,positionY:g,positionZ:y,upX:b,upY:k,upZ:I}=u.forwardX===void 0?h():u;return{get forwardX(){return f},get forwardY(){return d},get forwardZ(){return m},get positionX(){return _},get positionY(){return g},get positionZ(){return y},get upX(){return b},get upY(){return k},get upZ(){return I}}},Ri=n=>"context"in n,ci=n=>Ri(n[0]),gr=(n,e,t,s)=>{for(const r of n)if(t(r)){if(s)return!1;throw Error("The set contains at least one similar element.")}return n.add(e),!0},Ba=(n,e,[t,s],r)=>{gr(n,[e,t,s],i=>i[0]===e&&i[1]===t,r)},Ha=(n,[e,t,s],r)=>{const i=n.get(e);i===void 0?n.set(e,new Set([[t,s]])):gr(i,[t,s],o=>o[0]===t,r)},jr=n=>"inputs"in n,Pi=(n,e,t,s)=>{if(jr(e)){const r=e.inputs[s];return n.connect(r,t,0),[r,t,0]}return n.connect(e,t,s),[e,t,s]},pu=(n,e,t)=>{for(const s of n)if(s[0]===e&&s[1]===t)return n.delete(s),s;return null},tp=(n,e,t)=>Ui(n,s=>s[0]===e&&s[1]===t),mu=(n,e)=>{if(!oi(n).delete(e))throw new Error("Missing the expected event listener.")},_u=(n,e,t)=>{const s=Ys(n,e),r=Ui(s,i=>i[0]===t);return s.size===0&&n.delete(e),r},Vi=(n,e,t,s)=>{jr(e)?n.disconnect(e.inputs[s],t,0):n.disconnect(e,t,s)},vt=n=>Ys(Vo,n),ti=n=>Ys(xo,n),ur=n=>wo.has(n),Ni=n=>!Rr.has(n),ja=(n,e)=>new Promise(t=>{if(e!==null)t(!0);else{const s=n.createScriptProcessor(256,1,1),r=n.createGain(),i=n.createBuffer(1,2,44100),o=i.getChannelData(0);o[0]=1,o[1]=1;const a=n.createBufferSource();a.buffer=i,a.loop=!0,a.connect(s).connect(n.destination),a.connect(r),a.disconnect(r),s.onaudioprocess=l=>{const c=l.inputBuffer.getChannelData(0);Array.prototype.some.call(c,u=>u===1)?t(!0):t(!1),a.stop(),s.onaudioprocess=null,a.disconnect(s),s.disconnect(n.destination)},a.start()}}),mo=(n,e)=>{const t=new Map;for(const s of n)for(const r of s){const i=t.get(r);t.set(r,i===void 0?1:i+1)}t.forEach((s,r)=>e(r,s))},xi=n=>"context"in n,sp=n=>{const e=new Map;n.connect=(t=>(s,r=0,i=0)=>{const o=xi(s)?t(s,r,i):t(s,r),a=e.get(s);return a===void 0?e.set(s,[{input:i,output:r}]):a.every(l=>l.input!==i||l.output!==r)&&a.push({input:i,output:r}),o})(n.connect.bind(n)),n.disconnect=(t=>(s,r,i)=>{if(t.apply(n),s===void 0)e.clear();else if(typeof s=="number")for(const[o,a]of e){const l=a.filter(c=>c.output!==s);l.length===0?e.delete(o):e.set(o,l)}else if(e.has(s))if(r===void 0)e.delete(s);else{const o=e.get(s);if(o!==void 0){const a=o.filter(l=>l.output!==r&&(l.input!==i||i===void 0));a.length===0?e.delete(s):e.set(s,a)}}for(const[o,a]of e)a.forEach(l=>{xi(o)?n.connect(o,l.output,l.input):n.connect(o,l.output)})})(n.disconnect)},np=(n,e,t,s)=>{const{activeInputs:r,passiveInputs:i}=li(e),{outputs:o}=hs(n),a=oi(n),l=c=>{const u=vt(n),h=ti(e);if(c){const f=_u(i,n,t);Ba(r,n,f,!1),!s&&!ur(n)&&u.connect(h,t)}else{const f=tp(r,n,t);Ha(i,f,!1),!s&&!ur(n)&&u.disconnect(h,t)}};return gr(o,[e,t],c=>c[0]===e&&c[1]===t,!0)?(a.add(l),On(n)?Ba(r,n,[t,l],!0):Ha(i,[n,t,l],!0),!0):!1},rp=(n,e,t,s)=>{const{activeInputs:r,passiveInputs:i}=hs(e),o=pu(r[s],n,t);return o===null?[uu(i,n,t,s)[2],!1]:[o[2],!0]},ip=(n,e,t)=>{const{activeInputs:s,passiveInputs:r}=li(e),i=pu(s,n,t);return i===null?[_u(r,n,t)[1],!1]:[i[2],!0]},qo=(n,e,t,s,r)=>{const[i,o]=rp(n,t,s,r);if(i!==null&&(mu(n,i),o&&!e&&!ur(n)&&Vi(vt(n),vt(t),s,r)),On(t)){const{activeInputs:a}=hs(t);ko(t,a)}},Wo=(n,e,t,s)=>{const[r,i]=ip(n,t,s);r!==null&&(mu(n,r),i&&!e&&!ur(n)&&vt(n).disconnect(ti(t),s))},op=(n,e)=>{const t=hs(n),s=[];for(const r of t.outputs)ci(r)?qo(n,e,...r):Wo(n,e,...r),s.push(r[0]);return t.outputs.clear(),s},ap=(n,e,t)=>{const s=hs(n),r=[];for(const i of s.outputs)i[1]===t&&(ci(i)?qo(n,e,...i):Wo(n,e,...i),r.push(i[0]),s.outputs.delete(i));return r},lp=(n,e,t,s,r)=>{const i=hs(n);return Array.from(i.outputs).filter(o=>o[0]===t&&(s===void 0||o[1]===s)&&(r===void 0||o[2]===r)).map(o=>(ci(o)?qo(n,e,...o):Wo(n,e,...o),i.outputs.delete(o),o[0]))},cp=(n,e,t,s,r,i,o,a,l,c,u,h,f,d,m,_)=>class extends c{constructor(y,b,k,I){super(k),this._context=y,this._nativeAudioNode=k;const T=u(y);h(T)&&t(ja,()=>ja(T,_))!==!0&&sp(k),Vo.set(this,k),lu.set(this,new Set),y.state!=="closed"&&b&&Pr(this),n(this,I,k)}get channelCount(){return this._nativeAudioNode.channelCount}set channelCount(y){this._nativeAudioNode.channelCount=y}get channelCountMode(){return this._nativeAudioNode.channelCountMode}set channelCountMode(y){this._nativeAudioNode.channelCountMode=y}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation}set channelInterpretation(y){this._nativeAudioNode.channelInterpretation=y}get context(){return this._context}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs}connect(y,b=0,k=0){if(b<0||b>=this._nativeAudioNode.numberOfOutputs)throw r();const I=u(this._context),T=m(I);if(f(y)||d(y))throw i();if(Ri(y)){const w=vt(y);try{const M=Pi(this._nativeAudioNode,w,b,k),F=Ni(this);(T||F)&&this._nativeAudioNode.disconnect(...M),this.context.state!=="closed"&&!F&&Ni(y)&&Pr(y)}catch(M){throw M.code===12?i():M}if(e(this,y,b,k,T)){const M=l([this],y);mo(M,s(T))}return y}const C=ti(y);if(C.name==="playbackRate"&&C.maxValue===1024)throw o();try{this._nativeAudioNode.connect(C,b),(T||Ni(this))&&this._nativeAudioNode.disconnect(C,b)}catch(w){throw w.code===12?i():w}if(np(this,y,b,T)){const w=l([this],y);mo(w,s(T))}}disconnect(y,b,k){let I;const T=u(this._context),C=m(T);if(y===void 0)I=op(this,C);else if(typeof y=="number"){if(y<0||y>=this.numberOfOutputs)throw r();I=ap(this,C,y)}else{if(b!==void 0&&(b<0||b>=this.numberOfOutputs)||Ri(y)&&k!==void 0&&(k<0||k>=y.numberOfInputs))throw r();if(I=lp(this,C,y,b,k),I.length===0)throw i()}for(const A of I){const w=l([this],A);mo(w,a)}}},up=(n,e,t,s,r,i,o,a,l,c,u,h,f)=>(d,m,_,g=null,y=null)=>{const b=_.value,k=new bd(b),I=m?s(k):null,T={get defaultValue(){return b},get maxValue(){return g===null?_.maxValue:g},get minValue(){return y===null?_.minValue:y},get value(){return _.value},set value(C){_.value=C,T.setValueAtTime(C,d.context.currentTime)},cancelAndHoldAtTime(C){if(typeof _.cancelAndHoldAtTime=="function")I===null&&k.flush(d.context.currentTime),k.add(r(C)),_.cancelAndHoldAtTime(C);else{const A=Array.from(k).pop();I===null&&k.flush(d.context.currentTime),k.add(r(C));const w=Array.from(k).pop();_.cancelScheduledValues(C),A!==w&&w!==void 0&&(w.type==="exponentialRampToValue"?_.exponentialRampToValueAtTime(w.value,w.endTime):w.type==="linearRampToValue"?_.linearRampToValueAtTime(w.value,w.endTime):w.type==="setValue"?_.setValueAtTime(w.value,w.startTime):w.type==="setValueCurve"&&_.setValueCurveAtTime(w.values,w.startTime,w.duration))}return T},cancelScheduledValues(C){return I===null&&k.flush(d.context.currentTime),k.add(i(C)),_.cancelScheduledValues(C),T},exponentialRampToValueAtTime(C,A){if(C===0)throw new RangeError;if(!Number.isFinite(A)||A<0)throw new RangeError;const w=d.context.currentTime;return I===null&&k.flush(w),Array.from(k).length===0&&(k.add(c(b,w)),_.setValueAtTime(b,w)),k.add(o(C,A)),_.exponentialRampToValueAtTime(C,A),T},linearRampToValueAtTime(C,A){const w=d.context.currentTime;return I===null&&k.flush(w),Array.from(k).length===0&&(k.add(c(b,w)),_.setValueAtTime(b,w)),k.add(a(C,A)),_.linearRampToValueAtTime(C,A),T},setTargetAtTime(C,A,w){return I===null&&k.flush(d.context.currentTime),k.add(l(C,A,w)),_.setTargetAtTime(C,A,w),T},setValueAtTime(C,A){return I===null&&k.flush(d.context.currentTime),k.add(c(C,A)),_.setValueAtTime(C,A),T},setValueCurveAtTime(C,A,w){const D=C instanceof Float32Array?C:new Float32Array(C);if(h!==null&&h.name==="webkitAudioContext"){const M=A+w,F=d.context.sampleRate,q=Math.ceil(A*F),B=Math.floor(M*F),G=B-q,Y=new Float32Array(G);for(let L=0;L<G;L+=1){const K=(D.length-1)/w*((q+L)/F-A),z=Math.floor(K),Q=Math.ceil(K);Y[L]=z===Q?D[z]:(1-(K-z))*D[z]+(1-(Q-K))*D[Q]}I===null&&k.flush(d.context.currentTime),k.add(u(Y,A,w)),_.setValueCurveAtTime(Y,A,w);const U=B/F;U<M&&f(T,Y[Y.length-1],U),f(T,D[D.length-1],M)}else I===null&&k.flush(d.context.currentTime),k.add(u(D,A,w)),_.setValueCurveAtTime(D,A,w);return T}};return t.set(T,_),e.set(T,d),n(T,I),T},hp=n=>({replay(e){for(const t of n)if(t.type==="exponentialRampToValue"){const{endTime:s,value:r}=t;e.exponentialRampToValueAtTime(r,s)}else if(t.type==="linearRampToValue"){const{endTime:s,value:r}=t;e.linearRampToValueAtTime(r,s)}else if(t.type==="setTarget"){const{startTime:s,target:r,timeConstant:i}=t;e.setTargetAtTime(r,s,i)}else if(t.type==="setValue"){const{startTime:s,value:r}=t;e.setValueAtTime(r,s)}else if(t.type==="setValueCurve"){const{duration:s,startTime:r,values:i}=t;e.setValueCurveAtTime(i,r,s)}else throw new Error("Can't apply an unknown automation.")}});class gu{constructor(e){this._map=new Map(e)}get size(){return this._map.size}entries(){return this._map.entries()}forEach(e,t=null){return this._map.forEach((s,r)=>e.call(t,s,r,this))}get(e){return this._map.get(e)}has(e){return this._map.has(e)}keys(){return this._map.keys()}values(){return this._map.values()}}const fp={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:1,numberOfOutputs:1,parameterData:{},processorOptions:{}},dp=(n,e,t,s,r,i,o,a,l,c,u,h,f,d)=>class extends e{constructor(_,g,y){var b;const k=a(_),I=l(k),T=u({...fp,...y});f(T);const C=Co.get(k),A=C==null?void 0:C.get(g),w=I||k.state!=="closed"?k:(b=o(k))!==null&&b!==void 0?b:k,D=r(w,I?null:_.baseLatency,c,g,A,T),M=I?s(g,T,A):null;super(_,!0,D,M);const F=[];D.parameters.forEach((B,G)=>{const Y=t(this,I,B);F.push([G,Y])}),this._nativeAudioWorkletNode=D,this._onprocessorerror=null,this._parameters=new gu(F),I&&n(k,this);const{activeInputs:q}=i(this);h(D,q)}get onprocessorerror(){return this._onprocessorerror}set onprocessorerror(_){const g=typeof _=="function"?d(this,_):null;this._nativeAudioWorkletNode.onprocessorerror=g;const y=this._nativeAudioWorkletNode.onprocessorerror;this._onprocessorerror=y!==null&&y===g?_:y}get parameters(){return this._parameters===null?this._nativeAudioWorkletNode.parameters:this._parameters}get port(){return this._nativeAudioWorkletNode.port}};function Fi(n,e,t,s,r){if(typeof n.copyFromChannel=="function")e[t].byteLength===0&&(e[t]=new Float32Array(128)),n.copyFromChannel(e[t],s,r);else{const i=n.getChannelData(s);if(e[t].byteLength===0)e[t]=i.slice(r,r+128);else{const o=new Float32Array(i.buffer,r*Float32Array.BYTES_PER_ELEMENT,128);e[t].set(o)}}}const vu=(n,e,t,s,r)=>{typeof n.copyToChannel=="function"?e[t].byteLength!==0&&n.copyToChannel(e[t],s,r):e[t].byteLength!==0&&n.getChannelData(s).set(e[t],r)},qi=(n,e)=>{const t=[];for(let s=0;s<n;s+=1){const r=[],i=typeof e=="number"?e:e[s];for(let o=0;o<i;o+=1)r.push(new Float32Array(128));t.push(r)}return t},pp=(n,e)=>{const t=Ys(To,n),s=vt(e);return Ys(t,s)},mp=async(n,e,t,s,r,i,o)=>{const a=e===null?Math.ceil(n.context.length/128)*128:e.length,l=s.channelCount*s.numberOfInputs,c=r.reduce((g,y)=>g+y,0),u=c===0?null:t.createBuffer(c,a,t.sampleRate);if(i===void 0)throw new Error("Missing the processor constructor.");const h=hs(n),f=await pp(t,n),d=qi(s.numberOfInputs,s.channelCount),m=qi(s.numberOfOutputs,r),_=Array.from(n.parameters.keys()).reduce((g,y)=>({...g,[y]:new Float32Array(128)}),{});for(let g=0;g<a;g+=128){if(s.numberOfInputs>0&&e!==null)for(let y=0;y<s.numberOfInputs;y+=1)for(let b=0;b<s.channelCount;b+=1)Fi(e,d[y],b,b,g);i.parameterDescriptors!==void 0&&e!==null&&i.parameterDescriptors.forEach(({name:y},b)=>{Fi(e,_,y,l+b,g)});for(let y=0;y<s.numberOfInputs;y+=1)for(let b=0;b<r[y];b+=1)m[y][b].byteLength===0&&(m[y][b]=new Float32Array(128));try{const y=d.map((k,I)=>h.activeInputs[I].size===0?[]:k),b=o(g/t.sampleRate,t.sampleRate,()=>f.process(y,m,_));if(u!==null)for(let k=0,I=0;k<s.numberOfOutputs;k+=1){for(let T=0;T<r[k];T+=1)vu(u,m[k],T,I+T,g);I+=r[k]}if(!b)break}catch(y){n.dispatchEvent(new ErrorEvent("processorerror",{colno:y.colno,filename:y.filename,lineno:y.lineno,message:y.message}));break}}return u},_p=(n,e,t,s,r,i,o,a,l,c,u,h,f,d,m,_)=>(g,y,b)=>{const k=new WeakMap;let I=null;const T=async(C,A)=>{let w=u(C),D=null;const M=os(w,A),F=Array.isArray(y.outputChannelCount)?y.outputChannelCount:Array.from(y.outputChannelCount);if(h===null){const q=F.reduce((U,L)=>U+L,0),B=r(A,{channelCount:Math.max(1,q),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,q)}),G=[];for(let U=0;U<C.numberOfOutputs;U+=1)G.push(s(A,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:F[U]}));const Y=o(A,{channelCount:y.channelCount,channelCountMode:y.channelCountMode,channelInterpretation:y.channelInterpretation,gain:1});Y.connect=e.bind(null,G),Y.disconnect=l.bind(null,G),D=[B,G,Y]}else M||(w=new h(A,g));if(k.set(A,D===null?w:D[2]),D!==null){if(I===null){if(b===void 0)throw new Error("Missing the processor constructor.");if(f===null)throw new Error("Missing the native OfflineAudioContext constructor.");const L=C.channelCount*C.numberOfInputs,K=b.parameterDescriptors===void 0?0:b.parameterDescriptors.length,z=L+K;I=mp(C,z===0?null:await(async()=>{const te=new f(z,Math.ceil(C.context.length/128)*128,A.sampleRate),ce=[],ve=[];for(let me=0;me<y.numberOfInputs;me+=1)ce.push(o(te,{channelCount:y.channelCount,channelCountMode:y.channelCountMode,channelInterpretation:y.channelInterpretation,gain:1})),ve.push(r(te,{channelCount:y.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:y.channelCount}));const Ce=await Promise.all(Array.from(C.parameters.values()).map(async me=>{const be=i(te,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:me.value});return await d(te,me,be.offset),be})),ye=s(te,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,L+K)});for(let me=0;me<y.numberOfInputs;me+=1){ce[me].connect(ve[me]);for(let be=0;be<y.channelCount;be+=1)ve[me].connect(ye,be,me*y.channelCount+be)}for(const[me,be]of Ce.entries())be.connect(ye,0,L+me),be.start(0);return ye.connect(te.destination),await Promise.all(ce.map(me=>m(C,te,me))),_(te)})(),A,y,F,b,c)}const q=await I,B=t(A,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),[G,Y,U]=D;q!==null&&(B.buffer=q,B.start(0)),B.connect(G);for(let L=0,K=0;L<C.numberOfOutputs;L+=1){const z=Y[L];for(let Q=0;Q<F[L];Q+=1)G.connect(z,K+Q,Q);K+=F[L]}return U}if(M)for(const[q,B]of C.parameters.entries())await n(A,B,w.parameters.get(q));else for(const[q,B]of C.parameters.entries())await d(A,B,w.parameters.get(q));return await m(C,A,w),w};return{render(C,A){a(A,C);const w=k.get(A);return w!==void 0?Promise.resolve(w):T(C,A)}}},gp=(n,e,t,s,r,i,o,a,l,c,u,h,f,d,m,_,g,y,b,k)=>class extends m{constructor(T,C){super(T,C),this._nativeContext=T,this._audioWorklet=n===void 0?void 0:{addModule:(A,w)=>n(this,A,w)}}get audioWorklet(){return this._audioWorklet}createAnalyser(){return new e(this)}createBiquadFilter(){return new r(this)}createBuffer(T,C,A){return new t({length:C,numberOfChannels:T,sampleRate:A})}createBufferSource(){return new s(this)}createChannelMerger(T=6){return new i(this,{numberOfInputs:T})}createChannelSplitter(T=6){return new o(this,{numberOfOutputs:T})}createConstantSource(){return new a(this)}createConvolver(){return new l(this)}createDelay(T=1){return new u(this,{maxDelayTime:T})}createDynamicsCompressor(){return new h(this)}createGain(){return new f(this)}createIIRFilter(T,C){return new d(this,{feedback:C,feedforward:T})}createOscillator(){return new _(this)}createPanner(){return new g(this)}createPeriodicWave(T,C,A={disableNormalization:!1}){return new y(this,{...A,imag:C,real:T})}createStereoPanner(){return new b(this)}createWaveShaper(){return new k(this)}decodeAudioData(T,C,A){return c(this._nativeContext,T).then(w=>(typeof C=="function"&&C(w),w),w=>{throw typeof A=="function"&&A(w),w})}},vp={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},yp=(n,e,t,s,r,i,o,a)=>class extends n{constructor(c,u){const h=i(c),f={...vp,...u},d=r(h,f),m=o(h),_=m?t():null;super(c,!1,d,_),this._Q=e(this,m,d.Q,us,gs),this._detune=e(this,m,d.detune,1200*Math.log2(us),-1200*Math.log2(us)),this._frequency=e(this,m,d.frequency,c.sampleRate/2,0),this._gain=e(this,m,d.gain,40*Math.log10(us),gs),this._nativeBiquadFilterNode=d,a(this,1)}get detune(){return this._detune}get frequency(){return this._frequency}get gain(){return this._gain}get Q(){return this._Q}get type(){return this._nativeBiquadFilterNode.type}set type(c){this._nativeBiquadFilterNode.type=c}getFrequencyResponse(c,u,h){try{this._nativeBiquadFilterNode.getFrequencyResponse(c,u,h)}catch(f){throw f.code===11?s():f}if(c.length!==u.length||u.length!==h.length)throw s()}},bp=(n,e,t,s,r)=>()=>{const i=new WeakMap,o=async(a,l)=>{let c=t(a);const u=os(c,l);if(!u){const h={Q:c.Q.value,channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,detune:c.detune.value,frequency:c.frequency.value,gain:c.gain.value,type:c.type};c=e(l,h)}return i.set(l,c),u?(await n(l,a.Q,c.Q),await n(l,a.detune,c.detune),await n(l,a.frequency,c.frequency),await n(l,a.gain,c.gain)):(await s(l,a.Q,c.Q),await s(l,a.detune,c.detune),await s(l,a.frequency,c.frequency),await s(l,a.gain,c.gain)),await r(a,l,c),c};return{render(a,l){const c=i.get(l);return c!==void 0?Promise.resolve(c):o(a,l)}}},Sp=(n,e)=>(t,s)=>{const r=e.get(t);if(r!==void 0)return r;const i=n.get(t);if(i!==void 0)return i;try{const o=s();return o instanceof Promise?(n.set(t,o),o.catch(()=>!1).then(a=>(n.delete(t),e.set(t,a),a))):(e.set(t,o),o)}catch{return e.set(t,!1),!1}},wp={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},Cp=(n,e,t,s,r)=>class extends n{constructor(o,a){const l=s(o),c={...wp,...a},u=t(l,c),h=r(l)?e():null;super(o,!1,u,h)}},Tp=(n,e,t)=>()=>{const s=new WeakMap,r=async(i,o)=>{let a=e(i);if(!os(a,o)){const c={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,numberOfInputs:a.numberOfInputs};a=n(o,c)}return s.set(o,a),await t(i,o,a),a};return{render(i,o){const a=s.get(o);return a!==void 0?Promise.resolve(a):r(i,o)}}},kp={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},Ap=(n,e,t,s,r,i)=>class extends n{constructor(a,l){const c=s(a),u=i({...kp,...l}),h=t(c,u),f=r(c)?e():null;super(a,!1,h,f)}},Np=(n,e,t)=>()=>{const s=new WeakMap,r=async(i,o)=>{let a=e(i);if(!os(a,o)){const c={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,numberOfOutputs:a.numberOfOutputs};a=n(o,c)}return s.set(o,a),await t(i,o,a),a};return{render(i,o){const a=s.get(o);return a!==void 0?Promise.resolve(a):r(i,o)}}},Ep=n=>(e,t,s)=>n(t,e,s),Ip=n=>(e,t,s=0,r=0)=>{const i=e[s];if(i===void 0)throw n();return xi(t)?i.connect(t,0,r):i.connect(t,0)},Dp=n=>(e,t)=>{const s=n(e,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),r=e.createBuffer(1,2,44100);return s.buffer=r,s.loop=!0,s.connect(t),s.start(),()=>{s.stop(),s.disconnect(t)}},Mp={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},$p=(n,e,t,s,r,i,o)=>class extends n{constructor(l,c){const u=r(l),h={...Mp,...c},f=s(u,h),d=i(u),m=d?t():null;super(l,!1,f,m),this._constantSourceNodeRenderer=m,this._nativeConstantSourceNode=f,this._offset=e(this,d,f.offset,us,gs),this._onended=null}get offset(){return this._offset}get onended(){return this._onended}set onended(l){const c=typeof l=="function"?o(this,l):null;this._nativeConstantSourceNode.onended=c;const u=this._nativeConstantSourceNode.onended;this._onended=u!==null&&u===c?l:u}start(l=0){if(this._nativeConstantSourceNode.start(l),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.start=l),this.context.state!=="closed"){Pr(this);const c=()=>{this._nativeConstantSourceNode.removeEventListener("ended",c),On(this)&&ai(this)};this._nativeConstantSourceNode.addEventListener("ended",c)}}stop(l=0){this._nativeConstantSourceNode.stop(l),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.stop=l)}},Op=(n,e,t,s,r)=>()=>{const i=new WeakMap;let o=null,a=null;const l=async(c,u)=>{let h=t(c);const f=os(h,u);if(!f){const d={channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,offset:h.offset.value};h=e(u,d),o!==null&&h.start(o),a!==null&&h.stop(a)}return i.set(u,h),f?await n(u,c.offset,h.offset):await s(u,c.offset,h.offset),await r(c,u,h),h};return{set start(c){o=c},set stop(c){a=c},render(c,u){const h=i.get(u);return h!==void 0?Promise.resolve(h):l(c,u)}}},Rp=n=>e=>(n[0]=e,n[0]),Pp={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},Vp=(n,e,t,s,r,i)=>class extends n{constructor(a,l){const c=s(a),u={...Pp,...l},h=t(c,u),d=r(c)?e():null;super(a,!1,h,d),this._isBufferNullified=!1,this._nativeConvolverNode=h,u.buffer!==null&&i(this,u.buffer.duration)}get buffer(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer}set buffer(a){if(this._nativeConvolverNode.buffer=a,a===null&&this._nativeConvolverNode.buffer!==null){const l=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=l.createBuffer(1,1,l.sampleRate),this._isBufferNullified=!0,i(this,0)}else this._isBufferNullified=!1,i(this,this._nativeConvolverNode.buffer===null?0:this._nativeConvolverNode.buffer.duration)}get normalize(){return this._nativeConvolverNode.normalize}set normalize(a){this._nativeConvolverNode.normalize=a}},xp=(n,e,t)=>()=>{const s=new WeakMap,r=async(i,o)=>{let a=e(i);if(!os(a,o)){const c={buffer:a.buffer,channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,disableNormalization:!a.normalize};a=n(o,c)}return s.set(o,a),jr(a)?await t(i,o,a.inputs[0]):await t(i,o,a),a};return{render(i,o){const a=s.get(o);return a!==void 0?Promise.resolve(a):r(i,o)}}},Fp=(n,e)=>(t,s,r)=>{if(e===null)throw new Error("Missing the native OfflineAudioContext constructor.");try{return new e(t,s,r)}catch(i){throw i.name==="SyntaxError"?n():i}},qp=()=>new DOMException("","DataCloneError"),Ua=n=>{const{port1:e,port2:t}=new MessageChannel;return new Promise(s=>{const r=()=>{t.onmessage=null,e.close(),t.close(),s()};t.onmessage=()=>r();try{e.postMessage(n,[n])}catch{}finally{r()}})},Wp=(n,e,t,s,r,i,o,a,l,c,u)=>(h,f)=>{const d=o(h)?h:i(h);if(r.has(f)){const m=t();return Promise.reject(m)}try{r.add(f)}catch{}return e(l,()=>l(d))?d.decodeAudioData(f).then(m=>(Ua(f).catch(()=>{}),e(a,()=>a(m))||u(m),n.add(m),m)):new Promise((m,_)=>{const g=async()=>{try{await Ua(f)}catch{}},y=b=>{_(b),g()};try{d.decodeAudioData(f,b=>{typeof b.copyFromChannel!="function"&&(c(b),Fo(b)),n.add(b),g().then(()=>m(b))},b=>{y(b===null?s():b)})}catch(b){y(b)}})},Lp=(n,e,t,s,r,i,o,a)=>(l,c)=>{const u=e.get(l);if(u===void 0)throw new Error("Missing the expected cycle count.");const h=i(l.context),f=a(h);if(u===c){if(e.delete(l),!f&&o(l)){const d=s(l),{outputs:m}=t(l);for(const _ of m)if(ci(_)){const g=s(_[0]);n(d,g,_[1],_[2])}else{const g=r(_[0]);d.connect(g,_[1])}}}else e.set(l,u-c)},Bp={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},Hp=(n,e,t,s,r,i,o)=>class extends n{constructor(l,c){const u=r(l),h={...Bp,...c},f=s(u,h),d=i(u),m=d?t(h.maxDelayTime):null;super(l,!1,f,m),this._delayTime=e(this,d,f.delayTime),o(this,h.maxDelayTime)}get delayTime(){return this._delayTime}},jp=(n,e,t,s,r)=>i=>{const o=new WeakMap,a=async(l,c)=>{let u=t(l);const h=os(u,c);if(!h){const f={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,delayTime:u.delayTime.value,maxDelayTime:i};u=e(c,f)}return o.set(c,u),h?await n(c,l.delayTime,u.delayTime):await s(c,l.delayTime,u.delayTime),await r(l,c,u),u};return{render(l,c){const u=o.get(c);return u!==void 0?Promise.resolve(u):a(l,c)}}},Up=n=>(e,t,s,r)=>n(e[r],i=>i[0]===t&&i[1]===s),zp=n=>(e,t)=>{n(e).delete(t)},Gp=n=>"delayTime"in n,Zp=(n,e,t)=>function s(r,i){const o=Ri(i)?i:t(n,i);if(Gp(o))return[];if(r[0]===o)return[r];if(r.includes(o))return[];const{outputs:a}=e(o);return Array.from(a).map(l=>s([...r,o],l[0])).reduce((l,c)=>l.concat(c),[])},wi=(n,e,t)=>{const s=e[t];if(s===void 0)throw n();return s},Xp=n=>(e,t=void 0,s=void 0,r=0)=>t===void 0?e.forEach(i=>i.disconnect()):typeof t=="number"?wi(n,e,t).disconnect():xi(t)?s===void 0?e.forEach(i=>i.disconnect(t)):r===void 0?wi(n,e,s).disconnect(t,0):wi(n,e,s).disconnect(t,0,r):s===void 0?e.forEach(i=>i.disconnect(t)):wi(n,e,s).disconnect(t,0),Yp={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},Qp=(n,e,t,s,r,i,o,a)=>class extends n{constructor(c,u){const h=i(c),f={...Yp,...u},d=s(h,f),m=o(h),_=m?t():null;super(c,!1,d,_),this._attack=e(this,m,d.attack),this._knee=e(this,m,d.knee),this._nativeDynamicsCompressorNode=d,this._ratio=e(this,m,d.ratio),this._release=e(this,m,d.release),this._threshold=e(this,m,d.threshold),a(this,.006)}get attack(){return this._attack}get channelCount(){return this._nativeDynamicsCompressorNode.channelCount}set channelCount(c){const u=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=c,c>2)throw this._nativeDynamicsCompressorNode.channelCount=u,r()}get channelCountMode(){return this._nativeDynamicsCompressorNode.channelCountMode}set channelCountMode(c){const u=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=c,c==="max")throw this._nativeDynamicsCompressorNode.channelCountMode=u,r()}get knee(){return this._knee}get ratio(){return this._ratio}get reduction(){return typeof this._nativeDynamicsCompressorNode.reduction.value=="number"?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}get release(){return this._release}get threshold(){return this._threshold}},Jp=(n,e,t,s,r)=>()=>{const i=new WeakMap,o=async(a,l)=>{let c=t(a);const u=os(c,l);if(!u){const h={attack:c.attack.value,channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,knee:c.knee.value,ratio:c.ratio.value,release:c.release.value,threshold:c.threshold.value};c=e(l,h)}return i.set(l,c),u?(await n(l,a.attack,c.attack),await n(l,a.knee,c.knee),await n(l,a.ratio,c.ratio),await n(l,a.release,c.release),await n(l,a.threshold,c.threshold)):(await s(l,a.attack,c.attack),await s(l,a.knee,c.knee),await s(l,a.ratio,c.ratio),await s(l,a.release,c.release),await s(l,a.threshold,c.threshold)),await r(a,l,c),c};return{render(a,l){const c=i.get(l);return c!==void 0?Promise.resolve(c):o(a,l)}}},Kp=()=>new DOMException("","EncodingError"),em=n=>e=>new Promise((t,s)=>{if(n===null){s(new SyntaxError);return}const r=n.document.head;if(r===null)s(new SyntaxError);else{const i=n.document.createElement("script"),o=new Blob([e],{type:"application/javascript"}),a=URL.createObjectURL(o),l=n.onerror,c=()=>{n.onerror=l,URL.revokeObjectURL(a)};n.onerror=(u,h,f,d,m)=>{if(h===a||h===n.location.href&&f===1&&d===1)return c(),s(m),!1;if(l!==null)return l(u,h,f,d,m)},i.onerror=()=>{c(),s(new SyntaxError)},i.onload=()=>{c(),t()},i.src=a,i.type="module",r.appendChild(i)}}),tm=n=>class{constructor(t){this._nativeEventTarget=t,this._listeners=new WeakMap}addEventListener(t,s,r){if(s!==null){let i=this._listeners.get(s);i===void 0&&(i=n(this,s),typeof s=="function"&&this._listeners.set(s,i)),this._nativeEventTarget.addEventListener(t,i,r)}}dispatchEvent(t){return this._nativeEventTarget.dispatchEvent(t)}removeEventListener(t,s,r){const i=s===null?void 0:this._listeners.get(s);this._nativeEventTarget.removeEventListener(t,i===void 0?null:i,r)}},sm=n=>(e,t,s)=>{Object.defineProperties(n,{currentFrame:{configurable:!0,get(){return Math.round(e*t)}},currentTime:{configurable:!0,get(){return e}}});try{return s()}finally{n!==null&&(delete n.currentFrame,delete n.currentTime)}},nm=n=>async e=>{try{const t=await fetch(e);if(t.ok)return[await t.text(),t.url]}catch{}throw n()},rm={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},im=(n,e,t,s,r,i)=>class extends n{constructor(a,l){const c=r(a),u={...rm,...l},h=s(c,u),f=i(c),d=f?t():null;super(a,!1,h,d),this._gain=e(this,f,h.gain,us,gs)}get gain(){return this._gain}},om=(n,e,t,s,r)=>()=>{const i=new WeakMap,o=async(a,l)=>{let c=t(a);const u=os(c,l);if(!u){const h={channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,gain:c.gain.value};c=e(l,h)}return i.set(l,c),u?await n(l,a.gain,c.gain):await s(l,a.gain,c.gain),await r(a,l,c),c};return{render(a,l){const c=i.get(l);return c!==void 0?Promise.resolve(c):o(a,l)}}},am=(n,e)=>t=>e(n,t),lm=n=>e=>{const t=n(e);if(t.renderer===null)throw new Error("Missing the renderer of the given AudioNode in the audio graph.");return t.renderer},cm=n=>e=>{var t;return(t=n.get(e))!==null&&t!==void 0?t:0},um=n=>e=>{const t=n(e);if(t.renderer===null)throw new Error("Missing the renderer of the given AudioParam in the audio graph.");return t.renderer},hm=n=>e=>n.get(e),zt=()=>new DOMException("","InvalidStateError"),fm=n=>e=>{const t=n.get(e);if(t===void 0)throw zt();return t},dm=(n,e)=>t=>{let s=n.get(t);if(s!==void 0)return s;if(e===null)throw new Error("Missing the native OfflineAudioContext constructor.");return s=new e(1,1,44100),n.set(t,s),s},pm=n=>e=>{const t=n.get(e);if(t===void 0)throw new Error("The context has no set of AudioWorkletNodes.");return t},zi=()=>new DOMException("","InvalidAccessError"),mm=n=>{n.getFrequencyResponse=(e=>(t,s,r)=>{if(t.length!==s.length||s.length!==r.length)throw zi();return e.call(n,t,s,r)})(n.getFrequencyResponse)},_m={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},gm=(n,e,t,s,r,i)=>class extends n{constructor(a,l){const c=s(a),u=r(c),h={..._m,...l},f=e(c,u?null:a.baseLatency,h),d=u?t(h.feedback,h.feedforward):null;super(a,!1,f,d),mm(f),this._nativeIIRFilterNode=f,i(this,1)}getFrequencyResponse(a,l,c){return this._nativeIIRFilterNode.getFrequencyResponse(a,l,c)}},yu=(n,e,t,s,r,i,o,a,l,c,u)=>{const h=c.length;let f=a;for(let d=0;d<h;d+=1){let m=t[0]*c[d];for(let _=1;_<r;_+=1){const g=f-_&l-1;m+=t[_]*i[g],m-=n[_]*o[g]}for(let _=r;_<s;_+=1)m+=t[_]*i[f-_&l-1];for(let _=r;_<e;_+=1)m-=n[_]*o[f-_&l-1];i[f]=c[d],o[f]=m,f=f+1&l-1,u[d]=m}return f},vm=(n,e,t,s)=>{const r=t instanceof Float64Array?t:new Float64Array(t),i=s instanceof Float64Array?s:new Float64Array(s),o=r.length,a=i.length,l=Math.min(o,a);if(r[0]!==1){for(let m=0;m<o;m+=1)i[m]/=r[0];for(let m=1;m<a;m+=1)r[m]/=r[0]}const c=32,u=new Float32Array(c),h=new Float32Array(c),f=e.createBuffer(n.numberOfChannels,n.length,n.sampleRate),d=n.numberOfChannels;for(let m=0;m<d;m+=1){const _=n.getChannelData(m),g=f.getChannelData(m);u.fill(0),h.fill(0),yu(r,o,i,a,l,u,h,0,c,_,g)}return f},ym=(n,e,t,s,r)=>(i,o)=>{const a=new WeakMap;let l=null;const c=async(u,h)=>{let f=null,d=e(u);const m=os(d,h);if(h.createIIRFilter===void 0?f=n(h,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):m||(d=h.createIIRFilter(o,i)),a.set(h,f===null?d:f),f!==null){if(l===null){if(t===null)throw new Error("Missing the native OfflineAudioContext constructor.");const g=new t(u.context.destination.channelCount,u.context.length,h.sampleRate);l=(async()=>{await s(u,g,g.destination);const y=await r(g);return vm(y,h,i,o)})()}const _=await l;return f.buffer=_,f.start(0),f}return await s(u,h,d),d};return{render(u,h){const f=a.get(h);return f!==void 0?Promise.resolve(f):c(u,h)}}},bm=(n,e,t,s,r,i)=>o=>(a,l)=>{const c=n.get(a);if(c===void 0){if(!o&&i(a)){const u=s(a),{outputs:h}=t(a);for(const f of h)if(ci(f)){const d=s(f[0]);e(u,d,f[1],f[2])}else{const d=r(f[0]);u.disconnect(d,f[1])}}n.set(a,l)}else n.set(a,c+l)},Sm=(n,e)=>t=>{const s=n.get(t);return e(s)||e(t)},wm=(n,e)=>t=>n.has(t)||e(t),Cm=(n,e)=>t=>n.has(t)||e(t),Tm=(n,e)=>t=>{const s=n.get(t);return e(s)||e(t)},km=n=>e=>n!==null&&e instanceof n,Am=n=>e=>n!==null&&typeof n.AudioNode=="function"&&e instanceof n.AudioNode,Nm=n=>e=>n!==null&&typeof n.AudioParam=="function"&&e instanceof n.AudioParam,Em=(n,e)=>t=>n(t)||e(t),Im=n=>e=>n!==null&&e instanceof n,Dm=n=>n!==null&&n.isSecureContext,Mm=(n,e,t,s)=>class extends n{constructor(i,o){const a=t(i),l=e(a,o);if(s(a))throw TypeError();super(i,!0,l,null),this._nativeMediaElementAudioSourceNode=l}get mediaElement(){return this._nativeMediaElementAudioSourceNode.mediaElement}},$m={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers"},Om=(n,e,t,s)=>class extends n{constructor(i,o){const a=t(i);if(s(a))throw new TypeError;const l={...$m,...o},c=e(a,l);super(i,!1,c,null),this._nativeMediaStreamAudioDestinationNode=c}get stream(){return this._nativeMediaStreamAudioDestinationNode.stream}},Rm=(n,e,t,s)=>class extends n{constructor(i,o){const a=t(i),l=e(a,o);if(s(a))throw new TypeError;super(i,!0,l,null),this._nativeMediaStreamAudioSourceNode=l}get mediaStream(){return this._nativeMediaStreamAudioSourceNode.mediaStream}},Pm=(n,e,t)=>class extends n{constructor(r,i){const o=t(r),a=e(o,i);super(r,!0,a,null)}},Vm=(n,e,t,s,r,i)=>class extends t{constructor(a,l){super(a),this._nativeContext=a,ji.set(this,a),s(a)&&r.set(a,new Set),this._destination=new n(this,l),this._listener=e(this,a),this._onstatechange=null}get currentTime(){return this._nativeContext.currentTime}get destination(){return this._destination}get listener(){return this._listener}get onstatechange(){return this._onstatechange}set onstatechange(a){const l=typeof a=="function"?i(this,a):null;this._nativeContext.onstatechange=l;const c=this._nativeContext.onstatechange;this._onstatechange=c!==null&&c===l?a:c}get sampleRate(){return this._nativeContext.sampleRate}get state(){return this._nativeContext.state}},si=n=>{const e=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{const t=n.decodeAudioData(e.buffer,()=>{});return t===void 0?!1:(t.catch(()=>{}),!0)}catch{}return!1},xm=(n,e)=>(t,s,r)=>{const i=new Set;return t.connect=(o=>(a,l=0,c=0)=>{const u=i.size===0;if(e(a))return o.call(t,a,l,c),n(i,[a,l,c],h=>h[0]===a&&h[1]===l&&h[2]===c,!0),u&&s(),a;o.call(t,a,l),n(i,[a,l],h=>h[0]===a&&h[1]===l,!0),u&&s()})(t.connect),t.disconnect=(o=>(a,l,c)=>{const u=i.size>0;if(a===void 0)o.apply(t),i.clear();else if(typeof a=="number"){o.call(t,a);for(const f of i)f[1]===a&&i.delete(f)}else{e(a)?o.call(t,a,l,c):o.call(t,a,l);for(const f of i)f[0]===a&&(l===void 0||f[1]===l)&&(c===void 0||f[2]===c)&&i.delete(f)}const h=i.size===0;u&&h&&r()})(t.disconnect),t},bt=(n,e,t)=>{const s=e[t];s!==void 0&&s!==n[t]&&(n[t]=s)},jt=(n,e)=>{bt(n,e,"channelCount"),bt(n,e,"channelCountMode"),bt(n,e,"channelInterpretation")},za=n=>typeof n.getFloatTimeDomainData=="function",Fm=n=>{n.getFloatTimeDomainData=e=>{const t=new Uint8Array(e.length);n.getByteTimeDomainData(t);const s=Math.max(t.length,n.fftSize);for(let r=0;r<s;r+=1)e[r]=(t[r]-128)*.0078125;return e}},qm=(n,e)=>(t,s)=>{const r=t.createAnalyser();if(jt(r,s),!(s.maxDecibels>s.minDecibels))throw e();return bt(r,s,"fftSize"),bt(r,s,"maxDecibels"),bt(r,s,"minDecibels"),bt(r,s,"smoothingTimeConstant"),n(za,()=>za(r))||Fm(r),r},Wm=n=>n===null?null:n.hasOwnProperty("AudioBuffer")?n.AudioBuffer:null,Nt=(n,e,t)=>{const s=e[t];s!==void 0&&s!==n[t].value&&(n[t].value=s)},Lm=n=>{n.start=(e=>{let t=!1;return(s=0,r=0,i)=>{if(t)throw zt();e.call(n,s,r,i),t=!0}})(n.start)},Lo=n=>{n.start=(e=>(t=0,s=0,r)=>{if(typeof r=="number"&&r<0||s<0||t<0)throw new RangeError("The parameters can't be negative.");e.call(n,t,s,r)})(n.start)},Bo=n=>{n.stop=(e=>(t=0)=>{if(t<0)throw new RangeError("The parameter can't be negative.");e.call(n,t)})(n.stop)},Bm=(n,e,t,s,r,i,o,a,l,c,u)=>(h,f)=>{const d=h.createBufferSource();return jt(d,f),Nt(d,f,"playbackRate"),bt(d,f,"buffer"),bt(d,f,"loop"),bt(d,f,"loopEnd"),bt(d,f,"loopStart"),e(t,()=>t(h))||Lm(d),e(s,()=>s(h))||l(d),e(r,()=>r(h))||c(d,h),e(i,()=>i(h))||Lo(d),e(o,()=>o(h))||u(d,h),e(a,()=>a(h))||Bo(d),n(h,d),d},Hm=n=>n===null?null:n.hasOwnProperty("AudioContext")?n.AudioContext:n.hasOwnProperty("webkitAudioContext")?n.webkitAudioContext:null,jm=(n,e)=>(t,s,r)=>{const i=t.destination;if(i.channelCount!==s)try{i.channelCount=s}catch{}r&&i.channelCountMode!=="explicit"&&(i.channelCountMode="explicit"),i.maxChannelCount===0&&Object.defineProperty(i,"maxChannelCount",{value:s});const o=n(t,{channelCount:s,channelCountMode:i.channelCountMode,channelInterpretation:i.channelInterpretation,gain:1});return e(o,"channelCount",a=>()=>a.call(o),a=>l=>{a.call(o,l);try{i.channelCount=l}catch(c){if(l>i.maxChannelCount)throw c}}),e(o,"channelCountMode",a=>()=>a.call(o),a=>l=>{a.call(o,l),i.channelCountMode=l}),e(o,"channelInterpretation",a=>()=>a.call(o),a=>l=>{a.call(o,l),i.channelInterpretation=l}),Object.defineProperty(o,"maxChannelCount",{get:()=>i.maxChannelCount}),o.connect(i),o},Um=n=>n===null?null:n.hasOwnProperty("AudioWorkletNode")?n.AudioWorkletNode:null,zm=n=>{const{port1:e}=new MessageChannel;try{e.postMessage(n)}finally{e.close()}},Gm=(n,e,t,s,r)=>(i,o,a,l,c,u)=>{if(a!==null)try{const h=new a(i,l,u),f=new Map;let d=null;if(Object.defineProperties(h,{channelCount:{get:()=>u.channelCount,set:()=>{throw n()}},channelCountMode:{get:()=>"explicit",set:()=>{throw n()}},onprocessorerror:{get:()=>d,set:m=>{typeof d=="function"&&h.removeEventListener("processorerror",d),d=typeof m=="function"?m:null,typeof d=="function"&&h.addEventListener("processorerror",d)}}}),h.addEventListener=(m=>(..._)=>{if(_[0]==="processorerror"){const g=typeof _[1]=="function"?_[1]:typeof _[1]=="object"&&_[1]!==null&&typeof _[1].handleEvent=="function"?_[1].handleEvent:null;if(g!==null){const y=f.get(_[1]);y!==void 0?_[1]=y:(_[1]=b=>{b.type==="error"?(Object.defineProperties(b,{type:{value:"processorerror"}}),g(b)):g(new ErrorEvent(_[0],{...b}))},f.set(g,_[1]))}}return m.call(h,"error",_[1],_[2]),m.call(h,..._)})(h.addEventListener),h.removeEventListener=(m=>(..._)=>{if(_[0]==="processorerror"){const g=f.get(_[1]);g!==void 0&&(f.delete(_[1]),_[1]=g)}return m.call(h,"error",_[1],_[2]),m.call(h,_[0],_[1],_[2])})(h.removeEventListener),u.numberOfOutputs!==0){const m=t(i,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return h.connect(m).connect(i.destination),r(h,()=>m.disconnect(),()=>m.connect(i.destination))}return h}catch(h){throw h.code===11?s():h}if(c===void 0)throw s();return zm(u),e(i,o,c,u)},bu=(n,e)=>n===null?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(n*e))))),Zm=n=>new Promise((e,t)=>{const{port1:s,port2:r}=new MessageChannel;s.onmessage=({data:i})=>{s.close(),r.close(),e(i)},s.onmessageerror=({data:i})=>{s.close(),r.close(),t(i)},r.postMessage(n)}),Xm=async(n,e)=>{const t=await Zm(e);return new n(t)},Ym=(n,e,t,s)=>{let r=To.get(n);r===void 0&&(r=new WeakMap,To.set(n,r));const i=Xm(t,s);return r.set(e,i),i},Qm=(n,e,t,s,r,i,o,a,l,c,u,h,f)=>(d,m,_,g)=>{if(g.numberOfInputs===0&&g.numberOfOutputs===0)throw l();const y=Array.isArray(g.outputChannelCount)?g.outputChannelCount:Array.from(g.outputChannelCount);if(y.some(se=>se<1))throw l();if(y.length!==g.numberOfOutputs)throw e();if(g.channelCountMode!=="explicit")throw l();const b=g.channelCount*g.numberOfInputs,k=y.reduce((se,ae)=>se+ae,0),I=_.parameterDescriptors===void 0?0:_.parameterDescriptors.length;if(b+I>6||k>6)throw l();const T=new MessageChannel,C=[],A=[];for(let se=0;se<g.numberOfInputs;se+=1)C.push(o(d,{channelCount:g.channelCount,channelCountMode:g.channelCountMode,channelInterpretation:g.channelInterpretation,gain:1})),A.push(r(d,{channelCount:g.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:g.channelCount}));const w=[];if(_.parameterDescriptors!==void 0)for(const{defaultValue:se,maxValue:ae,minValue:Me,name:we}of _.parameterDescriptors){const Te=i(d,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:g.parameterData[we]!==void 0?g.parameterData[we]:se===void 0?0:se});Object.defineProperties(Te.offset,{defaultValue:{get:()=>se===void 0?0:se},maxValue:{get:()=>ae===void 0?us:ae},minValue:{get:()=>Me===void 0?gs:Me}}),w.push(Te)}const D=s(d,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,b+I)}),M=bu(m,d.sampleRate),F=a(d,M,b+I,Math.max(1,k)),q=r(d,{channelCount:Math.max(1,k),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,k)}),B=[];for(let se=0;se<g.numberOfOutputs;se+=1)B.push(s(d,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:y[se]}));for(let se=0;se<g.numberOfInputs;se+=1){C[se].connect(A[se]);for(let ae=0;ae<g.channelCount;ae+=1)A[se].connect(D,ae,se*g.channelCount+ae)}const G=new gu(_.parameterDescriptors===void 0?[]:_.parameterDescriptors.map(({name:se},ae)=>{const Me=w[ae];return Me.connect(D,0,b+ae),Me.start(0),[se,Me.offset]}));D.connect(F);let Y=g.channelInterpretation,U=null;const L=g.numberOfOutputs===0?[F]:B,K={get bufferSize(){return M},get channelCount(){return g.channelCount},set channelCount(se){throw t()},get channelCountMode(){return g.channelCountMode},set channelCountMode(se){throw t()},get channelInterpretation(){return Y},set channelInterpretation(se){for(const ae of C)ae.channelInterpretation=se;Y=se},get context(){return F.context},get inputs(){return C},get numberOfInputs(){return g.numberOfInputs},get numberOfOutputs(){return g.numberOfOutputs},get onprocessorerror(){return U},set onprocessorerror(se){typeof U=="function"&&K.removeEventListener("processorerror",U),U=typeof se=="function"?se:null,typeof U=="function"&&K.addEventListener("processorerror",U)},get parameters(){return G},get port(){return T.port2},addEventListener(...se){return F.addEventListener(se[0],se[1],se[2])},connect:n.bind(null,L),disconnect:c.bind(null,L),dispatchEvent(...se){return F.dispatchEvent(se[0])},removeEventListener(...se){return F.removeEventListener(se[0],se[1],se[2])}},z=new Map;T.port1.addEventListener=(se=>(...ae)=>{if(ae[0]==="message"){const Me=typeof ae[1]=="function"?ae[1]:typeof ae[1]=="object"&&ae[1]!==null&&typeof ae[1].handleEvent=="function"?ae[1].handleEvent:null;if(Me!==null){const we=z.get(ae[1]);we!==void 0?ae[1]=we:(ae[1]=Te=>{u(d.currentTime,d.sampleRate,()=>Me(Te))},z.set(Me,ae[1]))}}return se.call(T.port1,ae[0],ae[1],ae[2])})(T.port1.addEventListener),T.port1.removeEventListener=(se=>(...ae)=>{if(ae[0]==="message"){const Me=z.get(ae[1]);Me!==void 0&&(z.delete(ae[1]),ae[1]=Me)}return se.call(T.port1,ae[0],ae[1],ae[2])})(T.port1.removeEventListener);let Q=null;Object.defineProperty(T.port1,"onmessage",{get:()=>Q,set:se=>{typeof Q=="function"&&T.port1.removeEventListener("message",Q),Q=typeof se=="function"?se:null,typeof Q=="function"&&(T.port1.addEventListener("message",Q),T.port1.start())}}),_.prototype.port=T.port1;let te=null;Ym(d,K,_,g).then(se=>te=se);const ve=qi(g.numberOfInputs,g.channelCount),Ce=qi(g.numberOfOutputs,y),ye=_.parameterDescriptors===void 0?[]:_.parameterDescriptors.reduce((se,{name:ae})=>({...se,[ae]:new Float32Array(128)}),{});let me=!0;const be=()=>{g.numberOfOutputs>0&&F.disconnect(q);for(let se=0,ae=0;se<g.numberOfOutputs;se+=1){const Me=B[se];for(let we=0;we<y[se];we+=1)q.disconnect(Me,ae+we,we);ae+=y[se]}},X=new Map;F.onaudioprocess=({inputBuffer:se,outputBuffer:ae})=>{if(te!==null){const Me=h(K);for(let we=0;we<M;we+=128){for(let Te=0;Te<g.numberOfInputs;Te+=1)for(let $e=0;$e<g.channelCount;$e+=1)Fi(se,ve[Te],$e,$e,we);_.parameterDescriptors!==void 0&&_.parameterDescriptors.forEach(({name:Te},$e)=>{Fi(se,ye,Te,b+$e,we)});for(let Te=0;Te<g.numberOfInputs;Te+=1)for(let $e=0;$e<y[Te];$e+=1)Ce[Te][$e].byteLength===0&&(Ce[Te][$e]=new Float32Array(128));try{const Te=ve.map((je,Je)=>{if(Me[Je].size>0)return X.set(Je,M/128),je;const Ot=X.get(Je);return Ot===void 0?[]:(je.every(Rt=>Rt.every(ut=>ut===0))&&(Ot===1?X.delete(Je):X.set(Je,Ot-1)),je)});me=u(d.currentTime+we/d.sampleRate,d.sampleRate,()=>te.process(Te,Ce,ye));for(let je=0,Je=0;je<g.numberOfOutputs;je+=1){for(let _t=0;_t<y[je];_t+=1)vu(ae,Ce[je],_t,Je+_t,we);Je+=y[je]}}catch(Te){me=!1,K.dispatchEvent(new ErrorEvent("processorerror",{colno:Te.colno,filename:Te.filename,lineno:Te.lineno,message:Te.message}))}if(!me){for(let Te=0;Te<g.numberOfInputs;Te+=1){C[Te].disconnect(A[Te]);for(let $e=0;$e<g.channelCount;$e+=1)A[we].disconnect(D,$e,Te*g.channelCount+$e)}if(_.parameterDescriptors!==void 0){const Te=_.parameterDescriptors.length;for(let $e=0;$e<Te;$e+=1){const je=w[$e];je.disconnect(D,0,b+$e),je.stop()}}D.disconnect(F),F.onaudioprocess=null,Se?be():ue();break}}}};let Se=!1;const fe=o(d,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0}),le=()=>F.connect(fe).connect(d.destination),ue=()=>{F.disconnect(fe),fe.disconnect()},De=()=>{if(me){ue(),g.numberOfOutputs>0&&F.connect(q);for(let se=0,ae=0;se<g.numberOfOutputs;se+=1){const Me=B[se];for(let we=0;we<y[se];we+=1)q.connect(Me,ae+we,we);ae+=y[se]}}Se=!0},Oe=()=>{me&&(le(),be()),Se=!1};return le(),f(K,De,Oe)},Su=(n,e)=>{const t=n.createBiquadFilter();return jt(t,e),Nt(t,e,"Q"),Nt(t,e,"detune"),Nt(t,e,"frequency"),Nt(t,e,"gain"),bt(t,e,"type"),t},Jm=(n,e)=>(t,s)=>{const r=t.createChannelMerger(s.numberOfInputs);return n!==null&&n.name==="webkitAudioContext"&&e(t,r),jt(r,s),r},Km=n=>{const e=n.numberOfOutputs;Object.defineProperty(n,"channelCount",{get:()=>e,set:t=>{if(t!==e)throw zt()}}),Object.defineProperty(n,"channelCountMode",{get:()=>"explicit",set:t=>{if(t!=="explicit")throw zt()}}),Object.defineProperty(n,"channelInterpretation",{get:()=>"discrete",set:t=>{if(t!=="discrete")throw zt()}})},ui=(n,e)=>{const t=n.createChannelSplitter(e.numberOfOutputs);return jt(t,e),Km(t),t},e_=(n,e,t,s,r)=>(i,o)=>{if(i.createConstantSource===void 0)return t(i,o);const a=i.createConstantSource();return jt(a,o),Nt(a,o,"offset"),e(s,()=>s(i))||Lo(a),e(r,()=>r(i))||Bo(a),n(i,a),a},Ur=(n,e)=>(n.connect=e.connect.bind(e),n.disconnect=e.disconnect.bind(e),n),t_=(n,e,t,s)=>(r,{offset:i,...o})=>{const a=r.createBuffer(1,2,44100),l=e(r,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),c=t(r,{...o,gain:i}),u=a.getChannelData(0);u[0]=1,u[1]=1,l.buffer=a,l.loop=!0;const h={get bufferSize(){},get channelCount(){return c.channelCount},set channelCount(m){c.channelCount=m},get channelCountMode(){return c.channelCountMode},set channelCountMode(m){c.channelCountMode=m},get channelInterpretation(){return c.channelInterpretation},set channelInterpretation(m){c.channelInterpretation=m},get context(){return c.context},get inputs(){return[]},get numberOfInputs(){return l.numberOfInputs},get numberOfOutputs(){return c.numberOfOutputs},get offset(){return c.gain},get onended(){return l.onended},set onended(m){l.onended=m},addEventListener(...m){return l.addEventListener(m[0],m[1],m[2])},dispatchEvent(...m){return l.dispatchEvent(m[0])},removeEventListener(...m){return l.removeEventListener(m[0],m[1],m[2])},start(m=0){l.start.call(l,m)},stop(m=0){l.stop.call(l,m)}},f=()=>l.connect(c),d=()=>l.disconnect(c);return n(r,l),s(Ur(h,c),f,d)},s_=(n,e)=>(t,s)=>{const r=t.createConvolver();if(jt(r,s),s.disableNormalization===r.normalize&&(r.normalize=!s.disableNormalization),bt(r,s,"buffer"),s.channelCount>2||(e(r,"channelCount",i=>()=>i.call(r),i=>o=>{if(o>2)throw n();return i.call(r,o)}),s.channelCountMode==="max"))throw n();return e(r,"channelCountMode",i=>()=>i.call(r),i=>o=>{if(o==="max")throw n();return i.call(r,o)}),r},wu=(n,e)=>{const t=n.createDelay(e.maxDelayTime);return jt(t,e),Nt(t,e,"delayTime"),t},n_=n=>(e,t)=>{const s=e.createDynamicsCompressor();if(jt(s,t),t.channelCount>2||t.channelCountMode==="max")throw n();return Nt(s,t,"attack"),Nt(s,t,"knee"),Nt(s,t,"ratio"),Nt(s,t,"release"),Nt(s,t,"threshold"),s},bs=(n,e)=>{const t=n.createGain();return jt(t,e),Nt(t,e,"gain"),t},r_=n=>(e,t,s)=>{if(e.createIIRFilter===void 0)return n(e,t,s);const r=e.createIIRFilter(s.feedforward,s.feedback);return jt(r,s),r};function i_(n,e){const t=e[0]*e[0]+e[1]*e[1];return[(n[0]*e[0]+n[1]*e[1])/t,(n[1]*e[0]-n[0]*e[1])/t]}function o_(n,e){return[n[0]*e[0]-n[1]*e[1],n[0]*e[1]+n[1]*e[0]]}function Ga(n,e){let t=[0,0];for(let s=n.length-1;s>=0;s-=1)t=o_(t,e),t[0]+=n[s];return t}const a_=(n,e,t,s)=>(r,i,{channelCount:o,channelCountMode:a,channelInterpretation:l,feedback:c,feedforward:u})=>{const h=bu(i,r.sampleRate),f=c instanceof Float64Array?c:new Float64Array(c),d=u instanceof Float64Array?u:new Float64Array(u),m=f.length,_=d.length,g=Math.min(m,_);if(m===0||m>20)throw s();if(f[0]===0)throw e();if(_===0||_>20)throw s();if(d[0]===0)throw e();if(f[0]!==1){for(let w=0;w<_;w+=1)d[w]/=f[0];for(let w=1;w<m;w+=1)f[w]/=f[0]}const y=t(r,h,o,o);y.channelCount=o,y.channelCountMode=a,y.channelInterpretation=l;const b=32,k=[],I=[],T=[];for(let w=0;w<o;w+=1){k.push(0);const D=new Float32Array(b),M=new Float32Array(b);D.fill(0),M.fill(0),I.push(D),T.push(M)}y.onaudioprocess=w=>{const D=w.inputBuffer,M=w.outputBuffer,F=D.numberOfChannels;for(let q=0;q<F;q+=1){const B=D.getChannelData(q),G=M.getChannelData(q);k[q]=yu(f,m,d,_,g,I[q],T[q],k[q],b,B,G)}};const C=r.sampleRate/2;return Ur({get bufferSize(){return h},get channelCount(){return y.channelCount},set channelCount(w){y.channelCount=w},get channelCountMode(){return y.channelCountMode},set channelCountMode(w){y.channelCountMode=w},get channelInterpretation(){return y.channelInterpretation},set channelInterpretation(w){y.channelInterpretation=w},get context(){return y.context},get inputs(){return[y]},get numberOfInputs(){return y.numberOfInputs},get numberOfOutputs(){return y.numberOfOutputs},addEventListener(...w){return y.addEventListener(w[0],w[1],w[2])},dispatchEvent(...w){return y.dispatchEvent(w[0])},getFrequencyResponse(w,D,M){if(w.length!==D.length||D.length!==M.length)throw n();const F=w.length;for(let q=0;q<F;q+=1){const B=-Math.PI*(w[q]/C),G=[Math.cos(B),Math.sin(B)],Y=Ga(d,G),U=Ga(f,G),L=i_(Y,U);D[q]=Math.sqrt(L[0]*L[0]+L[1]*L[1]),M[q]=Math.atan2(L[1],L[0])}},removeEventListener(...w){return y.removeEventListener(w[0],w[1],w[2])}},y)},l_=(n,e)=>n.createMediaElementSource(e.mediaElement),c_=(n,e)=>{const t=n.createMediaStreamDestination();return jt(t,e),t.numberOfOutputs===1&&Object.defineProperty(t,"numberOfOutputs",{get:()=>0}),t},u_=(n,{mediaStream:e})=>{const t=e.getAudioTracks();t.sort((i,o)=>i.id<o.id?-1:i.id>o.id?1:0);const s=t.slice(0,1),r=n.createMediaStreamSource(new MediaStream(s));return Object.defineProperty(r,"mediaStream",{value:e}),r},h_=(n,e)=>(t,{mediaStreamTrack:s})=>{if(typeof t.createMediaStreamTrackSource=="function")return t.createMediaStreamTrackSource(s);const r=new MediaStream([s]),i=t.createMediaStreamSource(r);if(s.kind!=="audio")throw n();if(e(t))throw new TypeError;return i},f_=n=>n===null?null:n.hasOwnProperty("OfflineAudioContext")?n.OfflineAudioContext:n.hasOwnProperty("webkitOfflineAudioContext")?n.webkitOfflineAudioContext:null,d_=(n,e,t,s,r,i)=>(o,a)=>{const l=o.createOscillator();return jt(l,a),Nt(l,a,"detune"),Nt(l,a,"frequency"),a.periodicWave!==void 0?l.setPeriodicWave(a.periodicWave):bt(l,a,"type"),e(t,()=>t(o))||Lo(l),e(s,()=>s(o))||i(l,o),e(r,()=>r(o))||Bo(l),n(o,l),l},p_=n=>(e,t)=>{const s=e.createPanner();return s.orientationX===void 0?n(e,t):(jt(s,t),Nt(s,t,"orientationX"),Nt(s,t,"orientationY"),Nt(s,t,"orientationZ"),Nt(s,t,"positionX"),Nt(s,t,"positionY"),Nt(s,t,"positionZ"),bt(s,t,"coneInnerAngle"),bt(s,t,"coneOuterAngle"),bt(s,t,"coneOuterGain"),bt(s,t,"distanceModel"),bt(s,t,"maxDistance"),bt(s,t,"panningModel"),bt(s,t,"refDistance"),bt(s,t,"rolloffFactor"),s)},m_=(n,e,t,s,r,i,o,a,l,c)=>(u,{coneInnerAngle:h,coneOuterAngle:f,coneOuterGain:d,distanceModel:m,maxDistance:_,orientationX:g,orientationY:y,orientationZ:b,panningModel:k,positionX:I,positionY:T,positionZ:C,refDistance:A,rolloffFactor:w,...D})=>{const M=u.createPanner();if(D.channelCount>2||D.channelCountMode==="max")throw o();jt(M,D);const F={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},q=t(u,{...F,channelInterpretation:"speakers",numberOfInputs:6}),B=s(u,{...D,gain:1}),G=s(u,{...F,gain:1}),Y=s(u,{...F,gain:0}),U=s(u,{...F,gain:0}),L=s(u,{...F,gain:0}),K=s(u,{...F,gain:0}),z=s(u,{...F,gain:0}),Q=r(u,256,6,1),te=i(u,{...F,curve:new Float32Array([1,1]),oversample:"none"});let ce=[g,y,b],ve=[I,T,C];const Ce=new Float32Array(1);Q.onaudioprocess=({inputBuffer:X})=>{const Se=[l(X,Ce,0),l(X,Ce,1),l(X,Ce,2)];Se.some((le,ue)=>le!==ce[ue])&&(M.setOrientation(...Se),ce=Se);const fe=[l(X,Ce,3),l(X,Ce,4),l(X,Ce,5)];fe.some((le,ue)=>le!==ve[ue])&&(M.setPosition(...fe),ve=fe)},Object.defineProperty(Y.gain,"defaultValue",{get:()=>0}),Object.defineProperty(U.gain,"defaultValue",{get:()=>0}),Object.defineProperty(L.gain,"defaultValue",{get:()=>0}),Object.defineProperty(K.gain,"defaultValue",{get:()=>0}),Object.defineProperty(z.gain,"defaultValue",{get:()=>0});const ye={get bufferSize(){},get channelCount(){return M.channelCount},set channelCount(X){if(X>2)throw o();B.channelCount=X,M.channelCount=X},get channelCountMode(){return M.channelCountMode},set channelCountMode(X){if(X==="max")throw o();B.channelCountMode=X,M.channelCountMode=X},get channelInterpretation(){return M.channelInterpretation},set channelInterpretation(X){B.channelInterpretation=X,M.channelInterpretation=X},get coneInnerAngle(){return M.coneInnerAngle},set coneInnerAngle(X){M.coneInnerAngle=X},get coneOuterAngle(){return M.coneOuterAngle},set coneOuterAngle(X){M.coneOuterAngle=X},get coneOuterGain(){return M.coneOuterGain},set coneOuterGain(X){if(X<0||X>1)throw e();M.coneOuterGain=X},get context(){return M.context},get distanceModel(){return M.distanceModel},set distanceModel(X){M.distanceModel=X},get inputs(){return[B]},get maxDistance(){return M.maxDistance},set maxDistance(X){if(X<0)throw new RangeError;M.maxDistance=X},get numberOfInputs(){return M.numberOfInputs},get numberOfOutputs(){return M.numberOfOutputs},get orientationX(){return G.gain},get orientationY(){return Y.gain},get orientationZ(){return U.gain},get panningModel(){return M.panningModel},set panningModel(X){M.panningModel=X},get positionX(){return L.gain},get positionY(){return K.gain},get positionZ(){return z.gain},get refDistance(){return M.refDistance},set refDistance(X){if(X<0)throw new RangeError;M.refDistance=X},get rolloffFactor(){return M.rolloffFactor},set rolloffFactor(X){if(X<0)throw new RangeError;M.rolloffFactor=X},addEventListener(...X){return B.addEventListener(X[0],X[1],X[2])},dispatchEvent(...X){return B.dispatchEvent(X[0])},removeEventListener(...X){return B.removeEventListener(X[0],X[1],X[2])}};h!==ye.coneInnerAngle&&(ye.coneInnerAngle=h),f!==ye.coneOuterAngle&&(ye.coneOuterAngle=f),d!==ye.coneOuterGain&&(ye.coneOuterGain=d),m!==ye.distanceModel&&(ye.distanceModel=m),_!==ye.maxDistance&&(ye.maxDistance=_),g!==ye.orientationX.value&&(ye.orientationX.value=g),y!==ye.orientationY.value&&(ye.orientationY.value=y),b!==ye.orientationZ.value&&(ye.orientationZ.value=b),k!==ye.panningModel&&(ye.panningModel=k),I!==ye.positionX.value&&(ye.positionX.value=I),T!==ye.positionY.value&&(ye.positionY.value=T),C!==ye.positionZ.value&&(ye.positionZ.value=C),A!==ye.refDistance&&(ye.refDistance=A),w!==ye.rolloffFactor&&(ye.rolloffFactor=w),(ce[0]!==1||ce[1]!==0||ce[2]!==0)&&M.setOrientation(...ce),(ve[0]!==0||ve[1]!==0||ve[2]!==0)&&M.setPosition(...ve);const me=()=>{B.connect(M),n(B,te,0,0),te.connect(G).connect(q,0,0),te.connect(Y).connect(q,0,1),te.connect(U).connect(q,0,2),te.connect(L).connect(q,0,3),te.connect(K).connect(q,0,4),te.connect(z).connect(q,0,5),q.connect(Q).connect(u.destination)},be=()=>{B.disconnect(M),a(B,te,0,0),te.disconnect(G),G.disconnect(q),te.disconnect(Y),Y.disconnect(q),te.disconnect(U),U.disconnect(q),te.disconnect(L),L.disconnect(q),te.disconnect(K),K.disconnect(q),te.disconnect(z),z.disconnect(q),q.disconnect(Q),Q.disconnect(u.destination)};return c(Ur(ye,M),me,be)},__=n=>(e,{disableNormalization:t,imag:s,real:r})=>{const i=s instanceof Float32Array?s:new Float32Array(s),o=r instanceof Float32Array?r:new Float32Array(r),a=e.createPeriodicWave(o,i,{disableNormalization:t});if(Array.from(s).length<2)throw n();return a},hi=(n,e,t,s)=>n.createScriptProcessor(e,t,s),g_=(n,e)=>(t,s)=>{const r=s.channelCountMode;if(r==="clamped-max")throw e();if(t.createStereoPanner===void 0)return n(t,s);const i=t.createStereoPanner();return jt(i,s),Nt(i,s,"pan"),Object.defineProperty(i,"channelCountMode",{get:()=>r,set:o=>{if(o!==r)throw e()}}),i},v_=(n,e,t,s,r,i)=>{const a=new Float32Array([1,1]),l=Math.PI/2,c={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},u={...c,oversample:"none"},h=(m,_,g,y)=>{const b=new Float32Array(16385),k=new Float32Array(16385);for(let D=0;D<16385;D+=1){const M=D/16384*l;b[D]=Math.cos(M),k[D]=Math.sin(M)}const I=t(m,{...c,gain:0}),T=s(m,{...u,curve:b}),C=s(m,{...u,curve:a}),A=t(m,{...c,gain:0}),w=s(m,{...u,curve:k});return{connectGraph(){_.connect(I),_.connect(C.inputs===void 0?C:C.inputs[0]),_.connect(A),C.connect(g),g.connect(T.inputs===void 0?T:T.inputs[0]),g.connect(w.inputs===void 0?w:w.inputs[0]),T.connect(I.gain),w.connect(A.gain),I.connect(y,0,0),A.connect(y,0,1)},disconnectGraph(){_.disconnect(I),_.disconnect(C.inputs===void 0?C:C.inputs[0]),_.disconnect(A),C.disconnect(g),g.disconnect(T.inputs===void 0?T:T.inputs[0]),g.disconnect(w.inputs===void 0?w:w.inputs[0]),T.disconnect(I.gain),w.disconnect(A.gain),I.disconnect(y,0,0),A.disconnect(y,0,1)}}},f=(m,_,g,y)=>{const b=new Float32Array(16385),k=new Float32Array(16385),I=new Float32Array(16385),T=new Float32Array(16385),C=Math.floor(16385/2);for(let L=0;L<16385;L+=1)if(L>C){const K=(L-C)/(16384-C)*l;b[L]=Math.cos(K),k[L]=Math.sin(K),I[L]=0,T[L]=1}else{const K=L/(16384-C)*l;b[L]=1,k[L]=0,I[L]=Math.cos(K),T[L]=Math.sin(K)}const A=e(m,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),w=t(m,{...c,gain:0}),D=s(m,{...u,curve:b}),M=t(m,{...c,gain:0}),F=s(m,{...u,curve:k}),q=s(m,{...u,curve:a}),B=t(m,{...c,gain:0}),G=s(m,{...u,curve:I}),Y=t(m,{...c,gain:0}),U=s(m,{...u,curve:T});return{connectGraph(){_.connect(A),_.connect(q.inputs===void 0?q:q.inputs[0]),A.connect(w,0),A.connect(M,0),A.connect(B,1),A.connect(Y,1),q.connect(g),g.connect(D.inputs===void 0?D:D.inputs[0]),g.connect(F.inputs===void 0?F:F.inputs[0]),g.connect(G.inputs===void 0?G:G.inputs[0]),g.connect(U.inputs===void 0?U:U.inputs[0]),D.connect(w.gain),F.connect(M.gain),G.connect(B.gain),U.connect(Y.gain),w.connect(y,0,0),B.connect(y,0,0),M.connect(y,0,1),Y.connect(y,0,1)},disconnectGraph(){_.disconnect(A),_.disconnect(q.inputs===void 0?q:q.inputs[0]),A.disconnect(w,0),A.disconnect(M,0),A.disconnect(B,1),A.disconnect(Y,1),q.disconnect(g),g.disconnect(D.inputs===void 0?D:D.inputs[0]),g.disconnect(F.inputs===void 0?F:F.inputs[0]),g.disconnect(G.inputs===void 0?G:G.inputs[0]),g.disconnect(U.inputs===void 0?U:U.inputs[0]),D.disconnect(w.gain),F.disconnect(M.gain),G.disconnect(B.gain),U.disconnect(Y.gain),w.disconnect(y,0,0),B.disconnect(y,0,0),M.disconnect(y,0,1),Y.disconnect(y,0,1)}}},d=(m,_,g,y,b)=>{if(_===1)return h(m,g,y,b);if(_===2)return f(m,g,y,b);throw r()};return(m,{channelCount:_,channelCountMode:g,pan:y,...b})=>{if(g==="max")throw r();const k=n(m,{...b,channelCount:1,channelCountMode:g,numberOfInputs:2}),I=t(m,{...b,channelCount:_,channelCountMode:g,gain:1}),T=t(m,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:y});let{connectGraph:C,disconnectGraph:A}=d(m,_,I,T,k);Object.defineProperty(T.gain,"defaultValue",{get:()=>0}),Object.defineProperty(T.gain,"maxValue",{get:()=>1}),Object.defineProperty(T.gain,"minValue",{get:()=>-1});const w={get bufferSize(){},get channelCount(){return I.channelCount},set channelCount(q){I.channelCount!==q&&(D&&A(),{connectGraph:C,disconnectGraph:A}=d(m,q,I,T,k),D&&C()),I.channelCount=q},get channelCountMode(){return I.channelCountMode},set channelCountMode(q){if(q==="clamped-max"||q==="max")throw r();I.channelCountMode=q},get channelInterpretation(){return I.channelInterpretation},set channelInterpretation(q){I.channelInterpretation=q},get context(){return I.context},get inputs(){return[I]},get numberOfInputs(){return I.numberOfInputs},get numberOfOutputs(){return I.numberOfOutputs},get pan(){return T.gain},addEventListener(...q){return I.addEventListener(q[0],q[1],q[2])},dispatchEvent(...q){return I.dispatchEvent(q[0])},removeEventListener(...q){return I.removeEventListener(q[0],q[1],q[2])}};let D=!1;const M=()=>{C(),D=!0},F=()=>{A(),D=!1};return i(Ur(w,k),M,F)}},y_=(n,e,t,s,r,i,o)=>(a,l)=>{const c=a.createWaveShaper();if(i!==null&&i.name==="webkitAudioContext"&&a.createGain().gain.automationRate===void 0)return t(a,l);jt(c,l);const u=l.curve===null||l.curve instanceof Float32Array?l.curve:new Float32Array(l.curve);if(u!==null&&u.length<2)throw e();bt(c,{curve:u},"curve"),bt(c,l,"oversample");let h=null,f=!1;return o(c,"curve",_=>()=>_.call(c),_=>g=>(_.call(c,g),f&&(s(g)&&h===null?h=n(a,c):!s(g)&&h!==null&&(h(),h=null)),g)),r(c,()=>{f=!0,s(c.curve)&&(h=n(a,c))},()=>{f=!1,h!==null&&(h(),h=null)})},b_=(n,e,t,s,r)=>(i,{curve:o,oversample:a,...l})=>{const c=i.createWaveShaper(),u=i.createWaveShaper();jt(c,l),jt(u,l);const h=t(i,{...l,gain:1}),f=t(i,{...l,gain:-1}),d=t(i,{...l,gain:1}),m=t(i,{...l,gain:-1});let _=null,g=!1,y=null;const b={get bufferSize(){},get channelCount(){return c.channelCount},set channelCount(T){h.channelCount=T,f.channelCount=T,c.channelCount=T,d.channelCount=T,u.channelCount=T,m.channelCount=T},get channelCountMode(){return c.channelCountMode},set channelCountMode(T){h.channelCountMode=T,f.channelCountMode=T,c.channelCountMode=T,d.channelCountMode=T,u.channelCountMode=T,m.channelCountMode=T},get channelInterpretation(){return c.channelInterpretation},set channelInterpretation(T){h.channelInterpretation=T,f.channelInterpretation=T,c.channelInterpretation=T,d.channelInterpretation=T,u.channelInterpretation=T,m.channelInterpretation=T},get context(){return c.context},get curve(){return y},set curve(T){if(T!==null&&T.length<2)throw e();if(T===null)c.curve=T,u.curve=T;else{const C=T.length,A=new Float32Array(C+2-C%2),w=new Float32Array(C+2-C%2);A[0]=T[0],w[0]=-T[C-1];const D=Math.ceil((C+1)/2),M=(C+1)/2-1;for(let F=1;F<D;F+=1){const q=F/D*M,B=Math.floor(q),G=Math.ceil(q);A[F]=B===G?T[B]:(1-(q-B))*T[B]+(1-(G-q))*T[G],w[F]=B===G?-T[C-1-B]:-((1-(q-B))*T[C-1-B])-(1-(G-q))*T[C-1-G]}A[D]=C%2===1?T[D-1]:(T[D-2]+T[D-1])/2,c.curve=A,u.curve=w}y=T,g&&(s(y)&&_===null?_=n(i,h):_!==null&&(_(),_=null))},get inputs(){return[h]},get numberOfInputs(){return c.numberOfInputs},get numberOfOutputs(){return c.numberOfOutputs},get oversample(){return c.oversample},set oversample(T){c.oversample=T,u.oversample=T},addEventListener(...T){return h.addEventListener(T[0],T[1],T[2])},dispatchEvent(...T){return h.dispatchEvent(T[0])},removeEventListener(...T){return h.removeEventListener(T[0],T[1],T[2])}};o!==null&&(b.curve=o instanceof Float32Array?o:new Float32Array(o)),a!==b.oversample&&(b.oversample=a);const k=()=>{h.connect(c).connect(d),h.connect(f).connect(u).connect(m).connect(d),g=!0,s(y)&&(_=n(i,h))},I=()=>{h.disconnect(c),c.disconnect(d),h.disconnect(f),f.disconnect(u),u.disconnect(m),m.disconnect(d),g=!1,_!==null&&(_(),_=null)};return r(Ur(b,d),k,I)},fs=()=>new DOMException("","NotSupportedError"),S_={numberOfChannels:1},w_=(n,e,t,s,r)=>class extends n{constructor(o,a,l){let c;if(typeof o=="number"&&a!==void 0&&l!==void 0)c={length:a,numberOfChannels:o,sampleRate:l};else if(typeof o=="object")c=o;else throw new Error("The given parameters are not valid.");const{length:u,numberOfChannels:h,sampleRate:f}={...S_,...c},d=s(h,u,f);e(si,()=>si(d))||d.addEventListener("statechange",(()=>{let m=0;const _=g=>{this._state==="running"&&(m>0?(d.removeEventListener("statechange",_),g.stopImmediatePropagation(),this._waitForThePromiseToSettle(g)):m+=1)};return _})()),super(d,h),this._length=u,this._nativeOfflineAudioContext=d,this._state=null}get length(){return this._nativeOfflineAudioContext.length===void 0?this._length:this._nativeOfflineAudioContext.length}get state(){return this._state===null?this._nativeOfflineAudioContext.state:this._state}startRendering(){return this._state==="running"?Promise.reject(t()):(this._state="running",r(this.destination,this._nativeOfflineAudioContext).finally(()=>{this._state=null,du(this)}))}_waitForThePromiseToSettle(o){this._state===null?this._nativeOfflineAudioContext.dispatchEvent(o):setTimeout(()=>this._waitForThePromiseToSettle(o))}},C_={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,periodicWave:void 0,type:"sine"},T_=(n,e,t,s,r,i,o)=>class extends n{constructor(l,c){const u=r(l),h={...C_,...c},f=t(u,h),d=i(u),m=d?s():null,_=l.sampleRate/2;super(l,!1,f,m),this._detune=e(this,d,f.detune,153600,-153600),this._frequency=e(this,d,f.frequency,_,-_),this._nativeOscillatorNode=f,this._onended=null,this._oscillatorNodeRenderer=m,this._oscillatorNodeRenderer!==null&&h.periodicWave!==void 0&&(this._oscillatorNodeRenderer.periodicWave=h.periodicWave)}get detune(){return this._detune}get frequency(){return this._frequency}get onended(){return this._onended}set onended(l){const c=typeof l=="function"?o(this,l):null;this._nativeOscillatorNode.onended=c;const u=this._nativeOscillatorNode.onended;this._onended=u!==null&&u===c?l:u}get type(){return this._nativeOscillatorNode.type}set type(l){this._nativeOscillatorNode.type=l,this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=null)}setPeriodicWave(l){this._nativeOscillatorNode.setPeriodicWave(l),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=l)}start(l=0){if(this._nativeOscillatorNode.start(l),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.start=l),this.context.state!=="closed"){Pr(this);const c=()=>{this._nativeOscillatorNode.removeEventListener("ended",c),On(this)&&ai(this)};this._nativeOscillatorNode.addEventListener("ended",c)}}stop(l=0){this._nativeOscillatorNode.stop(l),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.stop=l)}},k_=(n,e,t,s,r)=>()=>{const i=new WeakMap;let o=null,a=null,l=null;const c=async(u,h)=>{let f=t(u);const d=os(f,h);if(!d){const m={channelCount:f.channelCount,channelCountMode:f.channelCountMode,channelInterpretation:f.channelInterpretation,detune:f.detune.value,frequency:f.frequency.value,periodicWave:o===null?void 0:o,type:f.type};f=e(h,m),a!==null&&f.start(a),l!==null&&f.stop(l)}return i.set(h,f),d?(await n(h,u.detune,f.detune),await n(h,u.frequency,f.frequency)):(await s(h,u.detune,f.detune),await s(h,u.frequency,f.frequency)),await r(u,h,f),f};return{set periodicWave(u){o=u},set start(u){a=u},set stop(u){l=u},render(u,h){const f=i.get(h);return f!==void 0?Promise.resolve(f):c(u,h)}}},A_={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},N_=(n,e,t,s,r,i,o)=>class extends n{constructor(l,c){const u=r(l),h={...A_,...c},f=t(u,h),d=i(u),m=d?s():null;super(l,!1,f,m),this._nativePannerNode=f,this._orientationX=e(this,d,f.orientationX,us,gs),this._orientationY=e(this,d,f.orientationY,us,gs),this._orientationZ=e(this,d,f.orientationZ,us,gs),this._positionX=e(this,d,f.positionX,us,gs),this._positionY=e(this,d,f.positionY,us,gs),this._positionZ=e(this,d,f.positionZ,us,gs),o(this,1)}get coneInnerAngle(){return this._nativePannerNode.coneInnerAngle}set coneInnerAngle(l){this._nativePannerNode.coneInnerAngle=l}get coneOuterAngle(){return this._nativePannerNode.coneOuterAngle}set coneOuterAngle(l){this._nativePannerNode.coneOuterAngle=l}get coneOuterGain(){return this._nativePannerNode.coneOuterGain}set coneOuterGain(l){this._nativePannerNode.coneOuterGain=l}get distanceModel(){return this._nativePannerNode.distanceModel}set distanceModel(l){this._nativePannerNode.distanceModel=l}get maxDistance(){return this._nativePannerNode.maxDistance}set maxDistance(l){this._nativePannerNode.maxDistance=l}get orientationX(){return this._orientationX}get orientationY(){return this._orientationY}get orientationZ(){return this._orientationZ}get panningModel(){return this._nativePannerNode.panningModel}set panningModel(l){this._nativePannerNode.panningModel=l}get positionX(){return this._positionX}get positionY(){return this._positionY}get positionZ(){return this._positionZ}get refDistance(){return this._nativePannerNode.refDistance}set refDistance(l){this._nativePannerNode.refDistance=l}get rolloffFactor(){return this._nativePannerNode.rolloffFactor}set rolloffFactor(l){this._nativePannerNode.rolloffFactor=l}},E_=(n,e,t,s,r,i,o,a,l,c)=>()=>{const u=new WeakMap;let h=null;const f=async(d,m)=>{let _=null,g=i(d);const y={channelCount:g.channelCount,channelCountMode:g.channelCountMode,channelInterpretation:g.channelInterpretation},b={...y,coneInnerAngle:g.coneInnerAngle,coneOuterAngle:g.coneOuterAngle,coneOuterGain:g.coneOuterGain,distanceModel:g.distanceModel,maxDistance:g.maxDistance,panningModel:g.panningModel,refDistance:g.refDistance,rolloffFactor:g.rolloffFactor},k=os(g,m);if("bufferSize"in g)_=s(m,{...y,gain:1});else if(!k){const I={...b,orientationX:g.orientationX.value,orientationY:g.orientationY.value,orientationZ:g.orientationZ.value,positionX:g.positionX.value,positionY:g.positionY.value,positionZ:g.positionZ.value};g=r(m,I)}if(u.set(m,_===null?g:_),_!==null){if(h===null){if(o===null)throw new Error("Missing the native OfflineAudioContext constructor.");const F=new o(6,d.context.length,m.sampleRate),q=e(F,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6});q.connect(F.destination),h=(async()=>{const B=await Promise.all([d.orientationX,d.orientationY,d.orientationZ,d.positionX,d.positionY,d.positionZ].map(async(G,Y)=>{const U=t(F,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:Y===0?1:0});return await a(F,G,U.offset),U}));for(let G=0;G<6;G+=1)B[G].connect(q,0,G),B[G].start(0);return c(F)})()}const I=await h,T=s(m,{...y,gain:1});await l(d,m,T);const C=[];for(let F=0;F<I.numberOfChannels;F+=1)C.push(I.getChannelData(F));let A=[C[0][0],C[1][0],C[2][0]],w=[C[3][0],C[4][0],C[5][0]],D=s(m,{...y,gain:1}),M=r(m,{...b,orientationX:A[0],orientationY:A[1],orientationZ:A[2],positionX:w[0],positionY:w[1],positionZ:w[2]});T.connect(D).connect(M.inputs[0]),M.connect(_);for(let F=128;F<I.length;F+=128){const q=[C[0][F],C[1][F],C[2][F]],B=[C[3][F],C[4][F],C[5][F]];if(q.some((G,Y)=>G!==A[Y])||B.some((G,Y)=>G!==w[Y])){A=q,w=B;const G=F/m.sampleRate;D.gain.setValueAtTime(0,G),D=s(m,{...y,gain:0}),M=r(m,{...b,orientationX:A[0],orientationY:A[1],orientationZ:A[2],positionX:w[0],positionY:w[1],positionZ:w[2]}),D.gain.setValueAtTime(1,G),T.connect(D).connect(M.inputs[0]),M.connect(_)}}return _}return k?(await n(m,d.orientationX,g.orientationX),await n(m,d.orientationY,g.orientationY),await n(m,d.orientationZ,g.orientationZ),await n(m,d.positionX,g.positionX),await n(m,d.positionY,g.positionY),await n(m,d.positionZ,g.positionZ)):(await a(m,d.orientationX,g.orientationX),await a(m,d.orientationY,g.orientationY),await a(m,d.orientationZ,g.orientationZ),await a(m,d.positionX,g.positionX),await a(m,d.positionY,g.positionY),await a(m,d.positionZ,g.positionZ)),jr(g)?await l(d,m,g.inputs[0]):await l(d,m,g),g};return{render(d,m){const _=u.get(m);return _!==void 0?Promise.resolve(_):f(d,m)}}},I_={disableNormalization:!1},D_=(n,e,t,s)=>class Cu{constructor(i,o){const a=e(i),l=s({...I_,...o}),c=n(a,l);return t.add(c),c}static[Symbol.hasInstance](i){return i!==null&&typeof i=="object"&&Object.getPrototypeOf(i)===Cu.prototype||t.has(i)}},M_=(n,e)=>(t,s,r)=>(n(s).replay(r),e(s,t,r)),$_=(n,e,t)=>async(s,r,i)=>{const o=n(s);await Promise.all(o.activeInputs.map((a,l)=>Array.from(a).map(async([c,u])=>{const f=await e(c).render(c,r),d=s.context.destination;!t(c)&&(s!==d||!t(s))&&f.connect(i,u,l)})).reduce((a,l)=>[...a,...l],[]))},O_=(n,e,t)=>async(s,r,i)=>{const o=e(s);await Promise.all(Array.from(o.activeInputs).map(async([a,l])=>{const u=await n(a).render(a,r);t(a)||u.connect(i,l)}))},R_=(n,e,t,s)=>r=>n(si,()=>si(r))?Promise.resolve(n(s,s)).then(i=>{if(!i){const o=t(r,512,0,1);r.oncomplete=()=>{o.onaudioprocess=null,o.disconnect()},o.onaudioprocess=()=>r.currentTime,o.connect(r.destination)}return r.startRendering()}):new Promise(i=>{const o=e(r,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});r.oncomplete=a=>{o.disconnect(),i(a.renderedBuffer)},o.connect(r.destination),r.startRendering()}),P_=n=>(e,t)=>{n.set(e,t)},V_=n=>(e,t)=>n.set(e,t),x_=(n,e,t,s,r,i,o,a)=>(l,c)=>t(l).render(l,c).then(()=>Promise.all(Array.from(s(c)).map(u=>t(u).render(u,c)))).then(()=>r(c)).then(u=>(typeof u.copyFromChannel!="function"?(o(u),Fo(u)):e(i,()=>i(u))||a(u),n.add(u),u)),F_={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},q_=(n,e,t,s,r,i)=>class extends n{constructor(a,l){const c=r(a),u={...F_,...l},h=t(c,u),f=i(c),d=f?s():null;super(a,!1,h,d),this._pan=e(this,f,h.pan)}get pan(){return this._pan}},W_=(n,e,t,s,r)=>()=>{const i=new WeakMap,o=async(a,l)=>{let c=t(a);const u=os(c,l);if(!u){const h={channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,pan:c.pan.value};c=e(l,h)}return i.set(l,c),u?await n(l,a.pan,c.pan):await s(l,a.pan,c.pan),jr(c)?await r(a,l,c.inputs[0]):await r(a,l,c),c};return{render(a,l){const c=i.get(l);return c!==void 0?Promise.resolve(c):o(a,l)}}},L_=n=>()=>{if(n===null)return!1;try{new n({length:1,sampleRate:44100})}catch{return!1}return!0},B_=(n,e)=>async()=>{if(n===null)return!0;if(e===null)return!1;const t=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),s=new e(1,128,44100),r=URL.createObjectURL(t);let i=!1,o=!1;try{await s.audioWorklet.addModule(r);const a=new n(s,"a",{numberOfOutputs:0}),l=s.createOscillator();a.port.onmessage=()=>i=!0,a.onprocessorerror=()=>o=!0,l.connect(a),l.start(0),await s.startRendering(),await new Promise(c=>setTimeout(c))}catch{}finally{URL.revokeObjectURL(r)}return i&&!o},H_=(n,e)=>()=>{if(e===null)return Promise.resolve(!1);const t=new e(1,1,44100),s=n(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise(r=>{t.oncomplete=()=>{s.disconnect(),r(t.currentTime!==0)},t.startRendering()})},j_=()=>new DOMException("","UnknownError"),U_={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},z_=(n,e,t,s,r,i,o)=>class extends n{constructor(l,c){const u=r(l),h={...U_,...c},f=t(u,h),m=i(u)?s():null;super(l,!0,f,m),this._isCurveNullified=!1,this._nativeWaveShaperNode=f,o(this,1)}get curve(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve}set curve(l){if(l===null)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(l.length<2)throw e();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=l}}get oversample(){return this._nativeWaveShaperNode.oversample}set oversample(l){this._nativeWaveShaperNode.oversample=l}},G_=(n,e,t)=>()=>{const s=new WeakMap,r=async(i,o)=>{let a=e(i);if(!os(a,o)){const c={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,curve:a.curve,oversample:a.oversample};a=n(o,c)}return s.set(o,a),jr(a)?await t(i,o,a.inputs[0]):await t(i,o,a),a};return{render(i,o){const a=s.get(o);return a!==void 0?Promise.resolve(a):r(i,o)}}},Z_=()=>typeof window>"u"?null:window,X_=(n,e)=>t=>{t.copyFromChannel=(s,r,i=0)=>{const o=n(i),a=n(r);if(a>=t.numberOfChannels)throw e();const l=t.length,c=t.getChannelData(a),u=s.length;for(let h=o<0?-o:0;h+o<l&&h<u;h+=1)s[h]=c[h+o]},t.copyToChannel=(s,r,i=0)=>{const o=n(i),a=n(r);if(a>=t.numberOfChannels)throw e();const l=t.length,c=t.getChannelData(a),u=s.length;for(let h=o<0?-o:0;h+o<l&&h<u;h+=1)c[h+o]=s[h]}},Y_=n=>e=>{e.copyFromChannel=(t=>(s,r,i=0)=>{const o=n(i),a=n(r);if(o<e.length)return t.call(e,s,a,o)})(e.copyFromChannel),e.copyToChannel=(t=>(s,r,i=0)=>{const o=n(i),a=n(r);if(o<e.length)return t.call(e,s,a,o)})(e.copyToChannel)},Q_=n=>(e,t)=>{const s=t.createBuffer(1,1,44100);e.buffer===null&&(e.buffer=s),n(e,"buffer",r=>()=>{const i=r.call(e);return i===s?null:i},r=>i=>r.call(e,i===null?s:i))},J_=(n,e)=>(t,s)=>{s.channelCount=1,s.channelCountMode="explicit",Object.defineProperty(s,"channelCount",{get:()=>1,set:()=>{throw n()}}),Object.defineProperty(s,"channelCountMode",{get:()=>"explicit",set:()=>{throw n()}});const r=t.createBufferSource();e(s,()=>{const a=s.numberOfInputs;for(let l=0;l<a;l+=1)r.connect(s,0,l)},()=>r.disconnect(s))},Tu=(n,e,t)=>n.copyFromChannel===void 0?n.getChannelData(t)[0]:(n.copyFromChannel(e,t),e[0]),ku=n=>{if(n===null)return!1;const e=n.length;return e%2!==0?n[Math.floor(e/2)]!==0:n[e/2-1]+n[e/2]!==0},fi=(n,e,t,s)=>{let r=n;for(;!r.hasOwnProperty(e);)r=Object.getPrototypeOf(r);const{get:i,set:o}=Object.getOwnPropertyDescriptor(r,e);Object.defineProperty(n,e,{get:t(i),set:s(o)})},K_=n=>({...n,outputChannelCount:n.outputChannelCount!==void 0?n.outputChannelCount:n.numberOfInputs===1&&n.numberOfOutputs===1?[n.channelCount]:Array.from({length:n.numberOfOutputs},()=>1)}),eg=n=>({...n,channelCount:n.numberOfOutputs}),tg=n=>{const{imag:e,real:t}=n;return e===void 0?t===void 0?{...n,imag:[0,0],real:[0,0]}:{...n,imag:Array.from(t,()=>0),real:t}:t===void 0?{...n,imag:e,real:Array.from(e,()=>0)}:{...n,imag:e,real:t}},Au=(n,e,t)=>{try{n.setValueAtTime(e,t)}catch(s){if(s.code!==9)throw s;Au(n,e,t+1e-7)}},sg=n=>{const e=n.createBufferSource();e.start();try{e.start()}catch{return!0}return!1},ng=n=>{const e=n.createBufferSource(),t=n.createBuffer(1,1,44100);e.buffer=t;try{e.start(0,1)}catch{return!1}return!0},rg=n=>{const e=n.createBufferSource();e.start();try{e.stop()}catch{return!1}return!0},Ho=n=>{const e=n.createOscillator();try{e.start(-1)}catch(t){return t instanceof RangeError}return!1},Nu=n=>{const e=n.createBuffer(1,1,44100),t=n.createBufferSource();t.buffer=e,t.start(),t.stop();try{return t.stop(),!0}catch{return!1}},jo=n=>{const e=n.createOscillator();try{e.stop(-1)}catch(t){return t instanceof RangeError}return!1},ig=n=>{const{port1:e,port2:t}=new MessageChannel;try{e.postMessage(n)}finally{e.close(),t.close()}},og=n=>{n.start=(e=>(t=0,s=0,r)=>{const i=n.buffer,o=i===null?s:Math.min(i.duration,s);i!==null&&o>i.duration-.5/n.context.sampleRate?e.call(n,t,0,0):e.call(n,t,o,r)})(n.start)},Eu=(n,e)=>{const t=e.createGain();n.connect(t);const s=(r=>()=>{r.call(n,t),n.removeEventListener("ended",s)})(n.disconnect);n.addEventListener("ended",s),Ur(n,t),n.stop=(r=>{let i=!1;return(o=0)=>{if(i)try{r.call(n,o)}catch{t.gain.setValueAtTime(0,o)}else r.call(n,o),i=!0}})(n.stop)},zr=(n,e)=>t=>{const s={value:n};return Object.defineProperties(t,{currentTarget:s,target:s}),typeof e=="function"?e.call(n,t):e.handleEvent.call(n,t)},ag=Nd(gr),lg=Od(gr),cg=Up(Ui),Iu=new WeakMap,ug=cm(Iu),Qs=Sp(new Map,new WeakMap),ln=Z_(),Du=qm(Qs,un),Uo=lm(hs),ss=$_(hs,Uo,ur),hg=Fd(Du,vt,ss),gt=fm(ji),Pn=f_(ln),ct=Im(Pn),Mu=new WeakMap,$u=tm(zr),di=Hm(ln),zo=km(di),Go=Am(ln),Ou=Nm(ln),ni=Um(ln),$t=cp(Ed(ou),$d(ag,lg,Pi,cg,Vi,hs,ug,oi,vt,gr,On,ur,Ni),Qs,bm(wo,Vi,hs,vt,ti,On),un,zi,fs,Lp(Pi,wo,hs,vt,ti,gt,On,ct),Zp(Mu,hs,Ys),$u,gt,zo,Go,Ou,ct,ni),fg=xd($t,hg,un,Du,gt,ct),Zo=new WeakSet,Za=Wm(ln),Ru=Rp(new Uint32Array(1)),Xo=X_(Ru,un),Yo=Y_(Ru),Pu=Wd(Zo,Qs,fs,Za,Pn,L_(Za),Xo,Yo),Gi=Rd(bs),Vu=O_(Uo,li,ur),hn=Ep(Vu),Gr=Bm(Gi,Qs,sg,ng,rg,Ho,Nu,jo,og,Q_(fi),Eu),fn=M_(um(li),Vu),dg=Hd(hn,Gr,vt,fn,ss),Js=up(Id(au),Mu,xo,hp,Sd,wd,Cd,Td,kd,yo,ru,di,Au),pg=Bd($t,dg,Js,zt,Gr,gt,ct,zr),mg=Jd($t,Kd,un,zt,jm(bs,fi),gt,ct,ss),_g=bp(hn,Su,vt,fn,ss),vr=V_(Iu),gg=yp($t,Js,_g,zi,Su,gt,ct,vr),zn=xm(gr,Go),vg=J_(zt,zn),Gn=Jm(di,vg),yg=Tp(Gn,vt,ss),bg=Cp($t,yg,Gn,gt,ct),Sg=Np(ui,vt,ss),wg=Ap($t,Sg,ui,gt,ct,eg),Cg=t_(Gi,Gr,bs,zn),Zr=e_(Gi,Qs,Cg,Ho,jo),Tg=Op(hn,Zr,vt,fn,ss),kg=$p($t,Js,Tg,Zr,gt,ct,zr),xu=s_(fs,fi),Ag=xp(xu,vt,ss),Ng=Vp($t,Ag,xu,gt,ct,vr),Eg=jp(hn,wu,vt,fn,ss),Ig=Hp($t,Js,Eg,wu,gt,ct,vr),Fu=n_(fs),Dg=Jp(hn,Fu,vt,fn,ss),Mg=Qp($t,Js,Dg,Fu,fs,gt,ct,vr),$g=om(hn,bs,vt,fn,ss),Og=im($t,Js,$g,bs,gt,ct),Rg=a_(zi,zt,hi,fs),Zi=R_(Qs,bs,hi,H_(bs,Pn)),Pg=ym(Gr,vt,Pn,ss,Zi),Vg=r_(Rg),xg=gm($t,Vg,Pg,gt,ct,vr),Fg=ep(Js,Gn,Zr,hi,fs,Tu,ct,fi),qu=new WeakMap,qg=Vm(mg,Fg,$u,ct,qu,zr),Wu=d_(Gi,Qs,Ho,Nu,jo,Eu),Wg=k_(hn,Wu,vt,fn,ss),Lg=T_($t,Js,Wu,Wg,gt,ct,zr),Lu=Dp(Gr),Bg=b_(Lu,zt,bs,ku,zn),Xi=y_(Lu,zt,Bg,ku,zn,di,fi),Hg=m_(Pi,zt,Gn,bs,hi,Xi,fs,Vi,Tu,zn),Bu=p_(Hg),jg=E_(hn,Gn,Zr,bs,Bu,vt,Pn,fn,ss,Zi),Ug=N_($t,Js,Bu,jg,gt,ct,vr),zg=__(un),Gg=D_(zg,gt,new WeakSet,tg),Zg=v_(Gn,ui,bs,Xi,fs,zn),Hu=g_(Zg,fs),Xg=W_(hn,Hu,vt,fn,ss),Yg=q_($t,Js,Hu,Xg,gt,ct),Qg=G_(Xi,vt,ss),Jg=z_($t,zt,Xi,Qg,gt,ct,vr),ju=Dm(ln),Qo=sm(ln),Uu=new WeakMap,Kg=dm(Uu,Pn),ev=ju?Md(Qs,fs,em(ln),Qo,nm(Ad),gt,Kg,ct,ni,new WeakMap,new WeakMap,B_(ni,Pn),ln):void 0,tv=Em(zo,ct),sv=Wp(Zo,Qs,qp,Kp,new WeakSet,gt,tv,Oi,si,Xo,Yo),zu=gp(ev,fg,Pu,pg,gg,bg,wg,kg,Ng,sv,Ig,Mg,Og,xg,qg,Lg,Ug,Gg,Yg,Jg),nv=Mm($t,l_,gt,ct),rv=Om($t,c_,gt,ct),iv=Rm($t,u_,gt,ct),ov=h_(zt,ct),av=Pm($t,ov,gt),lv=Qd(zu,zt,fs,j_,nv,rv,iv,av,di),Jo=pm(qu),cv=Pd(Jo),Gu=Ip(un),uv=zp(Jo),Zu=Xp(un),Xu=new WeakMap,hv=am(Xu,Ys),fv=Qm(Gu,un,zt,Gn,ui,Zr,bs,hi,fs,Zu,Qo,hv,zn),dv=Gm(zt,fv,bs,fs,zn),pv=_p(hn,Gu,Gr,Gn,ui,Zr,bs,uv,Zu,Qo,vt,ni,Pn,fn,ss,Zi),mv=hm(Uu),_v=P_(Xu),Xa=ju?dp(cv,$t,Js,pv,dv,hs,mv,gt,ct,ni,K_,_v,ig,zr):void 0,gv=Fp(fs,Pn),vv=x_(Zo,Qs,Uo,Jo,Zi,Oi,Xo,Yo),yv=w_(zu,Qs,zt,gv,vv),bv=Sm(ji,zo),Sv=wm(Vo,Go),wv=Cm(xo,Ou),Cv=Tm(ji,ct);function qs(n){return n===void 0}function Ge(n){return n!==void 0}function Tv(n){return typeof n=="function"}function hr(n){return typeof n=="number"}function cr(n){return Object.prototype.toString.call(n)==="[object Object]"&&n.constructor===Object}function kv(n){return typeof n=="boolean"}function Zs(n){return Array.isArray(n)}function Rn(n){return typeof n=="string"}function Ci(n){return Rn(n)&&/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i.test(n)}function qe(n,e){if(!n)throw new Error(e)}function jn(n,e,t=1/0){if(!(e<=n&&n<=t))throw new RangeError(`Value must be within [${e}, ${t}], got: ${n}`)}function Yu(n){!n.isOffline&&n.state!=="running"&&Ko('The AudioContext is "suspended". Invoke Tone.start() from a user action to start the audio.')}let Qu=!1,Ya=!1;function Qa(n){Qu=n}function Av(n){qs(n)&&Qu&&!Ya&&(Ya=!0,Ko("Events scheduled inside of scheduled callbacks should use the passed in scheduling time. See https://github.com/Tonejs/Tone.js/wiki/Accurate-Timing"))}let Ju=console;function Nv(...n){Ju.log(...n)}function Ko(...n){Ju.warn(...n)}function Ev(n){return new lv(n)}function Iv(n,e,t){return new yv(n,e,t)}const Is=typeof self=="object"?self:null,Dv=Is&&(Is.hasOwnProperty("AudioContext")||Is.hasOwnProperty("webkitAudioContext"));function Mv(n,e,t){return qe(Ge(Xa),"AudioWorkletNode only works in a secure context (https or localhost)"),new(n instanceof(Is==null?void 0:Is.BaseAudioContext)?Is==null?void 0:Is.AudioWorkletNode:Xa)(n,e,t)}function Ks(n,e,t,s){var r=arguments.length,i=r<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,t):s,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(n,e,t,s);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(i=(r<3?o(i):r>3?o(e,t,i):o(e,t))||i);return r>3&&i&&Object.defineProperty(e,t,i),i}function Ft(n,e,t,s){function r(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(u){try{c(s.next(u))}catch(h){o(h)}}function l(u){try{c(s.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):r(u.value).then(a,l)}c((s=s.apply(n,e||[])).next())})}class $v{constructor(e,t,s,r){this._callback=e,this._type=t,this._minimumUpdateInterval=Math.max(128/(r||44100),.001),this.updateInterval=s,this._createClock()}_createWorker(){const e=new Blob([`
			// the initial timeout time
			let timeoutTime =  ${(this._updateInterval*1e3).toFixed(1)};
			// onmessage callback
			self.onmessage = function(msg){
				timeoutTime = parseInt(msg.data);
			};
			// the tick function which posts a message
			// and schedules a new tick
			function tick(){
				setTimeout(tick, timeoutTime);
				self.postMessage('tick');
			}
			// call tick initially
			tick();
			`],{type:"text/javascript"}),t=URL.createObjectURL(e),s=new Worker(t);s.onmessage=this._callback.bind(this),this._worker=s}_createTimeout(){this._timeout=setTimeout(()=>{this._createTimeout(),this._callback()},this._updateInterval*1e3)}_createClock(){if(this._type==="worker")try{this._createWorker()}catch{this._type="timeout",this._createClock()}else this._type==="timeout"&&this._createTimeout()}_disposeClock(){this._timeout&&clearTimeout(this._timeout),this._worker&&(this._worker.terminate(),this._worker.onmessage=null)}get updateInterval(){return this._updateInterval}set updateInterval(e){var t;this._updateInterval=Math.max(e,this._minimumUpdateInterval),this._type==="worker"&&((t=this._worker)===null||t===void 0||t.postMessage(this._updateInterval*1e3))}get type(){return this._type}set type(e){this._disposeClock(),this._type=e,this._createClock()}dispose(){this._disposeClock()}}function fr(n){return wv(n)}function Bn(n){return Sv(n)}function Ei(n){return Cv(n)}function kr(n){return bv(n)}function Ov(n){return n instanceof Pu}function Rv(n,e){return n==="value"||fr(e)||Bn(e)||Ov(e)}function Dr(n,...e){if(!e.length)return n;const t=e.shift();if(cr(n)&&cr(t))for(const s in t)Rv(s,t[s])?n[s]=t[s]:cr(t[s])?(n[s]||Object.assign(n,{[s]:{}}),Dr(n[s],t[s])):Object.assign(n,{[s]:t[s]});return Dr(n,...e)}function Pv(n,e){return n.length===e.length&&n.every((t,s)=>e[s]===t)}function Fe(n,e,t=[],s){const r={},i=Array.from(e);if(cr(i[0])&&s&&!Reflect.has(i[0],s)&&(Object.keys(i[0]).some(a=>Reflect.has(n,a))||(Dr(r,{[s]:i[0]}),t.splice(t.indexOf(s),1),i.shift())),i.length===1&&cr(i[0]))Dr(r,i[0]);else for(let o=0;o<t.length;o++)Ge(i[o])&&(r[t[o]]=i[o]);return Dr(n,r)}function Vv(n){return n.constructor.getDefaults()}function Mr(n,e){return qs(n)?e:n}function Ja(n,e){return e.forEach(t=>{Reflect.has(n,t)&&delete n[t]}),n}/**
 * Tone.js
 * @author Yotam Mann
 * @license http://opensource.org/licenses/MIT MIT License
 * @copyright 2014-2024 Yotam Mann
 */class Vn{constructor(){this.debug=!1,this._wasDisposed=!1}static getDefaults(){return{}}log(...e){(this.debug||Is&&this.toString()===Is.TONE_DEBUG_CLASS)&&Nv(this,...e)}dispose(){return this._wasDisposed=!0,this}get disposed(){return this._wasDisposed}toString(){return this.name}}Vn.version=nu;const ea=1e-6;function Vr(n,e){return n>e+ea}function No(n,e){return Vr(n,e)||zs(n,e)}function Wi(n,e){return n+ea<e}function zs(n,e){return Math.abs(n-e)<ea}function xv(n,e,t){return Math.max(Math.min(n,t),e)}class Ws extends Vn{constructor(){super(),this.name="Timeline",this._timeline=[];const e=Fe(Ws.getDefaults(),arguments,["memory"]);this.memory=e.memory,this.increasing=e.increasing}static getDefaults(){return{memory:1/0,increasing:!1}}get length(){return this._timeline.length}add(e){if(qe(Reflect.has(e,"time"),"Timeline: events must have a time attribute"),e.time=e.time.valueOf(),this.increasing&&this.length){const t=this._timeline[this.length-1];qe(No(e.time,t.time),"The time must be greater than or equal to the last scheduled time"),this._timeline.push(e)}else{const t=this._search(e.time);this._timeline.splice(t+1,0,e)}if(this.length>this.memory){const t=this.length-this.memory;this._timeline.splice(0,t)}return this}remove(e){const t=this._timeline.indexOf(e);return t!==-1&&this._timeline.splice(t,1),this}get(e,t="time"){const s=this._search(e,t);return s!==-1?this._timeline[s]:null}peek(){return this._timeline[0]}shift(){return this._timeline.shift()}getAfter(e,t="time"){const s=this._search(e,t);return s+1<this._timeline.length?this._timeline[s+1]:null}getBefore(e){const t=this._timeline.length;if(t>0&&this._timeline[t-1].time<e)return this._timeline[t-1];const s=this._search(e);return s-1>=0?this._timeline[s-1]:null}cancel(e){if(this._timeline.length>1){let t=this._search(e);if(t>=0)if(zs(this._timeline[t].time,e)){for(let s=t;s>=0&&zs(this._timeline[s].time,e);s--)t=s;this._timeline=this._timeline.slice(0,t)}else this._timeline=this._timeline.slice(0,t+1);else this._timeline=[]}else this._timeline.length===1&&No(this._timeline[0].time,e)&&(this._timeline=[]);return this}cancelBefore(e){const t=this._search(e);return t>=0&&(this._timeline=this._timeline.slice(t+1)),this}previousEvent(e){const t=this._timeline.indexOf(e);return t>0?this._timeline[t-1]:null}_search(e,t="time"){if(this._timeline.length===0)return-1;let s=0;const r=this._timeline.length;let i=r;if(r>0&&this._timeline[r-1][t]<=e)return r-1;for(;s<i;){let o=Math.floor(s+(i-s)/2);const a=this._timeline[o],l=this._timeline[o+1];if(zs(a[t],e)){for(let c=o;c<this._timeline.length;c++){const u=this._timeline[c];if(zs(u[t],e))o=c;else break}return o}else{if(Wi(a[t],e)&&Vr(l[t],e))return o;Vr(a[t],e)?i=o:s=o+1}}return-1}_iterate(e,t=0,s=this._timeline.length-1){this._timeline.slice(t,s+1).forEach(e)}forEach(e){return this._iterate(e),this}forEachBefore(e,t){const s=this._search(e);return s!==-1&&this._iterate(t,0,s),this}forEachAfter(e,t){const s=this._search(e);return this._iterate(t,s+1),this}forEachBetween(e,t,s){let r=this._search(e),i=this._search(t);return r!==-1&&i!==-1?(this._timeline[r].time!==e&&(r+=1),this._timeline[i].time===t&&(i-=1),this._iterate(s,r,i)):r===-1&&this._iterate(s,0,i),this}forEachFrom(e,t){let s=this._search(e);for(;s>=0&&this._timeline[s].time>=e;)s--;return this._iterate(t,s+1),this}forEachAtTime(e,t){const s=this._search(e);if(s!==-1&&zs(this._timeline[s].time,e)){let r=s;for(let i=s;i>=0&&zs(this._timeline[i].time,e);i--)r=i;this._iterate(i=>{t(i)},r,s)}return this}dispose(){return super.dispose(),this._timeline=[],this}}const Ku=[];function Yi(n){Ku.push(n)}function Fv(n){Ku.forEach(e=>e(n))}const eh=[];function Qi(n){eh.push(n)}function qv(n){eh.forEach(e=>e(n))}class pi extends Vn{constructor(){super(...arguments),this.name="Emitter"}on(e,t){return e.split(/\W+/).forEach(r=>{qs(this._events)&&(this._events={}),this._events.hasOwnProperty(r)||(this._events[r]=[]),this._events[r].push(t)}),this}once(e,t){const s=(...r)=>{t(...r),this.off(e,s)};return this.on(e,s),this}off(e,t){return e.split(/\W+/).forEach(r=>{if(qs(this._events)&&(this._events={}),this._events.hasOwnProperty(r))if(qs(t))this._events[r]=[];else{const i=this._events[r];for(let o=i.length-1;o>=0;o--)i[o]===t&&i.splice(o,1)}}),this}emit(e,...t){if(this._events&&this._events.hasOwnProperty(e)){const s=this._events[e].slice(0);for(let r=0,i=s.length;r<i;r++)s[r].apply(this,t)}return this}static mixin(e){["on","once","off","emit"].forEach(t=>{const s=Object.getOwnPropertyDescriptor(pi.prototype,t);Object.defineProperty(e.prototype,t,s)})}dispose(){return super.dispose(),this._events=void 0,this}}class th extends pi{constructor(){super(...arguments),this.isOffline=!1}toJSON(){return{}}}class mi extends th{constructor(){var e,t;super(),this.name="Context",this._constants=new Map,this._timeouts=new Ws,this._timeoutIds=0,this._initialized=!1,this._closeStarted=!1,this.isOffline=!1,this._workletPromise=null;const s=Fe(mi.getDefaults(),arguments,["context"]);s.context?(this._context=s.context,this._latencyHint=((e=arguments[0])===null||e===void 0?void 0:e.latencyHint)||""):(this._context=Ev({latencyHint:s.latencyHint}),this._latencyHint=s.latencyHint),this._ticker=new $v(this.emit.bind(this,"tick"),s.clockSource,s.updateInterval,this._context.sampleRate),this.on("tick",this._timeoutLoop.bind(this)),this._context.onstatechange=()=>{this.emit("statechange",this.state)},this[!((t=arguments[0])===null||t===void 0)&&t.hasOwnProperty("updateInterval")?"_lookAhead":"lookAhead"]=s.lookAhead}static getDefaults(){return{clockSource:"worker",latencyHint:"interactive",lookAhead:.1,updateInterval:.05}}initialize(){return this._initialized||(Fv(this),this._initialized=!0),this}createAnalyser(){return this._context.createAnalyser()}createOscillator(){return this._context.createOscillator()}createBufferSource(){return this._context.createBufferSource()}createBiquadFilter(){return this._context.createBiquadFilter()}createBuffer(e,t,s){return this._context.createBuffer(e,t,s)}createChannelMerger(e){return this._context.createChannelMerger(e)}createChannelSplitter(e){return this._context.createChannelSplitter(e)}createConstantSource(){return this._context.createConstantSource()}createConvolver(){return this._context.createConvolver()}createDelay(e){return this._context.createDelay(e)}createDynamicsCompressor(){return this._context.createDynamicsCompressor()}createGain(){return this._context.createGain()}createIIRFilter(e,t){return this._context.createIIRFilter(e,t)}createPanner(){return this._context.createPanner()}createPeriodicWave(e,t,s){return this._context.createPeriodicWave(e,t,s)}createStereoPanner(){return this._context.createStereoPanner()}createWaveShaper(){return this._context.createWaveShaper()}createMediaStreamSource(e){return qe(kr(this._context),"Not available if OfflineAudioContext"),this._context.createMediaStreamSource(e)}createMediaElementSource(e){return qe(kr(this._context),"Not available if OfflineAudioContext"),this._context.createMediaElementSource(e)}createMediaStreamDestination(){return qe(kr(this._context),"Not available if OfflineAudioContext"),this._context.createMediaStreamDestination()}decodeAudioData(e){return this._context.decodeAudioData(e)}get currentTime(){return this._context.currentTime}get state(){return this._context.state}get sampleRate(){return this._context.sampleRate}get listener(){return this.initialize(),this._listener}set listener(e){qe(!this._initialized,"The listener cannot be set after initialization."),this._listener=e}get transport(){return this.initialize(),this._transport}set transport(e){qe(!this._initialized,"The transport cannot be set after initialization."),this._transport=e}get draw(){return this.initialize(),this._draw}set draw(e){qe(!this._initialized,"Draw cannot be set after initialization."),this._draw=e}get destination(){return this.initialize(),this._destination}set destination(e){qe(!this._initialized,"The destination cannot be set after initialization."),this._destination=e}createAudioWorkletNode(e,t){return Mv(this.rawContext,e,t)}addAudioWorkletModule(e){return Ft(this,void 0,void 0,function*(){qe(Ge(this.rawContext.audioWorklet),"AudioWorkletNode is only available in a secure context (https or localhost)"),this._workletPromise||(this._workletPromise=this.rawContext.audioWorklet.addModule(e)),yield this._workletPromise})}workletsAreReady(){return Ft(this,void 0,void 0,function*(){(yield this._workletPromise)?this._workletPromise:Promise.resolve()})}get updateInterval(){return this._ticker.updateInterval}set updateInterval(e){this._ticker.updateInterval=e}get clockSource(){return this._ticker.type}set clockSource(e){this._ticker.type=e}get lookAhead(){return this._lookAhead}set lookAhead(e){this._lookAhead=e,this.updateInterval=e?e/2:.01}get latencyHint(){return this._latencyHint}get rawContext(){return this._context}now(){return this._context.currentTime+this._lookAhead}immediate(){return this._context.currentTime}resume(){return kr(this._context)?this._context.resume():Promise.resolve()}close(){return Ft(this,void 0,void 0,function*(){kr(this._context)&&this.state!=="closed"&&!this._closeStarted&&(this._closeStarted=!0,yield this._context.close()),this._initialized&&qv(this)})}getConstant(e){if(this._constants.has(e))return this._constants.get(e);{const t=this._context.createBuffer(1,128,this._context.sampleRate),s=t.getChannelData(0);for(let i=0;i<s.length;i++)s[i]=e;const r=this._context.createBufferSource();return r.channelCount=1,r.channelCountMode="explicit",r.buffer=t,r.loop=!0,r.start(0),this._constants.set(e,r),r}}dispose(){return super.dispose(),this._ticker.dispose(),this._timeouts.dispose(),Object.keys(this._constants).map(e=>this._constants[e].disconnect()),this.close(),this}_timeoutLoop(){const e=this.now();this._timeouts.forEachBefore(e,t=>{t.callback(),this._timeouts.remove(t)})}setTimeout(e,t){this._timeoutIds++;const s=this.now();return this._timeouts.add({callback:e,id:this._timeoutIds,time:s+t}),this._timeoutIds}clearTimeout(e){return this._timeouts.forEach(t=>{t.id===e&&this._timeouts.remove(t)}),this}clearInterval(e){return this.clearTimeout(e)}setInterval(e,t){const s=++this._timeoutIds,r=()=>{const i=this.now();this._timeouts.add({callback:()=>{e(),r()},id:s,time:i+t})};return r(),s}}class Wv extends th{constructor(){super(...arguments),this.lookAhead=0,this.latencyHint=0,this.isOffline=!1}createAnalyser(){return{}}createOscillator(){return{}}createBufferSource(){return{}}createBiquadFilter(){return{}}createBuffer(e,t,s){return{}}createChannelMerger(e){return{}}createChannelSplitter(e){return{}}createConstantSource(){return{}}createConvolver(){return{}}createDelay(e){return{}}createDynamicsCompressor(){return{}}createGain(){return{}}createIIRFilter(e,t){return{}}createPanner(){return{}}createPeriodicWave(e,t,s){return{}}createStereoPanner(){return{}}createWaveShaper(){return{}}createMediaStreamSource(e){return{}}createMediaElementSource(e){return{}}createMediaStreamDestination(){return{}}decodeAudioData(e){return Promise.resolve({})}createAudioWorkletNode(e,t){return{}}get rawContext(){return{}}addAudioWorkletModule(e){return Ft(this,void 0,void 0,function*(){return Promise.resolve()})}resume(){return Promise.resolve()}setTimeout(e,t){return 0}clearTimeout(e){return this}setInterval(e,t){return 0}clearInterval(e){return this}getConstant(e){return{}}get currentTime(){return 0}get state(){return{}}get sampleRate(){return 0}get listener(){return{}}get transport(){return{}}get draw(){return{}}set draw(e){}get destination(){return{}}set destination(e){}now(){return 0}immediate(){return 0}}function It(n,e){Zs(e)?e.forEach(t=>It(n,t)):Object.defineProperty(n,e,{enumerable:!0,writable:!1})}function sh(n,e){Zs(e)?e.forEach(t=>sh(n,t)):Object.defineProperty(n,e,{writable:!0})}const lt=()=>{};class yt extends Vn{constructor(){super(),this.name="ToneAudioBuffer",this.onload=lt;const e=Fe(yt.getDefaults(),arguments,["url","onload","onerror"]);this.reverse=e.reverse,this.onload=e.onload,Rn(e.url)?this.load(e.url).catch(e.onerror):e.url&&this.set(e.url)}static getDefaults(){return{onerror:lt,onload:lt,reverse:!1}}get sampleRate(){return this._buffer?this._buffer.sampleRate:Vs().sampleRate}set(e){return e instanceof yt?e.loaded?this._buffer=e.get():e.onload=()=>{this.set(e),this.onload(this)}:this._buffer=e,this._reversed&&this._reverse(),this}get(){return this._buffer}load(e){return Ft(this,void 0,void 0,function*(){const t=yt.load(e).then(s=>{this.set(s),this.onload(this)});yt.downloads.push(t);try{yield t}finally{const s=yt.downloads.indexOf(t);yt.downloads.splice(s,1)}return this})}dispose(){return super.dispose(),this._buffer=void 0,this}fromArray(e){const t=Zs(e)&&e[0].length>0,s=t?e.length:1,r=t?e[0].length:e.length,i=Vs(),o=i.createBuffer(s,r,i.sampleRate),a=!t&&s===1?[e]:e;for(let l=0;l<s;l++)o.copyToChannel(a[l],l);return this._buffer=o,this}toMono(e){if(hr(e))this.fromArray(this.toArray(e));else{let t=new Float32Array(this.length);const s=this.numberOfChannels;for(let r=0;r<s;r++){const i=this.toArray(r);for(let o=0;o<i.length;o++)t[o]+=i[o]}t=t.map(r=>r/s),this.fromArray(t)}return this}toArray(e){if(hr(e))return this.getChannelData(e);if(this.numberOfChannels===1)return this.toArray(0);{const t=[];for(let s=0;s<this.numberOfChannels;s++)t[s]=this.getChannelData(s);return t}}getChannelData(e){return this._buffer?this._buffer.getChannelData(e):new Float32Array(0)}slice(e,t=this.duration){qe(this.loaded,"Buffer is not loaded");const s=Math.floor(e*this.sampleRate),r=Math.floor(t*this.sampleRate);qe(s<r,"The start time must be less than the end time");const i=r-s,o=Vs().createBuffer(this.numberOfChannels,i,this.sampleRate);for(let a=0;a<this.numberOfChannels;a++)o.copyToChannel(this.getChannelData(a).subarray(s,r),a);return new yt(o)}_reverse(){if(this.loaded)for(let e=0;e<this.numberOfChannels;e++)this.getChannelData(e).reverse();return this}get loaded(){return this.length>0}get duration(){return this._buffer?this._buffer.duration:0}get length(){return this._buffer?this._buffer.length:0}get numberOfChannels(){return this._buffer?this._buffer.numberOfChannels:0}get reverse(){return this._reversed}set reverse(e){this._reversed!==e&&(this._reversed=e,this._reverse())}static fromArray(e){return new yt().fromArray(e)}static fromUrl(e){return Ft(this,void 0,void 0,function*(){return yield new yt().load(e)})}static load(e){return Ft(this,void 0,void 0,function*(){const t=yt.baseUrl===""||yt.baseUrl.endsWith("/")?yt.baseUrl:yt.baseUrl+"/",s=yield fetch(t+e);if(!s.ok)throw new Error(`could not load url: ${e}`);const r=yield s.arrayBuffer();return yield Vs().decodeAudioData(r)})}static supportsType(e){const t=e.split("."),s=t[t.length-1];return document.createElement("audio").canPlayType("audio/"+s)!==""}static loaded(){return Ft(this,void 0,void 0,function*(){for(yield Promise.resolve();yt.downloads.length;)yield yt.downloads[0]})}}yt.baseUrl="";yt.downloads=[];class ta extends mi{constructor(){super({clockSource:"offline",context:Ei(arguments[0])?arguments[0]:Iv(arguments[0],arguments[1]*arguments[2],arguments[2]),lookAhead:0,updateInterval:Ei(arguments[0])?128/arguments[0].sampleRate:128/arguments[2]}),this.name="OfflineContext",this._currentTime=0,this.isOffline=!0,this._duration=Ei(arguments[0])?arguments[0].length/arguments[0].sampleRate:arguments[1]}now(){return this._currentTime}get currentTime(){return this._currentTime}_renderClock(e){return Ft(this,void 0,void 0,function*(){let t=0;for(;this._duration-this._currentTime>=0;){this.emit("tick"),this._currentTime+=128/this.sampleRate,t++;const s=Math.floor(this.sampleRate/128);e&&t%s===0&&(yield new Promise(r=>setTimeout(r,1)))}})}render(){return Ft(this,arguments,void 0,function*(e=!0){yield this.workletsAreReady(),yield this._renderClock(e);const t=yield this._context.startRendering();return new yt(t)})}close(){return Promise.resolve()}}const nh=new Wv;let Nr=nh;function Vs(){return Nr===nh&&Dv&&Lv(new mi),Nr}function Lv(n,e=!1){e&&Nr.dispose(),kr(n)?Nr=new mi(n):Ei(n)?Nr=new ta(n):Nr=n}if(Is&&!Is.TONE_SILENCE_LOGGING){const e=` * Tone.js v${nu} * `;console.log(`%c${e}`,"background: #000; color: #fff")}function Bv(n){return Math.pow(10,n/20)}function Hv(n){return 20*(Math.log(n)/Math.LN10)}function rh(n){return Math.pow(2,n/12)}let Ji=440;function jv(){return Ji}function Uv(n){Ji=n}function Eo(n){return Math.round(ih(n))}function ih(n){return 69+12*Math.log2(n/Ji)}function zv(n){return Ji*Math.pow(2,(n-69)/12)}class sa extends Vn{constructor(e,t,s){super(),this.defaultUnits="s",this._val=t,this._units=s,this.context=e,this._expressions=this._getExpressions()}_getExpressions(){return{hz:{method:e=>this._frequencyToUnits(parseFloat(e)),regexp:/^(\d+(?:\.\d+)?)hz$/i},i:{method:e=>this._ticksToUnits(parseInt(e,10)),regexp:/^(\d+)i$/i},m:{method:e=>this._beatsToUnits(parseInt(e,10)*this._getTimeSignature()),regexp:/^(\d+)m$/i},n:{method:(e,t)=>{const s=parseInt(e,10),r=t==="."?1.5:1;return s===1?this._beatsToUnits(this._getTimeSignature())*r:this._beatsToUnits(4/s)*r},regexp:/^(\d+)n(\.?)$/i},number:{method:e=>this._expressions[this.defaultUnits].method.call(this,e),regexp:/^(\d+(?:\.\d+)?)$/},s:{method:e=>this._secondsToUnits(parseFloat(e)),regexp:/^(\d+(?:\.\d+)?)s$/},samples:{method:e=>parseInt(e,10)/this.context.sampleRate,regexp:/^(\d+)samples$/},t:{method:e=>{const t=parseInt(e,10);return this._beatsToUnits(8/(Math.floor(t)*3))},regexp:/^(\d+)t$/i},tr:{method:(e,t,s)=>{let r=0;return e&&e!=="0"&&(r+=this._beatsToUnits(this._getTimeSignature()*parseFloat(e))),t&&t!=="0"&&(r+=this._beatsToUnits(parseFloat(t))),s&&s!=="0"&&(r+=this._beatsToUnits(parseFloat(s)/4)),r},regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?$/}}}valueOf(){if(this._val instanceof sa&&this.fromType(this._val),qs(this._val))return this._noArg();if(Rn(this._val)&&qs(this._units)){for(const e in this._expressions)if(this._expressions[e].regexp.test(this._val.trim())){this._units=e;break}}else if(cr(this._val)){let e=0;for(const t in this._val)if(Ge(this._val[t])){const s=this._val[t],r=new this.constructor(this.context,t).valueOf()*s;e+=r}return e}if(Ge(this._units)){const e=this._expressions[this._units],t=this._val.toString().trim().match(e.regexp);return t?e.method.apply(this,t.slice(1)):e.method.call(this,this._val)}else return Rn(this._val)?parseFloat(this._val):this._val}_frequencyToUnits(e){return 1/e}_beatsToUnits(e){return 60/this._getBpm()*e}_secondsToUnits(e){return e}_ticksToUnits(e){return e*this._beatsToUnits(1)/this._getPPQ()}_noArg(){return this._now()}_getBpm(){return this.context.transport.bpm.value}_getTimeSignature(){return this.context.transport.timeSignature}_getPPQ(){return this.context.transport.PPQ}fromType(e){switch(this._units=void 0,this.defaultUnits){case"s":this._val=e.toSeconds();break;case"i":this._val=e.toTicks();break;case"hz":this._val=e.toFrequency();break;case"midi":this._val=e.toMidi();break}return this}toFrequency(){return 1/this.toSeconds()}toSamples(){return this.toSeconds()*this.context.sampleRate}toMilliseconds(){return this.toSeconds()*1e3}}class Gs extends sa{constructor(){super(...arguments),this.name="TimeClass"}_getExpressions(){return Object.assign(super._getExpressions(),{now:{method:e=>this._now()+new this.constructor(this.context,e).valueOf(),regexp:/^\+(.+)/},quantize:{method:e=>{const t=new Gs(this.context,e).valueOf();return this._secondsToUnits(this.context.transport.nextSubdivision(t))},regexp:/^@(.+)/}})}quantize(e,t=1){const s=new this.constructor(this.context,e).valueOf(),r=this.valueOf(),a=Math.round(r/s)*s-r;return r+a*t}toNotation(){const e=this.toSeconds(),t=["1m"];for(let i=1;i<9;i++){const o=Math.pow(2,i);t.push(o+"n."),t.push(o+"n"),t.push(o+"t")}t.push("0");let s=t[0],r=new Gs(this.context,t[0]).toSeconds();return t.forEach(i=>{const o=new Gs(this.context,i).toSeconds();Math.abs(o-e)<Math.abs(r-e)&&(s=i,r=o)}),s}toBarsBeatsSixteenths(){const e=this._beatsToUnits(1);let t=this.valueOf()/e;t=parseFloat(t.toFixed(4));const s=Math.floor(t/this._getTimeSignature());let r=t%1*4;t=Math.floor(t)%this._getTimeSignature();const i=r.toString();return i.length>3&&(r=parseFloat(parseFloat(i).toFixed(3))),[s,t,r].join(":")}toTicks(){const e=this._beatsToUnits(1);return this.valueOf()/e*this._getPPQ()}toSeconds(){return this.valueOf()}toMidi(){return Eo(this.toFrequency())}_now(){return this.context.now()}}class xs extends Gs{constructor(){super(...arguments),this.name="Frequency",this.defaultUnits="hz"}static get A4(){return jv()}static set A4(e){Uv(e)}_getExpressions(){return Object.assign({},super._getExpressions(),{midi:{regexp:/^(\d+(?:\.\d+)?midi)/,method(e){return this.defaultUnits==="midi"?e:xs.mtof(e)}},note:{regexp:/^([a-g]{1}(?:b|#|##|x|bb|###|#x|x#|bbb)?)(-?[0-9]+)/i,method(e,t){const r=Gv[e.toLowerCase()]+(parseInt(t,10)+1)*12;return this.defaultUnits==="midi"?r:xs.mtof(r)}},tr:{regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?/,method(e,t,s){let r=1;return e&&e!=="0"&&(r*=this._beatsToUnits(this._getTimeSignature()*parseFloat(e))),t&&t!=="0"&&(r*=this._beatsToUnits(parseFloat(t))),s&&s!=="0"&&(r*=this._beatsToUnits(parseFloat(s)/4)),r}}})}transpose(e){return new xs(this.context,this.valueOf()*rh(e))}harmonize(e){return e.map(t=>this.transpose(t))}toMidi(){return Eo(this.valueOf())}toNote(){const e=this.toFrequency(),t=Math.log2(e/xs.A4);let s=Math.round(12*t)+57;const r=Math.floor(s/12);return r<0&&(s+=-12*r),Zv[s%12]+r.toString()}toSeconds(){return 1/super.toSeconds()}toTicks(){const e=this._beatsToUnits(1),t=this.valueOf()/e;return Math.floor(t*this._getPPQ())}_noArg(){return 0}_frequencyToUnits(e){return e}_ticksToUnits(e){return 1/(e*60/(this._getBpm()*this._getPPQ()))}_beatsToUnits(e){return 1/super._beatsToUnits(e)}_secondsToUnits(e){return 1/e}static mtof(e){return zv(e)}static ftom(e){return Eo(e)}}const Gv={cbbb:-3,cbb:-2,cb:-1,c:0,"c#":1,cx:2,"c##":2,"c###":3,"cx#":3,"c#x":3,dbbb:-1,dbb:0,db:1,d:2,"d#":3,dx:4,"d##":4,"d###":5,"dx#":5,"d#x":5,ebbb:1,ebb:2,eb:3,e:4,"e#":5,ex:6,"e##":6,"e###":7,"ex#":7,"e#x":7,fbbb:2,fbb:3,fb:4,f:5,"f#":6,fx:7,"f##":7,"f###":8,"fx#":8,"f#x":8,gbbb:4,gbb:5,gb:6,g:7,"g#":8,gx:9,"g##":9,"g###":10,"gx#":10,"g#x":10,abbb:6,abb:7,ab:8,a:9,"a#":10,ax:11,"a##":11,"a###":12,"ax#":12,"a#x":12,bbbb:8,bbb:9,bb:10,b:11,"b#":12,bx:13,"b##":13,"b###":14,"bx#":14,"b#x":14},Zv=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];class ei extends Gs{constructor(){super(...arguments),this.name="TransportTime"}_now(){return this.context.transport.seconds}}class ys extends Vn{constructor(){super();const e=Fe(ys.getDefaults(),arguments,["context"]);this.defaultContext?this.context=this.defaultContext:this.context=e.context}static getDefaults(){return{context:Vs()}}now(){return this.context.currentTime+this.context.lookAhead}immediate(){return this.context.currentTime}get sampleTime(){return 1/this.context.sampleRate}get blockTime(){return 128/this.context.sampleRate}toSeconds(e){return Av(e),new Gs(this.context,e).toSeconds()}toFrequency(e){return new xs(this.context,e).toFrequency()}toTicks(e){return new ei(this.context,e).toTicks()}_getPartialProperties(e){const t=this.get();return Object.keys(t).forEach(s=>{qs(e[s])&&delete t[s]}),t}get(){const e=Vv(this);return Object.keys(e).forEach(t=>{if(Reflect.has(this,t)){const s=this[t];Ge(s)&&Ge(s.value)&&Ge(s.setValueAtTime)?e[t]=s.value:s instanceof ys?e[t]=s._getPartialProperties(e[t]):Zs(s)||hr(s)||Rn(s)||kv(s)?e[t]=s:delete e[t]}}),e}set(e){return Object.keys(e).forEach(t=>{Reflect.has(this,t)&&Ge(this[t])&&(this[t]&&Ge(this[t].value)&&Ge(this[t].setValueAtTime)?this[t].value!==e[t]&&(this[t].value=e[t]):this[t]instanceof ys?this[t].set(e[t]):this[t]=e[t])}),this}}class na extends Ws{constructor(e="stopped"){super(),this.name="StateTimeline",this._initial=e,this.setStateAtTime(this._initial,0)}getValueAtTime(e){const t=this.get(e);return t!==null?t.state:this._initial}setStateAtTime(e,t,s){return jn(t,0),this.add(Object.assign({},s,{state:e,time:t})),this}getLastState(e,t){const s=this._search(t);for(let r=s;r>=0;r--){const i=this._timeline[r];if(i.state===e)return i}}getNextState(e,t){const s=this._search(t);if(s!==-1)for(let r=s;r<this._timeline.length;r++){const i=this._timeline[r];if(i.state===e)return i}}}class wt extends ys{constructor(){const e=Fe(wt.getDefaults(),arguments,["param","units","convert"]);for(super(e),this.name="Param",this.overridden=!1,this._minOutput=1e-7,qe(Ge(e.param)&&(fr(e.param)||e.param instanceof wt),"param must be an AudioParam");!fr(e.param);)e.param=e.param._param;this._swappable=Ge(e.swappable)?e.swappable:!1,this._swappable?(this.input=this.context.createGain(),this._param=e.param,this.input.connect(this._param)):this._param=this.input=e.param,this._events=new Ws(1e3),this._initialValue=this._param.defaultValue,this.units=e.units,this.convert=e.convert,this._minValue=e.minValue,this._maxValue=e.maxValue,Ge(e.value)&&e.value!==this._toType(this._initialValue)&&this.setValueAtTime(e.value,0)}static getDefaults(){return Object.assign(ys.getDefaults(),{convert:!0,units:"number"})}get value(){const e=this.now();return this.getValueAtTime(e)}set value(e){this.cancelScheduledValues(this.now()),this.setValueAtTime(e,this.now())}get minValue(){return Ge(this._minValue)?this._minValue:this.units==="time"||this.units==="frequency"||this.units==="normalRange"||this.units==="positive"||this.units==="transportTime"||this.units==="ticks"||this.units==="bpm"||this.units==="hertz"||this.units==="samples"?0:this.units==="audioRange"?-1:this.units==="decibels"?-1/0:this._param.minValue}get maxValue(){return Ge(this._maxValue)?this._maxValue:this.units==="normalRange"||this.units==="audioRange"?1:this._param.maxValue}_is(e,t){return this.units===t}_assertRange(e){return Ge(this.maxValue)&&Ge(this.minValue)&&jn(e,this._fromType(this.minValue),this._fromType(this.maxValue)),e}_fromType(e){return this.convert&&!this.overridden?this._is(e,"time")?this.toSeconds(e):this._is(e,"decibels")?Bv(e):this._is(e,"frequency")?this.toFrequency(e):e:this.overridden?0:e}_toType(e){return this.convert&&this.units==="decibels"?Hv(e):e}setValueAtTime(e,t){const s=this.toSeconds(t),r=this._fromType(e);return qe(isFinite(r)&&isFinite(s),`Invalid argument(s) to setValueAtTime: ${JSON.stringify(e)}, ${JSON.stringify(t)}`),this._assertRange(r),this.log(this.units,"setValueAtTime",e,s),this._events.add({time:s,type:"setValueAtTime",value:r}),this._param.setValueAtTime(r,s),this}getValueAtTime(e){const t=Math.max(this.toSeconds(e),0),s=this._events.getAfter(t),r=this._events.get(t);let i=this._initialValue;if(r===null)i=this._initialValue;else if(r.type==="setTargetAtTime"&&(s===null||s.type==="setValueAtTime")){const o=this._events.getBefore(r.time);let a;o===null?a=this._initialValue:a=o.value,r.type==="setTargetAtTime"&&(i=this._exponentialApproach(r.time,a,r.value,r.constant,t))}else if(s===null)i=r.value;else if(s.type==="linearRampToValueAtTime"||s.type==="exponentialRampToValueAtTime"){let o=r.value;if(r.type==="setTargetAtTime"){const a=this._events.getBefore(r.time);a===null?o=this._initialValue:o=a.value}s.type==="linearRampToValueAtTime"?i=this._linearInterpolate(r.time,o,s.time,s.value,t):i=this._exponentialInterpolate(r.time,o,s.time,s.value,t)}else i=r.value;return this._toType(i)}setRampPoint(e){e=this.toSeconds(e);let t=this.getValueAtTime(e);return this.cancelAndHoldAtTime(e),this._fromType(t)===0&&(t=this._toType(this._minOutput)),this.setValueAtTime(t,e),this}linearRampToValueAtTime(e,t){const s=this._fromType(e),r=this.toSeconds(t);return qe(isFinite(s)&&isFinite(r),`Invalid argument(s) to linearRampToValueAtTime: ${JSON.stringify(e)}, ${JSON.stringify(t)}`),this._assertRange(s),this._events.add({time:r,type:"linearRampToValueAtTime",value:s}),this.log(this.units,"linearRampToValueAtTime",e,r),this._param.linearRampToValueAtTime(s,r),this}exponentialRampToValueAtTime(e,t){let s=this._fromType(e);s=zs(s,0)?this._minOutput:s,this._assertRange(s);const r=this.toSeconds(t);return qe(isFinite(s)&&isFinite(r),`Invalid argument(s) to exponentialRampToValueAtTime: ${JSON.stringify(e)}, ${JSON.stringify(t)}`),this._events.add({time:r,type:"exponentialRampToValueAtTime",value:s}),this.log(this.units,"exponentialRampToValueAtTime",e,r),this._param.exponentialRampToValueAtTime(s,r),this}exponentialRampTo(e,t,s){return s=this.toSeconds(s),this.setRampPoint(s),this.exponentialRampToValueAtTime(e,s+this.toSeconds(t)),this}linearRampTo(e,t,s){return s=this.toSeconds(s),this.setRampPoint(s),this.linearRampToValueAtTime(e,s+this.toSeconds(t)),this}targetRampTo(e,t,s){return s=this.toSeconds(s),this.setRampPoint(s),this.exponentialApproachValueAtTime(e,s,t),this}exponentialApproachValueAtTime(e,t,s){t=this.toSeconds(t),s=this.toSeconds(s);const r=Math.log(s+1)/Math.log(200);return this.setTargetAtTime(e,t,r),this.cancelAndHoldAtTime(t+s*.9),this.linearRampToValueAtTime(e,t+s),this}setTargetAtTime(e,t,s){const r=this._fromType(e);qe(isFinite(s)&&s>0,"timeConstant must be a number greater than 0");const i=this.toSeconds(t);return this._assertRange(r),qe(isFinite(r)&&isFinite(i),`Invalid argument(s) to setTargetAtTime: ${JSON.stringify(e)}, ${JSON.stringify(t)}`),this._events.add({constant:s,time:i,type:"setTargetAtTime",value:r}),this.log(this.units,"setTargetAtTime",e,i,s),this._param.setTargetAtTime(r,i,s),this}setValueCurveAtTime(e,t,s,r=1){s=this.toSeconds(s),t=this.toSeconds(t);const i=this._fromType(e[0])*r;this.setValueAtTime(this._toType(i),t);const o=s/(e.length-1);for(let a=1;a<e.length;a++){const l=this._fromType(e[a])*r;this.linearRampToValueAtTime(this._toType(l),t+a*o)}return this}cancelScheduledValues(e){const t=this.toSeconds(e);return qe(isFinite(t),`Invalid argument to cancelScheduledValues: ${JSON.stringify(e)}`),this._events.cancel(t),this._param.cancelScheduledValues(t),this.log(this.units,"cancelScheduledValues",t),this}cancelAndHoldAtTime(e){const t=this.toSeconds(e),s=this._fromType(this.getValueAtTime(t));qe(isFinite(t),`Invalid argument to cancelAndHoldAtTime: ${JSON.stringify(e)}`),this.log(this.units,"cancelAndHoldAtTime",t,"value="+s);const r=this._events.get(t),i=this._events.getAfter(t);return r&&zs(r.time,t)?i?(this._param.cancelScheduledValues(i.time),this._events.cancel(i.time)):(this._param.cancelAndHoldAtTime(t),this._events.cancel(t+this.sampleTime)):i&&(this._param.cancelScheduledValues(i.time),this._events.cancel(i.time),i.type==="linearRampToValueAtTime"?this.linearRampToValueAtTime(this._toType(s),t):i.type==="exponentialRampToValueAtTime"&&this.exponentialRampToValueAtTime(this._toType(s),t)),this._events.add({time:t,type:"setValueAtTime",value:s}),this._param.setValueAtTime(s,t),this}rampTo(e,t=.1,s){return this.units==="frequency"||this.units==="bpm"||this.units==="decibels"?this.exponentialRampTo(e,t,s):this.linearRampTo(e,t,s),this}apply(e){const t=this.context.currentTime;e.setValueAtTime(this.getValueAtTime(t),t);const s=this._events.get(t);if(s&&s.type==="setTargetAtTime"){const r=this._events.getAfter(s.time),i=r?r.time:t+2,o=(i-t)/10;for(let a=t;a<i;a+=o)e.linearRampToValueAtTime(this.getValueAtTime(a),a)}return this._events.forEachAfter(this.context.currentTime,r=>{r.type==="cancelScheduledValues"?e.cancelScheduledValues(r.time):r.type==="setTargetAtTime"?e.setTargetAtTime(r.value,r.time,r.constant):e[r.type](r.value,r.time)}),this}setParam(e){qe(this._swappable,"The Param must be assigned as 'swappable' in the constructor");const t=this.input;return t.disconnect(this._param),this.apply(e),this._param=e,t.connect(this._param),this}dispose(){return super.dispose(),this._events.dispose(),this}get defaultValue(){return this._toType(this._param.defaultValue)}_exponentialApproach(e,t,s,r,i){return s+(t-s)*Math.exp(-(i-e)/r)}_linearInterpolate(e,t,s,r,i){return t+(r-t)*((i-e)/(s-e))}_exponentialInterpolate(e,t,s,r,i){return t*Math.pow(r/t,(i-e)/(s-e))}}class Ue extends ys{constructor(){super(...arguments),this._internalChannels=[]}get numberOfInputs(){return Ge(this.input)?fr(this.input)||this.input instanceof wt?1:this.input.numberOfInputs:0}get numberOfOutputs(){return Ge(this.output)?this.output.numberOfOutputs:0}_isAudioNode(e){return Ge(e)&&(e instanceof Ue||Bn(e))}_getInternalNodes(){const e=this._internalChannels.slice(0);return this._isAudioNode(this.input)&&e.push(this.input),this._isAudioNode(this.output)&&this.input!==this.output&&e.push(this.output),e}_setChannelProperties(e){this._getInternalNodes().forEach(s=>{s.channelCount=e.channelCount,s.channelCountMode=e.channelCountMode,s.channelInterpretation=e.channelInterpretation})}_getChannelProperties(){const e=this._getInternalNodes();qe(e.length>0,"ToneAudioNode does not have any internal nodes");const t=e[0];return{channelCount:t.channelCount,channelCountMode:t.channelCountMode,channelInterpretation:t.channelInterpretation}}get channelCount(){return this._getChannelProperties().channelCount}set channelCount(e){const t=this._getChannelProperties();this._setChannelProperties(Object.assign(t,{channelCount:e}))}get channelCountMode(){return this._getChannelProperties().channelCountMode}set channelCountMode(e){const t=this._getChannelProperties();this._setChannelProperties(Object.assign(t,{channelCountMode:e}))}get channelInterpretation(){return this._getChannelProperties().channelInterpretation}set channelInterpretation(e){const t=this._getChannelProperties();this._setChannelProperties(Object.assign(t,{channelInterpretation:e}))}connect(e,t=0,s=0){return Xr(this,e,t,s),this}toDestination(){return this.connect(this.context.destination),this}toMaster(){return Ko("toMaster() has been renamed toDestination()"),this.toDestination()}disconnect(e,t=0,s=0){return Xv(this,e,t,s),this}chain(...e){return Io(this,...e),this}fan(...e){return e.forEach(t=>this.connect(t)),this}dispose(){return super.dispose(),Ge(this.input)&&(this.input instanceof Ue?this.input.dispose():Bn(this.input)&&this.input.disconnect()),Ge(this.output)&&(this.output instanceof Ue?this.output.dispose():Bn(this.output)&&this.output.disconnect()),this._internalChannels=[],this}}function Io(...n){const e=n.shift();n.reduce((t,s)=>(t instanceof Ue?t.connect(s):Bn(t)&&Xr(t,s),s),e)}function Xr(n,e,t=0,s=0){for(qe(Ge(n),"Cannot connect from undefined node"),qe(Ge(e),"Cannot connect to undefined node"),(e instanceof Ue||Bn(e))&&qe(e.numberOfInputs>0,"Cannot connect to node with no inputs"),qe(n.numberOfOutputs>0,"Cannot connect from node with no outputs");e instanceof Ue||e instanceof wt;)Ge(e.input)&&(e=e.input);for(;n instanceof Ue;)Ge(n.output)&&(n=n.output);fr(e)?n.connect(e,t):n.connect(e,t,s)}function Xv(n,e,t=0,s=0){if(Ge(e))for(;e instanceof Ue;)e=e.input;for(;!Bn(n);)Ge(n.output)&&(n=n.output);fr(e)?n.disconnect(e,t):Bn(e)?n.disconnect(e,t,s):n.disconnect()}class is extends Ue{constructor(){const e=Fe(is.getDefaults(),arguments,["gain","units"]);super(e),this.name="Gain",this._gainNode=this.context.createGain(),this.input=this._gainNode,this.output=this._gainNode,this.gain=new wt({context:this.context,convert:e.convert,param:this._gainNode.gain,units:e.units,value:e.gain,minValue:e.minValue,maxValue:e.maxValue}),It(this,"gain")}static getDefaults(){return Object.assign(Ue.getDefaults(),{convert:!0,gain:1,units:"gain"})}dispose(){return super.dispose(),this._gainNode.disconnect(),this.gain.dispose(),this}}class xr extends Ue{constructor(e){super(e),this.onended=lt,this._startTime=-1,this._stopTime=-1,this._timeout=-1,this.output=new is({context:this.context,gain:0}),this._gainNode=this.output,this.getStateAtTime=function(t){const s=this.toSeconds(t);return this._startTime!==-1&&s>=this._startTime&&(this._stopTime===-1||s<=this._stopTime)?"started":"stopped"},this._fadeIn=e.fadeIn,this._fadeOut=e.fadeOut,this._curve=e.curve,this.onended=e.onended}static getDefaults(){return Object.assign(Ue.getDefaults(),{curve:"linear",fadeIn:0,fadeOut:0,onended:lt})}_startGain(e,t=1){qe(this._startTime===-1,"Source cannot be started more than once");const s=this.toSeconds(this._fadeIn);return this._startTime=e+s,this._startTime=Math.max(this._startTime,this.context.currentTime),s>0?(this._gainNode.gain.setValueAtTime(0,e),this._curve==="linear"?this._gainNode.gain.linearRampToValueAtTime(t,e+s):this._gainNode.gain.exponentialApproachValueAtTime(t,e,s)):this._gainNode.gain.setValueAtTime(t,e),this}stop(e){return this.log("stop",e),this._stopGain(this.toSeconds(e)),this}_stopGain(e){qe(this._startTime!==-1,"'start' must be called before 'stop'"),this.cancelStop();const t=this.toSeconds(this._fadeOut);return this._stopTime=this.toSeconds(e)+t,this._stopTime=Math.max(this._stopTime,this.now()),t>0?this._curve==="linear"?this._gainNode.gain.linearRampTo(0,t,e):this._gainNode.gain.targetRampTo(0,t,e):(this._gainNode.gain.cancelAndHoldAtTime(e),this._gainNode.gain.setValueAtTime(0,e)),this.context.clearTimeout(this._timeout),this._timeout=this.context.setTimeout(()=>{const s=this._curve==="exponential"?t*2:0;this._stopSource(this.now()+s),this._onended()},this._stopTime-this.context.currentTime),this}_onended(){if(this.onended!==lt&&(this.onended(this),this.onended=lt,!this.context.isOffline)){const e=()=>this.dispose();typeof requestIdleCallback<"u"?requestIdleCallback(e):setTimeout(e,10)}}get state(){return this.getStateAtTime(this.now())}cancelStop(){return this.log("cancelStop"),qe(this._startTime!==-1,"Source is not started"),this._gainNode.gain.cancelScheduledValues(this._startTime+this.sampleTime),this.context.clearTimeout(this._timeout),this._stopTime=-1,this}dispose(){return super.dispose(),this._gainNode.dispose(),this.onended=lt,this}}class ra extends xr{constructor(){const e=Fe(ra.getDefaults(),arguments,["offset"]);super(e),this.name="ToneConstantSource",this._source=this.context.createConstantSource(),Xr(this._source,this._gainNode),this.offset=new wt({context:this.context,convert:e.convert,param:this._source.offset,units:e.units,value:e.offset,minValue:e.minValue,maxValue:e.maxValue})}static getDefaults(){return Object.assign(xr.getDefaults(),{convert:!0,offset:1,units:"number"})}start(e){const t=this.toSeconds(e);return this.log("start",t),this._startGain(t),this._source.start(t),this}_stopSource(e){this._source.stop(e)}dispose(){return super.dispose(),this.state==="started"&&this.stop(),this._source.disconnect(),this.offset.dispose(),this}}class Zt extends Ue{constructor(){const e=Fe(Zt.getDefaults(),arguments,["value","units"]);super(e),this.name="Signal",this.override=!0,this.output=this._constantSource=new ra({context:this.context,convert:e.convert,offset:e.value,units:e.units,minValue:e.minValue,maxValue:e.maxValue}),this._constantSource.start(0),this.input=this._param=this._constantSource.offset}static getDefaults(){return Object.assign(Ue.getDefaults(),{convert:!0,units:"number",value:0})}connect(e,t=0,s=0){return ia(this,e,t,s),this}dispose(){return super.dispose(),this._param.dispose(),this._constantSource.dispose(),this}setValueAtTime(e,t){return this._param.setValueAtTime(e,t),this}getValueAtTime(e){return this._param.getValueAtTime(e)}setRampPoint(e){return this._param.setRampPoint(e),this}linearRampToValueAtTime(e,t){return this._param.linearRampToValueAtTime(e,t),this}exponentialRampToValueAtTime(e,t){return this._param.exponentialRampToValueAtTime(e,t),this}exponentialRampTo(e,t,s){return this._param.exponentialRampTo(e,t,s),this}linearRampTo(e,t,s){return this._param.linearRampTo(e,t,s),this}targetRampTo(e,t,s){return this._param.targetRampTo(e,t,s),this}exponentialApproachValueAtTime(e,t,s){return this._param.exponentialApproachValueAtTime(e,t,s),this}setTargetAtTime(e,t,s){return this._param.setTargetAtTime(e,t,s),this}setValueCurveAtTime(e,t,s,r){return this._param.setValueCurveAtTime(e,t,s,r),this}cancelScheduledValues(e){return this._param.cancelScheduledValues(e),this}cancelAndHoldAtTime(e){return this._param.cancelAndHoldAtTime(e),this}rampTo(e,t,s){return this._param.rampTo(e,t,s),this}get value(){return this._param.value}set value(e){this._param.value=e}get convert(){return this._param.convert}set convert(e){this._param.convert=e}get units(){return this._param.units}get overridden(){return this._param.overridden}set overridden(e){this._param.overridden=e}get maxValue(){return this._param.maxValue}get minValue(){return this._param.minValue}apply(e){return this._param.apply(e),this}}function ia(n,e,t,s){(e instanceof wt||fr(e)||e instanceof Zt&&e.override)&&(e.cancelScheduledValues(0),e.setValueAtTime(0,0),e instanceof Zt&&(e.overridden=!0)),Xr(n,e,t,s)}class oa extends wt{constructor(){const e=Fe(oa.getDefaults(),arguments,["value"]);super(e),this.name="TickParam",this._events=new Ws(1/0),this._multiplier=1,this._multiplier=e.multiplier,this._events.cancel(0),this._events.add({ticks:0,time:0,type:"setValueAtTime",value:this._fromType(e.value)}),this.setValueAtTime(e.value,0)}static getDefaults(){return Object.assign(wt.getDefaults(),{multiplier:1,units:"hertz",value:1})}setTargetAtTime(e,t,s){t=this.toSeconds(t),this.setRampPoint(t);const r=this._fromType(e),i=this._events.get(t),o=Math.round(Math.max(1/s,1));for(let a=0;a<=o;a++){const l=s*a+t,c=this._exponentialApproach(i.time,i.value,r,s,l);this.linearRampToValueAtTime(this._toType(c),l)}return this}setValueAtTime(e,t){const s=this.toSeconds(t);super.setValueAtTime(e,t);const r=this._events.get(s),i=this._events.previousEvent(r),o=this._getTicksUntilEvent(i,s);return r.ticks=Math.max(o,0),this}linearRampToValueAtTime(e,t){const s=this.toSeconds(t);super.linearRampToValueAtTime(e,t);const r=this._events.get(s),i=this._events.previousEvent(r),o=this._getTicksUntilEvent(i,s);return r.ticks=Math.max(o,0),this}exponentialRampToValueAtTime(e,t){t=this.toSeconds(t);const s=this._fromType(e),r=this._events.get(t),i=Math.round(Math.max((t-r.time)*10,1)),o=(t-r.time)/i;for(let a=0;a<=i;a++){const l=o*a+r.time,c=this._exponentialInterpolate(r.time,r.value,t,s,l);this.linearRampToValueAtTime(this._toType(c),l)}return this}_getTicksUntilEvent(e,t){if(e===null)e={ticks:0,time:0,type:"setValueAtTime",value:0};else if(qs(e.ticks)){const o=this._events.previousEvent(e);e.ticks=this._getTicksUntilEvent(o,e.time)}const s=this._fromType(this.getValueAtTime(e.time));let r=this._fromType(this.getValueAtTime(t));const i=this._events.get(t);return i&&i.time===t&&i.type==="setValueAtTime"&&(r=this._fromType(this.getValueAtTime(t-this.sampleTime))),.5*(t-e.time)*(s+r)+e.ticks}getTicksAtTime(e){const t=this.toSeconds(e),s=this._events.get(t);return Math.max(this._getTicksUntilEvent(s,t),0)}getDurationOfTicks(e,t){const s=this.toSeconds(t),r=this.getTicksAtTime(t);return this.getTimeOfTick(r+e)-s}getTimeOfTick(e){const t=this._events.get(e,"ticks"),s=this._events.getAfter(e,"ticks");if(t&&t.ticks===e)return t.time;if(t&&s&&s.type==="linearRampToValueAtTime"&&t.value!==s.value){const r=this._fromType(this.getValueAtTime(t.time)),o=(this._fromType(this.getValueAtTime(s.time))-r)/(s.time-t.time),a=Math.sqrt(Math.pow(r,2)-2*o*(t.ticks-e)),l=(-r+a)/o,c=(-r-a)/o;return(l>0?l:c)+t.time}else return t?t.value===0?1/0:t.time+(e-t.ticks)/t.value:e/this._initialValue}ticksToTime(e,t){return this.getDurationOfTicks(e,t)}timeToTicks(e,t){const s=this.toSeconds(t),r=this.toSeconds(e),i=this.getTicksAtTime(s);return this.getTicksAtTime(s+r)-i}_fromType(e){return this.units==="bpm"&&this.multiplier?1/(60/e/this.multiplier):super._fromType(e)}_toType(e){return this.units==="bpm"&&this.multiplier?e/this.multiplier*60:super._toType(e)}get multiplier(){return this._multiplier}set multiplier(e){const t=this.value;this._multiplier=e,this.cancelScheduledValues(0),this.setValueAtTime(t,0)}}class aa extends Zt{constructor(){const e=Fe(aa.getDefaults(),arguments,["value"]);super(e),this.name="TickSignal",this.input=this._param=new oa({context:this.context,convert:e.convert,multiplier:e.multiplier,param:this._constantSource.offset,units:e.units,value:e.value})}static getDefaults(){return Object.assign(Zt.getDefaults(),{multiplier:1,units:"hertz",value:1})}ticksToTime(e,t){return this._param.ticksToTime(e,t)}timeToTicks(e,t){return this._param.timeToTicks(e,t)}getTimeOfTick(e){return this._param.getTimeOfTick(e)}getDurationOfTicks(e,t){return this._param.getDurationOfTicks(e,t)}getTicksAtTime(e){return this._param.getTicksAtTime(e)}get multiplier(){return this._param.multiplier}set multiplier(e){this._param.multiplier=e}dispose(){return super.dispose(),this._param.dispose(),this}}class la extends ys{constructor(){const e=Fe(la.getDefaults(),arguments,["frequency"]);super(e),this.name="TickSource",this._state=new na,this._tickOffset=new Ws,this._ticksAtTime=new Ws,this._secondsAtTime=new Ws,this.frequency=new aa({context:this.context,units:e.units,value:e.frequency}),It(this,"frequency"),this._state.setStateAtTime("stopped",0),this.setTicksAtTime(0,0)}static getDefaults(){return Object.assign({frequency:1,units:"hertz"},ys.getDefaults())}get state(){return this.getStateAtTime(this.now())}start(e,t){const s=this.toSeconds(e);return this._state.getValueAtTime(s)!=="started"&&(this._state.setStateAtTime("started",s),Ge(t)&&this.setTicksAtTime(t,s),this._ticksAtTime.cancel(s),this._secondsAtTime.cancel(s)),this}stop(e){const t=this.toSeconds(e);if(this._state.getValueAtTime(t)==="stopped"){const s=this._state.get(t);s&&s.time>0&&(this._tickOffset.cancel(s.time),this._state.cancel(s.time))}return this._state.cancel(t),this._state.setStateAtTime("stopped",t),this.setTicksAtTime(0,t),this._ticksAtTime.cancel(t),this._secondsAtTime.cancel(t),this}pause(e){const t=this.toSeconds(e);return this._state.getValueAtTime(t)==="started"&&(this._state.setStateAtTime("paused",t),this._ticksAtTime.cancel(t),this._secondsAtTime.cancel(t)),this}cancel(e){return e=this.toSeconds(e),this._state.cancel(e),this._tickOffset.cancel(e),this._ticksAtTime.cancel(e),this._secondsAtTime.cancel(e),this}getTicksAtTime(e){const t=this.toSeconds(e),s=this._state.getLastState("stopped",t),r=this._ticksAtTime.get(t),i={state:"paused",time:t};this._state.add(i);let o=r||s,a=r?r.ticks:0,l=null;return this._state.forEachBetween(o.time,t+this.sampleTime,c=>{let u=o.time;const h=this._tickOffset.get(c.time);h&&h.time>=o.time&&(a=h.ticks,u=h.time),o.state==="started"&&c.state!=="started"&&(a+=this.frequency.getTicksAtTime(c.time)-this.frequency.getTicksAtTime(u),c.time!==i.time&&(l={state:c.state,time:c.time,ticks:a})),o=c}),this._state.remove(i),l&&this._ticksAtTime.add(l),a}get ticks(){return this.getTicksAtTime(this.now())}set ticks(e){this.setTicksAtTime(e,this.now())}get seconds(){return this.getSecondsAtTime(this.now())}set seconds(e){const t=this.now(),s=this.frequency.timeToTicks(e,t);this.setTicksAtTime(s,t)}getSecondsAtTime(e){e=this.toSeconds(e);const t=this._state.getLastState("stopped",e),s={state:"paused",time:e};this._state.add(s);const r=this._secondsAtTime.get(e);let i=r||t,o=r?r.seconds:0,a=null;return this._state.forEachBetween(i.time,e+this.sampleTime,l=>{let c=i.time;const u=this._tickOffset.get(l.time);u&&u.time>=i.time&&(o=u.seconds,c=u.time),i.state==="started"&&l.state!=="started"&&(o+=l.time-c,l.time!==s.time&&(a={state:l.state,time:l.time,seconds:o})),i=l}),this._state.remove(s),a&&this._secondsAtTime.add(a),o}setTicksAtTime(e,t){return t=this.toSeconds(t),this._tickOffset.cancel(t),this._tickOffset.add({seconds:this.frequency.getDurationOfTicks(e,t),ticks:e,time:t}),this._ticksAtTime.cancel(t),this._secondsAtTime.cancel(t),this}getStateAtTime(e){return e=this.toSeconds(e),this._state.getValueAtTime(e)}getTimeOfTick(e,t=this.now()){const s=this._tickOffset.get(t),r=this._state.get(t),i=Math.max(s.time,r.time),o=this.frequency.getTicksAtTime(i)+e-s.ticks;return this.frequency.getTimeOfTick(o)}forEachTickBetween(e,t,s){let r=this._state.get(e);this._state.forEachBetween(e,t,o=>{r&&r.state==="started"&&o.state!=="started"&&this.forEachTickBetween(Math.max(r.time,e),o.time-this.sampleTime,s),r=o});let i=null;if(r&&r.state==="started"){const o=Math.max(r.time,e),a=this.frequency.getTicksAtTime(o),l=this.frequency.getTicksAtTime(r.time),c=a-l;let u=Math.ceil(c)-c;u=zs(u,1)?0:u;let h=this.frequency.getTimeOfTick(a+u);for(;h<t;){try{s(h,Math.round(this.getTicksAtTime(h)))}catch(f){i=f;break}h+=this.frequency.getDurationOfTicks(1,h)}}if(i)throw i;return this}dispose(){return super.dispose(),this._state.dispose(),this._tickOffset.dispose(),this._ticksAtTime.dispose(),this._secondsAtTime.dispose(),this.frequency.dispose(),this}}class Ki extends ys{constructor(){const e=Fe(Ki.getDefaults(),arguments,["callback","frequency"]);super(e),this.name="Clock",this.callback=lt,this._lastUpdate=0,this._state=new na("stopped"),this._boundLoop=this._loop.bind(this),this.callback=e.callback,this._tickSource=new la({context:this.context,frequency:e.frequency,units:e.units}),this._lastUpdate=0,this.frequency=this._tickSource.frequency,It(this,"frequency"),this._state.setStateAtTime("stopped",0),this.context.on("tick",this._boundLoop)}static getDefaults(){return Object.assign(ys.getDefaults(),{callback:lt,frequency:1,units:"hertz"})}get state(){return this._state.getValueAtTime(this.now())}start(e,t){Yu(this.context);const s=this.toSeconds(e);return this.log("start",s),this._state.getValueAtTime(s)!=="started"&&(this._state.setStateAtTime("started",s),this._tickSource.start(s,t),s<this._lastUpdate&&this.emit("start",s,t)),this}stop(e){const t=this.toSeconds(e);return this.log("stop",t),this._state.cancel(t),this._state.setStateAtTime("stopped",t),this._tickSource.stop(t),t<this._lastUpdate&&this.emit("stop",t),this}pause(e){const t=this.toSeconds(e);return this._state.getValueAtTime(t)==="started"&&(this._state.setStateAtTime("paused",t),this._tickSource.pause(t),t<this._lastUpdate&&this.emit("pause",t)),this}get ticks(){return Math.ceil(this.getTicksAtTime(this.now()))}set ticks(e){this._tickSource.ticks=e}get seconds(){return this._tickSource.seconds}set seconds(e){this._tickSource.seconds=e}getSecondsAtTime(e){return this._tickSource.getSecondsAtTime(e)}setTicksAtTime(e,t){return this._tickSource.setTicksAtTime(e,t),this}getTimeOfTick(e,t=this.now()){return this._tickSource.getTimeOfTick(e,t)}getTicksAtTime(e){return this._tickSource.getTicksAtTime(e)}nextTickTime(e,t){const s=this.toSeconds(t),r=this.getTicksAtTime(s);return this._tickSource.getTimeOfTick(r+e,s)}_loop(){const e=this._lastUpdate,t=this.now();this._lastUpdate=t,this.log("loop",e,t),e!==t&&(this._state.forEachBetween(e,t,s=>{switch(s.state){case"started":const r=this._tickSource.getTicksAtTime(s.time);this.emit("start",s.time,r);break;case"stopped":s.time!==0&&this.emit("stop",s.time);break;case"paused":this.emit("pause",s.time);break}}),this._tickSource.forEachTickBetween(e,t,(s,r)=>{this.callback(s,r)}))}getStateAtTime(e){const t=this.toSeconds(e);return this._state.getValueAtTime(t)}dispose(){return super.dispose(),this.context.off("tick",this._boundLoop),this._tickSource.dispose(),this._state.dispose(),this}}pi.mixin(Ki);class Yr extends Ue{constructor(){const e=Fe(Yr.getDefaults(),arguments,["volume"]);super(e),this.name="Volume",this.input=this.output=new is({context:this.context,gain:e.volume,units:"decibels"}),this.volume=this.output.gain,It(this,"volume"),this._unmutedVolume=e.volume,this.mute=e.mute}static getDefaults(){return Object.assign(Ue.getDefaults(),{mute:!1,volume:0})}get mute(){return this.volume.value===-1/0}set mute(e){!this.mute&&e?(this._unmutedVolume=this.volume.value,this.volume.value=-1/0):this.mute&&!e&&(this.volume.value=this._unmutedVolume)}dispose(){return super.dispose(),this.input.dispose(),this.volume.dispose(),this}}class ca extends Ue{constructor(){const e=Fe(ca.getDefaults(),arguments);super(e),this.name="Destination",this.input=new Yr({context:this.context}),this.output=new is({context:this.context}),this.volume=this.input.volume,Io(this.input,this.output,this.context.rawContext.destination),this.mute=e.mute,this._internalChannels=[this.input,this.context.rawContext.destination,this.output]}static getDefaults(){return Object.assign(Ue.getDefaults(),{mute:!1,volume:0})}get mute(){return this.input.mute}set mute(e){this.input.mute=e}chain(...e){return this.input.disconnect(),e.unshift(this.input),e.push(this.output),Io(...e),this}get maxChannelCount(){return this.context.rawContext.destination.maxChannelCount}dispose(){return super.dispose(),this.volume.dispose(),this}}Yi(n=>{n.destination=new ca({context:n})});Qi(n=>{n.destination.dispose()});class Yv extends Ue{constructor(){super(...arguments),this.name="Listener",this.positionX=new wt({context:this.context,param:this.context.rawContext.listener.positionX}),this.positionY=new wt({context:this.context,param:this.context.rawContext.listener.positionY}),this.positionZ=new wt({context:this.context,param:this.context.rawContext.listener.positionZ}),this.forwardX=new wt({context:this.context,param:this.context.rawContext.listener.forwardX}),this.forwardY=new wt({context:this.context,param:this.context.rawContext.listener.forwardY}),this.forwardZ=new wt({context:this.context,param:this.context.rawContext.listener.forwardZ}),this.upX=new wt({context:this.context,param:this.context.rawContext.listener.upX}),this.upY=new wt({context:this.context,param:this.context.rawContext.listener.upY}),this.upZ=new wt({context:this.context,param:this.context.rawContext.listener.upZ})}static getDefaults(){return Object.assign(Ue.getDefaults(),{positionX:0,positionY:0,positionZ:0,forwardX:0,forwardY:0,forwardZ:-1,upX:0,upY:1,upZ:0})}dispose(){return super.dispose(),this.positionX.dispose(),this.positionY.dispose(),this.positionZ.dispose(),this.forwardX.dispose(),this.forwardY.dispose(),this.forwardZ.dispose(),this.upX.dispose(),this.upY.dispose(),this.upZ.dispose(),this}}Yi(n=>{n.listener=new Yv({context:n})});Qi(n=>{n.listener.dispose()});class ua extends Vn{constructor(){super(),this.name="ToneAudioBuffers",this._buffers=new Map,this._loadingCount=0;const e=Fe(ua.getDefaults(),arguments,["urls","onload","baseUrl"],"urls");this.baseUrl=e.baseUrl,Object.keys(e.urls).forEach(t=>{this._loadingCount++;const s=e.urls[t];this.add(t,s,this._bufferLoaded.bind(this,e.onload),e.onerror)})}static getDefaults(){return{baseUrl:"",onerror:lt,onload:lt,urls:{}}}has(e){return this._buffers.has(e.toString())}get(e){return qe(this.has(e),`ToneAudioBuffers has no buffer named: ${e}`),this._buffers.get(e.toString())}_bufferLoaded(e){this._loadingCount--,this._loadingCount===0&&e&&e()}get loaded(){return Array.from(this._buffers).every(([e,t])=>t.loaded)}add(e,t,s=lt,r=lt){return Rn(t)?(this.baseUrl&&t.trim().substring(0,11).toLowerCase()==="data:audio/"&&(this.baseUrl=""),this._buffers.set(e.toString(),new yt(this.baseUrl+t,s,r))):this._buffers.set(e.toString(),new yt(t,s,r)),this}dispose(){return super.dispose(),this._buffers.forEach(e=>e.dispose()),this._buffers.clear(),this}}class Er extends ei{constructor(){super(...arguments),this.name="Ticks",this.defaultUnits="i"}_now(){return this.context.transport.ticks}_beatsToUnits(e){return this._getPPQ()*e}_secondsToUnits(e){return Math.floor(e/(60/this._getBpm())*this._getPPQ())}_ticksToUnits(e){return e}toTicks(){return this.valueOf()}toSeconds(){return this.valueOf()/this._getPPQ()*(60/this._getBpm())}}class Qv extends ys{constructor(){super(...arguments),this.name="Draw",this.expiration=.25,this.anticipation=.008,this._events=new Ws,this._boundDrawLoop=this._drawLoop.bind(this),this._animationFrame=-1}schedule(e,t){return this._events.add({callback:e,time:this.toSeconds(t)}),this._events.length===1&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop)),this}cancel(e){return this._events.cancel(this.toSeconds(e)),this}_drawLoop(){const e=this.context.currentTime;this._events.forEachBefore(e+this.anticipation,t=>{e-t.time<=this.expiration&&t.callback(),this._events.remove(t)}),this._events.length>0&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop))}dispose(){return super.dispose(),this._events.dispose(),cancelAnimationFrame(this._animationFrame),this}}Yi(n=>{n.draw=new Qv({context:n})});Qi(n=>{n.draw.dispose()});class Jv extends Vn{constructor(){super(...arguments),this.name="IntervalTimeline",this._root=null,this._length=0}add(e){qe(Ge(e.time),"Events must have a time property"),qe(Ge(e.duration),"Events must have a duration parameter"),e.time=e.time.valueOf();let t=new Kv(e.time,e.time+e.duration,e);for(this._root===null?this._root=t:this._root.insert(t),this._length++;t!==null;)t.updateHeight(),t.updateMax(),this._rebalance(t),t=t.parent;return this}remove(e){if(this._root!==null){const t=[];this._root.search(e.time,t);for(const s of t)if(s.event===e){this._removeNode(s),this._length--;break}}return this}get length(){return this._length}cancel(e){return this.forEachFrom(e,t=>this.remove(t)),this}_setRoot(e){this._root=e,this._root!==null&&(this._root.parent=null)}_replaceNodeInParent(e,t){e.parent!==null?(e.isLeftChild()?e.parent.left=t:e.parent.right=t,this._rebalance(e.parent)):this._setRoot(t)}_removeNode(e){if(e.left===null&&e.right===null)this._replaceNodeInParent(e,null);else if(e.right===null)this._replaceNodeInParent(e,e.left);else if(e.left===null)this._replaceNodeInParent(e,e.right);else{const t=e.getBalance();let s,r=null;if(t>0)if(e.left.right===null)s=e.left,s.right=e.right,r=s;else{for(s=e.left.right;s.right!==null;)s=s.right;s.parent&&(s.parent.right=s.left,r=s.parent,s.left=e.left,s.right=e.right)}else if(e.right.left===null)s=e.right,s.left=e.left,r=s;else{for(s=e.right.left;s.left!==null;)s=s.left;s.parent&&(s.parent.left=s.right,r=s.parent,s.left=e.left,s.right=e.right)}e.parent!==null?e.isLeftChild()?e.parent.left=s:e.parent.right=s:this._setRoot(s),r&&this._rebalance(r)}e.dispose()}_rotateLeft(e){const t=e.parent,s=e.isLeftChild(),r=e.right;r&&(e.right=r.left,r.left=e),t!==null?s?t.left=r:t.right=r:this._setRoot(r)}_rotateRight(e){const t=e.parent,s=e.isLeftChild(),r=e.left;r&&(e.left=r.right,r.right=e),t!==null?s?t.left=r:t.right=r:this._setRoot(r)}_rebalance(e){const t=e.getBalance();t>1&&e.left?e.left.getBalance()<0?this._rotateLeft(e.left):this._rotateRight(e):t<-1&&e.right&&(e.right.getBalance()>0?this._rotateRight(e.right):this._rotateLeft(e))}get(e){if(this._root!==null){const t=[];if(this._root.search(e,t),t.length>0){let s=t[0];for(let r=1;r<t.length;r++)t[r].low>s.low&&(s=t[r]);return s.event}}return null}forEach(e){if(this._root!==null){const t=[];this._root.traverse(s=>t.push(s)),t.forEach(s=>{s.event&&e(s.event)})}return this}forEachAtTime(e,t){if(this._root!==null){const s=[];this._root.search(e,s),s.forEach(r=>{r.event&&t(r.event)})}return this}forEachFrom(e,t){if(this._root!==null){const s=[];this._root.searchAfter(e,s),s.forEach(r=>{r.event&&t(r.event)})}return this}dispose(){return super.dispose(),this._root!==null&&this._root.traverse(e=>e.dispose()),this._root=null,this}}class Kv{constructor(e,t,s){this._left=null,this._right=null,this.parent=null,this.height=0,this.event=s,this.low=e,this.high=t,this.max=this.high}insert(e){e.low<=this.low?this.left===null?this.left=e:this.left.insert(e):this.right===null?this.right=e:this.right.insert(e)}search(e,t){e>this.max||(this.left!==null&&this.left.search(e,t),this.low<=e&&this.high>e&&t.push(this),!(this.low>e)&&this.right!==null&&this.right.search(e,t))}searchAfter(e,t){this.low>=e&&(t.push(this),this.left!==null&&this.left.searchAfter(e,t)),this.right!==null&&this.right.searchAfter(e,t)}traverse(e){e(this),this.left!==null&&this.left.traverse(e),this.right!==null&&this.right.traverse(e)}updateHeight(){this.left!==null&&this.right!==null?this.height=Math.max(this.left.height,this.right.height)+1:this.right!==null?this.height=this.right.height+1:this.left!==null?this.height=this.left.height+1:this.height=0}updateMax(){this.max=this.high,this.left!==null&&(this.max=Math.max(this.max,this.left.max)),this.right!==null&&(this.max=Math.max(this.max,this.right.max))}getBalance(){let e=0;return this.left!==null&&this.right!==null?e=this.left.height-this.right.height:this.left!==null?e=this.left.height+1:this.right!==null&&(e=-(this.right.height+1)),e}isLeftChild(){return this.parent!==null&&this.parent.left===this}get left(){return this._left}set left(e){this._left=e,e!==null&&(e.parent=this),this.updateHeight(),this.updateMax()}get right(){return this._right}set right(e){this._right=e,e!==null&&(e.parent=this),this.updateHeight(),this.updateMax()}dispose(){this.parent=null,this._left=null,this._right=null,this.event=null}}class e1 extends Vn{constructor(e){super(),this.name="TimelineValue",this._timeline=new Ws({memory:10}),this._initialValue=e}set(e,t){return this._timeline.add({value:e,time:t}),this}get(e){const t=this._timeline.get(e);return t?t.value:this._initialValue}}class Fr extends Ue{constructor(){super(Fe(Fr.getDefaults(),arguments,["context"]))}connect(e,t=0,s=0){return ia(this,e,t,s),this}}class _i extends Fr{constructor(){const e=Fe(_i.getDefaults(),arguments,["mapping","length"]);super(e),this.name="WaveShaper",this._shaper=this.context.createWaveShaper(),this.input=this._shaper,this.output=this._shaper,Zs(e.mapping)||e.mapping instanceof Float32Array?this.curve=Float32Array.from(e.mapping):Tv(e.mapping)&&this.setMap(e.mapping,e.length)}static getDefaults(){return Object.assign(Zt.getDefaults(),{length:1024})}setMap(e,t=1024){const s=new Float32Array(t);for(let r=0,i=t;r<i;r++){const o=r/(i-1)*2-1;s[r]=e(o,r)}return this.curve=s,this}get curve(){return this._shaper.curve}set curve(e){this._shaper.curve=e}get oversample(){return this._shaper.oversample}set oversample(e){const t=["none","2x","4x"].some(s=>s.includes(e));qe(t,"oversampling must be either 'none', '2x', or '4x'"),this._shaper.oversample=e}dispose(){return super.dispose(),this._shaper.disconnect(),this}}class ha extends Fr{constructor(){const e=Fe(ha.getDefaults(),arguments,["value"]);super(e),this.name="Pow",this._exponentScaler=this.input=this.output=new _i({context:this.context,mapping:this._expFunc(e.value),length:8192}),this._exponent=e.value}static getDefaults(){return Object.assign(Fr.getDefaults(),{value:1})}_expFunc(e){return t=>Math.pow(Math.abs(t),e)}get value(){return this._exponent}set value(e){this._exponent=e,this._exponentScaler.setMap(this._expFunc(this._exponent))}dispose(){return super.dispose(),this._exponentScaler.dispose(),this}}class Un{constructor(e,t){this.id=Un._eventId++,this._remainderTime=0;const s=Object.assign(Un.getDefaults(),t);this.transport=e,this.callback=s.callback,this._once=s.once,this.time=Math.floor(s.time),this._remainderTime=s.time-this.time}static getDefaults(){return{callback:lt,once:!1,time:0}}get floatTime(){return this.time+this._remainderTime}invoke(e){if(this.callback){const t=this.transport.bpm.getDurationOfTicks(1,e);this.callback(e+this._remainderTime*t),this._once&&this.transport.clear(this.id)}}dispose(){return this.callback=void 0,this}}Un._eventId=0;class fa extends Un{constructor(e,t){super(e,t),this._currentId=-1,this._nextId=-1,this._nextTick=this.time,this._boundRestart=this._restart.bind(this);const s=Object.assign(fa.getDefaults(),t);this.duration=s.duration,this._interval=s.interval,this._nextTick=s.time,this.transport.on("start",this._boundRestart),this.transport.on("loopStart",this._boundRestart),this.transport.on("ticks",this._boundRestart),this.context=this.transport.context,this._restart()}static getDefaults(){return Object.assign({},Un.getDefaults(),{duration:1/0,interval:1,once:!1})}invoke(e){this._createEvents(e),super.invoke(e)}_createEvent(){return Wi(this._nextTick,this.floatTime+this.duration)?this.transport.scheduleOnce(this.invoke.bind(this),new Er(this.context,this._nextTick).toSeconds()):-1}_createEvents(e){Wi(this._nextTick+this._interval,this.floatTime+this.duration)&&(this._nextTick+=this._interval,this._currentId=this._nextId,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new Er(this.context,this._nextTick).toSeconds()))}_restart(e){this.transport.clear(this._currentId),this.transport.clear(this._nextId),this._nextTick=this.floatTime;const t=this.transport.getTicksAtTime(e);Vr(t,this.time)&&(this._nextTick=this.floatTime+Math.ceil((t-this.floatTime)/this._interval)*this._interval),this._currentId=this._createEvent(),this._nextTick+=this._interval,this._nextId=this._createEvent()}dispose(){return super.dispose(),this.transport.clear(this._currentId),this.transport.clear(this._nextId),this.transport.off("start",this._boundRestart),this.transport.off("loopStart",this._boundRestart),this.transport.off("ticks",this._boundRestart),this}}class eo extends ys{constructor(){const e=Fe(eo.getDefaults(),arguments);super(e),this.name="Transport",this._loop=new e1(!1),this._loopStart=0,this._loopEnd=0,this._scheduledEvents={},this._timeline=new Ws,this._repeatedEvents=new Jv,this._syncedSignals=[],this._swingAmount=0,this._ppq=e.ppq,this._clock=new Ki({callback:this._processTick.bind(this),context:this.context,frequency:0,units:"bpm"}),this._bindClockEvents(),this.bpm=this._clock.frequency,this._clock.frequency.multiplier=e.ppq,this.bpm.setValueAtTime(e.bpm,0),It(this,"bpm"),this._timeSignature=e.timeSignature,this._swingTicks=e.ppq/2}static getDefaults(){return Object.assign(ys.getDefaults(),{bpm:120,loopEnd:"4m",loopStart:0,ppq:192,swing:0,swingSubdivision:"8n",timeSignature:4})}_processTick(e,t){if(this._loop.get(e)&&t>=this._loopEnd&&(this.emit("loopEnd",e),this._clock.setTicksAtTime(this._loopStart,e),t=this._loopStart,this.emit("loopStart",e,this._clock.getSecondsAtTime(e)),this.emit("loop",e)),this._swingAmount>0&&t%this._ppq!==0&&t%(this._swingTicks*2)!==0){const s=t%(this._swingTicks*2)/(this._swingTicks*2),r=Math.sin(s*Math.PI)*this._swingAmount;e+=new Er(this.context,this._swingTicks*2/3).toSeconds()*r}Qa(!0),this._timeline.forEachAtTime(t,s=>s.invoke(e)),Qa(!1)}schedule(e,t){const s=new Un(this,{callback:e,time:new ei(this.context,t).toTicks()});return this._addEvent(s,this._timeline)}scheduleRepeat(e,t,s,r=1/0){const i=new fa(this,{callback:e,duration:new Gs(this.context,r).toTicks(),interval:new Gs(this.context,t).toTicks(),time:new ei(this.context,s).toTicks()});return this._addEvent(i,this._repeatedEvents)}scheduleOnce(e,t){const s=new Un(this,{callback:e,once:!0,time:new ei(this.context,t).toTicks()});return this._addEvent(s,this._timeline)}clear(e){if(this._scheduledEvents.hasOwnProperty(e)){const t=this._scheduledEvents[e.toString()];t.timeline.remove(t.event),t.event.dispose(),delete this._scheduledEvents[e.toString()]}return this}_addEvent(e,t){return this._scheduledEvents[e.id.toString()]={event:e,timeline:t},t.add(e),e.id}cancel(e=0){const t=this.toTicks(e);return this._timeline.forEachFrom(t,s=>this.clear(s.id)),this._repeatedEvents.forEachFrom(t,s=>this.clear(s.id)),this}_bindClockEvents(){this._clock.on("start",(e,t)=>{t=new Er(this.context,t).toSeconds(),this.emit("start",e,t)}),this._clock.on("stop",e=>{this.emit("stop",e)}),this._clock.on("pause",e=>{this.emit("pause",e)})}get state(){return this._clock.getStateAtTime(this.now())}start(e,t){this.context.resume();let s;return Ge(t)&&(s=this.toTicks(t)),this._clock.start(e,s),this}stop(e){return this._clock.stop(e),this}pause(e){return this._clock.pause(e),this}toggle(e){return e=this.toSeconds(e),this._clock.getStateAtTime(e)!=="started"?this.start(e):this.stop(e),this}get timeSignature(){return this._timeSignature}set timeSignature(e){Zs(e)&&(e=e[0]/e[1]*4),this._timeSignature=e}get loopStart(){return new Gs(this.context,this._loopStart,"i").toSeconds()}set loopStart(e){this._loopStart=this.toTicks(e)}get loopEnd(){return new Gs(this.context,this._loopEnd,"i").toSeconds()}set loopEnd(e){this._loopEnd=this.toTicks(e)}get loop(){return this._loop.get(this.now())}set loop(e){this._loop.set(e,this.now())}setLoopPoints(e,t){return this.loopStart=e,this.loopEnd=t,this}get swing(){return this._swingAmount}set swing(e){this._swingAmount=e}get swingSubdivision(){return new Er(this.context,this._swingTicks).toNotation()}set swingSubdivision(e){this._swingTicks=this.toTicks(e)}get position(){const e=this.now(),t=this._clock.getTicksAtTime(e);return new Er(this.context,t).toBarsBeatsSixteenths()}set position(e){const t=this.toTicks(e);this.ticks=t}get seconds(){return this._clock.seconds}set seconds(e){const t=this.now(),s=this._clock.frequency.timeToTicks(e,t);this.ticks=s}get progress(){if(this.loop){const e=this.now();return(this._clock.getTicksAtTime(e)-this._loopStart)/(this._loopEnd-this._loopStart)}else return 0}get ticks(){return this._clock.ticks}set ticks(e){if(this._clock.ticks!==e){const t=this.now();if(this.state==="started"){const s=this._clock.getTicksAtTime(t),r=this._clock.frequency.getDurationOfTicks(Math.ceil(s)-s,t),i=t+r;this.emit("stop",i),this._clock.setTicksAtTime(e,i),this.emit("start",i,this._clock.getSecondsAtTime(i))}else this.emit("ticks",t),this._clock.setTicksAtTime(e,t)}}getTicksAtTime(e){return this._clock.getTicksAtTime(e)}getSecondsAtTime(e){return this._clock.getSecondsAtTime(e)}get PPQ(){return this._clock.frequency.multiplier}set PPQ(e){this._clock.frequency.multiplier=e}nextSubdivision(e){if(e=this.toTicks(e),this.state!=="started")return 0;{const t=this.now(),s=this.getTicksAtTime(t),r=e-s%e;return this._clock.nextTickTime(r,t)}}syncSignal(e,t){const s=this.now();let r=this.bpm,i=1/(60/r.getValueAtTime(s)/this.PPQ),o=[];if(e.units==="time"){const l=.015625/i,c=new is(l),u=new ha(-1),h=new is(l);r.chain(c,u,h),r=h,i=1/i,o=[c,u,h]}t||(e.getValueAtTime(s)!==0?t=e.getValueAtTime(s)/i:t=0);const a=new is(t);return r.connect(a),a.connect(e._param),o.push(a),this._syncedSignals.push({initial:e.value,nodes:o,signal:e}),e.value=0,this}unsyncSignal(e){for(let t=this._syncedSignals.length-1;t>=0;t--){const s=this._syncedSignals[t];s.signal===e&&(s.nodes.forEach(r=>r.dispose()),s.signal.value=s.initial,this._syncedSignals.splice(t,1))}return this}dispose(){return super.dispose(),this._clock.dispose(),sh(this,"bpm"),this._timeline.dispose(),this._repeatedEvents.dispose(),this}}pi.mixin(eo);Yi(n=>{n.transport=new eo({context:n})});Qi(n=>{n.transport.dispose()});class Ms extends Ue{constructor(e){super(e),this.input=void 0,this._state=new na("stopped"),this._synced=!1,this._scheduled=[],this._syncedStart=lt,this._syncedStop=lt,this._state.memory=100,this._state.increasing=!0,this._volume=this.output=new Yr({context:this.context,mute:e.mute,volume:e.volume}),this.volume=this._volume.volume,It(this,"volume"),this.onstop=e.onstop}static getDefaults(){return Object.assign(Ue.getDefaults(),{mute:!1,onstop:lt,volume:0})}get state(){return this._synced?this.context.transport.state==="started"?this._state.getValueAtTime(this.context.transport.seconds):"stopped":this._state.getValueAtTime(this.now())}get mute(){return this._volume.mute}set mute(e){this._volume.mute=e}_clampToCurrentTime(e){return this._synced?e:Math.max(e,this.context.currentTime)}start(e,t,s){let r=qs(e)&&this._synced?this.context.transport.seconds:this.toSeconds(e);if(r=this._clampToCurrentTime(r),!this._synced&&this._state.getValueAtTime(r)==="started")qe(Vr(r,this._state.get(r).time),"Start time must be strictly greater than previous start time"),this._state.cancel(r),this._state.setStateAtTime("started",r),this.log("restart",r),this.restart(r,t,s);else if(this.log("start",r),this._state.setStateAtTime("started",r),this._synced){const i=this._state.get(r);i&&(i.offset=this.toSeconds(Mr(t,0)),i.duration=s?this.toSeconds(s):void 0);const o=this.context.transport.schedule(a=>{this._start(a,t,s)},r);this._scheduled.push(o),this.context.transport.state==="started"&&this.context.transport.getSecondsAtTime(this.immediate())>r&&this._syncedStart(this.now(),this.context.transport.seconds)}else Yu(this.context),this._start(r,t,s);return this}stop(e){let t=qs(e)&&this._synced?this.context.transport.seconds:this.toSeconds(e);if(t=this._clampToCurrentTime(t),this._state.getValueAtTime(t)==="started"||Ge(this._state.getNextState("started",t))){if(this.log("stop",t),!this._synced)this._stop(t);else{const s=this.context.transport.schedule(this._stop.bind(this),t);this._scheduled.push(s)}this._state.cancel(t),this._state.setStateAtTime("stopped",t)}return this}restart(e,t,s){return e=this.toSeconds(e),this._state.getValueAtTime(e)==="started"&&(this._state.cancel(e),this._restart(e,t,s)),this}sync(){return this._synced||(this._synced=!0,this._syncedStart=(e,t)=>{if(Vr(t,0)){const s=this._state.get(t);if(s&&s.state==="started"&&s.time!==t){const r=t-this.toSeconds(s.time);let i;s.duration&&(i=this.toSeconds(s.duration)-r),this._start(e,this.toSeconds(s.offset)+r,i)}}},this._syncedStop=e=>{const t=this.context.transport.getSecondsAtTime(Math.max(e-this.sampleTime,0));this._state.getValueAtTime(t)==="started"&&this._stop(e)},this.context.transport.on("start",this._syncedStart),this.context.transport.on("loopStart",this._syncedStart),this.context.transport.on("stop",this._syncedStop),this.context.transport.on("pause",this._syncedStop),this.context.transport.on("loopEnd",this._syncedStop)),this}unsync(){return this._synced&&(this.context.transport.off("stop",this._syncedStop),this.context.transport.off("pause",this._syncedStop),this.context.transport.off("loopEnd",this._syncedStop),this.context.transport.off("start",this._syncedStart),this.context.transport.off("loopStart",this._syncedStart)),this._synced=!1,this._scheduled.forEach(e=>this.context.transport.clear(e)),this._scheduled=[],this._state.cancel(0),this._stop(0),this}dispose(){return super.dispose(),this.onstop=lt,this.unsync(),this._volume.dispose(),this._state.dispose(),this}}class to extends xr{constructor(){const e=Fe(to.getDefaults(),arguments,["url","onload"]);super(e),this.name="ToneBufferSource",this._source=this.context.createBufferSource(),this._internalChannels=[this._source],this._sourceStarted=!1,this._sourceStopped=!1,Xr(this._source,this._gainNode),this._source.onended=()=>this._stopSource(),this.playbackRate=new wt({context:this.context,param:this._source.playbackRate,units:"positive",value:e.playbackRate}),this.loop=e.loop,this.loopStart=e.loopStart,this.loopEnd=e.loopEnd,this._buffer=new yt(e.url,e.onload,e.onerror),this._internalChannels.push(this._source)}static getDefaults(){return Object.assign(xr.getDefaults(),{url:new yt,loop:!1,loopEnd:0,loopStart:0,onload:lt,onerror:lt,playbackRate:1})}get fadeIn(){return this._fadeIn}set fadeIn(e){this._fadeIn=e}get fadeOut(){return this._fadeOut}set fadeOut(e){this._fadeOut=e}get curve(){return this._curve}set curve(e){this._curve=e}start(e,t,s,r=1){qe(this.buffer.loaded,"buffer is either not set or not loaded");const i=this.toSeconds(e);this._startGain(i,r),this.loop?t=Mr(t,this.loopStart):t=Mr(t,0);let o=Math.max(this.toSeconds(t),0);if(this.loop){const a=this.toSeconds(this.loopEnd)||this.buffer.duration,l=this.toSeconds(this.loopStart),c=a-l;No(o,a)&&(o=(o-l)%c+l),zs(o,this.buffer.duration)&&(o=0)}if(this._source.buffer=this.buffer.get(),this._source.loopEnd=this.toSeconds(this.loopEnd)||this.buffer.duration,Wi(o,this.buffer.duration)&&(this._sourceStarted=!0,this._source.start(i,o)),Ge(s)){let a=this.toSeconds(s);a=Math.max(a,0),this.stop(i+a)}return this}_stopSource(e){!this._sourceStopped&&this._sourceStarted&&(this._sourceStopped=!0,this._source.stop(this.toSeconds(e)),this._onended())}get loopStart(){return this._source.loopStart}set loopStart(e){this._source.loopStart=this.toSeconds(e)}get loopEnd(){return this._source.loopEnd}set loopEnd(e){this._source.loopEnd=this.toSeconds(e)}get buffer(){return this._buffer}set buffer(e){this._buffer.set(e)}get loop(){return this._source.loop}set loop(e){this._source.loop=e,this._sourceStarted&&this.cancelStop()}dispose(){return super.dispose(),this._source.onended=null,this._source.disconnect(),this._buffer.dispose(),this.playbackRate.dispose(),this}}function yr(n,e){return Ft(this,void 0,void 0,function*(){const t=e/n.context.sampleRate,s=new ta(1,t,n.context.sampleRate);return new n.constructor(Object.assign(n.get(),{frequency:2/t,detune:0,context:s})).toDestination().start(0),(yield s.render()).getChannelData(0)})}class da extends xr{constructor(){const e=Fe(da.getDefaults(),arguments,["frequency","type"]);super(e),this.name="ToneOscillatorNode",this._oscillator=this.context.createOscillator(),this._internalChannels=[this._oscillator],Xr(this._oscillator,this._gainNode),this.type=e.type,this.frequency=new wt({context:this.context,param:this._oscillator.frequency,units:"frequency",value:e.frequency}),this.detune=new wt({context:this.context,param:this._oscillator.detune,units:"cents",value:e.detune}),It(this,["frequency","detune"])}static getDefaults(){return Object.assign(xr.getDefaults(),{detune:0,frequency:440,type:"sine"})}start(e){const t=this.toSeconds(e);return this.log("start",t),this._startGain(t),this._oscillator.start(t),this}_stopSource(e){this._oscillator.stop(e)}setPeriodicWave(e){return this._oscillator.setPeriodicWave(e),this}get type(){return this._oscillator.type}set type(e){this._oscillator.type=e}dispose(){return super.dispose(),this.state==="started"&&this.stop(),this._oscillator.disconnect(),this.frequency.dispose(),this.detune.dispose(),this}}class xt extends Ms{constructor(){const e=Fe(xt.getDefaults(),arguments,["frequency","type"]);super(e),this.name="Oscillator",this._oscillator=null,this.frequency=new Zt({context:this.context,units:"frequency",value:e.frequency}),It(this,"frequency"),this.detune=new Zt({context:this.context,units:"cents",value:e.detune}),It(this,"detune"),this._partials=e.partials,this._partialCount=e.partialCount,this._type=e.type,e.partialCount&&e.type!=="custom"&&(this._type=this.baseType+e.partialCount.toString()),this.phase=e.phase}static getDefaults(){return Object.assign(Ms.getDefaults(),{detune:0,frequency:440,partialCount:0,partials:[],phase:0,type:"sine"})}_start(e){const t=this.toSeconds(e),s=new da({context:this.context,onended:()=>this.onstop(this)});this._oscillator=s,this._wave?this._oscillator.setPeriodicWave(this._wave):this._oscillator.type=this._type,this._oscillator.connect(this.output),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.start(t)}_stop(e){const t=this.toSeconds(e);this._oscillator&&this._oscillator.stop(t)}_restart(e){const t=this.toSeconds(e);return this.log("restart",t),this._oscillator&&this._oscillator.cancelStop(),this._state.cancel(t),this}syncFrequency(){return this.context.transport.syncSignal(this.frequency),this}unsyncFrequency(){return this.context.transport.unsyncSignal(this.frequency),this}_getCachedPeriodicWave(){if(this._type==="custom")return xt._periodicWaveCache.find(t=>t.phase===this._phase&&Pv(t.partials,this._partials));{const e=xt._periodicWaveCache.find(t=>t.type===this._type&&t.phase===this._phase);return this._partialCount=e?e.partialCount:this._partialCount,e}}get type(){return this._type}set type(e){this._type=e;const t=["sine","square","sawtooth","triangle"].indexOf(e)!==-1;if(this._phase===0&&t)this._wave=void 0,this._partialCount=0,this._oscillator!==null&&(this._oscillator.type=e);else{const s=this._getCachedPeriodicWave();if(Ge(s)){const{partials:r,wave:i}=s;this._wave=i,this._partials=r,this._oscillator!==null&&this._oscillator.setPeriodicWave(this._wave)}else{const[r,i]=this._getRealImaginary(e,this._phase),o=this.context.createPeriodicWave(r,i);this._wave=o,this._oscillator!==null&&this._oscillator.setPeriodicWave(this._wave),xt._periodicWaveCache.push({imag:i,partialCount:this._partialCount,partials:this._partials,phase:this._phase,real:r,type:this._type,wave:this._wave}),xt._periodicWaveCache.length>100&&xt._periodicWaveCache.shift()}}}get baseType(){return this._type.replace(this.partialCount.toString(),"")}set baseType(e){this.partialCount&&this._type!=="custom"&&e!=="custom"?this.type=e+this.partialCount:this.type=e}get partialCount(){return this._partialCount}set partialCount(e){jn(e,0);let t=this._type;const s=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(this._type);if(s&&(t=s[1]),this._type!=="custom")e===0?this.type=t:this.type=t+e.toString();else{const r=new Float32Array(e);this._partials.forEach((i,o)=>r[o]=i),this._partials=Array.from(r),this.type=this._type}}_getRealImaginary(e,t){let r=2048;const i=new Float32Array(r),o=new Float32Array(r);let a=1;if(e==="custom"){if(a=this._partials.length+1,this._partialCount=this._partials.length,r=a,this._partials.length===0)return[i,o]}else{const l=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(e);l?(a=parseInt(l[2],10)+1,this._partialCount=parseInt(l[2],10),e=l[1],a=Math.max(a,2),r=a):this._partialCount=0,this._partials=[]}for(let l=1;l<r;++l){const c=2/(l*Math.PI);let u;switch(e){case"sine":u=l<=a?1:0,this._partials[l-1]=u;break;case"square":u=l&1?2*c:0,this._partials[l-1]=u;break;case"sawtooth":u=c*(l&1?1:-1),this._partials[l-1]=u;break;case"triangle":l&1?u=2*(c*c)*(l-1>>1&1?-1:1):u=0,this._partials[l-1]=u;break;case"custom":u=this._partials[l-1];break;default:throw new TypeError("Oscillator: invalid type: "+e)}u!==0?(i[l]=-u*Math.sin(t*l),o[l]=u*Math.cos(t*l)):(i[l]=0,o[l]=0)}return[i,o]}_inverseFFT(e,t,s){let r=0;const i=e.length;for(let o=0;o<i;o++)r+=e[o]*Math.cos(o*s)+t[o]*Math.sin(o*s);return r}getInitialValue(){const[e,t]=this._getRealImaginary(this._type,0);let s=0;const r=Math.PI*2,i=32;for(let o=0;o<i;o++)s=Math.max(this._inverseFFT(e,t,o/i*r),s);return xv(-this._inverseFFT(e,t,this._phase)/s,-1,1)}get partials(){return this._partials.slice(0,this.partialCount)}set partials(e){this._partials=e,this._partialCount=this._partials.length,e.length&&(this.type="custom")}get phase(){return this._phase*(180/Math.PI)}set phase(e){this._phase=e*Math.PI/180,this.type=this._type}asArray(){return Ft(this,arguments,void 0,function*(e=1024){return yr(this,e)})}dispose(){return super.dispose(),this._oscillator!==null&&this._oscillator.dispose(),this._wave=void 0,this.frequency.dispose(),this.detune.dispose(),this}}xt._periodicWaveCache=[];class t1 extends Fr{constructor(){super(...arguments),this.name="AudioToGain",this._norm=new _i({context:this.context,mapping:e=>(e+1)/2}),this.input=this._norm,this.output=this._norm}dispose(){return super.dispose(),this._norm.dispose(),this}}class qr extends Zt{constructor(){const e=Fe(qr.getDefaults(),arguments,["value"]);super(e),this.name="Multiply",this.override=!1,this._mult=this.input=this.output=new is({context:this.context,minValue:e.minValue,maxValue:e.maxValue}),this.factor=this._param=this._mult.gain,this.factor.setValueAtTime(e.value,0)}static getDefaults(){return Object.assign(Zt.getDefaults(),{value:0})}dispose(){return super.dispose(),this._mult.dispose(),this}}class so extends Ms{constructor(){const e=Fe(so.getDefaults(),arguments,["frequency","type","modulationType"]);super(e),this.name="AMOscillator",this._modulationScale=new t1({context:this.context}),this._modulationNode=new is({context:this.context}),this._carrier=new xt({context:this.context,detune:e.detune,frequency:e.frequency,onstop:()=>this.onstop(this),phase:e.phase,type:e.type}),this.frequency=this._carrier.frequency,this.detune=this._carrier.detune,this._modulator=new xt({context:this.context,phase:e.phase,type:e.modulationType}),this.harmonicity=new qr({context:this.context,units:"positive",value:e.harmonicity}),this.frequency.chain(this.harmonicity,this._modulator.frequency),this._modulator.chain(this._modulationScale,this._modulationNode.gain),this._carrier.chain(this._modulationNode,this.output),It(this,["frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(xt.getDefaults(),{harmonicity:1,modulationType:"square"})}_start(e){this._modulator.start(e),this._carrier.start(e)}_stop(e){this._modulator.stop(e),this._carrier.stop(e)}_restart(e){this._modulator.restart(e),this._carrier.restart(e)}get type(){return this._carrier.type}set type(e){this._carrier.type=e}get baseType(){return this._carrier.baseType}set baseType(e){this._carrier.baseType=e}get partialCount(){return this._carrier.partialCount}set partialCount(e){this._carrier.partialCount=e}get modulationType(){return this._modulator.type}set modulationType(e){this._modulator.type=e}get phase(){return this._carrier.phase}set phase(e){this._carrier.phase=e,this._modulator.phase=e}get partials(){return this._carrier.partials}set partials(e){this._carrier.partials=e}asArray(){return Ft(this,arguments,void 0,function*(e=1024){return yr(this,e)})}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this._modulationScale.dispose(),this}}class no extends Ms{constructor(){const e=Fe(no.getDefaults(),arguments,["frequency","type","modulationType"]);super(e),this.name="FMOscillator",this._modulationNode=new is({context:this.context,gain:0}),this._carrier=new xt({context:this.context,detune:e.detune,frequency:0,onstop:()=>this.onstop(this),phase:e.phase,type:e.type}),this.detune=this._carrier.detune,this.frequency=new Zt({context:this.context,units:"frequency",value:e.frequency}),this._modulator=new xt({context:this.context,phase:e.phase,type:e.modulationType}),this.harmonicity=new qr({context:this.context,units:"positive",value:e.harmonicity}),this.modulationIndex=new qr({context:this.context,units:"positive",value:e.modulationIndex}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.frequency.chain(this.modulationIndex,this._modulationNode),this._modulator.connect(this._modulationNode.gain),this._modulationNode.connect(this._carrier.frequency),this._carrier.connect(this.output),this.detune.connect(this._modulator.detune),It(this,["modulationIndex","frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(xt.getDefaults(),{harmonicity:1,modulationIndex:2,modulationType:"square"})}_start(e){this._modulator.start(e),this._carrier.start(e)}_stop(e){this._modulator.stop(e),this._carrier.stop(e)}_restart(e){return this._modulator.restart(e),this._carrier.restart(e),this}get type(){return this._carrier.type}set type(e){this._carrier.type=e}get baseType(){return this._carrier.baseType}set baseType(e){this._carrier.baseType=e}get partialCount(){return this._carrier.partialCount}set partialCount(e){this._carrier.partialCount=e}get modulationType(){return this._modulator.type}set modulationType(e){this._modulator.type=e}get phase(){return this._carrier.phase}set phase(e){this._carrier.phase=e,this._modulator.phase=e}get partials(){return this._carrier.partials}set partials(e){this._carrier.partials=e}asArray(){return Ft(this,arguments,void 0,function*(e=1024){return yr(this,e)})}dispose(){return super.dispose(),this.frequency.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this.modulationIndex.dispose(),this}}class gi extends Ms{constructor(){const e=Fe(gi.getDefaults(),arguments,["frequency","width"]);super(e),this.name="PulseOscillator",this._widthGate=new is({context:this.context,gain:0}),this._thresh=new _i({context:this.context,mapping:t=>t<=0?-1:1}),this.width=new Zt({context:this.context,units:"audioRange",value:e.width}),this._triangle=new xt({context:this.context,detune:e.detune,frequency:e.frequency,onstop:()=>this.onstop(this),phase:e.phase,type:"triangle"}),this.frequency=this._triangle.frequency,this.detune=this._triangle.detune,this._triangle.chain(this._thresh,this.output),this.width.chain(this._widthGate,this._thresh),It(this,["width","frequency","detune"])}static getDefaults(){return Object.assign(Ms.getDefaults(),{detune:0,frequency:440,phase:0,type:"pulse",width:.2})}_start(e){e=this.toSeconds(e),this._triangle.start(e),this._widthGate.gain.setValueAtTime(1,e)}_stop(e){e=this.toSeconds(e),this._triangle.stop(e),this._widthGate.gain.cancelScheduledValues(e),this._widthGate.gain.setValueAtTime(0,e)}_restart(e){this._triangle.restart(e),this._widthGate.gain.cancelScheduledValues(e),this._widthGate.gain.setValueAtTime(1,e)}get phase(){return this._triangle.phase}set phase(e){this._triangle.phase=e}get type(){return"pulse"}get baseType(){return"pulse"}get partials(){return[]}get partialCount(){return 0}set carrierType(e){this._triangle.type=e}asArray(){return Ft(this,arguments,void 0,function*(e=1024){return yr(this,e)})}dispose(){return super.dispose(),this._triangle.dispose(),this.width.dispose(),this._widthGate.dispose(),this._thresh.dispose(),this}}class ro extends Ms{constructor(){const e=Fe(ro.getDefaults(),arguments,["frequency","type","spread"]);super(e),this.name="FatOscillator",this._oscillators=[],this.frequency=new Zt({context:this.context,units:"frequency",value:e.frequency}),this.detune=new Zt({context:this.context,units:"cents",value:e.detune}),this._spread=e.spread,this._type=e.type,this._phase=e.phase,this._partials=e.partials,this._partialCount=e.partialCount,this.count=e.count,It(this,["frequency","detune"])}static getDefaults(){return Object.assign(xt.getDefaults(),{count:3,spread:20,type:"sawtooth"})}_start(e){e=this.toSeconds(e),this._forEach(t=>t.start(e))}_stop(e){e=this.toSeconds(e),this._forEach(t=>t.stop(e))}_restart(e){this._forEach(t=>t.restart(e))}_forEach(e){for(let t=0;t<this._oscillators.length;t++)e(this._oscillators[t],t)}get type(){return this._type}set type(e){this._type=e,this._forEach(t=>t.type=e)}get spread(){return this._spread}set spread(e){if(this._spread=e,this._oscillators.length>1){const t=-e/2,s=e/(this._oscillators.length-1);this._forEach((r,i)=>r.detune.value=t+s*i)}}get count(){return this._oscillators.length}set count(e){if(jn(e,1),this._oscillators.length!==e){this._forEach(t=>t.dispose()),this._oscillators=[];for(let t=0;t<e;t++){const s=new xt({context:this.context,volume:-6-e*1.1,type:this._type,phase:this._phase+t/e*360,partialCount:this._partialCount,onstop:t===0?()=>this.onstop(this):lt});this.type==="custom"&&(s.partials=this._partials),this.frequency.connect(s.frequency),this.detune.connect(s.detune),s.detune.overridden=!1,s.connect(this.output),this._oscillators[t]=s}this.spread=this._spread,this.state==="started"&&this._forEach(t=>t.start())}}get phase(){return this._phase}set phase(e){this._phase=e,this._forEach((t,s)=>t.phase=this._phase+s/this.count*360)}get baseType(){return this._oscillators[0].baseType}set baseType(e){this._forEach(t=>t.baseType=e),this._type=this._oscillators[0].type}get partials(){return this._oscillators[0].partials}set partials(e){this._partials=e,this._partialCount=this._partials.length,e.length&&(this._type="custom",this._forEach(t=>t.partials=e))}get partialCount(){return this._oscillators[0].partialCount}set partialCount(e){this._partialCount=e,this._forEach(t=>t.partialCount=e),this._type=this._oscillators[0].type}asArray(){return Ft(this,arguments,void 0,function*(e=1024){return yr(this,e)})}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this._forEach(e=>e.dispose()),this}}class io extends Ms{constructor(){const e=Fe(io.getDefaults(),arguments,["frequency","modulationFrequency"]);super(e),this.name="PWMOscillator",this.sourceType="pwm",this._scale=new qr({context:this.context,value:2}),this._pulse=new gi({context:this.context,frequency:e.modulationFrequency}),this._pulse.carrierType="sine",this.modulationFrequency=this._pulse.frequency,this._modulator=new xt({context:this.context,detune:e.detune,frequency:e.frequency,onstop:()=>this.onstop(this),phase:e.phase}),this.frequency=this._modulator.frequency,this.detune=this._modulator.detune,this._modulator.chain(this._scale,this._pulse.width),this._pulse.connect(this.output),It(this,["modulationFrequency","frequency","detune"])}static getDefaults(){return Object.assign(Ms.getDefaults(),{detune:0,frequency:440,modulationFrequency:.4,phase:0,type:"pwm"})}_start(e){e=this.toSeconds(e),this._modulator.start(e),this._pulse.start(e)}_stop(e){e=this.toSeconds(e),this._modulator.stop(e),this._pulse.stop(e)}_restart(e){this._modulator.restart(e),this._pulse.restart(e)}get type(){return"pwm"}get baseType(){return"pwm"}get partials(){return[]}get partialCount(){return 0}get phase(){return this._modulator.phase}set phase(e){this._modulator.phase=e}asArray(){return Ft(this,arguments,void 0,function*(e=1024){return yr(this,e)})}dispose(){return super.dispose(),this._pulse.dispose(),this._scale.dispose(),this._modulator.dispose(),this}}const Ka={am:so,fat:ro,fm:no,oscillator:xt,pulse:gi,pwm:io};class Li extends Ms{constructor(){const e=Fe(Li.getDefaults(),arguments,["frequency","type"]);super(e),this.name="OmniOscillator",this.frequency=new Zt({context:this.context,units:"frequency",value:e.frequency}),this.detune=new Zt({context:this.context,units:"cents",value:e.detune}),It(this,["frequency","detune"]),this.set(e)}static getDefaults(){return Object.assign(xt.getDefaults(),no.getDefaults(),so.getDefaults(),ro.getDefaults(),gi.getDefaults(),io.getDefaults())}_start(e){this._oscillator.start(e)}_stop(e){this._oscillator.stop(e)}_restart(e){return this._oscillator.restart(e),this}get type(){let e="";return["am","fm","fat"].some(t=>this._sourceType===t)&&(e=this._sourceType),e+this._oscillator.type}set type(e){e.substr(0,2)==="fm"?(this._createNewOscillator("fm"),this._oscillator=this._oscillator,this._oscillator.type=e.substr(2)):e.substr(0,2)==="am"?(this._createNewOscillator("am"),this._oscillator=this._oscillator,this._oscillator.type=e.substr(2)):e.substr(0,3)==="fat"?(this._createNewOscillator("fat"),this._oscillator=this._oscillator,this._oscillator.type=e.substr(3)):e==="pwm"?(this._createNewOscillator("pwm"),this._oscillator=this._oscillator):e==="pulse"?this._createNewOscillator("pulse"):(this._createNewOscillator("oscillator"),this._oscillator=this._oscillator,this._oscillator.type=e)}get partials(){return this._oscillator.partials}set partials(e){!this._getOscType(this._oscillator,"pulse")&&!this._getOscType(this._oscillator,"pwm")&&(this._oscillator.partials=e)}get partialCount(){return this._oscillator.partialCount}set partialCount(e){!this._getOscType(this._oscillator,"pulse")&&!this._getOscType(this._oscillator,"pwm")&&(this._oscillator.partialCount=e)}set(e){return Reflect.has(e,"type")&&e.type&&(this.type=e.type),super.set(e),this}_createNewOscillator(e){if(e!==this._sourceType){this._sourceType=e;const t=Ka[e],s=this.now();if(this._oscillator){const r=this._oscillator;r.stop(s),this.context.setTimeout(()=>r.dispose(),this.blockTime)}this._oscillator=new t({context:this.context}),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.connect(this.output),this._oscillator.onstop=()=>this.onstop(this),this.state==="started"&&this._oscillator.start(s)}}get phase(){return this._oscillator.phase}set phase(e){this._oscillator.phase=e}get sourceType(){return this._sourceType}set sourceType(e){let t="sine";this._oscillator.type!=="pwm"&&this._oscillator.type!=="pulse"&&(t=this._oscillator.type),e==="fm"?this.type="fm"+t:e==="am"?this.type="am"+t:e==="fat"?this.type="fat"+t:e==="oscillator"?this.type=t:e==="pulse"?this.type="pulse":e==="pwm"&&(this.type="pwm")}_getOscType(e,t){return e instanceof Ka[t]}get baseType(){return this._oscillator.baseType}set baseType(e){!this._getOscType(this._oscillator,"pulse")&&!this._getOscType(this._oscillator,"pwm")&&e!=="pulse"&&e!=="pwm"&&(this._oscillator.baseType=e)}get width(){if(this._getOscType(this._oscillator,"pulse"))return this._oscillator.width}get count(){if(this._getOscType(this._oscillator,"fat"))return this._oscillator.count}set count(e){this._getOscType(this._oscillator,"fat")&&hr(e)&&(this._oscillator.count=e)}get spread(){if(this._getOscType(this._oscillator,"fat"))return this._oscillator.spread}set spread(e){this._getOscType(this._oscillator,"fat")&&hr(e)&&(this._oscillator.spread=e)}get modulationType(){if(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))return this._oscillator.modulationType}set modulationType(e){(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))&&Rn(e)&&(this._oscillator.modulationType=e)}get modulationIndex(){if(this._getOscType(this._oscillator,"fm"))return this._oscillator.modulationIndex}get harmonicity(){if(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))return this._oscillator.harmonicity}get modulationFrequency(){if(this._getOscType(this._oscillator,"pwm"))return this._oscillator.modulationFrequency}asArray(){return Ft(this,arguments,void 0,function*(e=1024){return yr(this,e)})}dispose(){return super.dispose(),this.detune.dispose(),this.frequency.dispose(),this._oscillator.dispose(),this}}function oh(n,e=1/0){const t=new WeakMap;return function(s,r){Reflect.defineProperty(s,r,{configurable:!0,enumerable:!0,get:function(){return t.get(this)},set:function(i){jn(i,n,e),t.set(this,i)}})}}function xn(n,e=1/0){const t=new WeakMap;return function(s,r){Reflect.defineProperty(s,r,{configurable:!0,enumerable:!0,get:function(){return t.get(this)},set:function(i){jn(this.toSeconds(i),n,e),t.set(this,i)}})}}class oo extends Ms{constructor(){const e=Fe(oo.getDefaults(),arguments,["url","onload"]);super(e),this.name="Player",this._activeSources=new Set,this._buffer=new yt({onload:this._onload.bind(this,e.onload),onerror:e.onerror,reverse:e.reverse,url:e.url}),this.autostart=e.autostart,this._loop=e.loop,this._loopStart=e.loopStart,this._loopEnd=e.loopEnd,this._playbackRate=e.playbackRate,this.fadeIn=e.fadeIn,this.fadeOut=e.fadeOut}static getDefaults(){return Object.assign(Ms.getDefaults(),{autostart:!1,fadeIn:0,fadeOut:0,loop:!1,loopEnd:0,loopStart:0,onload:lt,onerror:lt,playbackRate:1,reverse:!1})}load(e){return Ft(this,void 0,void 0,function*(){return yield this._buffer.load(e),this._onload(),this})}_onload(e=lt){e(),this.autostart&&this.start()}_onSourceEnd(e){this.onstop(this),this._activeSources.delete(e),this._activeSources.size===0&&!this._synced&&this._state.getValueAtTime(this.now())==="started"&&(this._state.cancel(this.now()),this._state.setStateAtTime("stopped",this.now()))}start(e,t,s){return super.start(e,t,s),this}_start(e,t,s){this._loop?t=Mr(t,this._loopStart):t=Mr(t,0);const r=this.toSeconds(t),i=s;s=Mr(s,Math.max(this._buffer.duration-r,0));let o=this.toSeconds(s);o=o/this._playbackRate,e=this.toSeconds(e);const a=new to({url:this._buffer,context:this.context,fadeIn:this.fadeIn,fadeOut:this.fadeOut,loop:this._loop,loopEnd:this._loopEnd,loopStart:this._loopStart,onended:this._onSourceEnd.bind(this),playbackRate:this._playbackRate}).connect(this.output);!this._loop&&!this._synced&&(this._state.cancel(e+o),this._state.setStateAtTime("stopped",e+o,{implicitEnd:!0})),this._activeSources.add(a),this._loop&&qs(i)?a.start(e,r):a.start(e,r,o-this.toSeconds(this.fadeOut))}_stop(e){const t=this.toSeconds(e);this._activeSources.forEach(s=>s.stop(t))}restart(e,t,s){return super.restart(e,t,s),this}_restart(e,t,s){var r;(r=[...this._activeSources].pop())===null||r===void 0||r.stop(e),this._start(e,t,s)}seek(e,t){const s=this.toSeconds(t);if(this._state.getValueAtTime(s)==="started"){const r=this.toSeconds(e);this._stop(s),this._start(s,r)}return this}setLoopPoints(e,t){return this.loopStart=e,this.loopEnd=t,this}get loopStart(){return this._loopStart}set loopStart(e){this._loopStart=e,this.buffer.loaded&&jn(this.toSeconds(e),0,this.buffer.duration),this._activeSources.forEach(t=>{t.loopStart=e})}get loopEnd(){return this._loopEnd}set loopEnd(e){this._loopEnd=e,this.buffer.loaded&&jn(this.toSeconds(e),0,this.buffer.duration),this._activeSources.forEach(t=>{t.loopEnd=e})}get buffer(){return this._buffer}set buffer(e){this._buffer.set(e)}get loop(){return this._loop}set loop(e){if(this._loop!==e&&(this._loop=e,this._activeSources.forEach(t=>{t.loop=e}),e)){const t=this._state.getNextState("stopped",this.now());t&&this._state.cancel(t.time)}}get playbackRate(){return this._playbackRate}set playbackRate(e){this._playbackRate=e;const t=this.now(),s=this._state.getNextState("stopped",t);s&&s.implicitEnd&&(this._state.cancel(s.time),this._activeSources.forEach(r=>r.cancelStop())),this._activeSources.forEach(r=>{r.playbackRate.setValueAtTime(e,t)})}get reverse(){return this._buffer.reverse}set reverse(e){this._buffer.reverse=e}get loaded(){return this._buffer.loaded}dispose(){return super.dispose(),this._activeSources.forEach(e=>e.dispose()),this._activeSources.clear(),this._buffer.dispose(),this}}Ks([xn(0)],oo.prototype,"fadeIn",void 0);Ks([xn(0)],oo.prototype,"fadeOut",void 0);class Zn extends Ue{constructor(){const e=Fe(Zn.getDefaults(),arguments,["attack","decay","sustain","release"]);super(e),this.name="Envelope",this._sig=new Zt({context:this.context,value:0}),this.output=this._sig,this.input=void 0,this.attack=e.attack,this.decay=e.decay,this.sustain=e.sustain,this.release=e.release,this.attackCurve=e.attackCurve,this.releaseCurve=e.releaseCurve,this.decayCurve=e.decayCurve}static getDefaults(){return Object.assign(Ue.getDefaults(),{attack:.01,attackCurve:"linear",decay:.1,decayCurve:"exponential",release:1,releaseCurve:"exponential",sustain:.5})}get value(){return this.getValueAtTime(this.now())}_getCurve(e,t){if(Rn(e))return e;{let s;for(s in Ti)if(Ti[s][t]===e)return s;return e}}_setCurve(e,t,s){if(Rn(s)&&Reflect.has(Ti,s)){const r=Ti[s];cr(r)?e!=="_decayCurve"&&(this[e]=r[t]):this[e]=r}else if(Zs(s)&&e!=="_decayCurve")this[e]=s;else throw new Error("Envelope: invalid curve: "+s)}get attackCurve(){return this._getCurve(this._attackCurve,"In")}set attackCurve(e){this._setCurve("_attackCurve","In",e)}get releaseCurve(){return this._getCurve(this._releaseCurve,"Out")}set releaseCurve(e){this._setCurve("_releaseCurve","Out",e)}get decayCurve(){return this._getCurve(this._decayCurve,"Out")}set decayCurve(e){this._setCurve("_decayCurve","Out",e)}triggerAttack(e,t=1){this.log("triggerAttack",e,t),e=this.toSeconds(e);let r=this.toSeconds(this.attack);const i=this.toSeconds(this.decay),o=this.getValueAtTime(e);if(o>0){const a=1/r;r=(1-o)/a}if(r<this.sampleTime)this._sig.cancelScheduledValues(e),this._sig.setValueAtTime(t,e);else if(this._attackCurve==="linear")this._sig.linearRampTo(t,r,e);else if(this._attackCurve==="exponential")this._sig.targetRampTo(t,r,e);else{this._sig.cancelAndHoldAtTime(e);let a=this._attackCurve;for(let l=1;l<a.length;l++)if(a[l-1]<=o&&o<=a[l]){a=this._attackCurve.slice(l),a[0]=o;break}this._sig.setValueCurveAtTime(a,e,r,t)}if(i&&this.sustain<1){const a=t*this.sustain,l=e+r;this.log("decay",l),this._decayCurve==="linear"?this._sig.linearRampToValueAtTime(a,i+l):this._sig.exponentialApproachValueAtTime(a,l,i)}return this}triggerRelease(e){this.log("triggerRelease",e),e=this.toSeconds(e);const t=this.getValueAtTime(e);if(t>0){const s=this.toSeconds(this.release);s<this.sampleTime?this._sig.setValueAtTime(0,e):this._releaseCurve==="linear"?this._sig.linearRampTo(0,s,e):this._releaseCurve==="exponential"?this._sig.targetRampTo(0,s,e):(qe(Zs(this._releaseCurve),"releaseCurve must be either 'linear', 'exponential' or an array"),this._sig.cancelAndHoldAtTime(e),this._sig.setValueCurveAtTime(this._releaseCurve,e,s,t))}return this}getValueAtTime(e){return this._sig.getValueAtTime(e)}triggerAttackRelease(e,t,s=1){return t=this.toSeconds(t),this.triggerAttack(t,s),this.triggerRelease(t+this.toSeconds(e)),this}cancel(e){return this._sig.cancelScheduledValues(this.toSeconds(e)),this}connect(e,t=0,s=0){return ia(this,e,t,s),this}asArray(){return Ft(this,arguments,void 0,function*(e=1024){const t=e/this.context.sampleRate,s=new ta(1,t,this.context.sampleRate),r=this.toSeconds(this.attack)+this.toSeconds(this.decay),i=r+this.toSeconds(this.release),o=i*.1,a=i+o,l=new this.constructor(Object.assign(this.get(),{attack:t*this.toSeconds(this.attack)/a,decay:t*this.toSeconds(this.decay)/a,release:t*this.toSeconds(this.release)/a,context:s}));return l._sig.toDestination(),l.triggerAttackRelease(t*(r+o)/a,0),(yield s.render()).getChannelData(0)})}dispose(){return super.dispose(),this._sig.dispose(),this}}Ks([xn(0)],Zn.prototype,"attack",void 0);Ks([xn(0)],Zn.prototype,"decay",void 0);Ks([oh(0,1)],Zn.prototype,"sustain",void 0);Ks([xn(0)],Zn.prototype,"release",void 0);const Ti=(()=>{let e,t;const s=[];for(e=0;e<128;e++)s[e]=Math.sin(e/127*(Math.PI/2));const r=[],i=6.4;for(e=0;e<127;e++){t=e/127;const f=Math.sin(t*(Math.PI*2)*i-Math.PI/2)+1;r[e]=f/10+t*.83}r[127]=1;const o=[],a=5;for(e=0;e<128;e++)o[e]=Math.ceil(e/127*a)/a;const l=[];for(e=0;e<128;e++)t=e/127,l[e]=.5*(1-Math.cos(Math.PI*t));const c=[];for(e=0;e<128;e++){t=e/127;const f=Math.pow(t,3)*4+.2,d=Math.cos(f*Math.PI*2*t);c[e]=Math.abs(d*(1-t))}function u(f){const d=new Array(f.length);for(let m=0;m<f.length;m++)d[m]=1-f[m];return d}function h(f){return f.slice(0).reverse()}return{bounce:{In:u(c),Out:c},cosine:{In:s,Out:h(s)},exponential:"exponential",linear:"linear",ripple:{In:r,Out:u(r)},sine:{In:l,Out:u(l)},step:{In:o,Out:u(o)}}})();class Wr extends Ue{constructor(){const e=Fe(Wr.getDefaults(),arguments);super(e),this._scheduledEvents=[],this._synced=!1,this._original_triggerAttack=this.triggerAttack,this._original_triggerRelease=this.triggerRelease,this._syncedRelease=t=>this._original_triggerRelease(t),this._volume=this.output=new Yr({context:this.context,volume:e.volume}),this.volume=this._volume.volume,It(this,"volume")}static getDefaults(){return Object.assign(Ue.getDefaults(),{volume:0})}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",0),this.context.transport.on("stop",this._syncedRelease),this.context.transport.on("pause",this._syncedRelease),this.context.transport.on("loopEnd",this._syncedRelease)),this}_syncState(){let e=!1;return this._synced||(this._synced=!0,e=!0),e}_syncMethod(e,t){const s=this["_original_"+e]=this[e];this[e]=(...r)=>{const i=r[t],o=this.context.transport.schedule(a=>{r[t]=a,s.apply(this,r)},i);this._scheduledEvents.push(o)}}unsync(){return this._scheduledEvents.forEach(e=>this.context.transport.clear(e)),this._scheduledEvents=[],this._synced&&(this._synced=!1,this.triggerAttack=this._original_triggerAttack,this.triggerRelease=this._original_triggerRelease,this.context.transport.off("stop",this._syncedRelease),this.context.transport.off("pause",this._syncedRelease),this.context.transport.off("loopEnd",this._syncedRelease)),this}triggerAttackRelease(e,t,s,r){const i=this.toSeconds(s),o=this.toSeconds(t);return this.triggerAttack(e,i,r),this.triggerRelease(i+o),this}dispose(){return super.dispose(),this._volume.dispose(),this.unsync(),this._scheduledEvents=[],this}}class Lr extends Wr{constructor(){const e=Fe(Lr.getDefaults(),arguments);super(e),this.portamento=e.portamento,this.onsilence=e.onsilence}static getDefaults(){return Object.assign(Wr.getDefaults(),{detune:0,onsilence:lt,portamento:0})}triggerAttack(e,t,s=1){this.log("triggerAttack",e,t,s);const r=this.toSeconds(t);return this._triggerEnvelopeAttack(r,s),this.setNote(e,r),this}triggerRelease(e){this.log("triggerRelease",e);const t=this.toSeconds(e);return this._triggerEnvelopeRelease(t),this}setNote(e,t){const s=this.toSeconds(t),r=e instanceof xs?e.toFrequency():e;if(this.portamento>0&&this.getLevelAtTime(s)>.05){const i=this.toSeconds(this.portamento);this.frequency.exponentialRampTo(r,i,s)}else this.frequency.setValueAtTime(r,s);return this}}Ks([xn(0)],Lr.prototype,"portamento",void 0);class pa extends Zn{constructor(){super(Fe(pa.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="AmplitudeEnvelope",this._gainNode=new is({context:this.context,gain:0}),this.output=this._gainNode,this.input=this._gainNode,this._sig.connect(this._gainNode.gain),this.output=this._gainNode,this.input=this._gainNode}dispose(){return super.dispose(),this._gainNode.dispose(),this}}class Bi extends Lr{constructor(){const e=Fe(Bi.getDefaults(),arguments);super(e),this.name="Synth",this.oscillator=new Li(Object.assign({context:this.context,detune:e.detune,onstop:()=>this.onsilence(this)},e.oscillator)),this.frequency=this.oscillator.frequency,this.detune=this.oscillator.detune,this.envelope=new pa(Object.assign({context:this.context},e.envelope)),this.oscillator.chain(this.envelope,this.output),It(this,["oscillator","frequency","detune","envelope"])}static getDefaults(){return Object.assign(Lr.getDefaults(),{envelope:Object.assign(Ja(Zn.getDefaults(),Object.keys(Ue.getDefaults())),{attack:.005,decay:.1,release:1,sustain:.3}),oscillator:Object.assign(Ja(Li.getDefaults(),[...Object.keys(Ms.getDefaults()),"frequency","detune"]),{type:"triangle"})})}_triggerEnvelopeAttack(e,t){if(this.envelope.triggerAttack(e,t),this.oscillator.start(e),this.envelope.sustain===0){const s=this.toSeconds(this.envelope.attack),r=this.toSeconds(this.envelope.decay);this.oscillator.stop(e+s+r)}}_triggerEnvelopeRelease(e){this.envelope.triggerRelease(e),this.oscillator.stop(e+this.toSeconds(this.envelope.release))}getLevelAtTime(e){return e=this.toSeconds(e),this.envelope.getValueAtTime(e)}dispose(){return super.dispose(),this.oscillator.dispose(),this.envelope.dispose(),this}}class ao extends Bi{constructor(){const e=Fe(ao.getDefaults(),arguments);super(e),this.name="MembraneSynth",this.portamento=0,this.pitchDecay=e.pitchDecay,this.octaves=e.octaves,It(this,["oscillator","envelope"])}static getDefaults(){return Dr(Lr.getDefaults(),Bi.getDefaults(),{envelope:{attack:.001,attackCurve:"exponential",decay:.4,release:1.4,sustain:.01},octaves:10,oscillator:{type:"sine"},pitchDecay:.05})}setNote(e,t){const s=this.toSeconds(t),r=this.toFrequency(e instanceof xs?e.toFrequency():e),i=r*this.octaves;return this.oscillator.frequency.setValueAtTime(i,s),this.oscillator.frequency.exponentialRampToValueAtTime(r,s+this.toSeconds(this.pitchDecay)),this}dispose(){return super.dispose(),this}}Ks([oh(0)],ao.prototype,"octaves",void 0);Ks([xn(0)],ao.prototype,"pitchDecay",void 0);const ah=new Set;function ma(n){ah.add(n)}function lh(n,e){const t=`registerProcessor("${n}", ${e})`;ah.add(t)}const s1=`
	/**
	 * The base AudioWorkletProcessor for use in Tone.js. Works with the {@link ToneAudioWorklet}. 
	 */
	class ToneAudioWorkletProcessor extends AudioWorkletProcessor {

		constructor(options) {
			
			super(options);
			/**
			 * If the processor was disposed or not. Keep alive until it's disposed.
			 */
			this.disposed = false;
		   	/** 
			 * The number of samples in the processing block
			 */
			this.blockSize = 128;
			/**
			 * the sample rate
			 */
			this.sampleRate = sampleRate;

			this.port.onmessage = (event) => {
				// when it receives a dispose 
				if (event.data === "dispose") {
					this.disposed = true;
				}
			};
		}
	}
`;ma(s1);const n1=`
	/**
	 * Abstract class for a single input/output processor. 
	 * has a 'generate' function which processes one sample at a time
	 */
	class SingleIOProcessor extends ToneAudioWorkletProcessor {

		constructor(options) {
			super(Object.assign(options, {
				numberOfInputs: 1,
				numberOfOutputs: 1
			}));
			/**
			 * Holds the name of the parameter and a single value of that
			 * parameter at the current sample
			 * @type { [name: string]: number }
			 */
			this.params = {}
		}

		/**
		 * Generate an output sample from the input sample and parameters
		 * @abstract
		 * @param input number
		 * @param channel number
		 * @param parameters { [name: string]: number }
		 * @returns number
		 */
		generate(){}

		/**
		 * Update the private params object with the 
		 * values of the parameters at the given index
		 * @param parameters { [name: string]: Float32Array },
		 * @param index number
		 */
		updateParams(parameters, index) {
			for (const paramName in parameters) {
				const param = parameters[paramName];
				if (param.length > 1) {
					this.params[paramName] = parameters[paramName][index];
				} else {
					this.params[paramName] = parameters[paramName][0];
				}
			}
		}

		/**
		 * Process a single frame of the audio
		 * @param inputs Float32Array[][]
		 * @param outputs Float32Array[][]
		 */
		process(inputs, outputs, parameters) {
			const input = inputs[0];
			const output = outputs[0];
			// get the parameter values
			const channelCount = Math.max(input && input.length || 0, output.length);
			for (let sample = 0; sample < this.blockSize; sample++) {
				this.updateParams(parameters, sample);
				for (let channel = 0; channel < channelCount; channel++) {
					const inputSample = input && input.length ? input[channel][sample] : 0;
					output[channel][sample] = this.generate(inputSample, channel, this.params);
				}
			}
			return !this.disposed;
		}
	};
`;ma(n1);const r1=`
	/**
	 * A multichannel buffer for use within an AudioWorkletProcessor as a delay line
	 */
	class DelayLine {
		
		constructor(size, channels) {
			this.buffer = [];
			this.writeHead = []
			this.size = size;

			// create the empty channels
			for (let i = 0; i < channels; i++) {
				this.buffer[i] = new Float32Array(this.size);
				this.writeHead[i] = 0;
			}
		}

		/**
		 * Push a value onto the end
		 * @param channel number
		 * @param value number
		 */
		push(channel, value) {
			this.writeHead[channel] += 1;
			if (this.writeHead[channel] > this.size) {
				this.writeHead[channel] = 0;
			}
			this.buffer[channel][this.writeHead[channel]] = value;
		}

		/**
		 * Get the recorded value of the channel given the delay
		 * @param channel number
		 * @param delay number delay samples
		 */
		get(channel, delay) {
			let readHead = this.writeHead[channel] - Math.floor(delay);
			if (readHead < 0) {
				readHead += this.size;
			}
			return this.buffer[channel][readHead];
		}
	}
`;ma(r1);const i1="feedback-comb-filter",o1=`
	class FeedbackCombFilterWorklet extends SingleIOProcessor {

		constructor(options) {
			super(options);
			this.delayLine = new DelayLine(this.sampleRate, options.channelCount || 2);
		}

		static get parameterDescriptors() {
			return [{
				name: "delayTime",
				defaultValue: 0.1,
				minValue: 0,
				maxValue: 1,
				automationRate: "k-rate"
			}, {
				name: "feedback",
				defaultValue: 0.5,
				minValue: 0,
				maxValue: 0.9999,
				automationRate: "k-rate"
			}];
		}

		generate(input, channel, parameters) {
			const delayedSample = this.delayLine.get(channel, parameters.delayTime * this.sampleRate);
			this.delayLine.push(channel, input + delayedSample * parameters.feedback);
			return delayedSample;
		}
	}
`;lh(i1,o1);class vi extends Wr{constructor(){const e=Fe(vi.getDefaults(),arguments,["urls","onload","baseUrl"],"urls");super(e),this.name="Sampler",this._activeSources=new Map;const t={};Object.keys(e.urls).forEach(s=>{const r=parseInt(s,10);if(qe(Ci(s)||hr(r)&&isFinite(r),`url key is neither a note or midi pitch: ${s}`),Ci(s)){const i=new xs(this.context,s).toMidi();t[i]=e.urls[s]}else hr(r)&&isFinite(r)&&(t[r]=e.urls[r])}),this._buffers=new ua({urls:t,onload:e.onload,baseUrl:e.baseUrl,onerror:e.onerror}),this.attack=e.attack,this.release=e.release,this.curve=e.curve,this._buffers.loaded&&Promise.resolve().then(e.onload)}static getDefaults(){return Object.assign(Wr.getDefaults(),{attack:0,baseUrl:"",curve:"exponential",onload:lt,onerror:lt,release:.1,urls:{}})}_findClosest(e){let s=0;for(;s<96;){if(this._buffers.has(e+s))return-s;if(this._buffers.has(e-s))return s;s++}throw new Error(`No available buffers for note: ${e}`)}triggerAttack(e,t,s=1){return this.log("triggerAttack",e,t,s),Array.isArray(e)||(e=[e]),e.forEach(r=>{const i=ih(new xs(this.context,r).toFrequency()),o=Math.round(i),a=i-o,l=this._findClosest(o),c=o-l,u=this._buffers.get(c),h=rh(l+a),f=new to({url:u,context:this.context,curve:this.curve,fadeIn:this.attack,fadeOut:this.release,playbackRate:h}).connect(this.output);f.start(t,0,u.duration/h,s),Zs(this._activeSources.get(o))||this._activeSources.set(o,[]),this._activeSources.get(o).push(f),f.onended=()=>{if(this._activeSources&&this._activeSources.has(o)){const d=this._activeSources.get(o),m=d.indexOf(f);m!==-1&&d.splice(m,1)}}}),this}triggerRelease(e,t){return this.log("triggerRelease",e,t),Array.isArray(e)||(e=[e]),e.forEach(s=>{const r=new xs(this.context,s).toMidi();if(this._activeSources.has(r)&&this._activeSources.get(r).length){const i=this._activeSources.get(r);t=this.toSeconds(t),i.forEach(o=>{o.stop(t)}),this._activeSources.set(r,[])}}),this}releaseAll(e){const t=this.toSeconds(e);return this._activeSources.forEach(s=>{for(;s.length;)s.shift().stop(t)}),this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1)),this}triggerAttackRelease(e,t,s,r=1){const i=this.toSeconds(s);return this.triggerAttack(e,i,r),Zs(t)?(qe(Zs(e),"notes must be an array when duration is array"),e.forEach((o,a)=>{const l=t[Math.min(a,t.length-1)];this.triggerRelease(o,i+this.toSeconds(l))})):this.triggerRelease(e,i+this.toSeconds(t)),this}add(e,t,s){if(qe(Ci(e)||isFinite(e),`note must be a pitch or midi: ${e}`),Ci(e)){const r=new xs(this.context,e).toMidi();this._buffers.add(r,t,s)}else this._buffers.add(e,t,s);return this}get loaded(){return this._buffers.loaded}dispose(){return super.dispose(),this._buffers.dispose(),this._activeSources.forEach(e=>{e.forEach(t=>t.dispose())}),this._activeSources.clear(),this}}Ks([xn(0)],vi.prototype,"attack",void 0);Ks([xn(0)],vi.prototype,"release",void 0);class _a extends Ue{constructor(){const e=Fe(_a.getDefaults(),arguments,["pan"]);super(e),this.name="Panner",this._panner=this.context.createStereoPanner(),this.input=this._panner,this.output=this._panner,this.pan=new wt({context:this.context,param:this._panner.pan,value:e.pan,minValue:-1,maxValue:1}),this._panner.channelCount=e.channelCount,this._panner.channelCountMode="explicit",It(this,"pan")}static getDefaults(){return Object.assign(Ue.getDefaults(),{pan:0,channelCount:1})}dispose(){return super.dispose(),this._panner.disconnect(),this.pan.dispose(),this}}const a1="bit-crusher",l1=`
	class BitCrusherWorklet extends SingleIOProcessor {

		static get parameterDescriptors() {
			return [{
				name: "bits",
				defaultValue: 12,
				minValue: 1,
				maxValue: 16,
				automationRate: 'k-rate'
			}];
		}

		generate(input, _channel, parameters) {
			const step = Math.pow(0.5, parameters.bits - 1);
			const val = step * Math.floor(input / step + 0.5);
			return val;
		}
	}
`;lh(a1,l1);class Vt extends Ue{constructor(){const e=Fe(Vt.getDefaults(),arguments,["solo"]);super(e),this.name="Solo",this.input=this.output=new is({context:this.context}),Vt._allSolos.has(this.context)||Vt._allSolos.set(this.context,new Set),Vt._allSolos.get(this.context).add(this),this.solo=e.solo}static getDefaults(){return Object.assign(Ue.getDefaults(),{solo:!1})}get solo(){return this._isSoloed()}set solo(e){e?this._addSolo():this._removeSolo(),Vt._allSolos.get(this.context).forEach(t=>t._updateSolo())}get muted(){return this.input.gain.value===0}_addSolo(){Vt._soloed.has(this.context)||Vt._soloed.set(this.context,new Set),Vt._soloed.get(this.context).add(this)}_removeSolo(){Vt._soloed.has(this.context)&&Vt._soloed.get(this.context).delete(this)}_isSoloed(){return Vt._soloed.has(this.context)&&Vt._soloed.get(this.context).has(this)}_noSolos(){return!Vt._soloed.has(this.context)||Vt._soloed.has(this.context)&&Vt._soloed.get(this.context).size===0}_updateSolo(){this._isSoloed()?this.input.gain.value=1:this._noSolos()?this.input.gain.value=1:this.input.gain.value=0}dispose(){return super.dispose(),Vt._allSolos.get(this.context).delete(this),this._removeSolo(),this}}Vt._allSolos=new Map;Vt._soloed=new Map;class ga extends Ue{constructor(){const e=Fe(ga.getDefaults(),arguments,["pan","volume"]);super(e),this.name="PanVol",this._panner=this.input=new _a({context:this.context,pan:e.pan,channelCount:e.channelCount}),this.pan=this._panner.pan,this._volume=this.output=new Yr({context:this.context,volume:e.volume}),this.volume=this._volume.volume,this._panner.connect(this._volume),this.mute=e.mute,It(this,["pan","volume"])}static getDefaults(){return Object.assign(Ue.getDefaults(),{mute:!1,pan:0,volume:0,channelCount:1})}get mute(){return this._volume.mute}set mute(e){this._volume.mute=e}dispose(){return super.dispose(),this._panner.dispose(),this.pan.dispose(),this._volume.dispose(),this.volume.dispose(),this}}class Ir extends Ue{constructor(){const e=Fe(Ir.getDefaults(),arguments,["volume","pan"]);super(e),this.name="Channel",this._solo=this.input=new Vt({solo:e.solo,context:this.context}),this._panVol=this.output=new ga({context:this.context,pan:e.pan,volume:e.volume,mute:e.mute,channelCount:e.channelCount}),this.pan=this._panVol.pan,this.volume=this._panVol.volume,this._solo.connect(this._panVol),It(this,["pan","volume"])}static getDefaults(){return Object.assign(Ue.getDefaults(),{pan:0,volume:0,mute:!1,solo:!1,channelCount:1})}get solo(){return this._solo.solo}set solo(e){this._solo.solo=e}get muted(){return this._solo.muted||this.mute}get mute(){return this._panVol.mute}set mute(e){this._panVol.mute=e}_getBus(e){return Ir.buses.has(e)||Ir.buses.set(e,new is({context:this.context})),Ir.buses.get(e)}send(e,t=0){const s=this._getBus(e),r=new is({context:this.context,units:"decibels",gain:t});return this.connect(r),r.connect(s),r}receive(e){return this._getBus(e).connect(this),this}dispose(){return super.dispose(),this._panVol.dispose(),this.pan.dispose(),this.volume.dispose(),this._solo.dispose(),this}}Ir.buses=new Map;function el(){return Vs().now()}Vs().transport;Vs().destination;Vs().destination;Vs().listener;Vs().draw;Vs();function tl(n,e,t){const s=n.slice();return s[5]=e[t],s}function sl(n){let e,t,s=n[5].accuracy.toFixed(1)+"",r,i;return{c(){e=E("div"),t=P("平均精度: "),r=P(s),i=P("%"),this.h()},l(o){e=N(o,"DIV",{class:!0});var a=$(e);t=R(a,"平均精度: "),r=R(a,s),i=R(a,"%"),a.forEach(v),this.h()},h(){S(e,"class","mt-2 text-xs text-gray-600")},m(o,a){H(o,e,a),p(e,t),p(e,r),p(e,i)},p(o,a){a&1&&s!==(s=o[5].accuracy.toFixed(1)+"")&&ee(r,s)},d(o){o&&v(e)}}}function nl(n){var K;let e,t,s,r,i=n[4](n[5].mastery)+"",o,a,l,c,u=(((K=n[2][n[5].type])==null?void 0:K.name)||n[5].type)+"",h,f,d,m=n[3](n[5].mastery)+"",_,g,y,b,k=n[5].mastery+"",I,T,C,A,w=n[5].attempts+"",D,M,F,q,B,G,Y,U,L=n[5].accuracy!==void 0&&sl(n);return{c(){e=E("div"),t=E("div"),s=E("div"),r=E("span"),o=P(i),a=x(),l=E("div"),c=E("div"),h=P(u),f=x(),d=E("div"),_=P(m),g=x(),y=E("div"),b=E("div"),I=P(k),T=P("%"),C=x(),A=E("div"),D=P(w),M=P("回挑戦"),F=x(),q=E("div"),B=E("div"),Y=x(),L&&L.c(),U=x(),this.h()},l(z){e=N(z,"DIV",{class:!0});var Q=$(e);t=N(Q,"DIV",{class:!0});var te=$(t);s=N(te,"DIV",{class:!0});var ce=$(s);r=N(ce,"SPAN",{class:!0});var ve=$(r);o=R(ve,i),ve.forEach(v),a=V(ce),l=N(ce,"DIV",{});var Ce=$(l);c=N(Ce,"DIV",{class:!0});var ye=$(c);h=R(ye,u),ye.forEach(v),f=V(Ce),d=N(Ce,"DIV",{class:!0});var me=$(d);_=R(me,m),me.forEach(v),Ce.forEach(v),ce.forEach(v),g=V(te),y=N(te,"DIV",{class:!0});var be=$(y);b=N(be,"DIV",{class:!0});var X=$(b);I=R(X,k),T=R(X,"%"),X.forEach(v),C=V(be),A=N(be,"DIV",{class:!0});var Se=$(A);D=R(Se,w),M=R(Se,"回挑戦"),Se.forEach(v),be.forEach(v),te.forEach(v),F=V(Q),q=N(Q,"DIV",{class:!0});var fe=$(q);B=N(fe,"DIV",{class:!0,style:!0}),$(B).forEach(v),fe.forEach(v),Y=V(Q),L&&L.l(Q),U=V(Q),Q.forEach(v),this.h()},h(){var z;S(r,"class","text-2xl"),S(c,"class","font-medium text-gray-800"),S(d,"class","text-xs text-gray-500"),S(s,"class","flex items-center gap-2"),S(b,"class","font-bold text-lg text-gray-800"),S(A,"class","text-xs text-gray-500"),S(y,"class","text-right"),S(t,"class","flex items-center justify-between mb-2"),S(B,"class",G="bg-gradient-to-r "+(((z=n[2][n[5].type])==null?void 0:z.color)||"from-gray-400 to-gray-600")+" h-3 transition-all duration-500 svelte-bryd2a"),st(B,"width",n[5].mastery+"%"),S(q,"class","w-full bg-gray-200 rounded-full h-3 overflow-hidden"),S(e,"class","interval-card bg-gray-50 rounded-lg p-4 hover:shadow-md transition-all duration-200 svelte-bryd2a")},m(z,Q){H(z,e,Q),p(e,t),p(t,s),p(s,r),p(r,o),p(s,a),p(s,l),p(l,c),p(c,h),p(l,f),p(l,d),p(d,_),p(t,g),p(t,y),p(y,b),p(b,I),p(b,T),p(y,C),p(y,A),p(A,D),p(A,M),p(e,F),p(e,q),p(q,B),p(e,Y),L&&L.m(e,null),p(e,U)},p(z,Q){var te,ce;Q&1&&i!==(i=z[4](z[5].mastery)+"")&&ee(o,i),Q&1&&u!==(u=(((te=z[2][z[5].type])==null?void 0:te.name)||z[5].type)+"")&&ee(h,u),Q&1&&m!==(m=z[3](z[5].mastery)+"")&&ee(_,m),Q&1&&k!==(k=z[5].mastery+"")&&ee(I,k),Q&1&&w!==(w=z[5].attempts+"")&&ee(D,w),Q&1&&G!==(G="bg-gradient-to-r "+(((ce=z[2][z[5].type])==null?void 0:ce.color)||"from-gray-400 to-gray-600")+" h-3 transition-all duration-500 svelte-bryd2a")&&S(B,"class",G),Q&1&&st(B,"width",z[5].mastery+"%"),z[5].accuracy!==void 0?L?L.p(z,Q):(L=sl(z),L.c(),L.m(e,U)):L&&(L.d(1),L=null)},d(z){z&&v(e),L&&L.d()}}}function rl(n){let e,t='<div class="text-4xl mb-2">🎵</div> <div>まだ音程データがありません</div>';return{c(){e=E("div"),e.innerHTML=t,this.h()},l(s){e=N(s,"DIV",{class:!0,"data-svelte-h":!0}),pe(e)!=="svelte-14r8c3z"&&(e.innerHTML=t),this.h()},h(){S(e,"class","text-center py-8 text-gray-500")},m(s,r){H(s,e,r)},d(s){s&&v(e)}}}function c1(n){let e,t,s="音程別習得状況",r,i,o,a,l=Ie(n[0]),c=[];for(let h=0;h<l.length;h+=1)c[h]=nl(tl(n,l,h));let u=n[0].length===0&&rl();return{c(){e=E("div"),t=E("h3"),t.textContent=s,r=x(),i=E("div");for(let h=0;h<c.length;h+=1)c[h].c();o=x(),u&&u.c(),this.h()},l(h){e=N(h,"DIV",{class:!0});var f=$(e);t=N(f,"H3",{class:!0,"data-svelte-h":!0}),pe(t)!=="svelte-e86xsw"&&(t.textContent=s),r=V(f),i=N(f,"DIV",{class:!0});var d=$(i);for(let m=0;m<c.length;m+=1)c[m].l(d);d.forEach(v),o=V(f),u&&u.l(f),f.forEach(v),this.h()},h(){S(t,"class","text-lg font-semibold text-gray-800 mb-4"),S(i,"class","grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"),S(e,"class",a="interval-progress-tracker "+n[1]+" bg-white rounded-xl shadow-lg p-6 svelte-bryd2a")},m(h,f){H(h,e,f),p(e,t),p(e,r),p(e,i);for(let d=0;d<c.length;d+=1)c[d]&&c[d].m(i,null);p(e,o),u&&u.m(e,null)},p(h,[f]){if(f&29){l=Ie(h[0]);let d;for(d=0;d<l.length;d+=1){const m=tl(h,l,d);c[d]?c[d].p(m,f):(c[d]=nl(m),c[d].c(),c[d].m(i,null))}for(;d<c.length;d+=1)c[d].d(1);c.length=l.length}h[0].length===0?u||(u=rl(),u.c(),u.m(e,null)):u&&(u.d(1),u=null),f&2&&a!==(a="interval-progress-tracker "+h[1]+" bg-white rounded-xl shadow-lg p-6 svelte-bryd2a")&&S(e,"class",a)},i:Et,o:Et,d(h){h&&v(e),dt(c,h),u&&u.d()}}}function u1(n,e,t){let{intervalData:s=[]}=e,{className:r=""}=e;const i={unison:{name:"ユニゾン",color:"from-gray-400 to-gray-600"},minor_second:{name:"短2度",color:"from-purple-400 to-purple-600"},major_second:{name:"長2度",color:"from-indigo-400 to-indigo-600"},minor_third:{name:"短3度",color:"from-blue-400 to-blue-600"},major_third:{name:"長3度",color:"from-cyan-400 to-cyan-600"},perfect_fourth:{name:"完全4度",color:"from-teal-400 to-teal-600"},tritone:{name:"トライトーン",color:"from-green-400 to-green-600"},perfect_fifth:{name:"完全5度",color:"from-lime-400 to-lime-600"},minor_sixth:{name:"短6度",color:"from-yellow-400 to-yellow-600"},major_sixth:{name:"長6度",color:"from-amber-400 to-amber-600"},minor_seventh:{name:"短7度",color:"from-orange-400 to-orange-600"},major_seventh:{name:"長7度",color:"from-red-400 to-red-600"},octave:{name:"オクターブ",color:"from-pink-400 to-pink-600"}},o=l=>l>=90?"マスター":l>=70?"習得中":l>=50?"練習中":l>=30?"初級":"未習得",a=l=>l>=90?"⭐":l>=70?"🌟":l>=50?"💪":l>=30?"🌱":"🌰";return n.$$set=l=>{"intervalData"in l&&t(0,s=l.intervalData),"className"in l&&t(1,r=l.className)},[s,r,i,o,a]}class h1 extends Be{constructor(e){super(),He(this,e,u1,c1,Le,{intervalData:0,className:1})}}function il(n,e,t){const s=n.slice();return s[7]=e[t],s[9]=t,s}function ol(n,e,t){const s=n.slice();return s[7]=e[t],s[9]=t,s}function al(n,e,t){const s=n.slice();return s[11]=e[t],s}function f1(n){let e,t="→",s,r,i="安定";return{c(){e=E("span"),e.textContent=t,s=x(),r=E("span"),r.textContent=i,this.h()},l(o){e=N(o,"SPAN",{class:!0,"data-svelte-h":!0}),pe(e)!=="svelte-1jbvjas"&&(e.textContent=t),s=V(o),r=N(o,"SPAN",{class:!0,"data-svelte-h":!0}),pe(r)!=="svelte-121e93u"&&(r.textContent=i),this.h()},h(){S(e,"class","text-gray-500"),S(r,"class","text-sm text-gray-600")},m(o,a){H(o,e,a),H(o,s,a),H(o,r,a)},d(o){o&&(v(e),v(s),v(r))}}}function d1(n){let e,t="↓",s,r,i="低下中";return{c(){e=E("span"),e.textContent=t,s=x(),r=E("span"),r.textContent=i,this.h()},l(o){e=N(o,"SPAN",{class:!0,"data-svelte-h":!0}),pe(e)!=="svelte-kdozxh"&&(e.textContent=t),s=V(o),r=N(o,"SPAN",{class:!0,"data-svelte-h":!0}),pe(r)!=="svelte-1xifm37"&&(r.textContent=i),this.h()},h(){S(e,"class","text-red-500"),S(r,"class","text-sm text-red-600")},m(o,a){H(o,e,a),H(o,s,a),H(o,r,a)},d(o){o&&(v(e),v(s),v(r))}}}function p1(n){let e,t="↑",s,r,i="改善中";return{c(){e=E("span"),e.textContent=t,s=x(),r=E("span"),r.textContent=i,this.h()},l(o){e=N(o,"SPAN",{class:!0,"data-svelte-h":!0}),pe(e)!=="svelte-16offtj"&&(e.textContent=t),s=V(o),r=N(o,"SPAN",{class:!0,"data-svelte-h":!0}),pe(r)!=="svelte-1rjrzhl"&&(r.textContent=i),this.h()},h(){S(e,"class","text-green-500"),S(r,"class","text-sm text-green-600")},m(o,a){H(o,e,a),H(o,s,a),H(o,r,a)},d(o){o&&(v(e),v(s),v(r))}}}function m1(n){let e,t='<div class="text-4xl mb-2">📈</div> <div>一貫性データがまだありません</div> <div class="text-sm mt-2">複数回チャレンジするとグラフが表示されます</div>';return{c(){e=E("div"),e.innerHTML=t,this.h()},l(s){e=N(s,"DIV",{class:!0,"data-svelte-h":!0}),pe(e)!=="svelte-19ujcxo"&&(e.innerHTML=t),this.h()},h(){S(e,"class","text-center py-12 text-gray-500")},m(s,r){H(s,e,r)},p:Et,d(s){s&&v(e)}}}function _1(n){let e,t,s,r,i,o,a,l,c,u,h=Ie([0,25,50,75,100]),f=[];for(let g=0;g<5;g+=1)f[g]=ll(al(n,h,g));let d=n[5].points&&cl(n),m=Ie(n[0].slice(-10)),_=[];for(let g=0;g<m.length;g+=1)_[g]=hl(il(n,m,g));return{c(){e=E("div"),t=Es("svg"),s=Es("g");for(let g=0;g<5;g+=1)f[g].c();r=Es("defs"),i=Es("linearGradient"),o=Es("stop"),a=Es("stop"),d&&d.c(),c=x(),u=E("div");for(let g=0;g<_.length;g+=1)_[g].c();this.h()},l(g){e=N(g,"DIV",{class:!0});var y=$(e);t=Ns(y,"svg",{viewBox:!0,class:!0,style:!0});var b=$(t);s=Ns(b,"g",{class:!0});var k=$(s);for(let A=0;A<5;A+=1)f[A].l(k);k.forEach(v),r=Ns(b,"defs",{});var I=$(r);i=Ns(I,"linearGradient",{id:!0,x1:!0,y1:!0,x2:!0,y2:!0});var T=$(i);o=Ns(T,"stop",{offset:!0,"stop-color":!0,"stop-opacity":!0}),$(o).forEach(v),a=Ns(T,"stop",{offset:!0,"stop-color":!0,"stop-opacity":!0}),$(a).forEach(v),T.forEach(v),I.forEach(v),d&&d.l(b),b.forEach(v),y.forEach(v),c=V(g),u=N(g,"DIV",{class:!0});var C=$(u);for(let A=0;A<_.length;A+=1)_[A].l(C);C.forEach(v),this.h()},h(){S(s,"class","grid-lines svelte-uaryoh"),S(o,"offset","0%"),S(o,"stop-color","#3b82f6"),S(o,"stop-opacity","0.2"),S(a,"offset","100%"),S(a,"stop-color","#3b82f6"),S(a,"stop-opacity","0"),S(i,"id","consistency-gradient"),S(i,"x1","0"),S(i,"y1","0"),S(i,"x2","0"),S(i,"y2","1"),S(t,"viewBox",l="0 0 400 "+n[2]),S(t,"class","w-full"),st(t,"height",n[2]+"px"),S(e,"class","graph-container svelte-uaryoh"),S(u,"class","mt-4 flex gap-2 overflow-x-auto")},m(g,y){H(g,e,y),p(e,t),p(t,s);for(let b=0;b<5;b+=1)f[b]&&f[b].m(s,null);p(t,r),p(r,i),p(i,o),p(i,a),d&&d.m(t,null),H(g,c,y),H(g,u,y);for(let b=0;b<_.length;b+=1)_[b]&&_[b].m(u,null)},p(g,y){if(y&4){h=Ie([0,25,50,75,100]);let b;for(b=0;b<5;b+=1){const k=al(g,h,b);f[b]?f[b].p(k,y):(f[b]=ll(k),f[b].c(),f[b].m(s,null))}for(;b<5;b+=1)f[b].d(1)}if(g[5].points?d?d.p(g,y):(d=cl(g),d.c(),d.m(t,null)):d&&(d.d(1),d=null),y&4&&l!==(l="0 0 400 "+g[2])&&S(t,"viewBox",l),y&4&&st(t,"height",g[2]+"px"),y&1){m=Ie(g[0].slice(-10));let b;for(b=0;b<m.length;b+=1){const k=il(g,m,b);_[b]?_[b].p(k,y):(_[b]=hl(k),_[b].c(),_[b].m(u,null))}for(;b<_.length;b+=1)_[b].d(1);_.length=m.length}},d(g){g&&(v(e),v(c),v(u)),dt(f,g),d&&d.d(),dt(_,g)}}}function ll(n){let e,t,s,r,i,o,a;return{c(){e=Es("line"),r=Es("text"),i=P(n[11]),o=P(`%
            `),this.h()},l(l){e=Ns(l,"line",{x1:!0,y1:!0,x2:!0,y2:!0,stroke:!0,"stroke-width":!0,"stroke-dasharray":!0}),$(e).forEach(v),r=Ns(l,"text",{x:!0,y:!0,"text-anchor":!0,fill:!0,"font-size":!0,class:!0});var c=$(r);i=R(c,n[11]),o=R(c,`%
            `),c.forEach(v),this.h()},h(){S(e,"x1","0"),S(e,"y1",t=n[2]-n[11]/100*n[2]),S(e,"x2","400"),S(e,"y2",s=n[2]-n[11]/100*n[2]),S(e,"stroke","#e5e7eb"),S(e,"stroke-width","1"),S(e,"stroke-dasharray","2,2"),S(r,"x","-5"),S(r,"y",a=n[2]-n[11]/100*n[2]+5),S(r,"text-anchor","end"),S(r,"fill","#9ca3af"),S(r,"font-size","12"),S(r,"class","svelte-uaryoh")},m(l,c){H(l,e,c),H(l,r,c),p(r,i),p(r,o)},p(l,c){c&4&&t!==(t=l[2]-l[11]/100*l[2])&&S(e,"y1",t),c&4&&s!==(s=l[2]-l[11]/100*l[2])&&S(e,"y2",s),c&4&&a!==(a=l[2]-l[11]/100*l[2]+5)&&S(r,"y",a)},d(l){l&&(v(e),v(r))}}}function cl(n){let e,t,s,r,i,o=Ie(n[0]),a=[];for(let l=0;l<o.length;l+=1)a[l]=ul(ol(n,o,l));return{c(){e=Es("polygon"),s=Es("polyline");for(let l=0;l<a.length;l+=1)a[l].c();i=Gt(),this.h()},l(l){e=Ns(l,"polygon",{points:!0,fill:!0}),$(e).forEach(v),s=Ns(l,"polyline",{points:!0,fill:!0,stroke:!0,"stroke-width":!0}),$(s).forEach(v);for(let c=0;c<a.length;c+=1)a[c].l(l);i=Gt(),this.h()},h(){S(e,"points",t="0,"+n[2]+" "+n[5].points+" 400,"+n[2]),S(e,"fill","url(#consistency-gradient)"),S(s,"points",r=n[5].points),S(s,"fill","none"),S(s,"stroke","#3b82f6"),S(s,"stroke-width","2")},m(l,c){H(l,e,c),H(l,s,c);for(let u=0;u<a.length;u+=1)a[u]&&a[u].m(l,c);H(l,i,c)},p(l,c){if(c&36&&t!==(t="0,"+l[2]+" "+l[5].points+" 400,"+l[2])&&S(e,"points",t),c&32&&r!==(r=l[5].points)&&S(s,"points",r),c&37){o=Ie(l[0]);let u;for(u=0;u<o.length;u+=1){const h=ol(l,o,u);a[u]?a[u].p(h,c):(a[u]=ul(h),a[u].c(),a[u].m(i.parentNode,i))}for(;u<a.length;u+=1)a[u].d(1);a.length=o.length}},d(l){l&&(v(e),v(s),v(i)),dt(a,l)}}}function ul(n){let e,t,s,r;return{c(){e=Es("circle"),this.h()},l(i){e=Ns(i,"circle",{cx:!0,cy:!0,r:!0,fill:!0,stroke:!0,"stroke-width":!0}),$(e).forEach(v),this.h()},h(){S(e,"cx",t=n[9]/(n[0].length-1)*400),S(e,"cy",s=n[2]-(n[7].score-n[5].min)/(n[5].max-n[5].min)*n[2]),S(e,"r","4"),S(e,"fill",r=Br(n[7].score)),S(e,"stroke","white"),S(e,"stroke-width","2")},m(i,o){H(i,e,o)},p(i,o){o&1&&t!==(t=i[9]/(i[0].length-1)*400)&&S(e,"cx",t),o&37&&s!==(s=i[2]-(i[7].score-i[5].min)/(i[5].max-i[5].min)*i[2])&&S(e,"cy",s),o&1&&r!==(r=Br(i[7].score))&&S(e,"fill",r)},d(i){i&&v(e)}}}function hl(n){let e,t,s=n[7].score+"",r,i,o,a=n[9]+1+"",l,c,u;return{c(){e=E("div"),t=E("div"),r=P(s),i=x(),o=E("div"),l=P(a),c=P("回前"),u=x(),this.h()},l(h){e=N(h,"DIV",{class:!0});var f=$(e);t=N(f,"DIV",{class:!0,style:!0});var d=$(t);r=R(d,s),d.forEach(v),i=V(f),o=N(f,"DIV",{class:!0});var m=$(o);l=R(m,a),c=R(m,"回前"),m.forEach(v),u=V(f),f.forEach(v),this.h()},h(){S(t,"class","w-12 h-12 rounded-full flex items-center justify-center text-white font-bold text-sm"),st(t,"background-color",Br(n[7].score)),S(o,"class","text-xs text-gray-500 mt-1"),S(e,"class","flex-shrink-0 text-center")},m(h,f){H(h,e,f),p(e,t),p(t,r),p(e,i),p(e,o),p(o,l),p(o,c),p(e,u)},p(h,f){f&1&&s!==(s=h[7].score+"")&&ee(r,s),f&1&&st(t,"background-color",Br(h[7].score))},d(h){h&&v(e)}}}function g1(n){let e,t,s,r="一貫性グラフ",i,o,a,l,c="平均:",u,h,f=n[4].toFixed(1)+"",d,m,_,g,y,b;function k(D,M){return D[3]==="improving"?p1:D[3]==="declining"?d1:f1}let I=k(n),T=I(n);function C(D,M){return D[0].length>0?_1:m1}let A=C(n),w=A(n);return{c(){e=E("div"),t=E("div"),s=E("h3"),s.textContent=r,i=x(),o=E("div"),a=E("div"),l=E("span"),l.textContent=c,u=x(),h=E("span"),d=P(f),m=P("%"),_=x(),g=E("div"),T.c(),y=x(),w.c(),this.h()},l(D){e=N(D,"DIV",{class:!0});var M=$(e);t=N(M,"DIV",{class:!0});var F=$(t);s=N(F,"H3",{class:!0,"data-svelte-h":!0}),pe(s)!=="svelte-17em45"&&(s.textContent=r),i=V(F),o=N(F,"DIV",{class:!0});var q=$(o);a=N(q,"DIV",{class:!0});var B=$(a);l=N(B,"SPAN",{class:!0,"data-svelte-h":!0}),pe(l)!=="svelte-1mot1su"&&(l.textContent=c),u=V(B),h=N(B,"SPAN",{class:!0,style:!0});var G=$(h);d=R(G,f),m=R(G,"%"),G.forEach(v),B.forEach(v),_=V(q),g=N(q,"DIV",{class:!0});var Y=$(g);T.l(Y),Y.forEach(v),q.forEach(v),F.forEach(v),y=V(M),w.l(M),M.forEach(v),this.h()},h(){S(s,"class","text-lg font-semibold text-gray-800"),S(l,"class","text-gray-500"),S(h,"class","font-bold"),st(h,"color",Br(n[4])),S(a,"class","text-sm"),S(g,"class","flex items-center gap-1"),S(o,"class","flex items-center gap-4"),S(t,"class","flex items-center justify-between mb-4"),S(e,"class",b="consistency-graph "+n[1]+" bg-white rounded-xl shadow-lg p-6 svelte-uaryoh")},m(D,M){H(D,e,M),p(e,t),p(t,s),p(t,i),p(t,o),p(o,a),p(a,l),p(a,u),p(a,h),p(h,d),p(h,m),p(o,_),p(o,g),T.m(g,null),p(e,y),w.m(e,null)},p(D,[M]){M&16&&f!==(f=D[4].toFixed(1)+"")&&ee(d,f),M&16&&st(h,"color",Br(D[4])),I!==(I=k(D))&&(T.d(1),T=I(D),T&&(T.c(),T.m(g,null))),A===(A=C(D))&&w?w.p(D,M):(w.d(1),w=A(D),w&&(w.c(),w.m(e,null))),M&2&&b!==(b="consistency-graph "+D[1]+" bg-white rounded-xl shadow-lg p-6 svelte-uaryoh")&&S(e,"class",b)},i:Et,o:Et,d(D){D&&v(e),T.d(),w.d()}}}function Br(n){return n>=80?"#10b981":n>=60?"#3b82f6":n>=40?"#f59e0b":"#ef4444"}function v1(n){if(n.length<2)return"neutral";const e=n.slice(-5),t=e.slice(0,Math.floor(e.length/2)),s=e.slice(Math.floor(e.length/2)),r=t.reduce((o,a)=>o+a.score,0)/t.length,i=s.reduce((o,a)=>o+a.score,0)/s.length;return i>r+5?"improving":i<r-5?"declining":"stable"}function y1(n,e,t){let s,r,i,{consistencyData:o=[]}=e,{className:a=""}=e,{height:l=200}=e;function c(u){if(!u||u.length===0)return{points:"",max:100,min:0};const h=u.map(y=>y.score),f=Math.max(...h,100),d=Math.min(...h,0),m=f-d||1,_=400;return{points:u.map((y,b)=>{const k=b/(u.length-1)*_,I=l-(y.score-d)/m*l;return`${k},${I}`}).join(" "),max:f,min:d,values:h}}return n.$$set=u=>{"consistencyData"in u&&t(0,o=u.consistencyData),"className"in u&&t(1,a=u.className),"height"in u&&t(2,l=u.height)},n.$$.update=()=>{n.$$.dirty&1&&t(5,s=c(o)),n.$$.dirty&1&&t(4,r=o.length>0?o.reduce((u,h)=>u+h.score,0)/o.length:0),n.$$.dirty&1&&t(3,i=v1(o))},[o,a,l,i,r,s]}class b1 extends Be{constructor(e){super(),He(this,e,y1,g1,Le,{consistencyData:0,className:1,height:2})}}function fl(n,e,t){const s=n.slice();return s[6]=e[t],s[8]=t,s}function dl(n,e,t){const s=n.slice();return s[9]=e[t][0],s[10]=e[t][1],s}function pl(n,e,t){const s=n.slice();return s[13]=e[t],s}function ml(n){let e,t=n[0].summary+"",s,r;return{c(){e=E("p"),s=P(t),this.h()},l(i){e=N(i,"P",{class:!0});var o=$(e);s=R(o,t),o.forEach(v),this.h()},h(){S(e,"class",r=Ca(n[3].contentColor)+" svelte-k1ib06")},m(i,o){H(i,e,o),p(e,s)},p(i,o){o&1&&t!==(t=i[0].summary+"")&&ee(s,t),o&8&&r!==(r=Ca(i[3].contentColor)+" svelte-k1ib06")&&S(e,"class",r)},d(i){i&&v(e)}}}function _l(n){let e,t,s=Ie(Object.entries(n[2])),r=[];for(let o=0;o<s.length;o+=1)r[o]=yl(dl(n,s,o));const i=o=>W(r[o],1,1,()=>{r[o]=null});return{c(){e=E("div");for(let o=0;o<r.length;o+=1)r[o].c();this.h()},l(o){e=N(o,"DIV",{class:!0});var a=$(e);for(let l=0;l<r.length;l+=1)r[l].l(a);a.forEach(v),this.h()},h(){S(e,"class","space-y-4 mt-6")},m(o,a){H(o,e,a);for(let l=0;l<r.length;l+=1)r[l]&&r[l].m(e,null);t=!0},p(o,a){if(a&28){s=Ie(Object.entries(o[2]));let l;for(l=0;l<s.length;l+=1){const c=dl(o,s,l);r[l]?(r[l].p(c,a),O(r[l],1)):(r[l]=yl(c),r[l].c(),O(r[l],1),r[l].m(e,null))}for(Ae(),l=s.length;l<r.length;l+=1)i(l);Ne()}},i(o){if(!t){for(let a=0;a<s.length;a+=1)O(r[a]);t=!0}},o(o){r=r.filter(Boolean);for(let a=0;a<r.length;a+=1)W(r[a]);t=!1},d(o){o&&v(e),dt(r,o)}}}function gl(n){let e,t,s,r,i,o=n[4][n[9]].title+"",a,l,c,u,h,f;var d=n[4][n[9]].icon;function m(y,b){return{props:{size:"16",class:y[3].titleColor}}}d&&(s=St(d,m(n)));let _=Ie(n[10]),g=[];for(let y=0;y<_.length;y+=1)g[y]=vl(pl(n,_,y));return{c(){e=E("div"),t=E("div"),s&&oe(s.$$.fragment),r=x(),i=E("h4"),a=P(o),c=x(),u=E("ul");for(let y=0;y<g.length;y+=1)g[y].c();h=x(),this.h()},l(y){e=N(y,"DIV",{class:!0});var b=$(e);t=N(b,"DIV",{class:!0});var k=$(t);s&&de(s.$$.fragment,k),r=V(k),i=N(k,"H4",{class:!0});var I=$(i);a=R(I,o),I.forEach(v),k.forEach(v),c=V(b),u=N(b,"UL",{class:!0});var T=$(u);for(let C=0;C<g.length;C+=1)g[C].l(T);T.forEach(v),h=V(b),b.forEach(v),this.h()},h(){S(i,"class",l="font-medium "+n[3].titleColor+" svelte-k1ib06"),S(t,"class","flex items-center gap-2 mb-2"),S(u,"class","space-y-2 ml-7"),S(e,"class","category-section svelte-k1ib06")},m(y,b){H(y,e,b),p(e,t),s&&ie(s,t,null),p(t,r),p(t,i),p(i,a),p(e,c),p(e,u);for(let k=0;k<g.length;k+=1)g[k]&&g[k].m(u,null);p(e,h),f=!0},p(y,b){if(b&4&&d!==(d=y[4][y[9]].icon)){if(s){Ae();const k=s;W(k.$$.fragment,1,0,()=>{re(k,1)}),Ne()}d?(s=St(d,m(y)),oe(s.$$.fragment),O(s.$$.fragment,1),ie(s,t,r)):s=null}else if(d){const k={};b&8&&(k.class=y[3].titleColor),s.$set(k)}if((!f||b&4)&&o!==(o=y[4][y[9]].title+"")&&ee(a,o),(!f||b&8&&l!==(l="font-medium "+y[3].titleColor+" svelte-k1ib06"))&&S(i,"class",l),b&12){_=Ie(y[10]);let k;for(k=0;k<_.length;k+=1){const I=pl(y,_,k);g[k]?g[k].p(I,b):(g[k]=vl(I),g[k].c(),g[k].m(u,null))}for(;k<g.length;k+=1)g[k].d(1);g.length=_.length}},i(y){f||(s&&O(s.$$.fragment,y),f=!0)},o(y){s&&W(s.$$.fragment,y),f=!1},d(y){y&&v(e),s&&re(s),dt(g,y)}}}function vl(n){let e,t,s,r,i,o,a=n[13].text+"",l,c,u;return{c(){e=E("li"),t=E("span"),s=P("•"),i=x(),o=E("span"),l=P(a),u=x(),this.h()},l(h){e=N(h,"LI",{class:!0});var f=$(e);t=N(f,"SPAN",{class:!0});var d=$(t);s=R(d,"•"),d.forEach(v),i=V(f),o=N(f,"SPAN",{class:!0});var m=$(o);l=R(m,a),m.forEach(v),u=V(f),f.forEach(v),this.h()},h(){S(t,"class",r=n[3].contentColor+" mt-1 svelte-k1ib06"),S(o,"class",c=n[3].contentColor+" text-sm svelte-k1ib06"),S(e,"class","flex items-start gap-2")},m(h,f){H(h,e,f),p(e,t),p(t,s),p(e,i),p(e,o),p(o,l),p(e,u)},p(h,f){f&8&&r!==(r=h[3].contentColor+" mt-1 svelte-k1ib06")&&S(t,"class",r),f&4&&a!==(a=h[13].text+"")&&ee(l,a),f&8&&c!==(c=h[3].contentColor+" text-sm svelte-k1ib06")&&S(o,"class",c)},d(h){h&&v(e)}}}function yl(n){let e,t,s=n[10].length>0&&gl(n);return{c(){s&&s.c(),e=Gt()},l(r){s&&s.l(r),e=Gt()},m(r,i){s&&s.m(r,i),H(r,e,i),t=!0},p(r,i){r[10].length>0?s?(s.p(r,i),i&4&&O(s,1)):(s=gl(r),s.c(),O(s,1),s.m(e.parentNode,e)):s&&(Ae(),W(s,1,1,()=>{s=null}),Ne())},i(r){t||(O(s),t=!0)},o(r){W(s),t=!1},d(r){r&&v(e),s&&s.d(r)}}}function bl(n){let e,t,s,r,i,o,a,l,c;s=new $h({props:{size:"16",class:n[3].titleColor}});let u=Ie(n[0].nextSteps),h=[];for(let f=0;f<u.length;f+=1)h[f]=Sl(fl(n,u,f));return{c(){e=E("div"),t=E("h4"),oe(s.$$.fragment),r=P(`
        次のステップ`),o=x(),a=E("div");for(let f=0;f<h.length;f+=1)h[f].c();this.h()},l(f){e=N(f,"DIV",{class:!0});var d=$(e);t=N(d,"H4",{class:!0});var m=$(t);de(s.$$.fragment,m),r=R(m,`
        次のステップ`),m.forEach(v),o=V(d),a=N(d,"DIV",{class:!0});var _=$(a);for(let g=0;g<h.length;g+=1)h[g].l(_);_.forEach(v),d.forEach(v),this.h()},h(){S(t,"class",i="font-medium "+n[3].titleColor+" mb-3 flex items-center gap-2 svelte-k1ib06"),S(a,"class","grid gap-2"),S(e,"class",l="mt-6 pt-4 border-t "+n[3].border+" svelte-k1ib06")},m(f,d){H(f,e,d),p(e,t),ie(s,t,null),p(t,r),p(e,o),p(e,a);for(let m=0;m<h.length;m+=1)h[m]&&h[m].m(a,null);c=!0},p(f,d){const m={};if(d&8&&(m.class=f[3].titleColor),s.$set(m),(!c||d&8&&i!==(i="font-medium "+f[3].titleColor+" mb-3 flex items-center gap-2 svelte-k1ib06"))&&S(t,"class",i),d&9){u=Ie(f[0].nextSteps);let _;for(_=0;_<u.length;_+=1){const g=fl(f,u,_);h[_]?h[_].p(g,d):(h[_]=Sl(g),h[_].c(),h[_].m(a,null))}for(;_<h.length;_+=1)h[_].d(1);h.length=u.length}(!c||d&8&&l!==(l="mt-6 pt-4 border-t "+f[3].border+" svelte-k1ib06"))&&S(e,"class",l)},i(f){c||(O(s.$$.fragment,f),c=!0)},o(f){W(s.$$.fragment,f),c=!1},d(f){f&&v(e),re(s),dt(h,f)}}}function Sl(n){let e,t,s,r=n[8]+1+"",i,o,a,l,c,u=n[6]+"",h,f,d;return{c(){e=E("div"),t=E("div"),s=E("span"),i=P(r),l=x(),c=E("span"),h=P(u),d=x(),this.h()},l(m){e=N(m,"DIV",{class:!0});var _=$(e);t=N(_,"DIV",{class:!0});var g=$(t);s=N(g,"SPAN",{class:!0});var y=$(s);i=R(y,r),y.forEach(v),g.forEach(v),l=V(_),c=N(_,"SPAN",{class:!0});var b=$(c);h=R(b,u),b.forEach(v),d=V(_),_.forEach(v),this.h()},h(){S(s,"class",o="text-xs font-bold "+n[3].titleColor+" svelte-k1ib06"),S(t,"class",a="w-6 h-6 rounded-full "+n[3].iconBg+" flex items-center justify-center flex-shrink-0 svelte-k1ib06"),S(c,"class",f="text-sm "+n[3].contentColor+" svelte-k1ib06"),S(e,"class","flex items-center gap-3 bg-white bg-opacity-50 rounded-lg p-3")},m(m,_){H(m,e,_),p(e,t),p(t,s),p(s,i),p(e,l),p(e,c),p(c,h),p(e,d)},p(m,_){_&8&&o!==(o="text-xs font-bold "+m[3].titleColor+" svelte-k1ib06")&&S(s,"class",o),_&8&&a!==(a="w-6 h-6 rounded-full "+m[3].iconBg+" flex items-center justify-center flex-shrink-0 svelte-k1ib06")&&S(t,"class",a),_&1&&u!==(u=m[6]+"")&&ee(h,u),_&8&&f!==(f="text-sm "+m[3].contentColor+" svelte-k1ib06")&&S(c,"class",f)},d(m){m&&v(e)}}}function wl(n){let e,t,s,r,i,o=n[0].motivation+"",a,l,c;return s=new $r({props:{size:"16",class:n[3].titleColor}}),{c(){e=E("div"),t=E("div"),oe(s.$$.fragment),r=x(),i=E("span"),a=P(o),this.h()},l(u){e=N(u,"DIV",{class:!0});var h=$(e);t=N(h,"DIV",{class:!0});var f=$(t);de(s.$$.fragment,f),r=V(f),i=N(f,"SPAN",{class:!0});var d=$(i);a=R(d,o),d.forEach(v),f.forEach(v),h.forEach(v),this.h()},h(){S(i,"class",l="font-medium "+n[3].titleColor+" svelte-k1ib06"),S(t,"class","inline-flex items-center gap-2 bg-white bg-opacity-50 rounded-full px-4 py-2"),S(e,"class","mt-4 text-center")},m(u,h){H(u,e,h),p(e,t),ie(s,t,null),p(t,r),p(t,i),p(i,a),c=!0},p(u,h){const f={};h&8&&(f.class=u[3].titleColor),s.$set(f),(!c||h&1)&&o!==(o=u[0].motivation+"")&&ee(a,o),(!c||h&8&&l!==(l="font-medium "+u[3].titleColor+" svelte-k1ib06"))&&S(i,"class",l)},i(u){c||(O(s.$$.fragment,u),c=!0)},o(u){W(s.$$.fragment,u),c=!1},d(u){u&&v(e),re(s)}}}function S1(n){let e,t,s,r,i,o,a,l,c=(n[0].primary||"フィードバック")+"",u,h,f,d,m,_,g,y;var b=n[3].icon;function k(w,D){return{props:{size:"24",class:w[3].titleColor}}}b&&(r=St(b,k(n)));let I=n[0].summary&&ml(n),T=n[0].details&&n[0].details.length>0&&_l(n),C=n[0].nextSteps&&n[0].nextSteps.length>0&&bl(n),A=n[0].motivation&&wl(n);return{c(){e=E("div"),t=E("div"),s=E("div"),r&&oe(r.$$.fragment),o=x(),a=E("div"),l=E("h3"),u=P(c),f=x(),I&&I.c(),d=x(),T&&T.c(),m=x(),C&&C.c(),_=x(),A&&A.c(),this.h()},l(w){e=N(w,"DIV",{class:!0});var D=$(e);t=N(D,"DIV",{class:!0});var M=$(t);s=N(M,"DIV",{class:!0});var F=$(s);r&&de(r.$$.fragment,F),F.forEach(v),o=V(M),a=N(M,"DIV",{class:!0});var q=$(a);l=N(q,"H3",{class:!0});var B=$(l);u=R(B,c),B.forEach(v),f=V(q),I&&I.l(q),q.forEach(v),M.forEach(v),d=V(D),T&&T.l(D),m=V(D),C&&C.l(D),_=V(D),A&&A.l(D),D.forEach(v),this.h()},h(){S(s,"class",i=n[3].iconBg+" rounded-full p-3 flex-shrink-0 svelte-k1ib06"),S(l,"class",h=n[3].titleColor+" font-semibold text-lg mb-2 svelte-k1ib06"),S(a,"class","flex-1"),S(t,"class","flex items-start gap-4 mb-4"),S(e,"class",g="feedback-display "+n[1]+" "+n[3].bg+" "+n[3].border+" border rounded-xl p-6 svelte-k1ib06")},m(w,D){H(w,e,D),p(e,t),p(t,s),r&&ie(r,s,null),p(t,o),p(t,a),p(a,l),p(l,u),p(a,f),I&&I.m(a,null),p(e,d),T&&T.m(e,null),p(e,m),C&&C.m(e,null),p(e,_),A&&A.m(e,null),y=!0},p(w,[D]){if(D&8&&b!==(b=w[3].icon)){if(r){Ae();const M=r;W(M.$$.fragment,1,0,()=>{re(M,1)}),Ne()}b?(r=St(b,k(w)),oe(r.$$.fragment),O(r.$$.fragment,1),ie(r,s,null)):r=null}else if(b){const M={};D&8&&(M.class=w[3].titleColor),r.$set(M)}(!y||D&8&&i!==(i=w[3].iconBg+" rounded-full p-3 flex-shrink-0 svelte-k1ib06"))&&S(s,"class",i),(!y||D&1)&&c!==(c=(w[0].primary||"フィードバック")+"")&&ee(u,c),(!y||D&8&&h!==(h=w[3].titleColor+" font-semibold text-lg mb-2 svelte-k1ib06"))&&S(l,"class",h),w[0].summary?I?I.p(w,D):(I=ml(w),I.c(),I.m(a,null)):I&&(I.d(1),I=null),w[0].details&&w[0].details.length>0?T?(T.p(w,D),D&1&&O(T,1)):(T=_l(w),T.c(),O(T,1),T.m(e,m)):T&&(Ae(),W(T,1,1,()=>{T=null}),Ne()),w[0].nextSteps&&w[0].nextSteps.length>0?C?(C.p(w,D),D&1&&O(C,1)):(C=bl(w),C.c(),O(C,1),C.m(e,_)):C&&(Ae(),W(C,1,1,()=>{C=null}),Ne()),w[0].motivation?A?(A.p(w,D),D&1&&O(A,1)):(A=wl(w),A.c(),O(A,1),A.m(e,null)):A&&(Ae(),W(A,1,1,()=>{A=null}),Ne()),(!y||D&10&&g!==(g="feedback-display "+w[1]+" "+w[3].bg+" "+w[3].border+" border rounded-xl p-6 svelte-k1ib06"))&&S(e,"class",g)},i(w){y||(r&&O(r.$$.fragment,w),O(T),O(C),O(A),y=!0)},o(w){r&&W(r.$$.fragment,w),W(T),W(C),W(A),y=!1},d(w){w&&v(e),r&&re(r),I&&I.d(),T&&T.d(),C&&C.d(),A&&A.d()}}}function w1(n){const e={strengths:[],improvements:[],tips:[],practice:[]};return n.forEach(t=>{t.category&&e[t.category]&&e[t.category].push(t)}),e}function C1(n,e,t){let s,r,{feedback:i={}}=e,{className:o=""}=e;const a={excellent:{bg:"bg-green-50",border:"border-green-200",icon:Or,iconBg:"bg-green-100",titleColor:"text-green-800",contentColor:"text-green-700"},good:{bg:"bg-blue-50",border:"border-blue-200",icon:Ro,iconBg:"bg-blue-100",titleColor:"text-blue-800",contentColor:"text-blue-700"},improvement:{bg:"bg-amber-50",border:"border-amber-200",icon:eu,iconBg:"bg-amber-100",titleColor:"text-amber-800",contentColor:"text-amber-700"},warning:{bg:"bg-red-50",border:"border-red-200",icon:su,iconBg:"bg-red-100",titleColor:"text-red-800",contentColor:"text-red-700"},info:{bg:"bg-gray-50",border:"border-gray-200",icon:Kc,iconBg:"bg-gray-100",titleColor:"text-gray-800",contentColor:"text-gray-700"}},l={strengths:{title:"優れている点",icon:$r},improvements:{title:"改善点",icon:Oo},tips:{title:"アドバイス",icon:df},practice:{title:"練習提案",icon:Ff}};return n.$$set=c=>{"feedback"in c&&t(0,i=c.feedback),"className"in c&&t(1,o=c.className)},n.$$.update=()=>{n.$$.dirty&1&&t(3,s=a[i.type]||a.info),n.$$.dirty&1&&t(2,r=w1(i.details||[]))},[i,o,r,s,l]}class T1 extends Be{constructor(e){super(),He(this,e,C1,S1,Le,{feedback:0,className:1})}}function Cl(n,e,t){const s=n.slice();return s[6]=e[t],s}function Tl(n,e,t){const s=n.slice();return s[9]=e[t],s}function kl(n){let e,t=n[9].icon+"",s;return{c(){e=E("span"),s=P(t),this.h()},l(r){e=N(r,"SPAN",{class:!0});var i=$(e);s=R(i,t),i.forEach(v),this.h()},h(){S(e,"class","mr-1")},m(r,i){H(r,e,i),p(e,s)},p(r,i){i&2&&t!==(t=r[9].icon+"")&&ee(s,t)},d(r){r&&v(e)}}}function Al(n){let e,t,s=n[9].label+"",r,i,o,a,l=n[9].value+"",c,u,h,f=n[9].icon&&kl(n);return{c(){e=E("div"),t=E("span"),r=P(s),i=x(),o=E("span"),f&&f.c(),a=x(),c=P(l),h=x(),this.h()},l(d){e=N(d,"DIV",{class:!0});var m=$(e);t=N(m,"SPAN",{class:!0});var _=$(t);r=R(_,s),_.forEach(v),i=V(m),o=N(m,"SPAN",{class:!0});var g=$(o);f&&f.l(g),a=V(g),c=R(g,l),g.forEach(v),h=V(m),m.forEach(v),this.h()},h(){S(t,"class","text-sm text-gray-600"),S(o,"class",u="font-semibold "+(n[9].customClass||(n[9].highlight?"text-blue-600":"text-gray-800"))+" svelte-zmai3x"),S(e,"class","stat-item flex justify-between items-center svelte-zmai3x")},m(d,m){H(d,e,m),p(e,t),p(t,r),p(e,i),p(e,o),f&&f.m(o,null),p(o,a),p(o,c),p(e,h)},p(d,m){m&2&&s!==(s=d[9].label+"")&&ee(r,s),d[9].icon?f?f.p(d,m):(f=kl(d),f.c(),f.m(o,a)):f&&(f.d(1),f=null),m&2&&l!==(l=d[9].value+"")&&ee(c,l),m&2&&u!==(u="font-semibold "+(d[9].customClass||(d[9].highlight?"text-blue-600":"text-gray-800"))+" svelte-zmai3x")&&S(o,"class",u)},d(d){d&&v(e),f&&f.d()}}}function Nl(n){let e,t,s,r=n[6].icon+"",i,o,a,l=n[6].title+"",c,u,h,f,d=Ie(n[6].stats),m=[];for(let _=0;_<d.length;_+=1)m[_]=Al(Tl(n,d,_));return{c(){e=E("div"),t=E("div"),s=E("span"),i=P(r),o=x(),a=E("h4"),c=P(l),u=x(),h=E("div");for(let _=0;_<m.length;_+=1)m[_].c();f=x(),this.h()},l(_){e=N(_,"DIV",{class:!0});var g=$(e);t=N(g,"DIV",{class:!0});var y=$(t);s=N(y,"SPAN",{class:!0});var b=$(s);i=R(b,r),b.forEach(v),o=V(y),a=N(y,"H4",{class:!0});var k=$(a);c=R(k,l),k.forEach(v),y.forEach(v),u=V(g),h=N(g,"DIV",{class:!0});var I=$(h);for(let T=0;T<m.length;T+=1)m[T].l(I);I.forEach(v),f=V(g),g.forEach(v),this.h()},h(){S(s,"class","text-2xl"),S(a,"class","font-medium text-gray-700"),S(t,"class","flex items-center gap-2 mb-3"),S(h,"class","space-y-2"),S(e,"class","stat-category bg-gray-50 rounded-lg p-4 svelte-zmai3x")},m(_,g){H(_,e,g),p(e,t),p(t,s),p(s,i),p(t,o),p(t,a),p(a,c),p(e,u),p(e,h);for(let y=0;y<m.length;y+=1)m[y]&&m[y].m(h,null);p(e,f)},p(_,g){if(g&2&&r!==(r=_[6].icon+"")&&ee(i,r),g&2&&l!==(l=_[6].title+"")&&ee(c,l),g&2){d=Ie(_[6].stats);let y;for(y=0;y<d.length;y+=1){const b=Tl(_,d,y);m[y]?m[y].p(b,g):(m[y]=Al(b),m[y].c(),m[y].m(h,null))}for(;y<m.length;y+=1)m[y].d(1);m.length=d.length}},d(_){_&&v(e),dt(m,_)}}}function k1(n){let e,t,s,r,i,o="セッションサマリー",a,l,c;function u(m,_){return m[2].averageScore>=80?E1:m[2].averageScore>=60?N1:A1}let f=u(n)(n),d=n[2].streakCount>0&&I1(n);return{c(){e=E("div"),t=E("div"),s=E("div"),r=E("div"),i=E("h4"),i.textContent=o,a=x(),l=E("p"),f.c(),c=x(),d&&d.c(),this.h()},l(m){e=N(m,"DIV",{class:!0});var _=$(e);t=N(_,"DIV",{class:!0});var g=$(t);s=N(g,"DIV",{class:!0});var y=$(s);r=N(y,"DIV",{});var b=$(r);i=N(b,"H4",{class:!0,"data-svelte-h":!0}),pe(i)!=="svelte-wj7huc"&&(i.textContent=o),a=V(b),l=N(b,"P",{class:!0});var k=$(l);f.l(k),k.forEach(v),b.forEach(v),c=V(y),d&&d.l(y),y.forEach(v),g.forEach(v),_.forEach(v),this.h()},h(){S(i,"class","font-medium text-gray-700 mb-1"),S(l,"class","text-sm text-gray-600"),S(s,"class","flex items-center justify-between flex-wrap gap-4"),S(t,"class","progress-summary bg-gradient-to-r from-blue-50 to-purple-50 rounded-lg p-4 svelte-zmai3x"),S(e,"class","mt-6 pt-6 border-t border-gray-200")},m(m,_){H(m,e,_),p(e,t),p(t,s),p(s,r),p(r,i),p(r,a),p(r,l),f.m(l,null),p(s,c),d&&d.m(s,null)},p(m,_){m[2].streakCount>0&&d.p(m,_)},d(m){m&&v(e),f.d(),d&&d.d()}}}function A1(n){let e;return{c(){e=P("練習を続けることが大切です。少しずつ確実に上達しています。")},l(t){e=R(t,"練習を続けることが大切です。少しずつ確実に上達しています。")},m(t,s){H(t,e,s)},d(t){t&&v(e)}}}function N1(n){let e;return{c(){e=P("良い進歩が見られます。継続することでさらなる向上が期待できます。")},l(t){e=R(t,"良い進歩が見られます。継続することでさらなる向上が期待できます。")},m(t,s){H(t,e,s)},d(t){t&&v(e)}}}function E1(n){let e;return{c(){e=P("素晴らしいパフォーマンスです！相対音感が向上しています。")},l(t){e=R(t,"素晴らしいパフォーマンスです！相対音感が向上しています。")},m(t,s){H(t,e,s)},d(t){t&&v(e)}}}function I1(n){let e,t,s="🔥",r,i,o=n[2].streakCount+"",a,l,c,u="連続正解中";return{c(){e=E("div"),t=E("span"),t.textContent=s,r=x(),i=E("span"),a=P(o),l=x(),c=E("span"),c.textContent=u,this.h()},l(h){e=N(h,"DIV",{class:!0});var f=$(e);t=N(f,"SPAN",{class:!0,"data-svelte-h":!0}),pe(t)!=="svelte-1u2kb0v"&&(t.textContent=s),r=V(f),i=N(f,"SPAN",{class:!0});var d=$(i);a=R(d,o),d.forEach(v),l=V(f),c=N(f,"SPAN",{class:!0,"data-svelte-h":!0}),pe(c)!=="svelte-186fq2y"&&(c.textContent=u),f.forEach(v),this.h()},h(){S(t,"class","text-2xl mr-2"),S(i,"class","font-bold text-orange-600"),S(c,"class","text-sm text-gray-600 ml-1"),S(e,"class","streak-display bg-white rounded-full px-4 py-2 shadow-sm")},m(h,f){H(h,e,f),p(e,t),p(e,r),p(e,i),p(i,a),p(e,l),p(e,c)},p:Et,d(h){h&&v(e)}}}function D1(n){let e,t,s="📊 セッション統計",r,i,o,a,l=Ie(n[1]),c=[];for(let h=0;h<l.length;h+=1)c[h]=Nl(Cl(n,l,h));let u=n[2].totalAttempts>0&&k1(n);return{c(){e=E("div"),t=E("h3"),t.textContent=s,r=x(),i=E("div");for(let h=0;h<c.length;h+=1)c[h].c();o=x(),u&&u.c(),this.h()},l(h){e=N(h,"DIV",{class:!0});var f=$(e);t=N(f,"H3",{class:!0,"data-svelte-h":!0}),pe(t)!=="svelte-1jvvszv"&&(t.textContent=s),r=V(f),i=N(f,"DIV",{class:!0});var d=$(i);for(let m=0;m<c.length;m+=1)c[m].l(d);d.forEach(v),o=V(f),u&&u.l(f),f.forEach(v),this.h()},h(){S(t,"class","text-xl font-semibold text-gray-800 mb-6"),S(i,"class","grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"),S(e,"class",a="session-statistics "+n[0]+" bg-white rounded-xl shadow-lg p-6 svelte-zmai3x")},m(h,f){H(h,e,f),p(e,t),p(e,r),p(e,i);for(let d=0;d<c.length;d+=1)c[d]&&c[d].m(i,null);p(e,o),u&&u.m(e,null)},p(h,[f]){if(f&2){l=Ie(h[1]);let d;for(d=0;d<l.length;d+=1){const m=Cl(h,l,d);c[d]?c[d].p(m,f):(c[d]=Nl(m),c[d].c(),c[d].m(i,null))}for(;d<c.length;d+=1)c[d].d(1);c.length=l.length}h[2].totalAttempts>0&&u.p(h,f),f&1&&a!==(a="session-statistics "+h[0]+" bg-white rounded-xl shadow-lg p-6 svelte-zmai3x")&&S(e,"class",a)},i:Et,o:Et,d(h){h&&v(e),dt(c,h),u&&u.d()}}}function M1(n){if(n<60)return`${Math.floor(n)}分`;const e=Math.floor(n/60),t=Math.floor(n%60);return`${e}時間${t}分`}function $1(n,e,t){let s,r,{statistics:i={}}=e,{className:o=""}=e;const a={totalAttempts:i.totalAttempts||0,successRate:i.successRate||0,averageScore:i.averageScore||0,bestScore:i.bestScore||0,sessionDuration:i.sessionDuration||0,streakCount:i.streakCount||0,fatigueLevel:i.fatigueLevel||"fresh",mostDifficultInterval:i.mostDifficultInterval||"-",mostSuccessfulInterval:i.mostSuccessfulInterval||"-",averageResponseTime:i.averageResponseTime||0},l={fresh:{label:"フレッシュ",color:"text-green-600",icon:"😊"},normal:{label:"通常",color:"text-blue-600",icon:"🙂"},tired:{label:"疲れ気味",color:"text-amber-600",icon:"😴"},exhausted:{label:"疲労",color:"text-red-600",icon:"😩"}};return n.$$set=c=>{"statistics"in c&&t(3,i=c.statistics),"className"in c&&t(0,o=c.className)},n.$$.update=()=>{n.$$.dirty&16&&t(1,r=[{title:"パフォーマンス",icon:"📊",stats:[{label:"総挑戦回数",value:`${(a==null?void 0:a.totalAttempts)||0}回`,highlight:((a==null?void 0:a.totalAttempts)||0)>20},{label:"成功率",value:`${((a==null?void 0:a.successRate)||0).toFixed(1)}%`,highlight:((a==null?void 0:a.successRate)||0)>70},{label:"平均スコア",value:`${((a==null?void 0:a.averageScore)||0).toFixed(1)}点`,highlight:((a==null?void 0:a.averageScore)||0)>75},{label:"最高スコア",value:`${(a==null?void 0:a.bestScore)||0}点`,highlight:((a==null?void 0:a.bestScore)||0)>90}]},{title:"セッション情報",icon:"⏱️",stats:[{label:"練習時間",value:M1((a==null?void 0:a.sessionDuration)||0)},{label:"連続正解",value:`${(a==null?void 0:a.streakCount)||0}回`,highlight:((a==null?void 0:a.streakCount)||0)>5},{label:"平均応答時間",value:`${((a==null?void 0:a.averageResponseTime)||0).toFixed(1)}秒`},{label:"疲労度",value:s.label,customClass:s.color,icon:s.icon}]},{title:"音程分析",icon:"🎵",stats:[{label:"最も難しい音程",value:(a==null?void 0:a.mostDifficultInterval)||"未分析",customClass:"text-red-600"},{label:"最も得意な音程",value:(a==null?void 0:a.mostSuccessfulInterval)||"未分析",customClass:"text-green-600"}]}])},t(4,s=a&&a.fatigueLevel&&l[a.fatigueLevel]||l.normal),[o,r,a,i,s]}class O1 extends Be{constructor(e){super(),He(this,e,$1,D1,Le,{statistics:3,className:0})}}function an(n){const e=n-1;return e*e*e+1}function Hn(n,{delay:e=0,duration:t=400,easing:s=zc}={}){const r=+getComputedStyle(n).opacity;return{delay:e,duration:t,easing:s,css:i=>`opacity: ${i*r}`}}function Hr(n,{delay:e=0,duration:t=400,easing:s=an,x:r=0,y:i=0,opacity:o=0}={}){const a=getComputedStyle(n),l=+a.opacity,c=a.transform==="none"?"":a.transform,u=l*(1-o),[h,f]=Ta(r),[d,m]=Ta(i);return{delay:e,duration:t,easing:s,css:(_,g)=>`
			transform: ${c} translate(${(1-_)*h}${f}, ${(1-_)*d}${m});
			opacity: ${l-u*g}`}}function El(n){return Object.prototype.toString.call(n)==="[object Date]"}function Do(n,e){if(n===e||n!==n)return()=>n;const t=typeof n;if(t!==typeof e||Array.isArray(n)!==Array.isArray(e))throw new Error("Cannot interpolate values of different type");if(Array.isArray(n)){const s=e.map((r,i)=>Do(n[i],r));return r=>s.map(i=>i(r))}if(t==="object"){if(!n||!e)throw new Error("Object cannot be null");if(El(n)&&El(e)){n=n.getTime(),e=e.getTime();const i=e-n;return o=>new Date(n+o*i)}const s=Object.keys(e),r={};return s.forEach(i=>{r[i]=Do(n[i],e[i])}),i=>{const o={};return s.forEach(a=>{o[a]=r[a](i)}),o}}if(t==="number"){const s=e-n;return r=>n+r*s}throw new Error(`Cannot interpolate ${t} values`)}function $n(n,e={}){const t=_r(n);let s,r=n;function i(o,a){if(n==null)return t.set(n=o),Promise.resolve();r=o;let l=s,c=!1,{delay:u=0,duration:h=400,easing:f=zc,interpolate:d=Do}=he(he({},e),a);if(h===0)return l&&(l.abort(),l=null),t.set(n=r),Promise.resolve();const m=vh()+u;let _;return s=yh(g=>{if(g<m)return!0;c||(_=d(n,o),typeof h=="function"&&(h=h(n,o)),c=!0),l&&(l.abort(),l=null);const y=g-m;return y>h?(t.set(n=o),!1):(t.set(n=_(f(y/h))),!0)}),s.promise}return{set:i,update:(o,a)=>i(o(r,n),a),subscribe:t.subscribe}}function R1(n){let e,t,s="🎉 結果をシェアしよう！",r,i,o,a,l,c,u="シェア",h,f,d,m,_,g="Twitter",y,b,k,I,T,C="画像保存",A,w,D,M,F,q=n[2]?"コピー完了!":"URLコピー",B,G,Y,U,L,K,z;return a=new Xf({props:{class:"w-5 h-5"}}),d=new gd({props:{class:"w-5 h-5"}}),k=new cf({props:{class:"w-5 h-5"}}),D=new ef({props:{class:"w-5 h-5"}}),{c(){e=E("div"),t=E("h3"),t.textContent=s,r=x(),i=E("div"),o=E("button"),oe(a.$$.fragment),l=x(),c=E("span"),c.textContent=u,h=x(),f=E("button"),oe(d.$$.fragment),m=x(),_=E("span"),_.textContent=g,y=x(),b=E("button"),oe(k.$$.fragment),I=x(),T=E("span"),T.textContent=C,A=x(),w=E("button"),oe(D.$$.fragment),M=x(),F=E("span"),B=P(q),G=x(),Y=E("canvas"),this.h()},l(Q){e=N(Q,"DIV",{class:!0});var te=$(e);t=N(te,"H3",{class:!0,"data-svelte-h":!0}),pe(t)!=="svelte-1k55mtq"&&(t.textContent=s),r=V(te),i=N(te,"DIV",{class:!0});var ce=$(i);o=N(ce,"BUTTON",{class:!0});var ve=$(o);de(a.$$.fragment,ve),l=V(ve),c=N(ve,"SPAN",{"data-svelte-h":!0}),pe(c)!=="svelte-n7ohiy"&&(c.textContent=u),ve.forEach(v),h=V(ce),f=N(ce,"BUTTON",{class:!0});var Ce=$(f);de(d.$$.fragment,Ce),m=V(Ce),_=N(Ce,"SPAN",{"data-svelte-h":!0}),pe(_)!=="svelte-9elsgz"&&(_.textContent=g),Ce.forEach(v),y=V(ce),b=N(ce,"BUTTON",{class:!0});var ye=$(b);de(k.$$.fragment,ye),I=V(ye),T=N(ye,"SPAN",{"data-svelte-h":!0}),pe(T)!=="svelte-6dblf9"&&(T.textContent=C),ye.forEach(v),A=V(ce),w=N(ce,"BUTTON",{class:!0});var me=$(w);de(D.$$.fragment,me),M=V(me),F=N(me,"SPAN",{});var be=$(F);B=R(be,q),be.forEach(v),me.forEach(v),ce.forEach(v),G=V(te),Y=N(te,"CANVAS",{style:!0}),$(Y).forEach(v),te.forEach(v),this.h()},h(){S(t,"class","share-title svelte-fiwdcm"),S(o,"class","share-btn primary svelte-fiwdcm"),S(f,"class","share-btn twitter svelte-fiwdcm"),S(b,"class","share-btn download svelte-fiwdcm"),S(w,"class","share-btn copy svelte-fiwdcm"),Ls(w,"success",n[2]),S(i,"class","button-grid svelte-fiwdcm"),st(Y,"display","none"),S(e,"class",U="sns-share-buttons "+n[0]+" svelte-fiwdcm")},m(Q,te){H(Q,e,te),p(e,t),p(e,r),p(e,i),p(i,o),ie(a,o,null),p(o,l),p(o,c),p(i,h),p(i,f),ie(d,f,null),p(f,m),p(f,_),p(i,y),p(i,b),ie(k,b,null),p(b,I),p(b,T),p(i,A),p(i,w),ie(D,w,null),p(w,M),p(w,F),p(F,B),p(e,G),p(e,Y),n[8](Y),L=!0,K||(z=[vs(o,"click",n[6]),vs(f,"click",n[3]),vs(b,"click",n[4]),vs(w,"click",n[5])],K=!0)},p(Q,[te]){(!L||te&4)&&q!==(q=Q[2]?"コピー完了!":"URLコピー")&&ee(B,q),(!L||te&4)&&Ls(w,"success",Q[2]),(!L||te&1&&U!==(U="sns-share-buttons "+Q[0]+" svelte-fiwdcm"))&&S(e,"class",U)},i(Q){L||(O(a.$$.fragment,Q),O(d.$$.fragment,Q),O(k.$$.fragment,Q),O(D.$$.fragment,Q),L=!0)},o(Q){W(a.$$.fragment,Q),W(d.$$.fragment,Q),W(k.$$.fragment,Q),W(D.$$.fragment,Q),L=!1},d(Q){Q&&v(e),re(a),re(d),re(k),re(D),n[8](null),K=!1,Gc(z)}}}function P1(n,e,t){let{scoreData:s=null}=e,{className:r=""}=e,i=null,o=!1;const a={excellent:"優秀",good:"良好",pass:"合格",needWork:"要練習",notMeasured:"測定不可"};async function l(){var A;if(!i||!s)return"";const m=i.getContext("2d"),_=800,g=600;t(1,i.width=_,i),t(1,i.height=g,i),m.fillStyle="#f8fafc",m.fillRect(0,0,_,g),m.fillStyle="#1e293b",m.font="bold 36px system-ui",m.textAlign="center",m.fillText("🎵 相対音感トレーニング結果",_/2,80);const y={excellent:"優秀",good:"良好",pass:"合格",needWork:"要練習",notMeasured:"測定不可"},b={excellent:"#fbbf24",good:"#10b981",pass:"#3b82f6",needWork:"#ef4444",notMeasured:"#9ca3af"},k=s.overallGrade||"needWork",I=y[k]||"要練習";m.fillStyle=b[k],m.font="bold 72px system-ui",m.fillText(`${I}達成！`,_/2,180);const T={random:"ランダム基音トレーニング",continuous:"連続チャレンジモード",chromatic:"12音階マスターモード"};if(m.fillStyle="#64748b",m.font="24px system-ui",m.fillText(T[s.mode]||"",_/2,220),m.fillStyle="#374151",m.font="20px system-ui",m.textAlign="left",[`📊 平均精度: ${s.averageAccuracy}%`,`🎯 測定率: ${Math.round(s.measuredNotes/s.totalNotes*100)}%`,`📅 完走セッション: ${((A=s.sessionHistory)==null?void 0:A.length)||0}回`].forEach((w,D)=>{m.fillText(w,100,300+D*35)}),s.sessionHistory){const F=(_-(s.sessionHistory.length*70-10))/2,q=420;s.sessionHistory.forEach((B,G)=>{const Y=F+G*70,U=b[B.grade]||"#6b7280",L=y[B.grade]||"不明";m.fillStyle=U,m.fillRect(Y,q,60,80),m.fillStyle="white",m.font="bold 16px system-ui",m.textAlign="center",m.fillText(`${G+1}`,Y+60/2,q+25),m.font="bold 20px system-ui",m.fillText(L,Y+60/2,q+50)})}return m.fillStyle="#9ca3af",m.font="16px system-ui",m.textAlign="center",m.fillText("https://kiyopi.github.io/pitch-training/",_/2,g-30),i.toDataURL("image/png")}async function c(){var b;await l();const _=`🎵 相対音感トレーニングで「${a[s.overallGrade]||"要練習"}」達成！
平均精度: ${s.averageAccuracy}%
${((b=s.sessionHistory)==null?void 0:b.length)||0}セッション完走 🎉`,y=`https://twitter.com/intent/tweet?text=${encodeURIComponent(_)}&url=${encodeURIComponent("https://kiyopi.github.io/pitch-training/")}`;window.open(y,"_blank")}async function u(){const m=await l(),_=a[s.overallGrade]||"要練習",g=document.createElement("a");g.download=`pitch-training-result-${s.mode}-${_}.png`,g.href=m,g.click()}async function h(){try{await navigator.clipboard.writeText("https://kiyopi.github.io/pitch-training/"),t(2,o=!0),setTimeout(()=>{t(2,o=!1)},2e3)}catch(m){console.error("コピーに失敗しました:",m)}}async function f(){if(!navigator.share){await c();return}try{const m=a[s.overallGrade]||"要練習";await navigator.share({title:"🎵 相対音感トレーニング結果",text:`「${m}」達成！平均精度: ${s.averageAccuracy}%`,url:"https://kiyopi.github.io/pitch-training/"})}catch(m){m.name!=="AbortError"&&console.error("共有に失敗しました:",m)}}function d(m){Zc[m?"unshift":"push"](()=>{i=m,t(1,i)})}return n.$$set=m=>{"scoreData"in m&&t(7,s=m.scoreData),"className"in m&&t(0,r=m.className)},[r,i,o,c,u,h,f,s,d]}class V1 extends Be{constructor(e){super(),He(this,e,P1,R1,Le,{scoreData:7,className:0})}}function Il(n,e,t){const s=n.slice();return s[16]=e[t],s[18]=t,s}function Dl(n,e,t){const s=n.slice();return s[19]=e[t],s[18]=t,s}const x1=n=>({session:n&1}),Ml=n=>({session:n[19],index:n[18]});function $l(n){let e,t,s;const r=n[12].default,i=nt(r,n,n[11],Ml);return{c(){e=E("div"),i&&i.c(),t=x(),this.h()},l(o){e=N(o,"DIV",{class:!0,"data-index":!0});var a=$(e);i&&i.l(a),t=V(a),a.forEach(v),this.h()},h(){S(e,"class","carousel-slide svelte-v7neeq"),S(e,"data-index",n[18])},m(o,a){H(o,e,a),i&&i.m(e,null),p(e,t),s=!0},p(o,a){i&&i.p&&(!s||a&2049)&&rt(i,r,o,o[11],s?ot(r,o[11],a,x1):it(o[11]),Ml)},i(o){s||(O(i,o),s=!0)},o(o){W(i,o),s=!1},d(o){o&&v(e),i&&i.d(o)}}}function Ol(n){let e,t,s;function r(){return n[13](n[18])}return{c(){e=E("button"),this.h()},l(i){e=N(i,"BUTTON",{class:!0,"aria-label":!0}),$(e).forEach(v),this.h()},h(){S(e,"class","carousel-indicator svelte-v7neeq"),S(e,"aria-label","セッション"+(n[18]+1)+"へ移動"),Ls(e,"active",n[18]===n[1])},m(i,o){H(i,e,o),t||(s=vs(e,"click",r),t=!0)},p(i,o){n=i,o&2&&Ls(e,"active",n[18]===n[1])},d(i){i&&v(e),t=!1,s()}}}function F1(n){let e,t,s,r,i,o,a,l,c,u,h,f,d,m,_,g,y,b;r=new jh({props:{size:"24"}});let k=Ie(n[0]),I=[];for(let w=0;w<k.length;w+=1)I[w]=$l(Dl(n,k,w));const T=w=>W(I[w],1,1,()=>{I[w]=null});h=new Qc({props:{size:"24"}});let C=Ie(n[0]),A=[];for(let w=0;w<C.length;w+=1)A[w]=Ol(Il(n,C,w));return{c(){e=E("div"),t=E("div"),s=E("button"),oe(r.$$.fragment),o=x(),a=E("div"),l=E("div");for(let w=0;w<I.length;w+=1)I[w].c();c=x(),u=E("button"),oe(h.$$.fragment),d=x(),m=E("div");for(let w=0;w<A.length;w+=1)A[w].c();this.h()},l(w){e=N(w,"DIV",{class:!0,role:!0,"aria-label":!0});var D=$(e);t=N(D,"DIV",{class:!0});var M=$(t);s=N(M,"BUTTON",{class:!0,"aria-label":!0});var F=$(s);de(r.$$.fragment,F),F.forEach(v),o=V(M),a=N(M,"DIV",{class:!0});var q=$(a);l=N(q,"DIV",{class:!0,style:!0});var B=$(l);for(let U=0;U<I.length;U+=1)I[U].l(B);B.forEach(v),q.forEach(v),c=V(M),u=N(M,"BUTTON",{class:!0,"aria-label":!0});var G=$(u);de(h.$$.fragment,G),G.forEach(v),M.forEach(v),d=V(D),m=N(D,"DIV",{class:!0});var Y=$(m);for(let U=0;U<A.length;U+=1)A[U].l(Y);Y.forEach(v),D.forEach(v),this.h()},h(){S(s,"class","carousel-nav carousel-nav-prev svelte-v7neeq"),s.disabled=i=!n[3],S(s,"aria-label","前のセッション"),S(l,"class","carousel-track svelte-v7neeq"),st(l,"transform","translateX("+n[5]+"%)"),S(a,"class","carousel-viewport svelte-v7neeq"),S(u,"class","carousel-nav carousel-nav-next svelte-v7neeq"),u.disabled=f=!n[4],S(u,"aria-label","次のセッション"),S(t,"class","carousel-container svelte-v7neeq"),S(m,"class","carousel-indicators svelte-v7neeq"),S(e,"class",_="session-carousel "+n[2]+" svelte-v7neeq"),S(e,"role","region"),S(e,"aria-label","セッション詳細カルーセル")},m(w,D){H(w,e,D),p(e,t),p(t,s),ie(r,s,null),p(t,o),p(t,a),p(a,l);for(let M=0;M<I.length;M+=1)I[M]&&I[M].m(l,null);p(t,c),p(t,u),ie(h,u,null),p(e,d),p(e,m);for(let M=0;M<A.length;M+=1)A[M]&&A[M].m(m,null);g=!0,y||(b=[vs(s,"click",n[9]),vs(u,"click",n[8]),vs(e,"keydown",n[10])],y=!0)},p(w,[D]){if((!g||D&8&&i!==(i=!w[3]))&&(s.disabled=i),D&2049){k=Ie(w[0]);let M;for(M=0;M<k.length;M+=1){const F=Dl(w,k,M);I[M]?(I[M].p(F,D),O(I[M],1)):(I[M]=$l(F),I[M].c(),O(I[M],1),I[M].m(l,null))}for(Ae(),M=k.length;M<I.length;M+=1)T(M);Ne()}if((!g||D&32)&&st(l,"transform","translateX("+w[5]+"%)"),(!g||D&16&&f!==(f=!w[4]))&&(u.disabled=f),D&131){C=Ie(w[0]);let M;for(M=0;M<C.length;M+=1){const F=Il(w,C,M);A[M]?A[M].p(F,D):(A[M]=Ol(F),A[M].c(),A[M].m(m,null))}for(;M<A.length;M+=1)A[M].d(1);A.length=C.length}(!g||D&4&&_!==(_="session-carousel "+w[2]+" svelte-v7neeq"))&&S(e,"class",_)},i(w){if(!g){O(r.$$.fragment,w);for(let D=0;D<k.length;D+=1)O(I[D]);O(h.$$.fragment,w),g=!0}},o(w){W(r.$$.fragment,w),I=I.filter(Boolean);for(let D=0;D<I.length;D+=1)W(I[D]);W(h.$$.fragment,w),g=!1},d(w){w&&v(e),re(r),dt(I,w),re(h),dt(A,w),y=!1,Gc(b)}}}function q1(n,e,t){let s,r,i,{$$slots:o={},$$scope:a}=e,{sessionHistory:l=[]}=e,{currentIndex:c=0}=e,{className:u=""}=e;const h=Xc(),f=$n(0,{duration:300,easing:an});Ut(n,f,b=>t(5,i=b));function d(b){console.log("🎯 [SessionCarousel] goToSession called:",{targetIndex:b,currentIndex:c,sessionHistoryLength:l.length,isValidIndex:b>=0&&b<l.length}),b>=0&&b<l.length?(console.log("🔥 [SessionCarousel] Dispatching sessionChange event:",b),h("sessionChange",{index:b}),f.set(-b*100),console.log("✅ [SessionCarousel] Session switched to:",b)):console.log("❌ [SessionCarousel] Invalid session index:",b)}function m(){s&&d(c+1)}function _(){console.log("🔄 [SessionCarousel] prevSession clicked:",{currentIndex:c,hasPrev:r,sessionHistory:l.length}),r?(console.log("✅ [SessionCarousel] Moving to previous session:",c-1),d(c-1)):console.log("⚠️ [SessionCarousel] Cannot go to previous session - at first session")}function g(b){b.key==="ArrowLeft"?_():b.key==="ArrowRight"&&m()}const y=b=>d(b);return n.$$set=b=>{"sessionHistory"in b&&t(0,l=b.sessionHistory),"currentIndex"in b&&t(1,c=b.currentIndex),"className"in b&&t(2,u=b.className),"$$scope"in b&&t(11,a=b.$$scope)},n.$$.update=()=>{n.$$.dirty&3&&l[c],n.$$.dirty&3&&t(4,s=c<l.length-1),n.$$.dirty&2&&t(3,r=c>0),n.$$.dirty&27&&console.log("🔍 [SessionCarousel] Navigation state:",{currentIndex:c,sessionHistoryLength:l.length,hasNext:s,hasPrev:r}),n.$$.dirty&3&&c>=0&&c<l.length&&f.set(-c*100)},[l,c,u,r,s,i,f,d,m,_,g,a,o,y]}class va extends Be{constructor(e){super(),He(this,e,q1,F1,Le,{sessionHistory:0,currentIndex:1,className:2})}}function Rl(n,e,t){const s=n.slice();return s[24]=e[t][0],s[25]=e[t][1],s}function Pl(n,e,t){const s=n.slice();return s[28]=e[t],s}function Vl(n,e,t){const s=n.slice();s[31]=e[t],s[35]=t;const r=Ii(s[31].cents);s[32]=r;const i=Math.abs(s[31].cents)>50;return s[33]=i,s}function xl(n,e,t){const s=n.slice();s[24]=e[t][0],s[25]=e[t][1],s[35]=t;const r=s[4][s[24]]||0;s[36]=r;const i=s[36]/8*100;return s[37]=i,s}function W1(n){let e,t,s;return{c(){e=P("平均誤差: "),t=P(n[6]),s=P("¢")},l(r){e=R(r,"平均誤差: "),t=R(r,n[6]),s=R(r,"¢")},m(r,i){H(r,e,i),H(r,t,i),H(r,s,i)},p(r,i){i[0]&64&&ee(t,r[6])},d(r){r&&(v(e),v(t),v(s))}}}function L1(n){let e,t=n[2]+1+"",s,r,i,o,a,l;return{c(){e=P("セッション"),s=P(t),r=P(" - 基音: "),i=P(n[3]),o=P("　平均誤差: "),a=P(n[6]),l=P("¢")},l(c){e=R(c,"セッション"),s=R(c,t),r=R(c," - 基音: "),i=R(c,n[3]),o=R(c,"　平均誤差: "),a=R(c,n[6]),l=R(c,"¢")},m(c,u){H(c,e,u),H(c,s,u),H(c,r,u),H(c,i,u),H(c,o,u),H(c,a,u),H(c,l,u)},p(c,u){u[0]&4&&t!==(t=c[2]+1+"")&&ee(s,t),u[0]&8&&ee(i,c[3]),u[0]&64&&ee(a,c[6])},d(c){c&&(v(e),v(s),v(r),v(i),v(o),v(a),v(l))}}}function Fl(n){let e,t,s,r,i,o;return{c(){e=E("p"),t=P("外れ値ペナルティ: -"),s=P(n[5]),r=P("点"),this.h()},l(a){e=N(a,"P",{class:!0});var l=$(e);t=R(l,"外れ値ペナルティ: -"),s=R(l,n[5]),r=R(l,"点"),l.forEach(v),this.h()},h(){S(e,"class","penalty-notice svelte-1e5y2q")},m(a,l){H(a,e,l),p(e,t),p(e,s),p(e,r),o=!0},p(a,l){(!o||l[0]&32)&&ee(s,a[5])},i(a){o||(a&&Ds(()=>{o&&(i||(i=ka(e,Hn,{},!0)),i.run(1))}),o=!0)},o(a){a&&(i||(i=ka(e,Hn,{},!1)),i.run(0)),o=!1},d(a){a&&v(e),a&&i&&i.end()}}}function ql(n){let e,t;return e=new Xs({props:{class:"w-4 h-4 text-red-500 animate-pulse"}}),{c(){oe(e.$$.fragment)},l(s){de(e.$$.fragment,s)},m(s,r){ie(e,s,r),t=!0},i(s){t||(O(e.$$.fragment,s),t=!0)},o(s){W(e.$$.fragment,s),t=!1},d(s){re(e,s)}}}function Wl(n){let e,t,s,r,i,o=n[25].name+"",a,l,c,u,h,f,d,m,_=n[36]+"",g,y,b,k,I;var T=n[25].icon;function C(w,D){return{props:{class:"w-5 h-5 "+w[25].color}}}T&&(s=St(T,C(n)));let A=n[24]==="needWork"&&n[36]>0&&ql();return{c(){e=E("div"),t=E("div"),s&&oe(s.$$.fragment),r=x(),i=E("span"),a=P(o),l=x(),c=E("div"),u=E("div"),f=x(),d=E("div"),m=E("span"),g=P(_),y=P("/8"),b=x(),A&&A.c(),k=x(),this.h()},l(w){e=N(w,"DIV",{class:!0,style:!0});var D=$(e);t=N(D,"DIV",{class:!0});var M=$(t);s&&de(s.$$.fragment,M),r=V(M),i=N(M,"SPAN",{});var F=$(i);a=R(F,o),F.forEach(v),M.forEach(v),l=V(D),c=N(D,"DIV",{class:!0});var q=$(c);u=N(q,"DIV",{class:!0,style:!0});var B=$(u);B.forEach(v),q.forEach(v),f=V(D),d=N(D,"DIV",{class:!0});var G=$(d);m=N(G,"SPAN",{class:!0});var Y=$(m);g=R(Y,_),y=R(Y,"/8"),Y.forEach(v),b=V(G),A&&A.l(G),G.forEach(v),k=V(D),D.forEach(v),this.h()},h(){S(t,"class","grade-label svelte-1e5y2q"),S(u,"class",h="distribution-bar "+(n[24]==="needWork"&&n[36]>0?"warning":"")+" svelte-1e5y2q"),st(u,"width",(n[24]==="excellent"?n[10]:n[24]==="good"?n[11]:n[24]==="pass"?n[12]:n[24]==="needWork"?n[13]:n[24]==="notMeasured"?n[14]:0)+"%"),S(c,"class","bar-container svelte-1e5y2q"),S(m,"class","count"),S(d,"class","count-display svelte-1e5y2q"),S(e,"class","distribution-row svelte-1e5y2q"),st(e,"animation-delay",n[35]*.1+"s")},m(w,D){H(w,e,D),p(e,t),s&&ie(s,t,null),p(t,r),p(t,i),p(i,a),p(e,l),p(e,c),p(c,u),p(e,f),p(e,d),p(d,m),p(m,g),p(m,y),p(d,b),A&&A.m(d,null),p(e,k),I=!0},p(w,D){if(T!==(T=w[25].icon)){if(s){Ae();const M=s;W(M.$$.fragment,1,0,()=>{re(M,1)}),Ne()}T?(s=St(T,C(w)),oe(s.$$.fragment),O(s.$$.fragment,1),ie(s,t,r)):s=null}(!I||D[0]&16&&h!==(h="distribution-bar "+(w[24]==="needWork"&&w[36]>0?"warning":"")+" svelte-1e5y2q"))&&S(u,"class",h),(!I||D[0]&31744)&&st(u,"width",(w[24]==="excellent"?w[10]:w[24]==="good"?w[11]:w[24]==="pass"?w[12]:w[24]==="needWork"?w[13]:w[24]==="notMeasured"?w[14]:0)+"%"),(!I||D[0]&16)&&_!==(_=w[36]+"")&&ee(g,_),w[24]==="needWork"&&w[36]>0?A?D[0]&16&&O(A,1):(A=ql(),A.c(),O(A,1),A.m(d,null)):A&&(Ae(),W(A,1,1,()=>{A=null}),Ne())},i(w){I||(s&&O(s.$$.fragment,w),O(A),I=!0)},o(w){s&&W(s.$$.fragment,w),W(A),I=!1},d(w){w&&v(e),s&&re(s),A&&A.d()}}}function Ll(n){let e,t,s,r,i=n[4].notMeasured+"",o,a,l;return t=new Xs({props:{class:"w-5 h-5"}}),{c(){e=E("div"),oe(t.$$.fragment),s=x(),r=E("span"),o=P(i),a=P("音が測定できませんでした"),this.h()},l(c){e=N(c,"DIV",{class:!0});var u=$(e);de(t.$$.fragment,u),s=V(u),r=N(u,"SPAN",{});var h=$(r);o=R(h,i),a=R(h,"音が測定できませんでした"),h.forEach(v),u.forEach(v),this.h()},h(){S(e,"class","summary-item warning svelte-1e5y2q")},m(c,u){H(c,e,u),ie(t,e,null),p(e,s),p(e,r),p(r,o),p(r,a),l=!0},p(c,u){(!l||u[0]&16)&&i!==(i=c[4].notMeasured+"")&&ee(o,i)},i(c){l||(O(t.$$.fragment,c),l=!0)},o(c){W(t.$$.fragment,c),l=!1},d(c){c&&v(e),re(t)}}}function B1(n){let e,t,s,r,i="良い調子です！",o;return t=new $r({props:{class:"w-5 h-5"}}),{c(){e=E("div"),oe(t.$$.fragment),s=x(),r=E("span"),r.textContent=i,this.h()},l(a){e=N(a,"DIV",{class:!0});var l=$(e);de(t.$$.fragment,l),s=V(l),r=N(l,"SPAN",{"data-svelte-h":!0}),pe(r)!=="svelte-1415xx7"&&(r.textContent=i),l.forEach(v),this.h()},h(){S(e,"class","summary-item good svelte-1e5y2q")},m(a,l){H(a,e,l),ie(t,e,null),p(e,s),p(e,r),o=!0},p:Et,i(a){o||(O(t.$$.fragment,a),o=!0)},o(a){W(t.$$.fragment,a),o=!1},d(a){a&&v(e),re(t)}}}function H1(n){let e,t,s,r,i="素晴らしい！ほとんどの音が完璧です",o;return t=new Or({props:{class:"w-5 h-5"}}),{c(){e=E("div"),oe(t.$$.fragment),s=x(),r=E("span"),r.textContent=i,this.h()},l(a){e=N(a,"DIV",{class:!0});var l=$(e);de(t.$$.fragment,l),s=V(l),r=N(l,"SPAN",{"data-svelte-h":!0}),pe(r)!=="svelte-b4akqi"&&(r.textContent=i),l.forEach(v),this.h()},h(){S(e,"class","summary-item excellent svelte-1e5y2q")},m(a,l){H(a,e,l),ie(t,e,null),p(e,s),p(e,r),o=!0},p:Et,i(a){o||(O(t.$$.fragment,a),o=!0)},o(a){W(t.$$.fragment,a),o=!1},d(a){a&&v(e),re(t)}}}function j1(n){let e,t,s,r,i=n[4].needWork+"",o,a,l;return t=new Xs({props:{class:"w-5 h-5"}}),{c(){e=E("div"),oe(t.$$.fragment),s=x(),r=E("span"),o=P(i),a=P("音が要改善です"),this.h()},l(c){e=N(c,"DIV",{class:!0});var u=$(e);de(t.$$.fragment,u),s=V(u),r=N(u,"SPAN",{});var h=$(r);o=R(h,i),a=R(h,"音が要改善です"),h.forEach(v),u.forEach(v),this.h()},h(){S(e,"class","summary-item warning svelte-1e5y2q")},m(c,u){H(c,e,u),ie(t,e,null),p(e,s),p(e,r),p(r,o),p(r,a),l=!0},p(c,u){(!l||u[0]&16)&&i!==(i=c[4].needWork+"")&&ee(o,i)},i(c){l||(O(t.$$.fragment,c),l=!0)},o(c){W(t.$$.fragment,c),l=!1},d(c){c&&v(e),re(t)}}}function U1(n){let e,t,s,r,i=n[31].name+"",o,a,l=n[31].targetFreq+"",c,u,h,f,d,m=(n[31].detectedFreq||n[31].adjustedFrequency||n[31].detectedFrequency||"データなし")+"",_,g,y=n[31].diff>0?"+":"",b,k=n[31].diff+"",I,T,C=n[31].cents>0?"+":"",A,w=n[31].cents+"",D,M,F,q;var B=n[15][n[32]].icon;function G(U,L){return{props:{class:"w-4 h-4 "+U[15][U[32]].color}}}B&&(t=St(B,G(n)));let Y=n[33]&&Bl(n);return{c(){e=E("div"),t&&oe(t.$$.fragment),s=x(),r=E("span"),o=P(i),a=P("（"),c=P(l),u=P("Hz）"),h=x(),f=E("span"),d=P("あなた: "),_=P(m),g=P("Hz ("),b=P(y),I=P(k),T=P("Hz) "),A=P(C),D=P(w),M=P("¢"),F=x(),Y&&Y.c(),this.h()},l(U){e=N(U,"DIV",{class:!0});var L=$(e);t&&de(t.$$.fragment,L),s=V(L),r=N(L,"SPAN",{class:!0});var K=$(r);o=R(K,i),a=R(K,"（"),c=R(K,l),u=R(K,"Hz）"),K.forEach(v),h=V(L),f=N(L,"SPAN",{class:!0});var z=$(f);d=R(z,"あなた: "),_=R(z,m),g=R(z,"Hz ("),b=R(z,y),I=R(z,k),T=R(z,"Hz) "),A=R(z,C),D=R(z,w),M=R(z,"¢"),z.forEach(v),F=V(L),Y&&Y.l(L),L.forEach(v),this.h()},h(){S(r,"class","note-name-simple svelte-1e5y2q"),S(f,"class","detection-result svelte-1e5y2q"),S(e,"class","simple-info svelte-1e5y2q")},m(U,L){H(U,e,L),t&&ie(t,e,null),p(e,s),p(e,r),p(r,o),p(r,a),p(r,c),p(r,u),p(e,h),p(e,f),p(f,d),p(f,_),p(f,g),p(f,b),p(f,I),p(f,T),p(f,A),p(f,D),p(f,M),p(e,F),Y&&Y.m(e,null),q=!0},p(U,L){if(L[0]&1&&B!==(B=U[15][U[32]].icon)){if(t){Ae();const K=t;W(K.$$.fragment,1,0,()=>{re(K,1)}),Ne()}B?(t=St(B,G(U)),oe(t.$$.fragment),O(t.$$.fragment,1),ie(t,e,s)):t=null}else if(B){const K={};L[0]&1&&(K.class="w-4 h-4 "+U[15][U[32]].color),t.$set(K)}(!q||L[0]&1)&&i!==(i=U[31].name+"")&&ee(o,i),(!q||L[0]&1)&&l!==(l=U[31].targetFreq+"")&&ee(c,l),(!q||L[0]&1)&&m!==(m=(U[31].detectedFreq||U[31].adjustedFrequency||U[31].detectedFrequency||"データなし")+"")&&ee(_,m),(!q||L[0]&1)&&y!==(y=U[31].diff>0?"+":"")&&ee(b,y),(!q||L[0]&1)&&k!==(k=U[31].diff+"")&&ee(I,k),(!q||L[0]&1)&&C!==(C=U[31].cents>0?"+":"")&&ee(A,C),(!q||L[0]&1)&&w!==(w=U[31].cents+"")&&ee(D,w),U[33]?Y?Y.p(U,L):(Y=Bl(U),Y.c(),Y.m(e,null)):Y&&(Y.d(1),Y=null)},i(U){q||(t&&O(t.$$.fragment,U),q=!0)},o(U){t&&W(t.$$.fragment,U),q=!1},d(U){U&&v(e),t&&re(t),Y&&Y.d()}}}function z1(n){let e,t,s,r,i=n[31].name+"",o,a,l,c="測定できませんでした",u;var h=n[15][n[32]].icon;function f(d,m){return{props:{class:"w-4 h-4 "+d[15][d[32]].color}}}return h&&(t=St(h,f(n))),{c(){e=E("div"),t&&oe(t.$$.fragment),s=x(),r=E("span"),o=P(i),a=x(),l=E("span"),l.textContent=c,this.h()},l(d){e=N(d,"DIV",{class:!0});var m=$(e);t&&de(t.$$.fragment,m),s=V(m),r=N(m,"SPAN",{class:!0});var _=$(r);o=R(_,i),_.forEach(v),a=V(m),l=N(m,"SPAN",{class:!0,"data-svelte-h":!0}),pe(l)!=="svelte-12v239r"&&(l.textContent=c),m.forEach(v),this.h()},h(){S(r,"class","note-name-simple svelte-1e5y2q"),S(l,"class","detection-failed svelte-1e5y2q"),S(e,"class","simple-info svelte-1e5y2q")},m(d,m){H(d,e,m),t&&ie(t,e,null),p(e,s),p(e,r),p(r,o),p(e,a),p(e,l),u=!0},p(d,m){if(m[0]&1&&h!==(h=d[15][d[32]].icon)){if(t){Ae();const _=t;W(_.$$.fragment,1,0,()=>{re(_,1)}),Ne()}h?(t=St(h,f(d)),oe(t.$$.fragment),O(t.$$.fragment,1),ie(t,e,s)):t=null}else if(h){const _={};m[0]&1&&(_.class="w-4 h-4 "+d[15][d[32]].color),t.$set(_)}(!u||m[0]&1)&&i!==(i=d[31].name+"")&&ee(o,i)},i(d){u||(t&&O(t.$$.fragment,d),u=!0)},o(d){t&&W(t.$$.fragment,d),u=!1},d(d){d&&v(e),t&&re(t)}}}function Bl(n){let e,t=Math.abs(n[31].cents)>100?"重大":"注意",s;return{c(){e=E("span"),s=P(t),this.h()},l(r){e=N(r,"SPAN",{class:!0});var i=$(e);s=R(i,t),i.forEach(v),this.h()},h(){S(e,"class","outlier-badge-simple svelte-1e5y2q")},m(r,i){H(r,e,i),p(e,s)},p(r,i){i[0]&1&&t!==(t=Math.abs(r[31].cents)>100?"重大":"注意")&&ee(s,t)},d(r){r&&v(e)}}}function Hl(n){let e,t,s,r='<div class="center-marker svelte-1e5y2q"></div> <span class="center-label svelte-1e5y2q">正確</span>',i,o,a;return{c(){e=E("div"),t=E("div"),s=E("div"),s.innerHTML=r,i=x(),o=E("div"),this.h()},l(l){e=N(l,"DIV",{class:!0});var c=$(e);t=N(c,"DIV",{class:!0});var u=$(t);s=N(u,"DIV",{class:!0,"data-svelte-h":!0}),pe(s)!=="svelte-hvzah"&&(s.innerHTML=r),i=V(u),o=N(u,"DIV",{class:!0,style:!0});var h=$(o);h.forEach(v),u.forEach(v),c.forEach(v),this.h()},h(){S(s,"class","center-line-enhanced svelte-1e5y2q"),S(o,"class",a="accuracy-indicator "+n[32]+" svelte-1e5y2q"),st(o,"left",Math.max(0,Math.min(100,50+n[31].cents/100*50))+"%"),S(t,"class","bar-track svelte-1e5y2q"),S(e,"class","accuracy-bar svelte-1e5y2q")},m(l,c){H(l,e,c),p(e,t),p(t,s),p(t,i),p(t,o)},p(l,c){c[0]&1&&a!==(a="accuracy-indicator "+l[32]+" svelte-1e5y2q")&&S(o,"class",a),c[0]&1&&st(o,"left",Math.max(0,Math.min(100,50+l[31].cents/100*50))+"%")},d(l){l&&v(e)}}}function jl(n){let e,t,s,r,i,o,a,l,c,u;const h=[z1,U1],f=[];function d(_,g){return _[32]==="notMeasured"?0:1}s=d(n),r=f[s]=h[s](n);let m=n[32]!=="notMeasured"&&Hl(n);return{c(){e=E("div"),t=E("div"),r.c(),o=x(),m&&m.c(),a=x(),this.h()},l(_){e=N(_,"DIV",{class:!0});var g=$(e);t=N(g,"DIV",{class:!0});var y=$(t);r.l(y),y.forEach(v),o=V(g),m&&m.l(g),a=V(g),g.forEach(v),this.h()},h(){S(t,"class",i="simple-header "+n[32]+" svelte-1e5y2q"),S(e,"class",l="note-result "+n[32]+" svelte-1e5y2q")},m(_,g){H(_,e,g),p(e,t),f[s].m(t,null),p(e,o),m&&m.m(e,null),p(e,a),u=!0},p(_,g){let y=s;s=d(_),s===y?f[s].p(_,g):(Ae(),W(f[y],1,1,()=>{f[y]=null}),Ne(),r=f[s],r?r.p(_,g):(r=f[s]=h[s](_),r.c()),O(r,1),r.m(t,null)),(!u||g[0]&1&&i!==(i="simple-header "+_[32]+" svelte-1e5y2q"))&&S(t,"class",i),_[32]!=="notMeasured"?m?m.p(_,g):(m=Hl(_),m.c(),m.m(e,a)):m&&(m.d(1),m=null),(!u||g[0]&1&&l!==(l="note-result "+_[32]+" svelte-1e5y2q"))&&S(e,"class",l)},i(_){u||(O(r),_&&(c||Ds(()=>{c=Fs(e,Hr,{x:-20,duration:300,delay:300+n[35]*50}),c.start()})),u=!0)},o(_){W(r),u=!1},d(_){_&&v(e),f[s].d(),m&&m.d()}}}function Ul(n){let e,t,s,r,i,o,a,l;s=new su({props:{class:"w-5 h-5 text-red-500"}});let c=Ie(n[7]),u=[];for(let h=0;h<c.length;h+=1)u[h]=zl(Pl(n,c,h));return{c(){e=E("div"),t=E("h4"),oe(s.$$.fragment),r=P(`
        外れ値検出`),i=x(),o=E("div");for(let h=0;h<u.length;h+=1)u[h].c();this.h()},l(h){e=N(h,"DIV",{class:!0});var f=$(e);t=N(f,"H4",{class:!0});var d=$(t);de(s.$$.fragment,d),r=R(d,`
        外れ値検出`),d.forEach(v),i=V(f),o=N(f,"DIV",{class:!0});var m=$(o);for(let _=0;_<u.length;_+=1)u[_].l(m);m.forEach(v),f.forEach(v),this.h()},h(){S(t,"class","svelte-1e5y2q"),S(o,"class","outlier-list svelte-1e5y2q"),S(e,"class","outlier-section svelte-1e5y2q")},m(h,f){H(h,e,f),p(e,t),ie(s,t,null),p(t,r),p(e,i),p(e,o);for(let d=0;d<u.length;d+=1)u[d]&&u[d].m(o,null);l=!0},p(h,f){if(f[0]&128){c=Ie(h[7]);let d;for(d=0;d<c.length;d+=1){const m=Pl(h,c,d);u[d]?u[d].p(m,f):(u[d]=zl(m),u[d].c(),u[d].m(o,null))}for(;d<u.length;d+=1)u[d].d(1);u.length=c.length}},i(h){l||(O(s.$$.fragment,h),h&&(a||Ds(()=>{a=Fs(e,Hn,{delay:500}),a.start()})),l=!0)},o(h){W(s.$$.fragment,h),l=!1},d(h){h&&v(e),re(s),dt(u,h)}}}function zl(n){let e,t,s=n[28].name+"",r,i,o,a=n[28].cents>0?"+":"",l,c=n[28].cents+"",u,h,f,d,m=Math.abs(n[28].cents)>100?"重大":"注意",_,g,y;return{c(){e=E("div"),t=E("span"),r=P(s),i=x(),o=E("span"),l=P(a),u=P(c),h=P("¢"),f=x(),d=E("span"),_=P(m),y=x(),this.h()},l(b){e=N(b,"DIV",{class:!0});var k=$(e);t=N(k,"SPAN",{class:!0});var I=$(t);r=R(I,s),I.forEach(v),i=V(k),o=N(k,"SPAN",{class:!0});var T=$(o);l=R(T,a),u=R(T,c),h=R(T,"¢"),T.forEach(v),f=V(k),d=N(k,"SPAN",{class:!0});var C=$(d);_=R(C,m),C.forEach(v),y=V(k),k.forEach(v),this.h()},h(){S(t,"class","note-badge svelte-1e5y2q"),S(o,"class","cents-value svelte-1e5y2q"),S(d,"class",g="severity-badge "+(Math.abs(n[28].cents)>100?"critical":"warning")+" svelte-1e5y2q"),S(e,"class","outlier-item svelte-1e5y2q")},m(b,k){H(b,e,k),p(e,t),p(t,r),p(e,i),p(e,o),p(o,l),p(o,u),p(o,h),p(e,f),p(e,d),p(d,_),p(e,y)},p(b,k){k[0]&128&&s!==(s=b[28].name+"")&&ee(r,s),k[0]&128&&a!==(a=b[28].cents>0?"+":"")&&ee(l,a),k[0]&128&&c!==(c=b[28].cents+"")&&ee(u,c),k[0]&128&&m!==(m=Math.abs(b[28].cents)>100?"重大":"注意")&&ee(_,m),k[0]&128&&g!==(g="severity-badge "+(Math.abs(b[28].cents)>100?"critical":"warning")+" svelte-1e5y2q")&&S(d,"class",g)},d(b){b&&v(e)}}}function Gl(n){let e,t,s,r=n[9].join("、")+"",i,o,a;return t=new Oo({props:{class:"w-4 h-4 text-red-500"}}),{c(){e=E("p"),oe(t.$$.fragment),s=P(`
          重点練習: `),i=P(r),o=P("の精度向上"),this.h()},l(l){e=N(l,"P",{class:!0});var c=$(e);de(t.$$.fragment,c),s=R(c,`
          重点練習: `),i=R(c,r),o=R(c,"の精度向上"),c.forEach(v),this.h()},h(){S(e,"class","svelte-1e5y2q")},m(l,c){H(l,e,c),ie(t,e,null),p(e,s),p(e,i),p(e,o),a=!0},p(l,c){(!a||c[0]&512)&&r!==(r=l[9].join("、")+"")&&ee(i,r)},i(l){a||(O(t.$$.fragment,l),a=!0)},o(l){W(t.$$.fragment,l),a=!1},d(l){l&&v(e),re(t)}}}function G1(n){let e,t,s,r;return t=new tu({props:{class:"w-4 h-4 text-green-500"}}),{c(){e=E("p"),oe(t.$$.fragment),s=P(`
          良い調子です！継続的な練習で更なる向上を`),this.h()},l(i){e=N(i,"P",{class:!0});var o=$(e);de(t.$$.fragment,o),s=R(o,`
          良い調子です！継続的な練習で更なる向上を`),o.forEach(v),this.h()},h(){S(e,"class","svelte-1e5y2q")},m(i,o){H(i,e,o),ie(t,e,null),p(e,s),r=!0},i(i){r||(O(t.$$.fragment,i),r=!0)},o(i){W(t.$$.fragment,i),r=!1},d(i){i&&v(e),re(t)}}}function Z1(n){let e,t,s,r;return t=new Or({props:{class:"w-4 h-4 text-yellow-500"}}),{c(){e=E("p"),oe(t.$$.fragment),s=P(`
          素晴らしい精度です！この調子を維持しましょう`),this.h()},l(i){e=N(i,"P",{class:!0});var o=$(e);de(t.$$.fragment,o),s=R(o,`
          素晴らしい精度です！この調子を維持しましょう`),o.forEach(v),this.h()},h(){S(e,"class","svelte-1e5y2q")},m(i,o){H(i,e,o),ie(t,e,null),p(e,s),r=!0},i(i){r||(O(t.$$.fragment,i),r=!0)},o(i){W(t.$$.fragment,i),r=!1},d(i){i&&v(e),re(t)}}}function X1(n){let e,t,s,r;return t=new gf({props:{class:"w-4 h-4 text-orange-500"}}),{c(){e=E("p"),oe(t.$$.fragment),s=P(`
          基礎練習: 音程感覚の根本的な見直しが必要`),this.h()},l(i){e=N(i,"P",{class:!0});var o=$(e);de(t.$$.fragment,o),s=R(o,`
          基礎練習: 音程感覚の根本的な見直しが必要`),o.forEach(v),this.h()},h(){S(e,"class","svelte-1e5y2q")},m(i,o){H(i,e,o),ie(t,e,null),p(e,s),r=!0},i(i){r||(O(t.$$.fragment,i),r=!0)},o(i){W(t.$$.fragment,i),r=!1},d(i){i&&v(e),re(t)}}}function Zl(n){let e,t,s,r,i=n[25].name+"",o,a,l,c=n[25].range+"",u,h;var f=n[25].icon;function d(m,_){return{props:{class:"w-4 h-4 "+m[25].color}}}return f&&(t=St(f,d(n))),{c(){e=E("div"),t&&oe(t.$$.fragment),s=x(),r=E("strong"),o=P(i),a=P(":"),l=x(),u=P(c),this.h()},l(m){e=N(m,"DIV",{class:!0});var _=$(e);t&&de(t.$$.fragment,_),s=V(_),r=N(_,"STRONG",{});var g=$(r);o=R(g,i),a=R(g,":"),g.forEach(v),l=V(_),u=R(_,c),_.forEach(v),this.h()},h(){S(e,"class","criteria-item svelte-1e5y2q")},m(m,_){H(m,e,_),t&&ie(t,e,null),p(e,s),p(e,r),p(r,o),p(r,a),p(e,l),p(e,u),h=!0},p(m,_){if(f!==(f=m[25].icon)){if(t){Ae();const g=t;W(g.$$.fragment,1,0,()=>{re(g,1)}),Ne()}f?(t=St(f,d(m)),oe(t.$$.fragment),O(t.$$.fragment,1),ie(t,e,s)):t=null}},i(m){h||(t&&O(t.$$.fragment,m),h=!0)},o(m){t&&W(t.$$.fragment,m),h=!1},d(m){m&&v(e),t&&re(t)}}}function Y1(n){let e,t,s,r,i,o,a,l=n[15][n[8]].name+"",c,u,h,f,d,m,_,g,y,b="評価分布",k,I,T,C,A,w,D,M,F,q,B,G,Y,U,L,K,z,Q,te,ce,ve,Ce,ye,me,be,X,Se,fe,le,ue,De,Oe,se,ae,Me,we,Te='<p class="svelte-1e5y2q">¢（セント）: 音程の精度単位。100¢ = 半音1つ分</p> <p class="svelte-1e5y2q">外れ値ペナルティ: ±50セント超の大きな外れがあると評価が下がります</p>',$e,je;var Je=n[15][n[8]].icon;function _t(j,ne){return{props:{size:"120",class:"grade-icon-simple "+j[15][j[8]].color}}}Je&&(i=St(Je,_t(n)));function Ot(j,ne){return j[2]!==null&&j[3]?L1:W1}let Rt=Ot(n),ut=Rt(n),Ke=n[5]>0&&Fl(n),qt=Ie(Object.entries(n[15])),Re=[];for(let j=0;j<qt.length;j+=1)Re[j]=Wl(xl(n,qt,j));const Xt=j=>W(Re[j],1,1,()=>{Re[j]=null});let Ze=n[4].notMeasured>0&&Ll(n);const Yt=[j1,H1,B1],Ct=[];function Qt(j,ne){return j[4].needWork>0?0:j[4].excellent>=6?1:2}w=Qt(n),D=Ct[w]=Yt[w](n),G=new Rf({props:{class:"w-5 h-5"}});let Wt=Ie(n[0]),We=[];for(let j=0;j<Wt.length;j+=1)We[j]=jl(Vl(n,Wt,j));const Ss=j=>W(We[j],1,1,()=>{We[j]=null});let Xe=n[7].length>0&&Ul(n);te=new eu({props:{class:"w-5 h-5 text-yellow-500"}});let et=n[9].length>0&&Gl(n);const $s=[X1,Z1,G1],Tt=[];function Dt(j,ne){return j[6]>200?0:j[6]<20?1:2}me=Dt(n),be=Tt[me]=$s[me](n),ue=new Kc({props:{class:"w-4 h-4"}}),Oe=new Wh({props:{class:"w-4 h-4 chevron-icon"}});let Z=Ie(Object.entries(n[15])),J=[];for(let j=0;j<Z.length;j+=1)J[j]=Zl(Rl(n,Z,j));const ge=j=>W(J[j],1,1,()=>{J[j]=null});return{c(){e=E("div"),t=E("div"),s=E("div"),r=E("div"),i&&oe(i.$$.fragment),o=x(),a=E("h2"),c=P(l),h=x(),f=E("p"),ut.c(),d=x(),Ke&&Ke.c(),_=x(),g=E("div"),y=E("h3"),y.textContent=b,k=x(),I=E("div");for(let j=0;j<Re.length;j+=1)Re[j].c();T=x(),C=E("div"),Ze&&Ze.c(),A=x(),D.c(),F=x(),q=E("div"),B=E("h3"),oe(G.$$.fragment),Y=P(`
      各音程の詳細結果`),U=x();for(let j=0;j<We.length;j+=1)We[j].c();L=x(),Xe&&Xe.c(),K=x(),z=E("div"),Q=E("h4"),oe(te.$$.fragment),ce=P(`
      改善アドバイス`),ve=x(),Ce=E("div"),et&&et.c(),ye=x(),be.c(),Se=x(),fe=E("details"),le=E("summary"),oe(ue.$$.fragment),De=P(`
      判定結果の見方
      `),oe(Oe.$$.fragment),se=x(),ae=E("div");for(let j=0;j<J.length;j+=1)J[j].c();Me=x(),we=E("div"),we.innerHTML=Te,this.h()},l(j){e=N(j,"DIV",{class:!0});var ne=$(e);t=N(ne,"DIV",{class:!0});var ke=$(t);s=N(ke,"DIV",{class:!0});var Qe=$(s);r=N(Qe,"DIV",{class:!0});var _e=$(r);i&&de(i.$$.fragment,_e),_e.forEach(v),o=V(Qe),a=N(Qe,"H2",{class:!0});var Ve=$(a);c=R(Ve,l),Ve.forEach(v),h=V(Qe),f=N(Qe,"P",{class:!0});var ns=$(f);ut.l(ns),ns.forEach(v),d=V(Qe),Ke&&Ke.l(Qe),Qe.forEach(v),ke.forEach(v),_=V(ne),g=N(ne,"DIV",{class:!0});var Ye=$(g);y=N(Ye,"H3",{class:!0,"data-svelte-h":!0}),pe(y)!=="svelte-1m1ccni"&&(y.textContent=b),k=V(Ye),I=N(Ye,"DIV",{class:!0});var kt=$(I);for(let tt=0;tt<Re.length;tt+=1)Re[tt].l(kt);kt.forEach(v),T=V(Ye),C=N(Ye,"DIV",{class:!0});var At=$(C);Ze&&Ze.l(At),A=V(At),D.l(At),At.forEach(v),Ye.forEach(v),F=V(ne),q=N(ne,"DIV",{class:!0});var Pt=$(q);B=N(Pt,"H3",{class:!0});var ds=$(B);de(G.$$.fragment,ds),Y=R(ds,`
      各音程の詳細結果`),ds.forEach(v),U=V(Pt);for(let tt=0;tt<We.length;tt+=1)We[tt].l(Pt);Pt.forEach(v),L=V(ne),Xe&&Xe.l(ne),K=V(ne),z=N(ne,"DIV",{class:!0});var as=$(z);Q=N(as,"H4",{class:!0});var Jt=$(Q);de(te.$$.fragment,Jt),ce=R(Jt,`
      改善アドバイス`),Jt.forEach(v),ve=V(as),Ce=N(as,"DIV",{class:!0});var Lt=$(Ce);et&&et.l(Lt),ye=V(Lt),be.l(Lt),Lt.forEach(v),as.forEach(v),Se=V(ne),fe=N(ne,"DETAILS",{class:!0});var Kt=$(fe);le=N(Kt,"SUMMARY",{class:!0});var Bs=$(le);de(ue.$$.fragment,Bs),De=R(Bs,`
      判定結果の見方
      `),de(Oe.$$.fragment,Bs),Bs.forEach(v),se=V(Kt),ae=N(Kt,"DIV",{class:!0});var Os=$(ae);for(let tt=0;tt<J.length;tt+=1)J[tt].l(Os);Me=V(Os),we=N(Os,"DIV",{class:!0,"data-svelte-h":!0}),pe(we)!=="svelte-li9kas"&&(we.innerHTML=Te),Os.forEach(v),Kt.forEach(v),ne.forEach(v),this.h()},h(){S(r,"class","simple-grade-icon svelte-1e5y2q"),S(a,"class",u="grade-title "+n[15][n[8]].color+" svelte-1e5y2q"),S(f,"class","grade-subtitle svelte-1e5y2q"),S(s,"class","grade-display-enhanced svelte-1e5y2q"),S(t,"class","overall-score-section svelte-1e5y2q"),S(y,"class","section-title svelte-1e5y2q"),S(I,"class","distribution-bars svelte-1e5y2q"),S(C,"class","distribution-summary svelte-1e5y2q"),S(g,"class","rating-distribution svelte-1e5y2q"),S(B,"class","section-title svelte-1e5y2q"),S(q,"class","note-details svelte-1e5y2q"),S(Q,"class","svelte-1e5y2q"),S(Ce,"class","advice-content svelte-1e5y2q"),S(z,"class","advice-section svelte-1e5y2q"),S(le,"class","svelte-1e5y2q"),S(we,"class","info-note svelte-1e5y2q"),S(ae,"class","criteria-content svelte-1e5y2q"),S(fe,"class","criteria-section svelte-1e5y2q"),S(e,"class",$e="random-mode-score-result "+n[1]+" svelte-1e5y2q")},m(j,ne){H(j,e,ne),p(e,t),p(t,s),p(s,r),i&&ie(i,r,null),p(s,o),p(s,a),p(a,c),p(s,h),p(s,f),ut.m(f,null),p(s,d),Ke&&Ke.m(s,null),p(e,_),p(e,g),p(g,y),p(g,k),p(g,I);for(let ke=0;ke<Re.length;ke+=1)Re[ke]&&Re[ke].m(I,null);p(g,T),p(g,C),Ze&&Ze.m(C,null),p(C,A),Ct[w].m(C,null),p(e,F),p(e,q),p(q,B),ie(G,B,null),p(B,Y),p(q,U);for(let ke=0;ke<We.length;ke+=1)We[ke]&&We[ke].m(q,null);p(e,L),Xe&&Xe.m(e,null),p(e,K),p(e,z),p(z,Q),ie(te,Q,null),p(Q,ce),p(z,ve),p(z,Ce),et&&et.m(Ce,null),p(Ce,ye),Tt[me].m(Ce,null),p(e,Se),p(e,fe),p(fe,le),ie(ue,le,null),p(le,De),ie(Oe,le,null),p(fe,se),p(fe,ae);for(let ke=0;ke<J.length;ke+=1)J[ke]&&J[ke].m(ae,null);p(ae,Me),p(ae,we),je=!0},p(j,ne){if(ne[0]&256&&Je!==(Je=j[15][j[8]].icon)){if(i){Ae();const _e=i;W(_e.$$.fragment,1,0,()=>{re(_e,1)}),Ne()}Je?(i=St(Je,_t(j)),oe(i.$$.fragment),O(i.$$.fragment,1),ie(i,r,null)):i=null}else if(Je){const _e={};ne[0]&256&&(_e.class="grade-icon-simple "+j[15][j[8]].color),i.$set(_e)}if((!je||ne[0]&256)&&l!==(l=j[15][j[8]].name+"")&&ee(c,l),(!je||ne[0]&256&&u!==(u="grade-title "+j[15][j[8]].color+" svelte-1e5y2q"))&&S(a,"class",u),Rt===(Rt=Ot(j))&&ut?ut.p(j,ne):(ut.d(1),ut=Rt(j),ut&&(ut.c(),ut.m(f,null))),j[5]>0?Ke?(Ke.p(j,ne),ne[0]&32&&O(Ke,1)):(Ke=Fl(j),Ke.c(),O(Ke,1),Ke.m(s,null)):Ke&&(Ae(),W(Ke,1,1,()=>{Ke=null}),Ne()),ne[0]&64528){qt=Ie(Object.entries(j[15]));let _e;for(_e=0;_e<qt.length;_e+=1){const Ve=xl(j,qt,_e);Re[_e]?(Re[_e].p(Ve,ne),O(Re[_e],1)):(Re[_e]=Wl(Ve),Re[_e].c(),O(Re[_e],1),Re[_e].m(I,null))}for(Ae(),_e=qt.length;_e<Re.length;_e+=1)Xt(_e);Ne()}j[4].notMeasured>0?Ze?(Ze.p(j,ne),ne[0]&16&&O(Ze,1)):(Ze=Ll(j),Ze.c(),O(Ze,1),Ze.m(C,A)):Ze&&(Ae(),W(Ze,1,1,()=>{Ze=null}),Ne());let ke=w;if(w=Qt(j),w===ke?Ct[w].p(j,ne):(Ae(),W(Ct[ke],1,1,()=>{Ct[ke]=null}),Ne(),D=Ct[w],D?D.p(j,ne):(D=Ct[w]=Yt[w](j),D.c()),O(D,1),D.m(C,null)),ne[0]&32769){Wt=Ie(j[0]);let _e;for(_e=0;_e<Wt.length;_e+=1){const Ve=Vl(j,Wt,_e);We[_e]?(We[_e].p(Ve,ne),O(We[_e],1)):(We[_e]=jl(Ve),We[_e].c(),O(We[_e],1),We[_e].m(q,null))}for(Ae(),_e=Wt.length;_e<We.length;_e+=1)Ss(_e);Ne()}j[7].length>0?Xe?(Xe.p(j,ne),ne[0]&128&&O(Xe,1)):(Xe=Ul(j),Xe.c(),O(Xe,1),Xe.m(e,K)):Xe&&(Ae(),W(Xe,1,1,()=>{Xe=null}),Ne()),j[9].length>0?et?(et.p(j,ne),ne[0]&512&&O(et,1)):(et=Gl(j),et.c(),O(et,1),et.m(Ce,ye)):et&&(Ae(),W(et,1,1,()=>{et=null}),Ne());let Qe=me;if(me=Dt(j),me!==Qe&&(Ae(),W(Tt[Qe],1,1,()=>{Tt[Qe]=null}),Ne(),be=Tt[me],be||(be=Tt[me]=$s[me](j),be.c()),O(be,1),be.m(Ce,null)),ne[0]&32768){Z=Ie(Object.entries(j[15]));let _e;for(_e=0;_e<Z.length;_e+=1){const Ve=Rl(j,Z,_e);J[_e]?(J[_e].p(Ve,ne),O(J[_e],1)):(J[_e]=Zl(Ve),J[_e].c(),O(J[_e],1),J[_e].m(ae,Me))}for(Ae(),_e=Z.length;_e<J.length;_e+=1)ge(_e);Ne()}(!je||ne[0]&2&&$e!==($e="random-mode-score-result "+j[1]+" svelte-1e5y2q"))&&S(e,"class",$e)},i(j){if(!je){i&&O(i.$$.fragment,j),O(Ke),j&&(m||Ds(()=>{m=Fs(s,Hr,{y:-20,duration:500}),m.start()}));for(let ne=0;ne<qt.length;ne+=1)O(Re[ne]);O(Ze),O(D),j&&(M||Ds(()=>{M=Fs(g,Hr,{y:20,duration:500,delay:200}),M.start()})),O(G.$$.fragment,j);for(let ne=0;ne<Wt.length;ne+=1)O(We[ne]);O(Xe),O(te.$$.fragment,j),O(et),O(be),j&&(X||Ds(()=>{X=Fs(z,Hn,{delay:600}),X.start()})),O(ue.$$.fragment,j),O(Oe.$$.fragment,j);for(let ne=0;ne<Z.length;ne+=1)O(J[ne]);je=!0}},o(j){i&&W(i.$$.fragment,j),W(Ke),Re=Re.filter(Boolean);for(let ne=0;ne<Re.length;ne+=1)W(Re[ne]);W(Ze),W(D),W(G.$$.fragment,j),We=We.filter(Boolean);for(let ne=0;ne<We.length;ne+=1)W(We[ne]);W(Xe),W(te.$$.fragment,j),W(et),W(be),W(ue.$$.fragment,j),W(Oe.$$.fragment,j),J=J.filter(Boolean);for(let ne=0;ne<J.length;ne+=1)W(J[ne]);je=!1},d(j){j&&v(e),i&&re(i),ut.d(),Ke&&Ke.d(),dt(Re,j),Ze&&Ze.d(),Ct[w].d(),re(G),dt(We,j),Xe&&Xe.d(),re(te),et&&et.d(),Tt[me].d(),re(ue),re(Oe),dt(J,j)}}}function Ii(n){if(n==null||isNaN(n))return"notMeasured";const e=Math.abs(n);return e<=15?"excellent":e<=25?"good":e<=40?"pass":"needWork"}function Q1(n,e,t){let s,r,i,o,a,l,c,u,h,f,d,m,{noteResults:_=[]}=e,{className:g=""}=e,{sessionIndex:y=null}=e,{baseNote:b=null}=e;const k={excellent:{name:"優秀",icon:Or,range:"±15¢以内",color:"text-yellow-500"},good:{name:"良好",icon:$r,range:"±25¢以内",color:"text-green-500"},pass:{name:"合格",icon:Ro,range:"±40¢以内",color:"text-blue-500"},needWork:{name:"要練習",icon:Jc,range:"±41¢以上",color:"text-red-500"},notMeasured:{name:"測定不可",icon:Xs,range:"音声未検出",color:"text-gray-500"}},I=$n(0,{duration:1e3,easing:an}),T=$n(0,{duration:800,easing:an,delay:0});Ut(n,T,M=>t(10,u=M));const C=$n(0,{duration:800,easing:an,delay:100});Ut(n,C,M=>t(11,h=M));const A=$n(0,{duration:800,easing:an,delay:200});Ut(n,A,M=>t(12,f=M));const w=$n(0,{duration:800,easing:an,delay:300});Ut(n,w,M=>t(13,d=M));const D=$n(0,{duration:800,easing:an,delay:400});return Ut(n,D,M=>t(14,m=M)),n.$$set=M=>{"noteResults"in M&&t(0,_=M.noteResults),"className"in M&&t(1,g=M.className),"sessionIndex"in M&&t(2,y=M.sessionIndex),"baseNote"in M&&t(3,b=M.baseNote)},n.$$.update=()=>{if(n.$$.dirty[0]&1&&_.length>0&&(console.log("🔍 Phase1: データ構造確認",_[0]),console.log("🔍 Phase1: 利用可能プロパティ",Object.keys(_[0])),_.forEach((M,F)=>{console.log(`🔍 Phase1: Note ${F}:`,{name:M.name,detectedFreq:M.detectedFreq,adjustedFrequency:M.adjustedFrequency,detectedFrequency:M.detectedFrequency})})),n.$$.dirty[0]&1&&t(4,s=_.reduce((M,F)=>{const q=Ii(F.cents);return M[q]=(M[q]||0)+1,q!=="notMeasured"&&(M.totalError+=Math.abs(F.cents),M.measuredCount+=1),M},{excellent:0,good:0,pass:0,needWork:0,notMeasured:0,totalError:0,measuredCount:0})),n.$$.dirty[0]&16&&t(6,r=s.measuredCount>0?Math.round(s.totalError/s.measuredCount):0),n.$$.dirty[0]&16&&t(21,i=s.excellent+s.good+s.pass),n.$$.dirty[0]&1&&t(7,o=_.filter(M=>Ii(M.cents)!=="notMeasured"&&Math.abs(M.cents)>50)),n.$$.dirty[0]&1&&t(9,a=_.filter(M=>Ii(M.cents)==="needWork").map(M=>M.name)),n.$$.dirty[0]&2097360&&t(8,l=s.notMeasured>3||s.needWork>2||s.needWork>0&&o.length>0||s.measuredCount===0?"needWork":r<=20&&s.excellent>=6?"excellent":r<=30&&i>=7?"good":i>=5?"pass":"needWork"),n.$$.dirty[0]&128&&t(5,c=o.reduce((M,F)=>{const q=Math.abs(F.cents)>100?16:8;return M+q},0)),n.$$.dirty[0]&113&&_.length>0){const M=Math.max(0,100-Math.round(r/10));I.set(M-c),setTimeout(()=>{T.set(s.excellent/8*100),C.set(s.good/8*100),A.set(s.pass/8*100),w.set(s.needWork/8*100),D.set(s.notMeasured/8*100)},300)}},[_,g,y,b,s,c,r,o,l,a,u,h,f,d,m,k,T,C,A,w,D,i]}class J1 extends Be{constructor(e){super(),He(this,e,Q1,Y1,Le,{noteResults:0,className:1,sessionIndex:2,baseNote:3},null,[-1,-1])}}function Xl(n,e,t){const s=n.slice();return s[43]=e[t][0],s[44]=e[t][1],s}function Yl(n,e,t){const s=n.slice();return s[47]=e[t],s}function Ql(n,e,t){const s=n.slice();return s[52]=e[t],s[50]=t,s}function Jl(n,e,t){const s=n.slice();return s[51]=e[t],s[50]=t,s}function Kl(n,e,t){const s=n.slice();return s[52]=e[t],s[50]=t,s}function ec(n,e,t){const s=n.slice();return s[51]=e[t],s[50]=t,s}function tc(n,e,t){const s=n.slice();return s[52]=e[t],s[50]=t,s}function sc(n,e,t){const s=n.slice();return s[51]=e[t],s[50]=t,s}function nc(n){let e,t,s,r,i,o=n[16].name+"",a,l,c,u,h,f=n[16].description+"",d,m,_,g=n[6]&&Object.keys(n[6]).length>0,y,b,k,I,T,C,A,w="評価の見方",D,M,F='<div class="grade-table svelte-ililvx"><div class="grade-row svelte-ililvx"><span class="grade-label svelte-ililvx">S級マスター</span> <span class="grade-condition svelte-ililvx">優秀90%以上 + 良好以上95%以上</span></div> <div class="grade-row svelte-ililvx"><span class="grade-label svelte-ililvx">A級エキスパート</span> <span class="grade-condition svelte-ililvx">優秀70%以上 + 良好以上85%以上</span></div> <div class="grade-row svelte-ililvx"><span class="grade-label svelte-ililvx">B級プロフィシエント</span> <span class="grade-condition svelte-ililvx">優秀50%以上 + 良好以上75%以上</span></div> <div class="grade-row svelte-ililvx"><span class="grade-label svelte-ililvx">C級アドバンス</span> <span class="grade-condition svelte-ililvx">良好以上65%以上</span></div> <div class="grade-row svelte-ililvx"><span class="grade-label svelte-ililvx">D級ビギナー</span> <span class="grade-condition svelte-ililvx">良好以上50%以上</span></div> <div class="grade-row svelte-ililvx"><span class="grade-label svelte-ililvx">E級スターター</span> <span class="grade-condition svelte-ililvx">良好以上50%未満</span></div></div>',q,B;var G=n[16].icon;function Y(L,K){return{props:{size:"120",class:"grade-icon "+L[16].color,style:"transform: scale("+L[19]+")"}}}G&&(s=St(G,Y(n)));let U=g&&rc(n);return T=new Qc({props:{size:"16",class:"chevron-icon"}}),{c(){e=E("div"),t=E("div"),s&&oe(s.$$.fragment),r=x(),i=E("h2"),a=P(o),u=x(),h=E("p"),d=P(f),_=x(),U&&U.c(),y=x(),b=E("div"),k=E("details"),I=E("summary"),oe(T.$$.fragment),C=x(),A=E("span"),A.textContent=w,D=x(),M=E("div"),M.innerHTML=F,this.h()},l(L){e=N(L,"DIV",{class:!0,style:!0});var K=$(e);t=N(K,"DIV",{class:!0});var z=$(t);s&&de(s.$$.fragment,z),z.forEach(v),r=V(K),i=N(K,"H2",{class:!0});var Q=$(i);a=R(Q,o),Q.forEach(v),u=V(K),h=N(K,"P",{class:!0});var te=$(h);d=R(te,f),te.forEach(v),_=V(K),U&&U.l(K),y=V(K),b=N(K,"DIV",{class:!0});var ce=$(b);k=N(ce,"DETAILS",{class:!0});var ve=$(k);I=N(ve,"SUMMARY",{class:!0});var Ce=$(I);de(T.$$.fragment,Ce),C=V(Ce),A=N(Ce,"SPAN",{"data-svelte-h":!0}),pe(A)!=="svelte-1etrem6"&&(A.textContent=w),Ce.forEach(v),D=V(ve),M=N(ve,"DIV",{class:!0,"data-svelte-h":!0}),pe(M)!=="svelte-5ampu9"&&(M.innerHTML=F),ve.forEach(v),ce.forEach(v),K.forEach(v),this.h()},h(){S(t,"class","grade-icon-wrapper svelte-ililvx"),S(i,"class",l="grade-name "+n[16].color+" svelte-ililvx"),S(h,"class","grade-description svelte-ililvx"),S(I,"class","grade-summary svelte-ililvx"),S(M,"class","grade-explanation-content svelte-ililvx"),S(k,"class","grade-details svelte-ililvx"),S(b,"class","grade-explanation svelte-ililvx"),S(e,"class","grade-display svelte-ililvx"),st(e,"background-color",n[16].bgColor),st(e,"border-color",n[16].borderColor),st(e,"opacity",n[18])},m(L,K){H(L,e,K),p(e,t),s&&ie(s,t,null),p(e,r),p(e,i),p(i,a),p(e,u),p(e,h),p(h,d),p(e,_),U&&U.m(e,null),p(e,y),p(e,b),p(b,k),p(k,I),ie(T,I,null),p(I,C),p(I,A),p(k,D),p(k,M),B=!0},p(L,K){if(K[0]&65536&&G!==(G=L[16].icon)){if(s){Ae();const z=s;W(z.$$.fragment,1,0,()=>{re(z,1)}),Ne()}G?(s=St(G,Y(L)),oe(s.$$.fragment),O(s.$$.fragment,1),ie(s,t,null)):s=null}else if(G){const z={};K[0]&65536&&(z.class="grade-icon "+L[16].color),K[0]&524288&&(z.style="transform: scale("+L[19]+")"),s.$set(z)}(!B||K[0]&65536)&&o!==(o=L[16].name+"")&&ee(a,o),(!B||K[0]&65536&&l!==(l="grade-name "+L[16].color+" svelte-ililvx"))&&S(i,"class",l),(!B||K[0]&65536)&&f!==(f=L[16].description+"")&&ee(d,f),K[0]&64&&(g=L[6]&&Object.keys(L[6]).length>0),g?U?(U.p(L,K),K[0]&64&&O(U,1)):(U=rc(L),U.c(),O(U,1),U.m(e,y)):U&&(Ae(),W(U,1,1,()=>{U=null}),Ne()),(!B||K[0]&65536)&&st(e,"background-color",L[16].bgColor),(!B||K[0]&65536)&&st(e,"border-color",L[16].borderColor),(!B||K[0]&262144)&&st(e,"opacity",L[18])},i(L){B||(s&&O(s.$$.fragment,L),L&&(c||Ds(()=>{c=Fs(i,Hn,{delay:400}),c.start()})),L&&(m||Ds(()=>{m=Fs(h,Hn,{delay:600}),m.start()})),O(U),O(T.$$.fragment,L),L&&(q||Ds(()=>{q=Fs(b,Hn,{delay:1e3}),q.start()})),B=!0)},o(L){s&&W(s.$$.fragment,L),W(U),W(T.$$.fragment,L),B=!1},d(L){L&&v(e),s&&re(s),U&&U.d(),re(T)}}}function rc(n){let e,t,s,r;return t=new T1({props:{feedback:n[6],className:"mt-6 completion-feedback-display"}}),{c(){e=E("div"),oe(t.$$.fragment),this.h()},l(i){e=N(i,"DIV",{class:!0});var o=$(e);de(t.$$.fragment,o),o.forEach(v),this.h()},h(){S(e,"class","completion-feedback svelte-ililvx")},m(i,o){H(i,e,o),ie(t,e,null),r=!0},p(i,o){const a={};o[0]&64&&(a.feedback=i[6]),t.$set(a)},i(i){r||(O(t.$$.fragment,i),i&&(s||Ds(()=>{s=Fs(e,Hn,{delay:800}),s.start()})),r=!0)},o(i){W(t.$$.fragment,i),r=!1},d(i){i&&v(e),re(t)}}}function ic(n){let e,t,s,r="🎵",i,o,a,l,c,u=n[1].sessionHistory.length+"",h,f,d=n[25][n[1].mode||"random"].maxSessions+"",m,_,g;return{c(){e=E("div"),t=E("div"),s=E("div"),s.textContent=r,i=x(),o=E("div"),a=P(n[17]),l=x(),c=E("div"),h=P(u),f=P("/"),m=P(d),_=P(" セッション"),this.h()},l(y){e=N(y,"DIV",{class:!0});var b=$(e);t=N(b,"DIV",{class:!0});var k=$(t);s=N(k,"DIV",{class:!0,"data-svelte-h":!0}),pe(s)!=="svelte-f85u65"&&(s.textContent=r),i=V(k),o=N(k,"DIV",{class:!0});var I=$(o);a=R(I,n[17]),I.forEach(v),l=V(k),c=N(k,"DIV",{class:!0});var T=$(c);h=R(T,u),f=R(T,"/"),m=R(T,d),_=R(T," セッション"),T.forEach(v),k.forEach(v),b.forEach(v),this.h()},h(){S(s,"class","progress-icon svelte-ililvx"),S(o,"class","progress-text svelte-ililvx"),S(c,"class","progress-counter svelte-ililvx"),S(t,"class","progress-message svelte-ililvx"),S(e,"class","progress-message-section svelte-ililvx")},m(y,b){H(y,e,b),p(e,t),p(t,s),p(t,i),p(t,o),p(o,a),p(t,l),p(t,c),p(c,h),p(c,f),p(c,m),p(c,_)},p(y,b){b[0]&131072&&ee(a,y[17]),b[0]&2&&u!==(u=y[1].sessionHistory.length+"")&&ee(h,u),b[0]&2&&d!==(d=y[25][y[1].mode||"random"].maxSessions+"")&&ee(m,d)},i(y){y&&(g||Ds(()=>{g=Fs(e,Hr,{y:20,duration:500,delay:700}),g.start()}))},o:Et,d(y){y&&v(e)}}}function K1(n){let e,t,s=n[1].sessionHistory&&n[1].sessionHistory.length>0&&oc(n);return{c(){e=E("div"),s&&s.c(),this.h()},l(r){e=N(r,"DIV",{class:!0});var i=$(e);s&&s.l(i),i.forEach(v),this.h()},h(){S(e,"class","summary-section svelte-ililvx")},m(r,i){H(r,e,i),s&&s.m(e,null),t=!0},p(r,i){r[1].sessionHistory&&r[1].sessionHistory.length>0?s?(s.p(r,i),i[0]&2&&O(s,1)):(s=oc(r),s.c(),O(s,1),s.m(e,null)):s&&(Ae(),W(s,1,1,()=>{s=null}),Ne())},i(r){t||(O(s),t=!0)},o(r){W(s),t=!1},d(r){r&&v(e),s&&s.d()}}}function e0(n){let e,t,s=n[1].sessionHistory&&n[1].sessionHistory.length>0&&cc(n);return{c(){e=E("div"),s&&s.c(),this.h()},l(r){e=N(r,"DIV",{class:!0});var i=$(e);s&&s.l(i),i.forEach(v),this.h()},h(){S(e,"class","summary-section svelte-ililvx")},m(r,i){H(r,e,i),s&&s.m(e,null),t=!0},p(r,i){r[1].sessionHistory&&r[1].sessionHistory.length>0?s?(s.p(r,i),i[0]&2&&O(s,1)):(s=cc(r),s.c(),O(s,1),s.m(e,null)):s&&(Ae(),W(s,1,1,()=>{s=null}),Ne())},i(r){t||(O(s),t=!0)},o(r){W(s),t=!1},d(r){r&&v(e),s&&s.d()}}}function t0(n){let e,t,s=n[1].sessionHistory&&n[1].sessionHistory.length>0&&fc(n);return{c(){e=E("div"),s&&s.c(),this.h()},l(r){e=N(r,"DIV",{class:!0});var i=$(e);s&&s.l(i),i.forEach(v),this.h()},h(){S(e,"class","summary-section svelte-ililvx")},m(r,i){H(r,e,i),s&&s.m(e,null),t=!0},p(r,i){r[1].sessionHistory&&r[1].sessionHistory.length>0?s?(s.p(r,i),i[0]&2&&O(s,1)):(s=fc(r),s.c(),O(s,1),s.m(e,null)):s&&(Ae(),W(s,1,1,()=>{s=null}),Ne())},i(r){t||(O(s),t=!0)},o(r){W(s),t=!1},d(r){r&&v(e),s&&s.d()}}}function oc(n){let e,t,s,r=n[1].sessionHistory.length+"",i,o,a,l,c,u,h,f,d,m=Ie(n[1].sessionHistory),_=[];for(let k=0;k<m.length;k+=1)_[k]=ac(Jl(n,m,k));const g=k=>W(_[k],1,1,()=>{_[k]=null});let y=Ie(Array(12-n[1].sessionHistory.length)),b=[];for(let k=0;k<y.length;k+=1)b[k]=lc(Ql(n,y,k));return f=new va({props:{currentIndex:n[8],sessionHistory:n[1].sessionHistory,className:"session-detail-carousel",$$slots:{default:[s0,({index:k,session:I})=>({50:k,51:I}),({index:k,session:I})=>[0,(k?524288:0)|(I?1048576:0)]]},$$scope:{ctx:n}}}),f.$on("sessionChange",n[32]),{c(){e=E("div"),t=E("div"),s=P("🎹 セッション履歴 ("),i=P(r),o=P("/12)"),a=x(),l=E("div");for(let k=0;k<_.length;k+=1)_[k].c();c=x();for(let k=0;k<b.length;k+=1)b[k].c();u=x(),h=E("div"),oe(f.$$.fragment),this.h()},l(k){e=N(k,"DIV",{class:!0});var I=$(e);t=N(I,"DIV",{class:!0});var T=$(t);s=R(T,"🎹 セッション履歴 ("),i=R(T,r),o=R(T,"/12)"),T.forEach(v),a=V(I),l=N(I,"DIV",{class:!0});var C=$(l);for(let w=0;w<_.length;w+=1)_[w].l(C);c=V(C);for(let w=0;w<b.length;w+=1)b[w].l(C);C.forEach(v),I.forEach(v),u=V(k),h=N(k,"DIV",{class:!0});var A=$(h);de(f.$$.fragment,A),A.forEach(v),this.h()},h(){S(t,"class","session-title svelte-ililvx"),S(l,"class","session-bars compact chromatic-mode svelte-ililvx"),S(e,"class","session-history-section compact svelte-ililvx"),S(h,"class","carousel-wrapper svelte-ililvx")},m(k,I){H(k,e,I),p(e,t),p(t,s),p(t,i),p(t,o),p(e,a),p(e,l);for(let T=0;T<_.length;T+=1)_[T]&&_[T].m(l,null);p(l,c);for(let T=0;T<b.length;T+=1)b[T]&&b[T].m(l,null);H(k,u,I),H(k,h,I),ie(f,h,null),d=!0},p(k,I){if((!d||I[0]&2)&&r!==(r=k[1].sessionHistory.length+"")&&ee(i,r),I[0]&1049346){m=Ie(k[1].sessionHistory);let C;for(C=0;C<m.length;C+=1){const A=Jl(k,m,C);_[C]?(_[C].p(A,I),O(_[C],1)):(_[C]=ac(A),_[C].c(),O(_[C],1),_[C].m(l,c))}for(Ae(),C=m.length;C<_.length;C+=1)g(C);Ne()}if(I[0]&2){y=Ie(Array(12-k[1].sessionHistory.length));let C;for(C=0;C<y.length;C+=1){const A=Ql(k,y,C);b[C]?b[C].p(A,I):(b[C]=lc(A),b[C].c(),b[C].m(l,null))}for(;C<b.length;C+=1)b[C].d(1);b.length=y.length}const T={};I[0]&256&&(T.currentIndex=k[8]),I[0]&2&&(T.sessionHistory=k[1].sessionHistory),I[1]&270008320&&(T.$$scope={dirty:I,ctx:k}),f.$set(T)},i(k){if(!d){for(let I=0;I<m.length;I+=1)O(_[I]);O(f.$$.fragment,k),d=!0}},o(k){_=_.filter(Boolean);for(let I=0;I<_.length;I+=1)W(_[I]);W(f.$$.fragment,k),d=!1},d(k){k&&(v(e),v(u),v(h)),dt(_,k),dt(b,k),re(f)}}}function ac(n){var g;let e,t,s=n[50]+1+"",r,i,o,a,l,c,u,h,f;var d=((g=n[20][n[51].grade])==null?void 0:g.icon)||Xs;function m(y,b){return{props:{size:"14"}}}d&&(o=St(d,m()));function _(){return n[31](n[50])}return{c(){e=E("button"),t=E("span"),r=P(s),i=x(),o&&oe(o.$$.fragment),a=x(),this.h()},l(y){e=N(y,"BUTTON",{class:!0,title:!0});var b=$(e);t=N(b,"SPAN",{class:!0});var k=$(t);r=R(k,s),k.forEach(v),i=V(b),o&&de(o.$$.fragment,b),a=V(b),b.forEach(v),this.h()},h(){var y;S(t,"class","session-number svelte-ililvx"),S(e,"class",l="session-bar-button grade-"+n[51].grade+" svelte-ililvx"),S(e,"title",c="セッション"+(n[50]+1)+": "+((y=n[20][n[51].grade])==null?void 0:y.name)+" (精度"+n[51].accuracy+"%)"),Ls(e,"active",n[50]===n[8])},m(y,b){H(y,e,b),p(e,t),p(t,r),p(e,i),o&&ie(o,e,null),p(e,a),u=!0,h||(f=vs(e,"click",_),h=!0)},p(y,b){var k,I;if(n=y,b[0]&2&&d!==(d=((k=n[20][n[51].grade])==null?void 0:k.icon)||Xs)){if(o){Ae();const T=o;W(T.$$.fragment,1,0,()=>{re(T,1)}),Ne()}d?(o=St(d,m()),oe(o.$$.fragment),O(o.$$.fragment,1),ie(o,e,a)):o=null}(!u||b[0]&2&&l!==(l="session-bar-button grade-"+n[51].grade+" svelte-ililvx"))&&S(e,"class",l),(!u||b[0]&2&&c!==(c="セッション"+(n[50]+1)+": "+((I=n[20][n[51].grade])==null?void 0:I.name)+" (精度"+n[51].accuracy+"%)"))&&S(e,"title",c),(!u||b[0]&258)&&Ls(e,"active",n[50]===n[8])},i(y){u||(o&&O(o.$$.fragment,y),u=!0)},o(y){o&&W(o.$$.fragment,y),u=!1},d(y){y&&v(e),o&&re(o),h=!1,f()}}}function lc(n){let e,t,s=n[1].sessionHistory.length+n[50]+1+"",r,i,o,a="-",l;return{c(){e=E("div"),t=E("span"),r=P(s),i=x(),o=E("span"),o.textContent=a,l=x(),this.h()},l(c){e=N(c,"DIV",{class:!0});var u=$(e);t=N(u,"SPAN",{class:!0});var h=$(t);r=R(h,s),h.forEach(v),i=V(u),o=N(u,"SPAN",{class:!0,"data-svelte-h":!0}),pe(o)!=="svelte-ut6ezx"&&(o.textContent=a),l=V(u),u.forEach(v),this.h()},h(){S(t,"class","session-number svelte-ililvx"),S(o,"class","empty-icon svelte-ililvx"),S(e,"class","session-bar-button empty svelte-ililvx")},m(c,u){H(c,e,u),p(e,t),p(t,r),p(e,i),p(e,o),p(e,l)},p(c,u){u[0]&2&&s!==(s=c[1].sessionHistory.length+c[50]+1+"")&&ee(r,s)},d(c){c&&v(e)}}}function s0(n){let e,t,s,r=n[50]+1+"",i,o,a=n[51].chromaticNote+"",l,c,u;return{c(){e=E("div"),t=E("div"),s=P("セッション"),i=P(r),o=P(" - 半音階: "),l=P(a),c=E("br"),u=P(`
                  12音階モードの詳細表示は準備中です`),this.h()},l(h){e=N(h,"DIV",{slot:!0});var f=$(e);t=N(f,"DIV",{class:!0});var d=$(t);s=R(d,"セッション"),i=R(d,r),o=R(d," - 半音階: "),l=R(d,a),c=N(d,"BR",{}),u=R(d,`
                  12音階モードの詳細表示は準備中です`),d.forEach(v),f.forEach(v),this.h()},h(){S(t,"class","no-details svelte-ililvx"),S(e,"slot","default")},m(h,f){H(h,e,f),p(e,t),p(t,s),p(t,i),p(t,o),p(t,l),p(t,c),p(t,u)},p(h,f){f[1]&524288&&r!==(r=h[50]+1+"")&&ee(i,r),f[1]&1048576&&a!==(a=h[51].chromaticNote+"")&&ee(l,a)},d(h){h&&v(e)}}}function cc(n){let e,t,s,r=n[1].sessionHistory.length+"",i,o,a=(n[1].mode==="chromatic"?12:8)+"",l,c,u,h,f,d,m,_,g,y=Ie(n[1].sessionHistory),b=[];for(let C=0;C<y.length;C+=1)b[C]=uc(ec(n,y,C));const k=C=>W(b[C],1,1,()=>{b[C]=null});let I=Ie(Array((n[1].mode==="chromatic"?12:8)-n[1].sessionHistory.length)),T=[];for(let C=0;C<I.length;C+=1)T[C]=hc(Kl(n,I,C));return _=new va({props:{currentIndex:n[8],sessionHistory:n[1].sessionHistory,className:"session-detail-carousel",$$slots:{default:[n0,({index:C,session:A})=>({50:C,51:A}),({index:C,session:A})=>[0,(C?524288:0)|(A?1048576:0)]]},$$scope:{ctx:n}}}),_.$on("sessionChange",n[30]),{c(){e=E("div"),t=E("div"),s=P("⏱️ セッション履歴 ("),i=P(r),o=P("/"),l=P(a),c=P(")"),u=x(),h=E("div");for(let C=0;C<b.length;C+=1)b[C].c();f=x();for(let C=0;C<T.length;C+=1)T[C].c();d=x(),m=E("div"),oe(_.$$.fragment),this.h()},l(C){e=N(C,"DIV",{class:!0});var A=$(e);t=N(A,"DIV",{class:!0});var w=$(t);s=R(w,"⏱️ セッション履歴 ("),i=R(w,r),o=R(w,"/"),l=R(w,a),c=R(w,")"),w.forEach(v),u=V(A),h=N(A,"DIV",{class:!0});var D=$(h);for(let F=0;F<b.length;F+=1)b[F].l(D);f=V(D);for(let F=0;F<T.length;F+=1)T[F].l(D);D.forEach(v),A.forEach(v),d=V(C),m=N(C,"DIV",{class:!0});var M=$(m);de(_.$$.fragment,M),M.forEach(v),this.h()},h(){S(t,"class","session-title svelte-ililvx"),S(h,"class","session-bars compact svelte-ililvx"),S(e,"class","session-history-section compact svelte-ililvx"),S(m,"class","carousel-wrapper svelte-ililvx")},m(C,A){H(C,e,A),p(e,t),p(t,s),p(t,i),p(t,o),p(t,l),p(t,c),p(e,u),p(e,h);for(let w=0;w<b.length;w+=1)b[w]&&b[w].m(h,null);p(h,f);for(let w=0;w<T.length;w+=1)T[w]&&T[w].m(h,null);H(C,d,A),H(C,m,A),ie(_,m,null),g=!0},p(C,A){if((!g||A[0]&2)&&r!==(r=C[1].sessionHistory.length+"")&&ee(i,r),(!g||A[0]&2)&&a!==(a=(C[1].mode==="chromatic"?12:8)+"")&&ee(l,a),A[0]&1049346){y=Ie(C[1].sessionHistory);let D;for(D=0;D<y.length;D+=1){const M=ec(C,y,D);b[D]?(b[D].p(M,A),O(b[D],1)):(b[D]=uc(M),b[D].c(),O(b[D],1),b[D].m(h,f))}for(Ae(),D=y.length;D<b.length;D+=1)k(D);Ne()}if(A[0]&2){I=Ie(Array((C[1].mode==="chromatic"?12:8)-C[1].sessionHistory.length));let D;for(D=0;D<I.length;D+=1){const M=Kl(C,I,D);T[D]?T[D].p(M,A):(T[D]=hc(M),T[D].c(),T[D].m(h,null))}for(;D<T.length;D+=1)T[D].d(1);T.length=I.length}const w={};A[0]&256&&(w.currentIndex=C[8]),A[0]&2&&(w.sessionHistory=C[1].sessionHistory),A[1]&270008320&&(w.$$scope={dirty:A,ctx:C}),_.$set(w)},i(C){if(!g){for(let A=0;A<y.length;A+=1)O(b[A]);O(_.$$.fragment,C),g=!0}},o(C){b=b.filter(Boolean);for(let A=0;A<b.length;A+=1)W(b[A]);W(_.$$.fragment,C),g=!1},d(C){C&&(v(e),v(d),v(m)),dt(b,C),dt(T,C),re(_)}}}function uc(n){var g;let e,t,s=n[50]+1+"",r,i,o,a,l,c,u,h,f;var d=((g=n[20][n[51].grade])==null?void 0:g.icon)||Xs;function m(y,b){return{props:{size:"14"}}}d&&(o=St(d,m()));function _(){return n[29](n[50])}return{c(){e=E("button"),t=E("span"),r=P(s),i=x(),o&&oe(o.$$.fragment),a=x(),this.h()},l(y){e=N(y,"BUTTON",{class:!0,title:!0});var b=$(e);t=N(b,"SPAN",{class:!0});var k=$(t);r=R(k,s),k.forEach(v),i=V(b),o&&de(o.$$.fragment,b),a=V(b),b.forEach(v),this.h()},h(){var y;S(t,"class","session-number svelte-ililvx"),S(e,"class",l="session-bar-button grade-"+n[51].grade+" svelte-ililvx"),S(e,"title",c="セッション"+(n[50]+1)+": "+((y=n[20][n[51].grade])==null?void 0:y.name)+" (精度"+n[51].accuracy+"%)"),Ls(e,"active",n[50]===n[8])},m(y,b){H(y,e,b),p(e,t),p(t,r),p(e,i),o&&ie(o,e,null),p(e,a),u=!0,h||(f=vs(e,"click",_),h=!0)},p(y,b){var k,I;if(n=y,b[0]&2&&d!==(d=((k=n[20][n[51].grade])==null?void 0:k.icon)||Xs)){if(o){Ae();const T=o;W(T.$$.fragment,1,0,()=>{re(T,1)}),Ne()}d?(o=St(d,m()),oe(o.$$.fragment),O(o.$$.fragment,1),ie(o,e,a)):o=null}(!u||b[0]&2&&l!==(l="session-bar-button grade-"+n[51].grade+" svelte-ililvx"))&&S(e,"class",l),(!u||b[0]&2&&c!==(c="セッション"+(n[50]+1)+": "+((I=n[20][n[51].grade])==null?void 0:I.name)+" (精度"+n[51].accuracy+"%)"))&&S(e,"title",c),(!u||b[0]&258)&&Ls(e,"active",n[50]===n[8])},i(y){u||(o&&O(o.$$.fragment,y),u=!0)},o(y){o&&W(o.$$.fragment,y),u=!1},d(y){y&&v(e),o&&re(o),h=!1,f()}}}function hc(n){let e,t,s=n[1].sessionHistory.length+n[50]+1+"",r,i,o,a="-",l;return{c(){e=E("div"),t=E("span"),r=P(s),i=x(),o=E("span"),o.textContent=a,l=x(),this.h()},l(c){e=N(c,"DIV",{class:!0});var u=$(e);t=N(u,"SPAN",{class:!0});var h=$(t);r=R(h,s),h.forEach(v),i=V(u),o=N(u,"SPAN",{class:!0,"data-svelte-h":!0}),pe(o)!=="svelte-ut6ezx"&&(o.textContent=a),l=V(u),u.forEach(v),this.h()},h(){S(t,"class","session-number svelte-ililvx"),S(o,"class","empty-icon svelte-ililvx"),S(e,"class","session-bar-button empty svelte-ililvx")},m(c,u){H(c,e,u),p(e,t),p(t,r),p(e,i),p(e,o),p(e,l)},p(c,u){u[0]&2&&s!==(s=c[1].sessionHistory.length+c[50]+1+"")&&ee(r,s)},d(c){c&&v(e)}}}function n0(n){let e,t,s,r=n[50]+1+"",i,o,a=n[51].baseNote+"",l,c,u;return{c(){e=E("div"),t=E("div"),s=P("セッション"),i=P(r),o=P(" - 基音: "),l=P(a),c=E("br"),u=P(`
                  連続モードの詳細表示は準備中です`),this.h()},l(h){e=N(h,"DIV",{slot:!0});var f=$(e);t=N(f,"DIV",{class:!0});var d=$(t);s=R(d,"セッション"),i=R(d,r),o=R(d," - 基音: "),l=R(d,a),c=N(d,"BR",{}),u=R(d,`
                  連続モードの詳細表示は準備中です`),d.forEach(v),f.forEach(v),this.h()},h(){S(t,"class","no-details svelte-ililvx"),S(e,"slot","default")},m(h,f){H(h,e,f),p(e,t),p(t,s),p(t,i),p(t,o),p(t,l),p(t,c),p(t,u)},p(h,f){f[1]&524288&&r!==(r=h[50]+1+"")&&ee(i,r),f[1]&1048576&&a!==(a=h[51].baseNote+"")&&ee(l,a)},d(h){h&&v(e)}}}function fc(n){let e,t,s,r=n[1].sessionHistory.length+"",i,o,a=(n[1].mode==="chromatic"?12:8)+"",l,c,u,h,f,d,m,_,g,y=Ie(n[1].sessionHistory),b=[];for(let C=0;C<y.length;C+=1)b[C]=dc(sc(n,y,C));const k=C=>W(b[C],1,1,()=>{b[C]=null});let I=Ie(Array((n[1].mode==="chromatic"?12:8)-n[1].sessionHistory.length)),T=[];for(let C=0;C<I.length;C+=1)T[C]=pc(tc(n,I,C));return _=new va({props:{currentIndex:n[8],sessionHistory:n[1].sessionHistory,className:"session-detail-carousel",$$slots:{default:[o0,({index:C,session:A})=>({50:C,51:A}),({index:C,session:A})=>[0,(C?524288:0)|(A?1048576:0)]]},$$scope:{ctx:n}}}),_.$on("sessionChange",n[28]),{c(){e=E("div"),t=E("div"),s=P("🎵 セッション履歴 ("),i=P(r),o=P("/"),l=P(a),c=P(")"),u=x(),h=E("div");for(let C=0;C<b.length;C+=1)b[C].c();f=x();for(let C=0;C<T.length;C+=1)T[C].c();d=x(),m=E("div"),oe(_.$$.fragment),this.h()},l(C){e=N(C,"DIV",{class:!0});var A=$(e);t=N(A,"DIV",{class:!0});var w=$(t);s=R(w,"🎵 セッション履歴 ("),i=R(w,r),o=R(w,"/"),l=R(w,a),c=R(w,")"),w.forEach(v),u=V(A),h=N(A,"DIV",{class:!0});var D=$(h);for(let F=0;F<b.length;F+=1)b[F].l(D);f=V(D);for(let F=0;F<T.length;F+=1)T[F].l(D);D.forEach(v),A.forEach(v),d=V(C),m=N(C,"DIV",{class:!0});var M=$(m);de(_.$$.fragment,M),M.forEach(v),this.h()},h(){S(t,"class","session-title svelte-ililvx"),S(h,"class","session-bars compact svelte-ililvx"),S(e,"class","session-history-section compact svelte-ililvx"),S(m,"class","carousel-wrapper svelte-ililvx")},m(C,A){H(C,e,A),p(e,t),p(t,s),p(t,i),p(t,o),p(t,l),p(t,c),p(e,u),p(e,h);for(let w=0;w<b.length;w+=1)b[w]&&b[w].m(h,null);p(h,f);for(let w=0;w<T.length;w+=1)T[w]&&T[w].m(h,null);H(C,d,A),H(C,m,A),ie(_,m,null),g=!0},p(C,A){if((!g||A[0]&2)&&r!==(r=C[1].sessionHistory.length+"")&&ee(i,r),(!g||A[0]&2)&&a!==(a=(C[1].mode==="chromatic"?12:8)+"")&&ee(l,a),A[0]&1049346){y=Ie(C[1].sessionHistory);let D;for(D=0;D<y.length;D+=1){const M=sc(C,y,D);b[D]?(b[D].p(M,A),O(b[D],1)):(b[D]=dc(M),b[D].c(),O(b[D],1),b[D].m(h,f))}for(Ae(),D=y.length;D<b.length;D+=1)k(D);Ne()}if(A[0]&2){I=Ie(Array((C[1].mode==="chromatic"?12:8)-C[1].sessionHistory.length));let D;for(D=0;D<I.length;D+=1){const M=tc(C,I,D);T[D]?T[D].p(M,A):(T[D]=pc(M),T[D].c(),T[D].m(h,null))}for(;D<T.length;D+=1)T[D].d(1);T.length=I.length}const w={};A[0]&256&&(w.currentIndex=C[8]),A[0]&2&&(w.sessionHistory=C[1].sessionHistory),A[1]&270008320&&(w.$$scope={dirty:A,ctx:C}),_.$set(w)},i(C){if(!g){for(let A=0;A<y.length;A+=1)O(b[A]);O(_.$$.fragment,C),g=!0}},o(C){b=b.filter(Boolean);for(let A=0;A<b.length;A+=1)W(b[A]);W(_.$$.fragment,C),g=!1},d(C){C&&(v(e),v(d),v(m)),dt(b,C),dt(T,C),re(_)}}}function dc(n){var g;let e,t,s=n[50]+1+"",r,i,o,a,l,c,u,h,f;var d=((g=n[20][n[51].grade])==null?void 0:g.icon)||Xs;function m(y,b){return{props:{size:"14"}}}d&&(o=St(d,m()));function _(){return n[27](n[50])}return{c(){e=E("button"),t=E("span"),r=P(s),i=x(),o&&oe(o.$$.fragment),a=x(),this.h()},l(y){e=N(y,"BUTTON",{class:!0,title:!0});var b=$(e);t=N(b,"SPAN",{class:!0});var k=$(t);r=R(k,s),k.forEach(v),i=V(b),o&&de(o.$$.fragment,b),a=V(b),b.forEach(v),this.h()},h(){var y;S(t,"class","session-number svelte-ililvx"),S(e,"class",l="session-bar-button grade-"+n[51].grade+" svelte-ililvx"),S(e,"title",c="セッション"+(n[50]+1)+": "+((y=n[20][n[51].grade])==null?void 0:y.name)+" (精度"+n[51].accuracy+"%)"),Ls(e,"active",n[50]===n[8])},m(y,b){H(y,e,b),p(e,t),p(t,r),p(e,i),o&&ie(o,e,null),p(e,a),u=!0,h||(f=vs(e,"click",_),h=!0)},p(y,b){var k,I;if(n=y,b[0]&2&&d!==(d=((k=n[20][n[51].grade])==null?void 0:k.icon)||Xs)){if(o){Ae();const T=o;W(T.$$.fragment,1,0,()=>{re(T,1)}),Ne()}d?(o=St(d,m()),oe(o.$$.fragment),O(o.$$.fragment,1),ie(o,e,a)):o=null}(!u||b[0]&2&&l!==(l="session-bar-button grade-"+n[51].grade+" svelte-ililvx"))&&S(e,"class",l),(!u||b[0]&2&&c!==(c="セッション"+(n[50]+1)+": "+((I=n[20][n[51].grade])==null?void 0:I.name)+" (精度"+n[51].accuracy+"%)"))&&S(e,"title",c),(!u||b[0]&258)&&Ls(e,"active",n[50]===n[8])},i(y){u||(o&&O(o.$$.fragment,y),u=!0)},o(y){o&&W(o.$$.fragment,y),u=!1},d(y){y&&v(e),o&&re(o),h=!1,f()}}}function pc(n){let e,t,s=n[1].sessionHistory.length+n[50]+1+"",r,i,o,a="-",l;return{c(){e=E("div"),t=E("span"),r=P(s),i=x(),o=E("span"),o.textContent=a,l=x(),this.h()},l(c){e=N(c,"DIV",{class:!0});var u=$(e);t=N(u,"SPAN",{class:!0});var h=$(t);r=R(h,s),h.forEach(v),i=V(u),o=N(u,"SPAN",{class:!0,"data-svelte-h":!0}),pe(o)!=="svelte-ut6ezx"&&(o.textContent=a),l=V(u),u.forEach(v),this.h()},h(){S(t,"class","session-number svelte-ililvx"),S(o,"class","empty-icon svelte-ililvx"),S(e,"class","session-bar-button empty svelte-ililvx")},m(c,u){H(c,e,u),p(e,t),p(t,r),p(e,i),p(e,o),p(e,l)},p(c,u){u[0]&2&&s!==(s=c[1].sessionHistory.length+c[50]+1+"")&&ee(r,s)},d(c){c&&v(e)}}}function r0(n){let e,t,s=n[50]+1+"",r,i,o=n[51].baseNote+"",a,l,c;return{c(){e=E("div"),t=P("セッション"),r=P(s),i=P(" - 基音: "),a=P(o),l=E("br"),c=P(`
                    詳細データがありません`),this.h()},l(u){e=N(u,"DIV",{class:!0});var h=$(e);t=R(h,"セッション"),r=R(h,s),i=R(h," - 基音: "),a=R(h,o),l=N(h,"BR",{}),c=R(h,`
                    詳細データがありません`),h.forEach(v),this.h()},h(){S(e,"class","no-details svelte-ililvx")},m(u,h){H(u,e,h),p(e,t),p(e,r),p(e,i),p(e,a),p(e,l),p(e,c)},p(u,h){h[1]&524288&&s!==(s=u[50]+1+"")&&ee(r,s),h[1]&1048576&&o!==(o=u[51].baseNote+"")&&ee(a,o)},i:Et,o:Et,d(u){u&&v(e)}}}function i0(n){let e,t;return e=new J1({props:{noteResults:n[51].noteResults,sessionIndex:n[50],baseNote:n[51].baseNote,className:"carousel-score-result"}}),{c(){oe(e.$$.fragment)},l(s){de(e.$$.fragment,s)},m(s,r){ie(e,s,r),t=!0},p(s,r){const i={};r[1]&1048576&&(i.noteResults=s[51].noteResults),r[1]&524288&&(i.sessionIndex=s[50]),r[1]&1048576&&(i.baseNote=s[51].baseNote),e.$set(i)},i(s){t||(O(e.$$.fragment,s),t=!0)},o(s){W(e.$$.fragment,s),t=!1},d(s){re(e,s)}}}function o0(n){let e,t,s,r;const i=[i0,r0],o=[];function a(l,c){return l[51].noteResults?0:1}return t=a(n),s=o[t]=i[t](n),{c(){e=E("div"),s.c(),this.h()},l(l){e=N(l,"DIV",{slot:!0});var c=$(e);s.l(c),c.forEach(v),this.h()},h(){S(e,"slot","default")},m(l,c){H(l,e,c),o[t].m(e,null),r=!0},p(l,c){let u=t;t=a(l),t===u?o[t].p(l,c):(Ae(),W(o[u],1,1,()=>{o[u]=null}),Ne(),s=o[t],s?s.p(l,c):(s=o[t]=i[t](l),s.c()),O(s,1),s.m(e,null))},i(l){r||(O(s),r=!0)},o(l){W(s),r=!1},d(l){l&&v(e),o[t].d()}}}function mc(n){let e,t,s,r=n[15]&&_c(n);return{c(){e=E("div"),r&&r.c(),this.h()},l(i){e=N(i,"DIV",{class:!0});var o=$(e);r&&r.l(o),o.forEach(v),this.h()},h(){S(e,"class","detailed-analysis-dashboard svelte-ililvx")},m(i,o){H(i,e,o),r&&r.m(e,null),s=!0},p(i,o){i[15]?r?(r.p(i,o),o[0]&32768&&O(r,1)):(r=_c(i),r.c(),O(r,1),r.m(e,null)):r&&(Ae(),W(r,1,1,()=>{r=null}),Ne())},i(i){s||(O(r),i&&(t||Ds(()=>{t=Fs(e,Hr,{y:20,duration:500,delay:1e3}),t.start()})),s=!0)},o(i){W(r),s=!1},d(i){i&&v(e),r&&r.d()}}}function _c(n){var m,_,g,y,b,k;let e,t,s,r,i,o,a,l=Ie(n[14]),c=[];for(let I=0;I<l.length;I+=1)c[I]=gc(Yl(n,l,I));let u=n[13]==="technical"&&((m=n[12])==null?void 0:m.technicalAnalysis)&&((_=n[1])==null?void 0:_.sessionHistory)&&n[1].sessionHistory.length>=(((g=n[1])==null?void 0:g.mode)==="chromatic"?12:8)&&vc(n),h=n[13]==="intervals"&&(((y=n[12])==null?void 0:y.intervalAnalysis)||n[4].length>0)&&bc(n),f=n[13]==="consistency"&&(((b=n[12])==null?void 0:b.consistencyAnalysis)||n[5].length>0)&&wc(n),d=n[13]==="statistics"&&(((k=n[12])==null?void 0:k.comprehensiveStatistics)||n[7])&&Cc(n);return{c(){e=E("div"),t=E("div");for(let I=0;I<c.length;I+=1)c[I].c();s=x(),u&&u.c(),r=x(),h&&h.c(),i=x(),f&&f.c(),o=x(),d&&d.c(),this.h()},l(I){e=N(I,"DIV",{class:!0});var T=$(e);t=N(T,"DIV",{class:!0});var C=$(t);for(let A=0;A<c.length;A+=1)c[A].l(C);C.forEach(v),s=V(T),u&&u.l(T),r=V(T),h&&h.l(T),i=V(T),f&&f.l(T),o=V(T),d&&d.l(T),T.forEach(v),this.h()},h(){S(t,"class","scoring-tabs svelte-ililvx"),S(e,"class","scoring-tabs-container svelte-ililvx")},m(I,T){H(I,e,T),p(e,t);for(let C=0;C<c.length;C+=1)c[C]&&c[C].m(t,null);p(e,s),u&&u.m(e,null),p(e,r),h&&h.m(e,null),p(e,i),f&&f.m(e,null),p(e,o),d&&d.m(e,null),a=!0},p(I,T){var C,A,w,D,M,F;if(T[0]&16801792){l=Ie(I[14]);let q;for(q=0;q<l.length;q+=1){const B=Yl(I,l,q);c[q]?c[q].p(B,T):(c[q]=gc(B),c[q].c(),c[q].m(t,null))}for(;q<c.length;q+=1)c[q].d(1);c.length=l.length}I[13]==="technical"&&((C=I[12])!=null&&C.technicalAnalysis)&&((A=I[1])!=null&&A.sessionHistory)&&I[1].sessionHistory.length>=(((w=I[1])==null?void 0:w.mode)==="chromatic"?12:8)?u?u.p(I,T):(u=vc(I),u.c(),u.m(e,r)):u&&(u.d(1),u=null),I[13]==="intervals"&&((D=I[12])!=null&&D.intervalAnalysis||I[4].length>0)?h?(h.p(I,T),T[0]&12304&&O(h,1)):(h=bc(I),h.c(),O(h,1),h.m(e,i)):h&&(Ae(),W(h,1,1,()=>{h=null}),Ne()),I[13]==="consistency"&&((M=I[12])!=null&&M.consistencyAnalysis||I[5].length>0)?f?(f.p(I,T),T[0]&12320&&O(f,1)):(f=wc(I),f.c(),O(f,1),f.m(e,o)):f&&(Ae(),W(f,1,1,()=>{f=null}),Ne()),I[13]==="statistics"&&((F=I[12])!=null&&F.comprehensiveStatistics||I[7])?d?(d.p(I,T),T[0]&12416&&O(d,1)):(d=Cc(I),d.c(),O(d,1),d.m(e,null)):d&&(Ae(),W(d,1,1,()=>{d=null}),Ne())},i(I){a||(O(h),O(f),O(d),a=!0)},o(I){W(h),W(f),W(d),a=!1},d(I){I&&v(e),dt(c,I),u&&u.d(),h&&h.d(),f&&f.d(),d&&d.d()}}}function gc(n){let e,t=n[47].label+"",s,r,i,o;function a(){return n[33](n[47])}return{c(){e=E("button"),s=P(t),r=x(),this.h()},l(l){e=N(l,"BUTTON",{class:!0});var c=$(e);s=R(c,t),r=V(c),c.forEach(v),this.h()},h(){S(e,"class","scoring-tab svelte-ililvx"),Ls(e,"active",n[13]===n[47].id)},m(l,c){H(l,e,c),p(e,s),p(e,r),i||(o=vs(e,"click",a),i=!0)},p(l,c){n=l,c[0]&16384&&t!==(t=n[47].label+"")&&ee(s,t),c[0]&24576&&Ls(e,"active",n[13]===n[47].id)},d(l){l&&v(e),i=!1,o()}}}function vc(n){var rn;let e,t,s,r="🔬 技術分析結果",i,o,a,l="🎯 測定精度分析",c,u,h,f,d="標準偏差",m,_,g,y=n[12].technicalAnalysis.standardDeviation+"",b,k,I,T,C,A="外れ値検出",w,D,M=n[12].technicalAnalysis.outlierCount+"",F,q,B=n[12].technicalAnalysis.outlierPercentage+"",G,Y,U,L,K,z="信頼区間",Q,te,ce=n[12].technicalAnalysis.confidenceInterval.lower+"",ve,Ce,ye=n[12].technicalAnalysis.confidenceInterval.upper+"",me,be,X,Se,fe,le="📊 誤差分布",ue,De,Oe,se,ae="高精度測定",Me,we,Te=n[12].technicalAnalysis.errorDistribution.highPrecision+"",$e,je,Je,_t,Ot,Rt="中精度測定",ut,Ke,qt=n[12].technicalAnalysis.errorDistribution.mediumPrecision+"",Re,Xt,Ze,Yt,Ct,Qt="低精度測定",Wt,We,Ss=n[12].technicalAnalysis.errorDistribution.lowPrecision+"",Xe,et,$s,Tt,Dt,Z="異常値",J,ge,j=n[12].technicalAnalysis.errorDistribution.anomalies+"",ne,ke,Qe,_e,Ve,ns="🔍 技術誤差補正結果",Ye,kt,At,Pt,ds="補正前平均",as,Jt,Lt=n[12].technicalAnalysis.correctedEvaluation.rawAverage+"",Kt,Bs,Os,tt,ws,Xn="補正後平均",Yn,Cs,en=n[12].technicalAnalysis.correctedEvaluation.correctedAverage+"",Fn,Qn,Rs,rs,tn,br="真の実力推定",Ps,ls,Ts=((rn=n[21][n[10]])==null?void 0:rn.name)+"",Jn,Kn,cs,ks,er="評価信頼度",tr,ps,Hs=n[12].technicalAnalysis.correctedEvaluation.confidenceLevel+"",dn,sr,ms,Bt,sn,pn,Sr="評価について:",wr,nn=n[12].technicalAnalysis.errorDistribution.highPrecision+n[12].technicalAnalysis.errorDistribution.mediumPrecision+n[12].technicalAnalysis.errorDistribution.lowPrecision+"",_s,Cr,nr;function Qr(Pe,ft){return Pe[1].mode==="chromatic"?l0:a0}let ze=Qr(n),xe=ze(n),ht=n[12].technicalAnalysis.outlierCount>0&&yc(n);return{c(){e=E("div"),t=E("div"),s=E("h4"),s.textContent=r,i=x(),o=E("div"),a=E("h5"),a.textContent=l,c=x(),u=E("div"),h=E("div"),f=E("span"),f.textContent=d,m=x(),_=E("span"),g=P("±"),b=P(y),k=P("¢"),I=x(),T=E("div"),C=E("span"),C.textContent=A,w=x(),D=E("span"),F=P(M),q=P("個（"),G=P(B),Y=P("%）"),U=x(),L=E("div"),K=E("span"),K.textContent=z,Q=x(),te=E("span"),ve=P(ce),Ce=P("% - "),me=P(ye),be=P("%"),X=x(),Se=E("div"),fe=E("h5"),fe.textContent=le,ue=x(),De=E("div"),Oe=E("div"),se=E("span"),se.textContent=ae,Me=x(),we=E("span"),$e=P(Te),je=P("回（技術誤差 ±10¢以内）"),Je=x(),_t=E("div"),Ot=E("span"),Ot.textContent=Rt,ut=x(),Ke=E("span"),Re=P(qt),Xt=P("回（技術誤差 ±20¢以内）"),Ze=x(),Yt=E("div"),Ct=E("span"),Ct.textContent=Qt,Wt=x(),We=E("span"),Xe=P(Ss),et=P("回（技術誤差 ±50¢以内）"),$s=x(),Tt=E("div"),Dt=E("span"),Dt.textContent=Z,J=x(),ge=E("span"),ne=P(j),ke=P("回（統計的外れ値）"),Qe=x(),_e=E("div"),Ve=E("h5"),Ve.textContent=ns,Ye=x(),kt=E("div"),At=E("div"),Pt=E("span"),Pt.textContent=ds,as=x(),Jt=E("span"),Kt=P(Lt),Bs=P("点"),Os=x(),tt=E("div"),ws=E("span"),ws.textContent=Xn,Yn=x(),Cs=E("span"),Fn=P(en),Qn=P("点"),Rs=x(),rs=E("div"),tn=E("span"),tn.textContent=br,Ps=x(),ls=E("span"),Jn=P(Ts),Kn=x(),cs=E("div"),ks=E("span"),ks.textContent=er,tr=x(),ps=E("span"),dn=P(Hs),sr=P("%"),ms=x(),Bt=E("div"),sn=P("💡 "),pn=E("strong"),pn.textContent=Sr,wr=x(),_s=P(nn),Cr=P(`回の測定データから統計的に分析し、技術的な誤差を考慮した真の音感能力を評価しています。
                  
                  `),xe.c(),nr=x(),ht&&ht.c(),this.h()},l(Pe){e=N(Pe,"DIV",{class:!0});var ft=$(e);t=N(ft,"DIV",{class:!0});var Ht=$(t);s=N(Ht,"H4",{class:!0,"data-svelte-h":!0}),pe(s)!=="svelte-et2bou"&&(s.textContent=r),i=V(Ht),o=N(Ht,"DIV",{class:!0});var mn=$(o);a=N(mn,"H5",{class:!0,"data-svelte-h":!0}),pe(a)!=="svelte-11w6zb4"&&(a.textContent=l),c=V(mn),u=N(mn,"DIV",{class:!0});var js=$(u);h=N(js,"DIV",{class:!0});var qn=$(h);f=N(qn,"SPAN",{class:!0,"data-svelte-h":!0}),pe(f)!=="svelte-185l6ms"&&(f.textContent=d),m=V(qn),_=N(qn,"SPAN",{class:!0});var _n=$(_);g=R(_n,"±"),b=R(_n,y),k=R(_n,"¢"),_n.forEach(v),qn.forEach(v),I=V(js),T=N(js,"DIV",{class:!0});var gn=$(T);C=N(gn,"SPAN",{class:!0,"data-svelte-h":!0}),pe(C)!=="svelte-1b9l8zi"&&(C.textContent=A),w=V(gn),D=N(gn,"SPAN",{class:!0});var vn=$(D);F=R(vn,M),q=R(vn,"個（"),G=R(vn,B),Y=R(vn,"%）"),vn.forEach(v),gn.forEach(v),U=V(js),L=N(js,"DIV",{class:!0});var yn=$(L);K=N(yn,"SPAN",{class:!0,"data-svelte-h":!0}),pe(K)!=="svelte-e2n7xo"&&(K.textContent=z),Q=V(yn),te=N(yn,"SPAN",{class:!0});var on=$(te);ve=R(on,ce),Ce=R(on,"% - "),me=R(on,ye),be=R(on,"%"),on.forEach(v),yn.forEach(v),js.forEach(v),mn.forEach(v),X=V(Ht),Se=N(Ht,"DIV",{class:!0});var bn=$(Se);fe=N(bn,"H5",{class:!0,"data-svelte-h":!0}),pe(fe)!=="svelte-zp8k2h"&&(fe.textContent=le),ue=V(bn),De=N(bn,"DIV",{class:!0});var es=$(De);Oe=N(es,"DIV",{class:!0});var Sn=$(Oe);se=N(Sn,"SPAN",{class:!0,"data-svelte-h":!0}),pe(se)!=="svelte-18w16wk"&&(se.textContent=ae),Me=V(Sn),we=N(Sn,"SPAN",{class:!0});var wn=$(we);$e=R(wn,Te),je=R(wn,"回（技術誤差 ±10¢以内）"),wn.forEach(v),Sn.forEach(v),Je=V(es),_t=N(es,"DIV",{class:!0});var Cn=$(_t);Ot=N(Cn,"SPAN",{class:!0,"data-svelte-h":!0}),pe(Ot)!=="svelte-dybcjr"&&(Ot.textContent=Rt),ut=V(Cn),Ke=N(Cn,"SPAN",{class:!0});var rr=$(Ke);Re=R(rr,qt),Xt=R(rr,"回（技術誤差 ±20¢以内）"),rr.forEach(v),Cn.forEach(v),Ze=V(es),Yt=N(es,"DIV",{class:!0});var Tn=$(Yt);Ct=N(Tn,"SPAN",{class:!0,"data-svelte-h":!0}),pe(Ct)!=="svelte-l6fo1e"&&(Ct.textContent=Qt),Wt=V(Tn),We=N(Tn,"SPAN",{class:!0});var ir=$(We);Xe=R(ir,Ss),et=R(ir,"回（技術誤差 ±50¢以内）"),ir.forEach(v),Tn.forEach(v),$s=V(es),Tt=N(es,"DIV",{class:!0});var kn=$(Tt);Dt=N(kn,"SPAN",{class:!0,"data-svelte-h":!0}),pe(Dt)!=="svelte-qqm2a2"&&(Dt.textContent=Z),J=V(kn),ge=N(kn,"SPAN",{class:!0});var An=$(ge);ne=R(An,j),ke=R(An,"回（統計的外れ値）"),An.forEach(v),kn.forEach(v),es.forEach(v),bn.forEach(v),Qe=V(Ht),_e=N(Ht,"DIV",{class:!0});var Nn=$(_e);Ve=N(Nn,"H5",{class:!0,"data-svelte-h":!0}),pe(Ve)!=="svelte-17ec45x"&&(Ve.textContent=ns),Ye=V(Nn),kt=N(Nn,"DIV",{class:!0});var As=$(kt);At=N(As,"DIV",{class:!0});var En=$(At);Pt=N(En,"SPAN",{class:!0,"data-svelte-h":!0}),pe(Pt)!=="svelte-icsoao"&&(Pt.textContent=ds),as=V(En),Jt=N(En,"SPAN",{class:!0});var Tr=$(Jt);Kt=R(Tr,Lt),Bs=R(Tr,"点"),Tr.forEach(v),En.forEach(v),Os=V(As),tt=N(As,"DIV",{class:!0});var or=$(tt);ws=N(or,"SPAN",{class:!0,"data-svelte-h":!0}),pe(ws)!=="svelte-1hm05j"&&(ws.textContent=Xn),Yn=V(or),Cs=N(or,"SPAN",{class:!0});var In=$(Cs);Fn=R(In,en),Qn=R(In,"点"),In.forEach(v),or.forEach(v),Rs=V(As),rs=N(As,"DIV",{class:!0});var yi=$(rs);tn=N(yi,"SPAN",{class:!0,"data-svelte-h":!0}),pe(tn)!=="svelte-1d0gxw1"&&(tn.textContent=br),Ps=V(yi),ls=N(yi,"SPAN",{class:!0});var ba=$(ls);Jn=R(ba,Ts),ba.forEach(v),yi.forEach(v),Kn=V(As),cs=N(As,"DIV",{class:!0});var bi=$(cs);ks=N(bi,"SPAN",{class:!0,"data-svelte-h":!0}),pe(ks)!=="svelte-1otck2l"&&(ks.textContent=er),tr=V(bi),ps=N(bi,"SPAN",{class:!0});var uo=$(ps);dn=R(uo,Hs),sr=R(uo,"%"),uo.forEach(v),bi.forEach(v),As.forEach(v),Nn.forEach(v),ms=V(Ht),Bt=N(Ht,"DIV",{class:!0});var Dn=$(Bt);sn=R(Dn,"💡 "),pn=N(Dn,"STRONG",{"data-svelte-h":!0}),pe(pn)!=="svelte-1ducxw7"&&(pn.textContent=Sr),wr=V(Dn),_s=R(Dn,nn),Cr=R(Dn,`回の測定データから統計的に分析し、技術的な誤差を考慮した真の音感能力を評価しています。
                  
                  `),xe.l(Dn),nr=V(Dn),ht&&ht.l(Dn),Dn.forEach(v),Ht.forEach(v),ft.forEach(v),this.h()},h(){S(s,"class","analysis-title svelte-ililvx"),S(a,"class","section-title svelte-ililvx"),S(f,"class","analysis-label svelte-ililvx"),S(_,"class","analysis-value svelte-ililvx"),S(h,"class","analysis-item svelte-ililvx"),S(C,"class","analysis-label svelte-ililvx"),S(D,"class","analysis-value svelte-ililvx"),S(T,"class","analysis-item svelte-ililvx"),S(K,"class","analysis-label svelte-ililvx"),S(te,"class","analysis-value svelte-ililvx"),S(L,"class","analysis-item svelte-ililvx"),S(u,"class","analysis-grid svelte-ililvx"),S(o,"class","analysis-section svelte-ililvx"),S(fe,"class","section-title svelte-ililvx"),S(se,"class","analysis-label svelte-ililvx"),S(we,"class","analysis-value text-green-600 svelte-ililvx"),S(Oe,"class","analysis-item svelte-ililvx"),S(Ot,"class","analysis-label svelte-ililvx"),S(Ke,"class","analysis-value text-blue-600 svelte-ililvx"),S(_t,"class","analysis-item svelte-ililvx"),S(Ct,"class","analysis-label svelte-ililvx"),S(We,"class","analysis-value text-amber-600 svelte-ililvx"),S(Yt,"class","analysis-item svelte-ililvx"),S(Dt,"class","analysis-label svelte-ililvx"),S(ge,"class","analysis-value text-red-600 svelte-ililvx"),S(Tt,"class","analysis-item svelte-ililvx"),S(De,"class","analysis-grid svelte-ililvx"),S(Se,"class","analysis-section svelte-ililvx"),S(Ve,"class","section-title svelte-ililvx"),S(Pt,"class","analysis-label svelte-ililvx"),S(Jt,"class","analysis-value svelte-ililvx"),S(At,"class","analysis-item svelte-ililvx"),S(ws,"class","analysis-label svelte-ililvx"),S(Cs,"class","analysis-value text-green-600 font-bold svelte-ililvx"),S(tt,"class","analysis-item svelte-ililvx"),S(tn,"class","analysis-label svelte-ililvx"),S(ls,"class","analysis-value grade-indicator svelte-ililvx"),S(rs,"class","analysis-item svelte-ililvx"),S(ks,"class","analysis-label svelte-ililvx"),S(ps,"class","analysis-value svelte-ililvx"),S(cs,"class","analysis-item svelte-ililvx"),S(kt,"class","analysis-grid svelte-ililvx"),S(_e,"class","analysis-section svelte-ililvx"),S(Bt,"class","analysis-explanation svelte-ililvx"),S(t,"class","technical-analysis-content svelte-ililvx"),S(e,"class","tab-panel svelte-ililvx")},m(Pe,ft){H(Pe,e,ft),p(e,t),p(t,s),p(t,i),p(t,o),p(o,a),p(o,c),p(o,u),p(u,h),p(h,f),p(h,m),p(h,_),p(_,g),p(_,b),p(_,k),p(u,I),p(u,T),p(T,C),p(T,w),p(T,D),p(D,F),p(D,q),p(D,G),p(D,Y),p(u,U),p(u,L),p(L,K),p(L,Q),p(L,te),p(te,ve),p(te,Ce),p(te,me),p(te,be),p(t,X),p(t,Se),p(Se,fe),p(Se,ue),p(Se,De),p(De,Oe),p(Oe,se),p(Oe,Me),p(Oe,we),p(we,$e),p(we,je),p(De,Je),p(De,_t),p(_t,Ot),p(_t,ut),p(_t,Ke),p(Ke,Re),p(Ke,Xt),p(De,Ze),p(De,Yt),p(Yt,Ct),p(Yt,Wt),p(Yt,We),p(We,Xe),p(We,et),p(De,$s),p(De,Tt),p(Tt,Dt),p(Tt,J),p(Tt,ge),p(ge,ne),p(ge,ke),p(t,Qe),p(t,_e),p(_e,Ve),p(_e,Ye),p(_e,kt),p(kt,At),p(At,Pt),p(At,as),p(At,Jt),p(Jt,Kt),p(Jt,Bs),p(kt,Os),p(kt,tt),p(tt,ws),p(tt,Yn),p(tt,Cs),p(Cs,Fn),p(Cs,Qn),p(kt,Rs),p(kt,rs),p(rs,tn),p(rs,Ps),p(rs,ls),p(ls,Jn),p(kt,Kn),p(kt,cs),p(cs,ks),p(cs,tr),p(cs,ps),p(ps,dn),p(ps,sr),p(t,ms),p(t,Bt),p(Bt,sn),p(Bt,pn),p(Bt,wr),p(Bt,_s),p(Bt,Cr),xe.m(Bt,null),p(Bt,nr),ht&&ht.m(Bt,null)},p(Pe,ft){var Ht;ft[0]&4096&&y!==(y=Pe[12].technicalAnalysis.standardDeviation+"")&&ee(b,y),ft[0]&4096&&M!==(M=Pe[12].technicalAnalysis.outlierCount+"")&&ee(F,M),ft[0]&4096&&B!==(B=Pe[12].technicalAnalysis.outlierPercentage+"")&&ee(G,B),ft[0]&4096&&ce!==(ce=Pe[12].technicalAnalysis.confidenceInterval.lower+"")&&ee(ve,ce),ft[0]&4096&&ye!==(ye=Pe[12].technicalAnalysis.confidenceInterval.upper+"")&&ee(me,ye),ft[0]&4096&&Te!==(Te=Pe[12].technicalAnalysis.errorDistribution.highPrecision+"")&&ee($e,Te),ft[0]&4096&&qt!==(qt=Pe[12].technicalAnalysis.errorDistribution.mediumPrecision+"")&&ee(Re,qt),ft[0]&4096&&Ss!==(Ss=Pe[12].technicalAnalysis.errorDistribution.lowPrecision+"")&&ee(Xe,Ss),ft[0]&4096&&j!==(j=Pe[12].technicalAnalysis.errorDistribution.anomalies+"")&&ee(ne,j),ft[0]&4096&&Lt!==(Lt=Pe[12].technicalAnalysis.correctedEvaluation.rawAverage+"")&&ee(Kt,Lt),ft[0]&4096&&en!==(en=Pe[12].technicalAnalysis.correctedEvaluation.correctedAverage+"")&&ee(Fn,en),ft[0]&1024&&Ts!==(Ts=((Ht=Pe[21][Pe[10]])==null?void 0:Ht.name)+"")&&ee(Jn,Ts),ft[0]&4096&&Hs!==(Hs=Pe[12].technicalAnalysis.correctedEvaluation.confidenceLevel+"")&&ee(dn,Hs),ft[0]&4096&&nn!==(nn=Pe[12].technicalAnalysis.errorDistribution.highPrecision+Pe[12].technicalAnalysis.errorDistribution.mediumPrecision+Pe[12].technicalAnalysis.errorDistribution.lowPrecision+"")&&ee(_s,nn),ze===(ze=Qr(Pe))&&xe?xe.p(Pe,ft):(xe.d(1),xe=ze(Pe),xe&&(xe.c(),xe.m(Bt,nr))),Pe[12].technicalAnalysis.outlierCount>0?ht?ht.p(Pe,ft):(ht=yc(Pe),ht.c(),ht.m(Bt,null)):ht&&(ht.d(1),ht=null)},d(Pe){Pe&&v(e),xe.d(),ht&&ht.d()}}}function a0(n){let e,t,s="🎵 8音階モード:",r,i=n[1].sessionHistory.length+"",o,a,l=n[1].sessionHistory.length*8+"",c,u;return{c(){e=E("br"),t=E("strong"),t.textContent=s,r=x(),o=P(i),a=P("セッション × 8音 = "),c=P(l),u=P("回の測定による統計的分析です。")},l(h){e=N(h,"BR",{}),t=N(h,"STRONG",{"data-svelte-h":!0}),pe(t)!=="svelte-h6ql6r"&&(t.textContent=s),r=V(h),o=R(h,i),a=R(h,"セッション × 8音 = "),c=R(h,l),u=R(h,"回の測定による統計的分析です。")},m(h,f){H(h,e,f),H(h,t,f),H(h,r,f),H(h,o,f),H(h,a,f),H(h,c,f),H(h,u,f)},p(h,f){f[0]&2&&i!==(i=h[1].sessionHistory.length+"")&&ee(o,i),f[0]&2&&l!==(l=h[1].sessionHistory.length*8+"")&&ee(c,l)},d(h){h&&(v(e),v(t),v(r),v(o),v(a),v(c),v(u))}}}function l0(n){let e,t,s="🎹 12音階モード:",r,i=n[1].sessionHistory.length+"",o,a,l=n[1].sessionHistory.length*12+"",c,u;return{c(){e=E("br"),t=E("strong"),t.textContent=s,r=x(),o=P(i),a=P("セッション × 12音 = "),c=P(l),u=P("回の高精度半音階分析により、最も正確な音感能力測定を実現しています。")},l(h){e=N(h,"BR",{}),t=N(h,"STRONG",{"data-svelte-h":!0}),pe(t)!=="svelte-2om8xo"&&(t.textContent=s),r=V(h),o=R(h,i),a=R(h,"セッション × 12音 = "),c=R(h,l),u=R(h,"回の高精度半音階分析により、最も正確な音感能力測定を実現しています。")},m(h,f){H(h,e,f),H(h,t,f),H(h,r,f),H(h,o,f),H(h,a,f),H(h,c,f),H(h,u,f)},p(h,f){f[0]&2&&i!==(i=h[1].sessionHistory.length+"")&&ee(o,i),f[0]&2&&l!==(l=h[1].sessionHistory.length*12+"")&&ee(c,l)},d(h){h&&(v(e),v(t),v(r),v(o),v(a),v(c),v(u))}}}function yc(n){let e,t,s=n[12].technicalAnalysis.outlierCount+"",r,i;return{c(){e=E("br"),t=P("("),r=P(s),i=P("回の外れ値を検出・補正済み)")},l(o){e=N(o,"BR",{}),t=R(o,"("),r=R(o,s),i=R(o,"回の外れ値を検出・補正済み)")},m(o,a){H(o,e,a),H(o,t,a),H(o,r,a),H(o,i,a)},p(o,a){a[0]&4096&&s!==(s=o[12].technicalAnalysis.outlierCount+"")&&ee(r,s)},d(o){o&&(v(e),v(t),v(r),v(i))}}}function bc(n){let e,t,s,r;const i=[u0,c0],o=[];function a(l,c){var u;return(u=l[12])!=null&&u.intervalAnalysis?0:1}return t=a(n),s=o[t]=i[t](n),{c(){e=E("div"),s.c(),this.h()},l(l){e=N(l,"DIV",{class:!0});var c=$(e);s.l(c),c.forEach(v),this.h()},h(){S(e,"class","tab-panel svelte-ililvx")},m(l,c){H(l,e,c),o[t].m(e,null),r=!0},p(l,c){let u=t;t=a(l),t===u?o[t].p(l,c):(Ae(),W(o[u],1,1,()=>{o[u]=null}),Ne(),s=o[t],s?s.p(l,c):(s=o[t]=i[t](l),s.c()),O(s,1),s.m(e,null))},i(l){r||(O(s),r=!0)},o(l){W(s),r=!1},d(l){l&&v(e),o[t].d()}}}function c0(n){let e,t;return e=new h1({props:{intervalData:n[4]}}),{c(){oe(e.$$.fragment)},l(s){de(e.$$.fragment,s)},m(s,r){ie(e,s,r),t=!0},p(s,r){const i={};r[0]&16&&(i.intervalData=s[4]),e.$set(i)},i(s){t||(O(e.$$.fragment,s),t=!0)},o(s){W(e.$$.fragment,s),t=!1},d(s){re(e,s)}}}function u0(n){let e,t,s="🎵 音程別習得状況（技術誤差補正版）",r,i,o,a,l=`💡 <strong>音程別分析:</strong> 
                    各音程の技術誤差を統計的に分離し、真の習得度を表示しています。
                    技術誤差が大きい音程は測定環境の改善で向上が期待できます。`,c=Ie(Object.entries(n[12].intervalAnalysis)),u=[];for(let h=0;h<c.length;h+=1)u[h]=Sc(Xl(n,c,h));return{c(){e=E("div"),t=E("h4"),t.textContent=s,r=x(),i=E("div");for(let h=0;h<u.length;h+=1)u[h].c();o=x(),a=E("div"),a.innerHTML=l,this.h()},l(h){e=N(h,"DIV",{class:!0});var f=$(e);t=N(f,"H4",{class:!0,"data-svelte-h":!0}),pe(t)!=="svelte-1massnn"&&(t.textContent=s),r=V(f),i=N(f,"DIV",{class:!0});var d=$(i);for(let m=0;m<u.length;m+=1)u[m].l(d);d.forEach(v),o=V(f),a=N(f,"DIV",{class:!0,"data-svelte-h":!0}),pe(a)!=="svelte-vnvjgz"&&(a.innerHTML=l),f.forEach(v),this.h()},h(){S(t,"class","analysis-title svelte-ililvx"),S(i,"class","interval-grid svelte-ililvx"),S(a,"class","analysis-explanation svelte-ililvx"),S(e,"class","interval-analysis-enhanced svelte-ililvx")},m(h,f){H(h,e,f),p(e,t),p(e,r),p(e,i);for(let d=0;d<u.length;d+=1)u[d]&&u[d].m(i,null);p(e,o),p(e,a)},p(h,f){if(f[0]&4096){c=Ie(Object.entries(h[12].intervalAnalysis));let d;for(d=0;d<c.length;d+=1){const m=Xl(h,c,d);u[d]?u[d].p(m,f):(u[d]=Sc(m),u[d].c(),u[d].m(i,null))}for(;d<u.length;d+=1)u[d].d(1);u.length=c.length}},i:Et,o:Et,d(h){h&&v(e),dt(u,h)}}}function Sc(n){let e,t,s,r=(n[43]==="unison"?"ユニゾン":n[43]==="minor_second"?"短2度":n[43]==="major_second"?"長2度":n[43]==="minor_third"?"短3度":n[43]==="major_third"?"長3度":n[43]==="perfect_fourth"?"完全4度":n[43]==="tritone"?"トライトーン":n[43]==="perfect_fifth"?"完全5度":n[43]==="minor_sixth"?"短6度":n[43]==="major_sixth"?"長6度":n[43]==="minor_seventh"?"短7度":n[43]==="major_seventh"?"長7度":n[43]==="octave"?"オクターブ":n[43])+"",i,o,a,l=n[44].mastery>=90?"⭐":n[44].mastery>=70?"🌟":n[44].mastery>=50?"💪":n[44].mastery>=30?"🌱":"🌰",c,u,h=n[44].mastery+"",f,d,m,_,g,y,b="挑戦回数:",k,I,T=n[44].attempts+"",C,A,w,D,M,F="技術誤差:",q,B,G,Y=n[44].technicalErrorRate+"",U,L,K,z,Q,te="真の精度:",ce,ve,Ce=n[44].trueAccuracy+"",ye,me,be,X,Se,fe;return{c(){e=E("div"),t=E("div"),s=E("div"),i=P(r),o=x(),a=E("div"),c=P(l),u=x(),f=P(h),d=P("%"),m=x(),_=E("div"),g=E("div"),y=E("span"),y.textContent=b,k=x(),I=E("span"),C=P(T),A=P("回"),w=x(),D=E("div"),M=E("span"),M.textContent=F,q=x(),B=E("span"),G=P("±"),U=P(Y),L=P("¢"),K=x(),z=E("div"),Q=E("span"),Q.textContent=te,ce=x(),ve=E("span"),ye=P(Ce),me=P("%"),be=x(),X=E("div"),Se=E("div"),fe=x(),this.h()},l(le){e=N(le,"DIV",{class:!0});var ue=$(e);t=N(ue,"DIV",{class:!0});var De=$(t);s=N(De,"DIV",{class:!0});var Oe=$(s);i=R(Oe,r),Oe.forEach(v),o=V(De),a=N(De,"DIV",{class:!0});var se=$(a);c=R(se,l),u=V(se),f=R(se,h),d=R(se,"%"),se.forEach(v),De.forEach(v),m=V(ue),_=N(ue,"DIV",{class:!0});var ae=$(_);g=N(ae,"DIV",{class:!0});var Me=$(g);y=N(Me,"SPAN",{class:!0,"data-svelte-h":!0}),pe(y)!=="svelte-1i4u9k7"&&(y.textContent=b),k=V(Me),I=N(Me,"SPAN",{class:!0});var we=$(I);C=R(we,T),A=R(we,"回"),we.forEach(v),Me.forEach(v),w=V(ae),D=N(ae,"DIV",{class:!0});var Te=$(D);M=N(Te,"SPAN",{class:!0,"data-svelte-h":!0}),pe(M)!=="svelte-15pr351"&&(M.textContent=F),q=V(Te),B=N(Te,"SPAN",{class:!0});var $e=$(B);G=R($e,"±"),U=R($e,Y),L=R($e,"¢"),$e.forEach(v),Te.forEach(v),K=V(ae),z=N(ae,"DIV",{class:!0});var je=$(z);Q=N(je,"SPAN",{class:!0,"data-svelte-h":!0}),pe(Q)!=="svelte-fvd72j"&&(Q.textContent=te),ce=V(je),ve=N(je,"SPAN",{class:!0});var Je=$(ve);ye=R(Je,Ce),me=R(Je,"%"),Je.forEach(v),je.forEach(v),ae.forEach(v),be=V(ue),X=N(ue,"DIV",{class:!0});var _t=$(X);Se=N(_t,"DIV",{class:!0,style:!0}),$(Se).forEach(v),_t.forEach(v),fe=V(ue),ue.forEach(v),this.h()},h(){S(s,"class","interval-name svelte-ililvx"),S(a,"class","mastery-badge svelte-ililvx"),S(t,"class","interval-header svelte-ililvx"),S(y,"class","stat-label svelte-ililvx"),S(I,"class","stat-value svelte-ililvx"),S(g,"class","stat-row svelte-ililvx"),S(M,"class","stat-label svelte-ililvx"),S(B,"class","stat-value text-amber-600 svelte-ililvx"),S(D,"class","stat-row svelte-ililvx"),S(Q,"class","stat-label svelte-ililvx"),S(ve,"class","stat-value text-green-600 font-bold svelte-ililvx"),S(z,"class","stat-row svelte-ililvx"),S(_,"class","interval-stats svelte-ililvx"),S(Se,"class","progress-fill svelte-ililvx"),st(Se,"width",n[44].mastery+"%"),st(Se,"background","linear-gradient(90deg, #3b82f6, #10b981)"),S(X,"class","progress-bar svelte-ililvx"),S(e,"class","interval-card svelte-ililvx")},m(le,ue){H(le,e,ue),p(e,t),p(t,s),p(s,i),p(t,o),p(t,a),p(a,c),p(a,u),p(a,f),p(a,d),p(e,m),p(e,_),p(_,g),p(g,y),p(g,k),p(g,I),p(I,C),p(I,A),p(_,w),p(_,D),p(D,M),p(D,q),p(D,B),p(B,G),p(B,U),p(B,L),p(_,K),p(_,z),p(z,Q),p(z,ce),p(z,ve),p(ve,ye),p(ve,me),p(e,be),p(e,X),p(X,Se),p(e,fe)},p(le,ue){ue[0]&4096&&r!==(r=(le[43]==="unison"?"ユニゾン":le[43]==="minor_second"?"短2度":le[43]==="major_second"?"長2度":le[43]==="minor_third"?"短3度":le[43]==="major_third"?"長3度":le[43]==="perfect_fourth"?"完全4度":le[43]==="tritone"?"トライトーン":le[43]==="perfect_fifth"?"完全5度":le[43]==="minor_sixth"?"短6度":le[43]==="major_sixth"?"長6度":le[43]==="minor_seventh"?"短7度":le[43]==="major_seventh"?"長7度":le[43]==="octave"?"オクターブ":le[43])+"")&&ee(i,r),ue[0]&4096&&l!==(l=le[44].mastery>=90?"⭐":le[44].mastery>=70?"🌟":le[44].mastery>=50?"💪":le[44].mastery>=30?"🌱":"🌰")&&ee(c,l),ue[0]&4096&&h!==(h=le[44].mastery+"")&&ee(f,h),ue[0]&4096&&T!==(T=le[44].attempts+"")&&ee(C,T),ue[0]&4096&&Y!==(Y=le[44].technicalErrorRate+"")&&ee(U,Y),ue[0]&4096&&Ce!==(Ce=le[44].trueAccuracy+"")&&ee(ye,Ce),ue[0]&4096&&st(Se,"width",le[44].mastery+"%")},d(le){le&&v(e)}}}function wc(n){let e,t,s,r;const i=[f0,h0],o=[];function a(l,c){var u;return(u=l[12])!=null&&u.consistencyAnalysis?0:1}return t=a(n),s=o[t]=i[t](n),{c(){e=E("div"),s.c(),this.h()},l(l){e=N(l,"DIV",{class:!0});var c=$(e);s.l(c),c.forEach(v),this.h()},h(){S(e,"class","tab-panel svelte-ililvx")},m(l,c){H(l,e,c),o[t].m(e,null),r=!0},p(l,c){let u=t;t=a(l),t===u?o[t].p(l,c):(Ae(),W(o[u],1,1,()=>{o[u]=null}),Ne(),s=o[t],s?s.p(l,c):(s=o[t]=i[t](l),s.c()),O(s,1),s.m(e,null))},i(l){r||(O(s),r=!0)},o(l){W(s),r=!1},d(l){l&&v(e),o[t].d()}}}function h0(n){let e,t;return e=new b1({props:{consistencyData:n[5]}}),{c(){oe(e.$$.fragment)},l(s){de(e.$$.fragment,s)},m(s,r){ie(e,s,r),t=!0},p(s,r){const i={};r[0]&32&&(i.consistencyData=s[5]),e.$set(i)},i(s){t||(O(e.$$.fragment,s),t=!0)},o(s){W(e.$$.fragment,s),t=!1},d(s){re(e,s)}}}function f0(n){let e,t,s="📊 一貫性グラフ（技術誤差補正版）",r,i,o,a,l="一貫性スコア:",c,u,h=n[12].consistencyAnalysis.consistencyScore+"",f,d,m,_,g,y="変動幅:",b,k,I=n[12].consistencyAnalysis.maxVariation.raw+"",T,C,A=n[12].consistencyAnalysis.maxVariation.corrected+"",w,D,M,F,q,B="トレンド:",G,Y,U=n[12].consistencyAnalysis.trendAnalysis==="improving"?"📈 改善中":n[12].consistencyAnalysis.trendAnalysis==="declining"?"📉 低下中":"➡️ 安定",L,K,z,Q,te,ce="一貫性分析:",ve,Ce=n[12].consistencyAnalysis.trendAnalysis==="improving"?"継続練習により確実に向上しています。":n[12].consistencyAnalysis.trendAnalysis==="declining"?"練習環境の見直しで改善が期待できます。":"安定したパフォーマンスを維持できています。",ye;return{c(){e=E("div"),t=E("h4"),t.textContent=s,r=x(),i=E("div"),o=E("div"),a=E("span"),a.textContent=l,c=x(),u=E("span"),f=P(h),d=P("%"),m=x(),_=E("div"),g=E("span"),g.textContent=y,b=x(),k=E("span"),T=P(I),C=P(`点（補正前）/ 
                        `),w=P(A),D=P("点（補正後）"),M=x(),F=E("div"),q=E("span"),q.textContent=B,G=x(),Y=E("span"),L=P(U),K=x(),z=E("div"),Q=P("💡 "),te=E("strong"),te.textContent=ce,ve=P(` 
                    技術誤差を考慮すると、実際のパフォーマンスは補正前より安定しています。
                    `),ye=P(Ce),this.h()},l(me){e=N(me,"DIV",{class:!0});var be=$(e);t=N(be,"H4",{class:!0,"data-svelte-h":!0}),pe(t)!=="svelte-1bl7bfg"&&(t.textContent=s),r=V(be),i=N(be,"DIV",{class:!0});var X=$(i);o=N(X,"DIV",{class:!0});var Se=$(o);a=N(Se,"SPAN",{class:!0,"data-svelte-h":!0}),pe(a)!=="svelte-tyfq9w"&&(a.textContent=l),c=V(Se),u=N(Se,"SPAN",{class:!0});var fe=$(u);f=R(fe,h),d=R(fe,"%"),fe.forEach(v),Se.forEach(v),m=V(X),_=N(X,"DIV",{class:!0});var le=$(_);g=N(le,"SPAN",{class:!0,"data-svelte-h":!0}),pe(g)!=="svelte-1sw2ab9"&&(g.textContent=y),b=V(le),k=N(le,"SPAN",{class:!0});var ue=$(k);T=R(ue,I),C=R(ue,`点（補正前）/ 
                        `),w=R(ue,A),D=R(ue,"点（補正後）"),ue.forEach(v),le.forEach(v),M=V(X),F=N(X,"DIV",{class:!0});var De=$(F);q=N(De,"SPAN",{class:!0,"data-svelte-h":!0}),pe(q)!=="svelte-322f6c"&&(q.textContent=B),G=V(De),Y=N(De,"SPAN",{class:!0});var Oe=$(Y);L=R(Oe,U),Oe.forEach(v),De.forEach(v),X.forEach(v),K=V(be),z=N(be,"DIV",{class:!0});var se=$(z);Q=R(se,"💡 "),te=N(se,"STRONG",{"data-svelte-h":!0}),pe(te)!=="svelte-ivwxx6"&&(te.textContent=ce),ve=R(se,` 
                    技術誤差を考慮すると、実際のパフォーマンスは補正前より安定しています。
                    `),ye=R(se,Ce),se.forEach(v),be.forEach(v),this.h()},h(){S(t,"class","analysis-title svelte-ililvx"),S(a,"class","stat-label svelte-ililvx"),S(u,"class","stat-value svelte-ililvx"),S(o,"class","stat-item svelte-ililvx"),S(g,"class","stat-label svelte-ililvx"),S(k,"class","stat-value svelte-ililvx"),S(_,"class","stat-item svelte-ililvx"),S(q,"class","stat-label svelte-ililvx"),S(Y,"class","stat-value svelte-ililvx"),S(F,"class","stat-item svelte-ililvx"),S(i,"class","consistency-stats svelte-ililvx"),S(z,"class","analysis-explanation svelte-ililvx"),S(e,"class","consistency-analysis-enhanced svelte-ililvx")},m(me,be){H(me,e,be),p(e,t),p(e,r),p(e,i),p(i,o),p(o,a),p(o,c),p(o,u),p(u,f),p(u,d),p(i,m),p(i,_),p(_,g),p(_,b),p(_,k),p(k,T),p(k,C),p(k,w),p(k,D),p(i,M),p(i,F),p(F,q),p(F,G),p(F,Y),p(Y,L),p(e,K),p(e,z),p(z,Q),p(z,te),p(z,ve),p(z,ye)},p(me,be){be[0]&4096&&h!==(h=me[12].consistencyAnalysis.consistencyScore+"")&&ee(f,h),be[0]&4096&&I!==(I=me[12].consistencyAnalysis.maxVariation.raw+"")&&ee(T,I),be[0]&4096&&A!==(A=me[12].consistencyAnalysis.maxVariation.corrected+"")&&ee(w,A),be[0]&4096&&U!==(U=me[12].consistencyAnalysis.trendAnalysis==="improving"?"📈 改善中":me[12].consistencyAnalysis.trendAnalysis==="declining"?"📉 低下中":"➡️ 安定")&&ee(L,U),be[0]&4096&&Ce!==(Ce=me[12].consistencyAnalysis.trendAnalysis==="improving"?"継続練習により確実に向上しています。":me[12].consistencyAnalysis.trendAnalysis==="declining"?"練習環境の見直しで改善が期待できます。":"安定したパフォーマンスを維持できています。")&&ee(ye,Ce)},i:Et,o:Et,d(me){me&&v(e)}}}function Cc(n){let e,t,s,r;const i=[p0,d0],o=[];function a(l,c){var u;return(u=l[12])!=null&&u.comprehensiveStatistics?0:1}return t=a(n),s=o[t]=i[t](n),{c(){e=E("div"),s.c(),this.h()},l(l){e=N(l,"DIV",{class:!0});var c=$(e);s.l(c),c.forEach(v),this.h()},h(){S(e,"class","tab-panel svelte-ililvx")},m(l,c){H(l,e,c),o[t].m(e,null),r=!0},p(l,c){let u=t;t=a(l),t===u?o[t].p(l,c):(Ae(),W(o[u],1,1,()=>{o[u]=null}),Ne(),s=o[t],s?s.p(l,c):(s=o[t]=i[t](l),s.c()),O(s,1),s.m(e,null))},i(l){r||(O(s),r=!0)},o(l){W(s),r=!1},d(l){l&&v(e),o[t].d()}}}function d0(n){let e,t;return e=new O1({props:{statistics:n[7]}}),{c(){oe(e.$$.fragment)},l(s){de(e.$$.fragment,s)},m(s,r){ie(e,s,r),t=!0},p(s,r){const i={};r[0]&128&&(i.statistics=s[7]),e.$set(i)},i(s){t||(O(e.$$.fragment,s),t=!0)},o(s){W(e.$$.fragment,s),t=!1},d(s){re(e,s)}}}function p0(n){var Cr,nr,Qr;let e,t,s="📈 セッション統計（技術誤差補正版）",r,i,o,a,l=((Cr=n[1])==null?void 0:Cr.mode)==="chromatic"?"12":"8",c,u,h,f,d,m,_="総挑戦回数:",g,y,b=n[12].comprehensiveStatistics.totalAttempts+"",k,I,T=((nr=n[1])==null?void 0:nr.mode)==="chromatic"?"12":"8",C,A,w,D,M,F="成功率:",q,B,G=n[12].comprehensiveStatistics.rawSuccessRate+"",Y,U,L,K=n[12].comprehensiveStatistics.correctedSuccessRate+"",z,Q,te,ce,ve,Ce="平均スコア:",ye,me,be=n[12].comprehensiveStatistics.rawAverageScore+"",X,Se,fe,le=n[12].comprehensiveStatistics.correctedAverageScore+"",ue,De,Oe,se,ae,Me="セッション改善率:",we,Te,$e,je=n[12].comprehensiveStatistics.improvementRate+"",Je,_t,Ot,Rt,ut,Ke="⏱️ 練習効率指標",qt,Re,Xt,Ze,Yt="総練習時間:",Ct,Qt,Wt=Math.floor(n[12].comprehensiveStatistics.totalPracticeTime/60)+"",We,Ss,Xe=n[12].comprehensiveStatistics.totalPracticeTime%60+"",et,$s,Tt,Dt,Z,J="平均セッション時間:",ge,j,ne=n[12].comprehensiveStatistics.averageSessionTime+"",ke,Qe,_e,Ve,ns,Ye="最大連続正解:",kt,At,Pt=n[12].comprehensiveStatistics.maxConsecutiveCorrect+"",ds,as,Jt,Lt,Kt,Bs="最高/最低スコア:",Os,tt,ws=n[12].comprehensiveStatistics.bestSessionScore+"",Xn,Yn,Cs=n[12].comprehensiveStatistics.worstSessionScore+"",en,Fn,Qn,Rs,rs,tn="🎯 相対音感レベル診断",br,Ps,ls,Ts,Jn="技術誤差補正後レベル:",Kn,cs,ks=((Qr=n[21][n[10]])==null?void 0:Qr.name)+"",er,tr,ps,Hs=n[10]==="S"?"🏆 音楽家レベルの相対音感を達成されました！":n[10]==="A"?"🌟 優秀な音感能力です。継続練習でS級到達が期待できます。":n[10]==="B"?"💪 良好な音感基礎が確立されています。":n[10]==="C"?"🌱 基本的な音程認識ができています。":n[10]==="D"?"📚 発展途上です。継続練習が重要です。":"🌰 良いスタートです。焦らず継続することが大切です。",dn,sr,ms,Bt,sn,pn="統計分析:",Sr;function wr(ze,xe){var ht;return((ht=ze[1])==null?void 0:ht.mode)==="chromatic"?_0:m0}let nn=wr(n),_s=nn(n);return{c(){e=E("div"),t=E("h4"),t.textContent=s,r=x(),i=E("div"),o=E("h5"),a=P("📊 "),c=P(l),u=P("セッション総合結果"),h=x(),f=E("div"),d=E("div"),m=E("span"),m.textContent=_,g=x(),y=E("span"),k=P(b),I=P(`回
                          （`),C=P(T),A=P("セッション完了）"),w=x(),D=E("div"),M=E("span"),M.textContent=F,q=x(),B=E("span"),Y=P(G),U=P(`% → 
                          `),L=E("span"),z=P(K),Q=P("%"),te=x(),ce=E("div"),ve=E("span"),ve.textContent=Ce,ye=x(),me=E("span"),X=P(be),Se=P(`点 → 
                          `),fe=E("span"),ue=P(le),De=P("点"),Oe=x(),se=E("div"),ae=E("span"),ae.textContent=Me,we=x(),Te=E("span"),$e=P("+"),Je=P(je),_t=P("%"),Ot=x(),Rt=E("div"),ut=E("h5"),ut.textContent=Ke,qt=x(),Re=E("div"),Xt=E("div"),Ze=E("span"),Ze.textContent=Yt,Ct=x(),Qt=E("span"),We=P(Wt),Ss=P("時間"),et=P(Xe),$s=P("分"),Tt=x(),Dt=E("div"),Z=E("span"),Z.textContent=J,ge=x(),j=E("span"),ke=P(ne),Qe=P("分"),_e=x(),Ve=E("div"),ns=E("span"),ns.textContent=Ye,kt=x(),At=E("span"),ds=P(Pt),as=P("回"),Jt=x(),Lt=E("div"),Kt=E("span"),Kt.textContent=Bs,Os=x(),tt=E("span"),Xn=P(ws),Yn=P("点 / "),en=P(Cs),Fn=P("点"),Qn=x(),Rs=E("div"),rs=E("h5"),rs.textContent=tn,br=x(),Ps=E("div"),ls=E("div"),Ts=E("span"),Ts.textContent=Jn,Kn=x(),cs=E("span"),er=P(ks),tr=x(),ps=E("div"),dn=P(Hs),sr=x(),ms=E("div"),Bt=P("💡 "),sn=E("strong"),sn.textContent=pn,Sr=P(` 
                    技術誤差を統計的に補正することで、真の相対音感能力をより正確に評価しています。
                    `),_s.c(),this.h()},l(ze){e=N(ze,"DIV",{class:!0});var xe=$(e);t=N(xe,"H4",{class:!0,"data-svelte-h":!0}),pe(t)!=="svelte-1g2h9xs"&&(t.textContent=s),r=V(xe),i=N(xe,"DIV",{class:!0});var ht=$(i);o=N(ht,"H5",{class:!0});var rn=$(o);a=R(rn,"📊 "),c=R(rn,l),u=R(rn,"セッション総合結果"),rn.forEach(v),h=V(ht),f=N(ht,"DIV",{class:!0});var Pe=$(f);d=N(Pe,"DIV",{class:!0});var ft=$(d);m=N(ft,"SPAN",{class:!0,"data-svelte-h":!0}),pe(m)!=="svelte-sxe2ek"&&(m.textContent=_),g=V(ft),y=N(ft,"SPAN",{class:!0});var Ht=$(y);k=R(Ht,b),I=R(Ht,`回
                          （`),C=R(Ht,T),A=R(Ht,"セッション完了）"),Ht.forEach(v),ft.forEach(v),w=V(Pe),D=N(Pe,"DIV",{class:!0});var mn=$(D);M=N(mn,"SPAN",{class:!0,"data-svelte-h":!0}),pe(M)!=="svelte-1uxnlki"&&(M.textContent=F),q=V(mn),B=N(mn,"SPAN",{class:!0});var js=$(B);Y=R(js,G),U=R(js,`% → 
                          `),L=N(js,"SPAN",{class:!0});var qn=$(L);z=R(qn,K),Q=R(qn,"%"),qn.forEach(v),js.forEach(v),mn.forEach(v),te=V(Pe),ce=N(Pe,"DIV",{class:!0});var _n=$(ce);ve=N(_n,"SPAN",{class:!0,"data-svelte-h":!0}),pe(ve)!=="svelte-1rk7k5k"&&(ve.textContent=Ce),ye=V(_n),me=N(_n,"SPAN",{class:!0});var gn=$(me);X=R(gn,be),Se=R(gn,`点 → 
                          `),fe=N(gn,"SPAN",{class:!0});var vn=$(fe);ue=R(vn,le),De=R(vn,"点"),vn.forEach(v),gn.forEach(v),_n.forEach(v),Oe=V(Pe),se=N(Pe,"DIV",{class:!0});var yn=$(se);ae=N(yn,"SPAN",{class:!0,"data-svelte-h":!0}),pe(ae)!=="svelte-1f053rn"&&(ae.textContent=Me),we=V(yn),Te=N(yn,"SPAN",{class:!0});var on=$(Te);$e=R(on,"+"),Je=R(on,je),_t=R(on,"%"),on.forEach(v),yn.forEach(v),Pe.forEach(v),ht.forEach(v),Ot=V(xe),Rt=N(xe,"DIV",{class:!0});var bn=$(Rt);ut=N(bn,"H5",{class:!0,"data-svelte-h":!0}),pe(ut)!=="svelte-24iqmf"&&(ut.textContent=Ke),qt=V(bn),Re=N(bn,"DIV",{class:!0});var es=$(Re);Xt=N(es,"DIV",{class:!0});var Sn=$(Xt);Ze=N(Sn,"SPAN",{class:!0,"data-svelte-h":!0}),pe(Ze)!=="svelte-1ewa6zw"&&(Ze.textContent=Yt),Ct=V(Sn),Qt=N(Sn,"SPAN",{class:!0});var wn=$(Qt);We=R(wn,Wt),Ss=R(wn,"時間"),et=R(wn,Xe),$s=R(wn,"分"),wn.forEach(v),Sn.forEach(v),Tt=V(es),Dt=N(es,"DIV",{class:!0});var Cn=$(Dt);Z=N(Cn,"SPAN",{class:!0,"data-svelte-h":!0}),pe(Z)!=="svelte-cygwug"&&(Z.textContent=J),ge=V(Cn),j=N(Cn,"SPAN",{class:!0});var rr=$(j);ke=R(rr,ne),Qe=R(rr,"分"),rr.forEach(v),Cn.forEach(v),_e=V(es),Ve=N(es,"DIV",{class:!0});var Tn=$(Ve);ns=N(Tn,"SPAN",{class:!0,"data-svelte-h":!0}),pe(ns)!=="svelte-mwlvji"&&(ns.textContent=Ye),kt=V(Tn),At=N(Tn,"SPAN",{class:!0});var ir=$(At);ds=R(ir,Pt),as=R(ir,"回"),ir.forEach(v),Tn.forEach(v),Jt=V(es),Lt=N(es,"DIV",{class:!0});var kn=$(Lt);Kt=N(kn,"SPAN",{class:!0,"data-svelte-h":!0}),pe(Kt)!=="svelte-1yf8al"&&(Kt.textContent=Bs),Os=V(kn),tt=N(kn,"SPAN",{class:!0});var An=$(tt);Xn=R(An,ws),Yn=R(An,"点 / "),en=R(An,Cs),Fn=R(An,"点"),An.forEach(v),kn.forEach(v),es.forEach(v),bn.forEach(v),Qn=V(xe),Rs=N(xe,"DIV",{class:!0});var Nn=$(Rs);rs=N(Nn,"H5",{class:!0,"data-svelte-h":!0}),pe(rs)!=="svelte-bt3vfj"&&(rs.textContent=tn),br=V(Nn),Ps=N(Nn,"DIV",{class:!0});var As=$(Ps);ls=N(As,"DIV",{class:!0});var En=$(ls);Ts=N(En,"SPAN",{class:!0,"data-svelte-h":!0}),pe(Ts)!=="svelte-1x9is5g"&&(Ts.textContent=Jn),Kn=V(En),cs=N(En,"SPAN",{class:!0});var Tr=$(cs);er=R(Tr,ks),Tr.forEach(v),En.forEach(v),tr=V(As),ps=N(As,"DIV",{class:!0});var or=$(ps);dn=R(or,Hs),or.forEach(v),As.forEach(v),Nn.forEach(v),sr=V(xe),ms=N(xe,"DIV",{class:!0});var In=$(ms);Bt=R(In,"💡 "),sn=N(In,"STRONG",{"data-svelte-h":!0}),pe(sn)!=="svelte-1qrqo1f"&&(sn.textContent=pn),Sr=R(In,` 
                    技術誤差を統計的に補正することで、真の相対音感能力をより正確に評価しています。
                    `),_s.l(In),In.forEach(v),xe.forEach(v),this.h()},h(){S(t,"class","analysis-title svelte-ililvx"),S(o,"class","section-title svelte-ililvx"),S(m,"class","stat-label svelte-ililvx"),S(y,"class","stat-value svelte-ililvx"),S(d,"class","stat-item svelte-ililvx"),S(M,"class","stat-label svelte-ililvx"),S(L,"class","text-green-600 font-bold"),S(B,"class","stat-value svelte-ililvx"),S(D,"class","stat-item svelte-ililvx"),S(ve,"class","stat-label svelte-ililvx"),S(fe,"class","text-green-600 font-bold"),S(me,"class","stat-value svelte-ililvx"),S(ce,"class","stat-item svelte-ililvx"),S(ae,"class","stat-label svelte-ililvx"),S(Te,"class","stat-value text-blue-600 svelte-ililvx"),S(se,"class","stat-item svelte-ililvx"),S(f,"class","stats-grid svelte-ililvx"),S(i,"class","stats-section svelte-ililvx"),S(ut,"class","section-title svelte-ililvx"),S(Ze,"class","stat-label svelte-ililvx"),S(Qt,"class","stat-value svelte-ililvx"),S(Xt,"class","stat-item svelte-ililvx"),S(Z,"class","stat-label svelte-ililvx"),S(j,"class","stat-value svelte-ililvx"),S(Dt,"class","stat-item svelte-ililvx"),S(ns,"class","stat-label svelte-ililvx"),S(At,"class","stat-value svelte-ililvx"),S(Ve,"class","stat-item svelte-ililvx"),S(Kt,"class","stat-label svelte-ililvx"),S(tt,"class","stat-value svelte-ililvx"),S(Lt,"class","stat-item svelte-ililvx"),S(Re,"class","stats-grid svelte-ililvx"),S(Rt,"class","stats-section svelte-ililvx"),S(rs,"class","section-title svelte-ililvx"),S(Ts,"class","level-label svelte-ililvx"),S(cs,"class","level-value grade-indicator svelte-ililvx"),S(ls,"class","current-level svelte-ililvx"),S(ps,"class","level-description svelte-ililvx"),S(Ps,"class","level-assessment svelte-ililvx"),S(Rs,"class","stats-section svelte-ililvx"),S(ms,"class","analysis-explanation svelte-ililvx"),S(e,"class","comprehensive-statistics-enhanced svelte-ililvx")},m(ze,xe){H(ze,e,xe),p(e,t),p(e,r),p(e,i),p(i,o),p(o,a),p(o,c),p(o,u),p(i,h),p(i,f),p(f,d),p(d,m),p(d,g),p(d,y),p(y,k),p(y,I),p(y,C),p(y,A),p(f,w),p(f,D),p(D,M),p(D,q),p(D,B),p(B,Y),p(B,U),p(B,L),p(L,z),p(L,Q),p(f,te),p(f,ce),p(ce,ve),p(ce,ye),p(ce,me),p(me,X),p(me,Se),p(me,fe),p(fe,ue),p(fe,De),p(f,Oe),p(f,se),p(se,ae),p(se,we),p(se,Te),p(Te,$e),p(Te,Je),p(Te,_t),p(e,Ot),p(e,Rt),p(Rt,ut),p(Rt,qt),p(Rt,Re),p(Re,Xt),p(Xt,Ze),p(Xt,Ct),p(Xt,Qt),p(Qt,We),p(Qt,Ss),p(Qt,et),p(Qt,$s),p(Re,Tt),p(Re,Dt),p(Dt,Z),p(Dt,ge),p(Dt,j),p(j,ke),p(j,Qe),p(Re,_e),p(Re,Ve),p(Ve,ns),p(Ve,kt),p(Ve,At),p(At,ds),p(At,as),p(Re,Jt),p(Re,Lt),p(Lt,Kt),p(Lt,Os),p(Lt,tt),p(tt,Xn),p(tt,Yn),p(tt,en),p(tt,Fn),p(e,Qn),p(e,Rs),p(Rs,rs),p(Rs,br),p(Rs,Ps),p(Ps,ls),p(ls,Ts),p(ls,Kn),p(ls,cs),p(cs,er),p(Ps,tr),p(Ps,ps),p(ps,dn),p(e,sr),p(e,ms),p(ms,Bt),p(ms,sn),p(ms,Sr),_s.m(ms,null)},p(ze,xe){var ht,rn,Pe;xe[0]&2&&l!==(l=((ht=ze[1])==null?void 0:ht.mode)==="chromatic"?"12":"8")&&ee(c,l),xe[0]&4096&&b!==(b=ze[12].comprehensiveStatistics.totalAttempts+"")&&ee(k,b),xe[0]&2&&T!==(T=((rn=ze[1])==null?void 0:rn.mode)==="chromatic"?"12":"8")&&ee(C,T),xe[0]&4096&&G!==(G=ze[12].comprehensiveStatistics.rawSuccessRate+"")&&ee(Y,G),xe[0]&4096&&K!==(K=ze[12].comprehensiveStatistics.correctedSuccessRate+"")&&ee(z,K),xe[0]&4096&&be!==(be=ze[12].comprehensiveStatistics.rawAverageScore+"")&&ee(X,be),xe[0]&4096&&le!==(le=ze[12].comprehensiveStatistics.correctedAverageScore+"")&&ee(ue,le),xe[0]&4096&&je!==(je=ze[12].comprehensiveStatistics.improvementRate+"")&&ee(Je,je),xe[0]&4096&&Wt!==(Wt=Math.floor(ze[12].comprehensiveStatistics.totalPracticeTime/60)+"")&&ee(We,Wt),xe[0]&4096&&Xe!==(Xe=ze[12].comprehensiveStatistics.totalPracticeTime%60+"")&&ee(et,Xe),xe[0]&4096&&ne!==(ne=ze[12].comprehensiveStatistics.averageSessionTime+"")&&ee(ke,ne),xe[0]&4096&&Pt!==(Pt=ze[12].comprehensiveStatistics.maxConsecutiveCorrect+"")&&ee(ds,Pt),xe[0]&4096&&ws!==(ws=ze[12].comprehensiveStatistics.bestSessionScore+"")&&ee(Xn,ws),xe[0]&4096&&Cs!==(Cs=ze[12].comprehensiveStatistics.worstSessionScore+"")&&ee(en,Cs),xe[0]&1024&&ks!==(ks=((Pe=ze[21][ze[10]])==null?void 0:Pe.name)+"")&&ee(er,ks),xe[0]&1024&&Hs!==(Hs=ze[10]==="S"?"🏆 音楽家レベルの相対音感を達成されました！":ze[10]==="A"?"🌟 優秀な音感能力です。継続練習でS級到達が期待できます。":ze[10]==="B"?"💪 良好な音感基礎が確立されています。":ze[10]==="C"?"🌱 基本的な音程認識ができています。":ze[10]==="D"?"📚 発展途上です。継続練習が重要です。":"🌰 良いスタートです。焦らず継続することが大切です。")&&ee(dn,Hs),nn!==(nn=wr(ze))&&(_s.d(1),_s=nn(ze),_s&&(_s.c(),_s.m(ms,null)))},i:Et,o:Et,d(ze){ze&&v(e),_s.d()}}}function m0(n){let e;return{c(){e=P("継続練習により、さらなる向上が期待できます。")},l(t){e=R(t,"継続練習により、さらなる向上が期待できます。")},m(t,s){H(t,e,s)},d(t){t&&v(e)}}}function _0(n){let e;return{c(){e=P("12音階モードでの完了は特に高い音感能力の証明であり、音楽的な応用への準備が整っています。")},l(t){e=R(t,"12音階モードでの完了は特に高い音感能力の証明であり、音楽的な応用への準備が整っています。")},m(t,s){H(t,e,s)},d(t){t&&v(e)}}}function Tc(n){let e,t;return e=new V1({props:{scoreData:n[1]}}),{c(){oe(e.$$.fragment)},l(s){de(e.$$.fragment,s)},m(s,r){ie(e,s,r),t=!0},p(s,r){const i={};r[0]&2&&(i.scoreData=s[1]),e.$set(i)},i(s){t||(O(e.$$.fragment,s),t=!0)},o(s){W(e.$$.fragment,s),t=!1},d(s){re(e,s)}}}function kc(n){let e,t="詳細を表示",s,r;return{c(){e=E("button"),e.textContent=t,this.h()},l(i){e=N(i,"BUTTON",{class:!0,"data-svelte-h":!0}),pe(e)!=="svelte-8tgs13"&&(e.textContent=t),this.h()},h(){S(e,"class","details-toggle svelte-ililvx")},m(i,o){H(i,e,o),s||(r=vs(e,"click",n[34]),s=!0)},p:Et,d(i){i&&v(e),s=!1,r()}}}function g0(n){var T,C;let e,t,s,r,i,o,a,l,c,u,h,f,d=n[11]&&nc(n),m=n[17]&&((T=n[1])==null?void 0:T.sessionHistory)&&ic(n);const _=[t0,e0,K1],g=[];function y(A,w){var D,M,F;return((D=A[1])==null?void 0:D.mode)==="random"?0:((M=A[1])==null?void 0:M.mode)==="continuous"?1:((F=A[1])==null?void 0:F.mode)==="chromatic"?2:-1}~(i=y(n))&&(o=g[i]=_[i](n));let b=n[15]&&(n[3]||n[4].length>0||n[6]||n[7])&&mc(n),k=((C=n[1])==null?void 0:C.sessionHistory)&&n[1].sessionHistory.length>=(n[1].mode==="chromatic"?12:8)&&Tc(n),I=n[0]&&kc(n);return{c(){e=E("div"),d&&d.c(),t=x(),m&&m.c(),s=x(),r=E("div"),o&&o.c(),l=x(),b&&b.c(),c=x(),k&&k.c(),u=x(),I&&I.c(),this.h()},l(A){e=N(A,"DIV",{class:!0});var w=$(e);d&&d.l(w),t=V(w),m&&m.l(w),s=V(w),r=N(w,"DIV",{class:!0});var D=$(r);o&&o.l(D),D.forEach(v),l=V(w),b&&b.l(w),c=V(w),k&&k.l(w),u=V(w),I&&I.l(w),w.forEach(v),this.h()},h(){S(r,"class","mode-summary svelte-ililvx"),S(e,"class",h="unified-score-result "+n[2]+" svelte-ililvx")},m(A,w){H(A,e,w),d&&d.m(e,null),p(e,t),m&&m.m(e,null),p(e,s),p(e,r),~i&&g[i].m(r,null),p(e,l),b&&b.m(e,null),p(e,c),k&&k.m(e,null),p(e,u),I&&I.m(e,null),f=!0},p(A,w){var M,F;A[11]?d?(d.p(A,w),w[0]&2048&&O(d,1)):(d=nc(A),d.c(),O(d,1),d.m(e,t)):d&&(Ae(),W(d,1,1,()=>{d=null}),Ne()),A[17]&&((M=A[1])!=null&&M.sessionHistory)?m?(m.p(A,w),w[0]&131074&&O(m,1)):(m=ic(A),m.c(),O(m,1),m.m(e,s)):m&&(m.d(1),m=null);let D=i;i=y(A),i===D?~i&&g[i].p(A,w):(o&&(Ae(),W(g[D],1,1,()=>{g[D]=null}),Ne()),~i?(o=g[i],o?o.p(A,w):(o=g[i]=_[i](A),o.c()),O(o,1),o.m(r,null)):o=null),A[15]&&(A[3]||A[4].length>0||A[6]||A[7])?b?(b.p(A,w),w[0]&32984&&O(b,1)):(b=mc(A),b.c(),O(b,1),b.m(e,c)):b&&(Ae(),W(b,1,1,()=>{b=null}),Ne()),(F=A[1])!=null&&F.sessionHistory&&A[1].sessionHistory.length>=(A[1].mode==="chromatic"?12:8)?k?(k.p(A,w),w[0]&2&&O(k,1)):(k=Tc(A),k.c(),O(k,1),k.m(e,u)):k&&(Ae(),W(k,1,1,()=>{k=null}),Ne()),A[0]?I?I.p(A,w):(I=kc(A),I.c(),I.m(e,null)):I&&(I.d(1),I=null),(!f||w[0]&4&&h!==(h="unified-score-result "+A[2]+" svelte-ililvx"))&&S(e,"class",h)},i(A){f||(O(d),O(m),O(o),A&&(a||Ds(()=>{a=Fs(r,Hr,{y:20,duration:500,delay:800}),a.start()})),O(b),O(k),f=!0)},o(A){W(d),W(o),W(b),W(k),f=!1},d(A){A&&v(e),d&&d.d(),m&&m.d(),~i&&g[i].d(),b&&b.d(),k&&k.d(),I&&I.d()}}}function v0(n){const e=[];return n.forEach(t=>{t.noteResults&&t.noteResults.forEach(s=>{s.cents!==null&&s.cents!==void 0&&!isNaN(s.cents)&&e.push(Math.abs(s.cents))})}),e}function y0(){return{technicalErrorRate:0,robustAccuracy:0,confidenceLevel:"low",outlierCount:0,totalMeasurements:0,averageError:0,measurement:"insufficient_data"}}function b0(n){const e=n.reduce((r,i)=>r+i,0)/n.length,t=n.reduce((r,i)=>r+Math.pow(i-e,2),0)/n.length,s=Math.sqrt(t);return{mean:e,variance:t,stdDev:s}}function S0(n,e){const t=e.mean+3*e.stdDev,s=n.filter(r=>r>t);return{threshold:t,data:s,count:s.length,rate:s.length/n.length}}function w0(n,e){const t=n.filter(i=>i<=e.threshold),s=t.length>0?t.reduce((i,o)=>i+o,0)/t.length:0,r=Math.max(0,100-s);return{mean:s,accuracy:r,cleanDataCount:t.length}}function C0(n,e){return n>=.5&&e<=.2?"high":n>=.25&&e<=.4?"medium":"low"}function T0(n){const e={};return["unison","minor_second","major_second","minor_third","major_third","perfect_fourth","tritone","perfect_fifth","minor_sixth","major_sixth","minor_seventh","major_seventh","octave"].forEach(s=>{const r=[];if(n.forEach(i=>{i.noteResults&&i.noteResults.forEach(o=>{o.intervalType===s&&o.cents!==null&&r.push({cents:Math.abs(o.cents),correct:o.correct})})}),r.length>0){const i=r.filter(l=>l.correct).length,o=r.reduce((l,c)=>l+c.cents,0)/r.length,a=Math.round(o);e[s]={mastery:Math.round(i/r.length*100),attempts:r.length,technicalErrorRate:a,trueAccuracy:Math.max(0,Math.round(100-o)),averageError:Math.round(o*10)/10}}}),e}function k0(n,e,t){const s=n.map(d=>d.score||0),r=n.map((d,m)=>{const _=[];return d.noteResults&&d.noteResults.forEach(g=>{g.cents!==null&&_.push(Math.abs(g.cents))}),_.length>0?Math.round(_.reduce((g,y)=>g+y,0)/_.length):e.mean}),i=s.map((d,m)=>{const _=Math.max(0,(e.mean-r[m])/2);return Math.min(100,d+_)}),o=i.slice(0,Math.floor(i.length/2)),a=i.slice(Math.floor(i.length/2)),l=o.reduce((d,m)=>d+m,0)/o.length,c=a.reduce((d,m)=>d+m,0)/a.length;let u="stable";c>l+5?u="improving":c<l-5&&(u="declining");const h=i.reduce((d,m)=>{const _=i.reduce((g,y)=>g+y,0)/i.length;return d+Math.pow(m-_,2)},0)/i.length,f=Math.max(0,100-Math.sqrt(h));return{sessionScores:s,technicalErrorPattern:r,correctedScores:i,trendAnalysis:u,consistencyScore:Math.round(f*10)/10,maxVariation:{raw:Math.max(...s)-Math.min(...s),corrected:Math.max(...i)-Math.min(...i)}}}function A0(n,e,t){const s=e.length,r=n.reduce((h,f)=>h+(f.noteResults?f.noteResults.filter(d=>d.correct).length:0),0)/s*100,i=Math.min(100,r*1.15),o=n.map(h=>h.score||0),a=o.reduce((h,f)=>h+f,0)/o.length,l=Math.min(100,a+(t.accuracy-a)*.3),c=n.reduce((h,f)=>h+(f.duration||0),0),u=Math.max(...n.map(h=>h.streakCount||0));return{totalAttempts:s,rawSuccessRate:Math.round(r*10)/10,correctedSuccessRate:Math.round(i*10)/10,rawAverageScore:Math.round(a*10)/10,correctedAverageScore:Math.round(l*10)/10,bestSessionScore:Math.max(...o),worstSessionScore:Math.min(...o),totalPracticeTime:c,averageSessionTime:Math.round(c/n.length),maxConsecutiveCorrect:u,improvementRate:o.length>1?Math.round((o[o.length-1]-o[0])/o[0]*100):0}}function N0(n,e,t){let s,r,i,o,a,l,c,u,h,{scoreData:f=null}=e,{showDetails:d=!1}=e,{className:m=""}=e,{currentScoreData:_=null}=e,{intervalData:g=[]}=e,{consistencyData:y=[]}=e,{feedbackData:b=null}=e,{sessionStatistics:k=null}=e,I="technical";const T={excellent:{name:"優秀",icon:Or,range:"±15¢以内",color:"text-yellow-500",bgColor:"#fffbeb",borderColor:"#fbbf24"},good:{name:"良好",icon:$r,range:"±25¢以内",color:"text-green-500",bgColor:"#ecfdf5",borderColor:"#10b981"},pass:{name:"合格",icon:Ro,range:"±40¢以内",color:"text-blue-500",bgColor:"#eff6ff",borderColor:"#3b82f6"},needWork:{name:"要練習",icon:Jc,range:"±41¢以上",color:"text-red-500",bgColor:"#fef2f2",borderColor:"#ef4444"},notMeasured:{name:"測定不可",icon:Xs,range:"音声未検出",color:"text-gray-500",bgColor:"#f9fafb",borderColor:"#9ca3af"}},C={S:{name:"S級マスター",icon:Or,color:"text-purple-500",bgColor:"#faf5ff",borderColor:"#8b5cf6",description:"完璧な演奏です！"},A:{name:"A級エキスパート",icon:rf,color:"text-yellow-500",bgColor:"#fffbeb",borderColor:"#f59e0b",description:"素晴らしい精度です！"},B:{name:"B級プロフィシエント",icon:$r,color:"text-green-500",bgColor:"#ecfdf5",borderColor:"#10b981",description:"良い調子です！"},C:{name:"C級アドバンス",icon:Vh,color:"text-blue-500",bgColor:"#eff6ff",borderColor:"#3b82f6",description:"着実に上達しています"},D:{name:"D級ビギナー",icon:Oo,color:"text-orange-500",bgColor:"#fff7ed",borderColor:"#f97316",description:"練習を続けましょう"},E:{name:"E級スターター",icon:tu,color:"text-red-500",bgColor:"#fef2f2",borderColor:"#ef4444",description:"基礎から頑張りましょう"}},A=$n(0,{duration:600,easing:an});Ut(n,A,X=>t(19,h=X));const w=$n(0,{duration:300,easing:an});Ut(n,w,X=>t(18,u=X));let D=0,M=0,F=!1;function q(X){t(13,I=X)}const B={random:{name:"ランダム基音モード",maxSessions:8,notesPerSession:8,totalNotes:64,scaleType:"diatonic",difficulty:"basic",evaluationFocus:"相対音感基礎"},continuous:{name:"連続チャレンジモード",maxSessions:8,notesPerSession:8,totalNotes:64,scaleType:"diatonic",difficulty:"intermediate",evaluationFocus:"持続的集中力"},chromatic:{name:"12音階モード",maxSessions:12,notesPerSession:12,totalNotes:144,scaleType:"chromatic",difficulty:"advanced",evaluationFocus:"半音階精密認識"}};function G(X){return{minDataThreshold:(B[X]||B.random).notesPerSession,mediumDataRatio:.25,highDataRatio:.5,completionThreshold:.8,masteryThreshold:1,basicPrecisionFactor:1,enhancedPrecisionFactor:X==="chromatic"?1.2:1.1,masteryBonus:X==="chromatic"?1.3:1.2}}function Y(X,Se){const fe=G(Se),le=B[Se]||B.random,ue=v0(X),De=ue.length/le.totalNotes,Oe=X.length/le.maxSessions;if(ue.length<fe.minDataThreshold)return y0();const se=b0(ue),ae=S0(ue,se),Me=w0(ue,ae),we=C0(De,ae.rate),Te=U(Me.accuracy,Se,Oe,we),$e=K(X,ue,se,ae,Me,we);return{totalMeasurements:ue.length,averageError:Math.round(Me.mean),technicalErrorRate:Math.round(se.stdDev/50*100),confidenceLevel:we,outlierCount:ae.count,outlierRate:ae.rate,robustAccuracy:Math.round(Te),correctionFactor:L(Se,Oe,we),measurement:"complete",analysisMode:Se,progressRatio:Oe,dataCompleteness:De,technicalAnalysis:$e.technicalAnalysis,intervalAnalysis:$e.intervalAnalysis,consistencyAnalysis:$e.consistencyAnalysis,comprehensiveStatistics:$e.comprehensiveStatistics}}function U(X,Se,fe,le){const ue=G(Se);let De=X;const Oe={high:1.1,medium:1.05,low:1}[le];return De*=Oe,fe>=ue.completionThreshold&&(De*=ue.enhancedPrecisionFactor),fe>=ue.masteryThreshold&&(De*=ue.masteryBonus),Se==="chromatic"&&fe>=.8&&(De*=1.15),Math.min(De,100)}function L(X,Se,fe){const le=G(X);let ue=1;return fe==="high"?ue*=1.1:fe==="medium"&&(ue*=1.05),Se>=le.completionThreshold&&(ue*=le.enhancedPrecisionFactor),Se>=le.masteryThreshold&&(ue*=le.masteryBonus),ue}function K(X,Se,fe,le,ue,De){const Oe={standardDeviation:Math.round(fe.stdDev*10)/10,outlierCount:le.count,outlierPercentage:Math.round(le.rate*1e3)/10,confidenceInterval:{lower:Math.round((ue.accuracy-fe.stdDev)*10)/10,upper:Math.round((ue.accuracy+fe.stdDev)*10)/10},errorDistribution:{highPrecision:Se.filter(we=>we<=10).length,mediumPrecision:Se.filter(we=>we<=20).length,lowPrecision:Se.filter(we=>we<=50).length,anomalies:le.count},correctedEvaluation:{rawAverage:Math.round(fe.mean*10)/10,correctedAverage:Math.round(ue.mean*10)/10,confidenceLevel:De==="high"?94.2:De==="medium"?87.5:72.1}},se=T0(X),ae=k0(X,fe),Me=A0(X,Se,ue);return{technicalAnalysis:Oe,intervalAnalysis:se,consistencyAnalysis:ae,comprehensiveStatistics:Me}}const z={session_1_3:"データ蓄積中... より正確な評価のために練習を続けましょう",session_4_7:"統計分析開始！ 技術誤差を考慮した評価を表示しています",session_8:"8セッション完走！ あなたの真の音感能力が明らかになりました",session_12:"🎹 12音階マスター認定！ 半音階の精密な音感能力を証明しました",random_complete:"ランダム基音モード完走！ 基礎的な相対音感能力を習得",continuous_complete:"連続チャレンジ完走！ 持続的な集中力と音感の両立達成",chromatic_complete:"🏆 12音階モード制覇！ 真の音感マスターの称号を獲得"};Yc(()=>{w.set(1),setTimeout(()=>{A.set(1.2),setTimeout(()=>{A.set(1)},200)},100)});const Q=X=>{console.log("🎯 [UnifiedScore] Session bar clicked:",X),t(9,F=!0),t(8,D=X)},te=X=>{console.log("🎭 [UnifiedScore] Session change received:",X.detail.index),t(9,F=!0),t(8,D=X.detail.index)},ce=X=>{console.log("🎯 [UnifiedScore] Session bar clicked:",X),t(9,F=!0),t(8,D=X)},ve=X=>{console.log("🎭 [UnifiedScore] Session change received:",X.detail.index),t(9,F=!0),t(8,D=X.detail.index)},Ce=X=>{console.log("🎯 [UnifiedScore] Session bar clicked:",X),t(9,F=!0),t(8,D=X)},ye=X=>{console.log("🎭 [UnifiedScore] Session change received:",X.detail.index),t(9,F=!0),t(8,D=X.detail.index)},me=X=>q(X.id),be=()=>t(0,d=!d);return n.$$set=X=>{"scoreData"in X&&t(1,f=X.scoreData),"showDetails"in X&&t(0,d=X.showDetails),"className"in X&&t(2,m=X.className),"currentScoreData"in X&&t(3,_=X.currentScoreData),"intervalData"in X&&t(4,g=X.intervalData),"consistencyData"in X&&t(5,y=X.consistencyData),"feedbackData"in X&&t(6,b=X.feedbackData),"sessionStatistics"in X&&t(7,k=X.sessionStatistics)},n.$$.update=()=>{var X,Se;if(n.$$.dirty[0]&67109634&&f!=null&&f.sessionHistory){const fe=f.sessionHistory.length;if(console.log("🔍 [UnifiedScore] Session history update:",{lastSessionCount:M,currentSessionCount:fe,currentSessionIndex:D,preventAutoMove:F,sessionHistory:f.sessionHistory.length}),M===0||fe>M)if(console.log("🔍 [UnifiedScore] New session detected. Evaluating auto-move..."),F)console.log("🔧 [UnifiedScore] Preventing auto-move due to user interaction"),t(9,F=!1);else if(D>=M-1){const ue=Math.max(0,fe-1);console.log("🔧 [UnifiedScore] Auto-moving to latest session:",ue),t(8,D=ue)}else console.log("🔧 [UnifiedScore] User viewing older session, keeping position:",D);t(26,M=fe)}n.$$.dirty[0]&2&&t(12,s=(()=>{if(!(f!=null&&f.sessionHistory))return null;const fe=(f==null?void 0:f.mode)||"random",le=fe==="chromatic"?12:8;if(f.sessionHistory.length<le)return null;const ue=Y(f.sessionHistory,fe);return ue.measurement==="complete"?ue:null})()),n.$$.dirty[0]&4098&&t(10,r=(()=>{if(!(f!=null&&f.sessionHistory)||f.sessionHistory.length===0)return"E";const fe=s||Y(f.sessionHistory,(f==null?void 0:f.mode)||"random"),le=f.sessionHistory.map(Te=>Te.grade),ue=le.filter(Te=>Te==="excellent").length,De=le.filter(Te=>Te==="good").length,Oe=le.filter(Te=>Te==="pass").length,se=ue+De+Oe,ae=f.sessionHistory.length;let Me=ue/ae,we=se/ae;return fe.measurement==="complete"&&fe.confidenceLevel!=="low"&&(Me*=fe.correctionFactor,we*=fe.correctionFactor,Me=Math.min(Me,1),we=Math.min(we,1)),Me>=.9&&we>=.95?"S":Me>=.7&&we>=.85?"A":Me>=.5&&we>=.75?"B":we>=.65?"C":we>=.5?"D":"E"})()),n.$$.dirty[0]&2&&Y((f==null?void 0:f.sessionHistory)||[],(f==null?void 0:f.mode)||"random"),n.$$.dirty[0]&2&&t(17,i=(()=>{if(!(f!=null&&f.sessionHistory))return null;const fe=f.sessionHistory.length,le=f.mode||"random",ue=B[le].maxSessions;return fe>=ue?z[`${le}_complete`]:le==="chromatic"&&fe===12?z.session_12:fe===8?z.session_8:fe>=4&&fe<=7?z.session_4_7:fe>=1&&fe<=3?z.session_1_3:null})()),n.$$.dirty[0]&2&&(()=>{if(!(f!=null&&f.sessionHistory)||f.sessionHistory.length===0)return{totalSessions:0,excellentCount:0,goodCount:0,passCount:0,excellentRate:0,goodRate:0};const fe=f.sessionHistory.map(ae=>ae.grade),le=fe.filter(ae=>ae==="excellent").length,ue=fe.filter(ae=>ae==="good").length,De=fe.filter(ae=>ae==="pass").length,Oe=le+ue+De,se=f.sessionHistory.length;return{totalSessions:se,excellentCount:le,goodCount:ue,passCount:De,excellentRate:Math.round(le/se*100),goodRate:Math.round(Oe/se*100)}})(),n.$$.dirty[0]&2&&t(11,o=(f==null?void 0:f.sessionHistory)&&f.sessionHistory.length>=(f.mode==="chromatic"?12:8)),n.$$.dirty[0]&3074&&t(16,a=o?C[r]:T[((Se=(X=f==null?void 0:f.sessionHistory)==null?void 0:X[f.sessionHistory.length-1])==null?void 0:Se.grade)||"needWork"]),n.$$.dirty[0]&2&&t(15,l=(f==null?void 0:f.sessionHistory)&&f.sessionHistory.length>=8)},t(14,c=[{id:"technical",label:"🔬 技術分析"},{id:"intervals",label:"🎵 音程別進捗"},{id:"consistency",label:"📊 一貫性グラフ"},{id:"statistics",label:"📈 セッション統計"}]),[d,f,m,_,g,y,b,k,D,F,r,o,s,I,c,l,a,i,u,h,T,C,A,w,q,B,M,Q,te,ce,ve,Ce,ye,me,be]}class ch extends Be{constructor(e){super(),He(this,e,N0,g0,Le,{scoreData:1,showDetails:0,className:2,currentScoreData:3,intervalData:4,consistencyData:5,feedbackData:6,sessionStatistics:7},null,[-1,-1])}}function Ac(n,e,t){const s=n.slice();return s[7]=e[t],s}function Nc(n){let e,t,s,r,i=n[7].label+"",o,a,l,c,u,h;var f=n[7].icon;function d(_,g){return{props:{size:"16"}}}f&&(t=St(f,d()));function m(){return n[5](n[7])}return{c(){e=E("button"),t&&oe(t.$$.fragment),s=x(),r=E("span"),o=P(i),a=x(),this.h()},l(_){e=N(_,"BUTTON",{class:!0});var g=$(e);t&&de(t.$$.fragment,g),s=V(g),r=N(g,"SPAN",{});var y=$(r);o=R(y,i),y.forEach(v),a=V(g),g.forEach(v),this.h()},h(){S(e,"class",l="action-btn "+n[7].type+" svelte-1tfeplg")},m(_,g){H(_,e,g),t&&ie(t,e,null),p(e,s),p(e,r),p(r,o),p(e,a),c=!0,u||(h=vs(e,"click",m),u=!0)},p(_,g){if(n=_,g&4&&f!==(f=n[7].icon)){if(t){Ae();const y=t;W(y.$$.fragment,1,0,()=>{re(y,1)}),Ne()}f?(t=St(f,d()),oe(t.$$.fragment),O(t.$$.fragment,1),ie(t,e,s)):t=null}(!c||g&4)&&i!==(i=n[7].label+"")&&ee(o,i),(!c||g&4&&l!==(l="action-btn "+n[7].type+" svelte-1tfeplg"))&&S(e,"class",l)},i(_){c||(t&&O(t.$$.fragment,_),c=!0)},o(_){t&&W(t.$$.fragment,_),c=!1},d(_){_&&v(e),t&&re(t),u=!1,h()}}}function E0(n){let e,t,s,r,i=Ie(n[2]),o=[];for(let l=0;l<i.length;l+=1)o[l]=Nc(Ac(n,i,l));const a=l=>W(o[l],1,1,()=>{o[l]=null});return{c(){e=E("div"),t=E("div");for(let l=0;l<o.length;l+=1)o[l].c();this.h()},l(l){e=N(l,"DIV",{class:!0});var c=$(e);t=N(c,"DIV",{class:!0});var u=$(t);for(let h=0;h<o.length;h+=1)o[h].l(u);u.forEach(v),c.forEach(v),this.h()},h(){S(t,"class","action-buttons svelte-1tfeplg"),S(e,"class",s="action-buttons-container "+n[0]+" "+n[1]+" svelte-1tfeplg")},m(l,c){H(l,e,c),p(e,t);for(let u=0;u<o.length;u+=1)o[u]&&o[u].m(t,null);r=!0},p(l,[c]){if(c&12){i=Ie(l[2]);let u;for(u=0;u<i.length;u+=1){const h=Ac(l,i,u);o[u]?(o[u].p(h,c),O(o[u],1)):(o[u]=Nc(h),o[u].c(),O(o[u],1),o[u].m(t,null))}for(Ae(),u=i.length;u<o.length;u+=1)a(u);Ne()}(!r||c&3&&s!==(s="action-buttons-container "+l[0]+" "+l[1]+" svelte-1tfeplg"))&&S(e,"class",s)},i(l){if(!r){for(let c=0;c<i.length;c+=1)O(o[c]);r=!0}},o(l){o=o.filter(Boolean);for(let c=0;c<o.length;c+=1)W(o[c]);r=!1},d(l){l&&v(e),dt(o,l)}}}function I0(n,e,t){let s;const r=Xc();let{isCompleted:i=!1}=e,{position:o="bottom"}=e,{className:a=""}=e;function l(u){r("action",{type:u})}const c=u=>l(u.type);return n.$$set=u=>{"isCompleted"in u&&t(4,i=u.isCompleted),"position"in u&&t(0,o=u.position),"className"in u&&t(1,a=u.className)},n.$$.update=()=>{n.$$.dirty&16&&t(2,s=i?[{type:"restart",label:"初めから挑戦",icon:$a},{type:"home",label:"ホーム",icon:Tf}]:[{type:"same",label:"同じ基音で再挑戦",icon:$a},{type:"different",label:"違う基音で開始",icon:Bf}])},[o,a,s,l,i,c]}class uh extends Be{constructor(e){super(),He(this,e,I0,E0,Le,{isCompleted:4,position:0,className:1})}}const ki={TRAINING_PROGRESS:"pitch-training-random-progress-v1",SETTINGS:"pitch-training-settings-v1",TEMP_SESSION:"pitch-training-temp-session-v1"},Jr={LAST_BACKUP:"pitch-training-backup-timestamp",PROGRESS_BACKUP:"pitch-training-progress-backup"},ar=["C4","D4","E4","F4","G4","A4","B4","C5","D5","E5"],D0={C4:"ド（低）",D4:"レ（低）",E4:"ミ（低）",F4:"ファ（低）",G4:"ソ（低）",A4:"ラ（中）",B4:"シ（中）",C5:"ド（高）",D5:"レ（高）",E5:"ミ（高）"},_o="1.0.0",Us={EXCELLENT:15,GOOD:25,PASS:40,S_GRADE:{excellentRatio:.9,goodPlusRatio:.95},A_GRADE:{excellentRatio:.7,goodPlusRatio:.85},B_GRADE:{excellentRatio:.5,goodPlusRatio:.75},C_GRADE:{goodPlusRatio:.65},D_GRADE:{goodPlusRatio:.5}};function M0(n){return typeof n=="object"&&typeof n.sessionId=="number"&&typeof n.baseNote=="string"&&typeof n.grade=="string"&&typeof n.accuracy=="number"&&Array.isArray(n.noteResults)&&typeof n.isCompleted=="boolean"}function go(n){return typeof n=="object"&&n.mode==="random"&&typeof n.version=="string"&&Array.isArray(n.sessionHistory)&&typeof n.currentSessionId=="number"&&typeof n.isCompleted=="boolean"}const lr=class lr{constructor(){ho(this,"progress",null)}static getInstance(){return lr.instance||(lr.instance=new lr),lr.instance}loadProgress(){try{const e=localStorage.getItem(ki.TRAINING_PROGRESS);if(!e)return this.progress=null,null;const t=JSON.parse(e);if(!go(t))return console.warn("[SessionStorageManager] Invalid progress data, creating backup"),this.createBackup(t),this.progress=null,null;if(t.version!==_o){console.info("[SessionStorageManager] Data version mismatch, attempting migration");const s=this.migrateDataVersion(t);return s?(this.saveProgress(s),this.progress=s,s):(this.progress=null,null)}return this.progress=t,this.progress}catch(e){return console.error("[SessionStorageManager] Error loading progress:",e),this.progress=null,null}}saveProgress(e){try{return go(e)?(e.lastUpdatedAt=new Date().toISOString(),this.progress&&this.createBackup(this.progress),localStorage.setItem(ki.TRAINING_PROGRESS,JSON.stringify(e)),this.progress=e,console.info("[SessionStorageManager] Progress saved successfully"),!0):(console.error("[SessionStorageManager] Invalid progress data for save"),!1)}catch(t){if(console.error("[SessionStorageManager] Error saving progress:",t),t.name==="QuotaExceededError"){this.clearBackups();try{return localStorage.setItem(ki.TRAINING_PROGRESS,JSON.stringify(e)),this.progress=e,console.info("[SessionStorageManager] Progress saved after backup cleanup"),!0}catch(s){console.error("[SessionStorageManager] Failed to save even after cleanup:",s)}}return!1}}resetProgress(){try{return this.progress&&this.createBackup(this.progress),localStorage.removeItem(ki.TRAINING_PROGRESS),this.progress=null,console.info("[SessionStorageManager] Progress reset successfully"),!0}catch(e){return console.error("[SessionStorageManager] Error resetting progress:",e),!1}}createNewProgress(){const e={mode:"random",version:_o,createdAt:new Date().toISOString(),lastUpdatedAt:new Date().toISOString(),sessionHistory:[],currentSessionId:1,isCompleted:!1,availableBaseNotes:[...ar],usedBaseNotes:[]};return this.progress=e,this.saveProgress(e),e}addSessionResult(e){try{let t=this.progress||this.loadProgress();return t||(t=this.createNewProgress()),M0(e)?(e.sessionId!==t.currentSessionId&&(console.warn("[SessionStorageManager] Session ID mismatch"),e.sessionId=t.currentSessionId),t.sessionHistory.push(e),t.usedBaseNotes.includes(e.baseNote)||t.usedBaseNotes.push(e.baseNote),t.sessionHistory.length>=8?(t.isCompleted=!0,t.overallGrade=this.calculateOverallGrade(t.sessionHistory),t.overallAccuracy=this.calculateOverallAccuracy(t.sessionHistory),t.totalPlayTime=t.sessionHistory.reduce((s,r)=>s+r.duration,0),console.info("[SessionStorageManager] 8セッション完了: isCompleted=true, currentSessionId維持")):(t.currentSessionId=t.currentSessionId+1,console.info(`[SessionStorageManager] 次セッションに進行: ${t.currentSessionId}`)),this.saveProgress(t)):(console.error("[SessionStorageManager] Invalid session result"),!1)}catch(t){return console.error("[SessionStorageManager] Error adding session result:",t),!1}}getCurrentSessionId(){const e=this.progress||this.loadProgress();return(e==null?void 0:e.currentSessionId)||1}getNextBaseNote(){const e=this.progress||this.loadProgress();if(!e)return ar[Math.floor(Math.random()*ar.length)];const t=ar.filter(s=>!e.usedBaseNotes.includes(s));return t.length===0?ar[Math.floor(Math.random()*ar.length)]:t[Math.floor(Math.random()*t.length)]}isCompleted(){const e=this.progress||this.loadProgress();return(e==null?void 0:e.isCompleted)||!1}generateUnifiedScoreData(){const e=this.progress||this.loadProgress();return e?{mode:"random",sessionHistory:e.sessionHistory.map(t=>({sessionId:t.sessionId,grade:t.grade,accuracy:t.accuracy,baseNote:t.baseNote,baseName:t.baseName,noteResults:t.noteResults,completedAt:t.completedAt})),overallGrade:e.overallGrade,overallAccuracy:e.overallAccuracy,isCompleted:e.isCompleted,totalSessions:e.sessionHistory.length,targetSessions:8}:null}calculateOverallGrade(e){if(e.length<8)return"E";const t=e.reduce((o,a)=>(o[a.grade]=(o[a.grade]||0)+1,o),{excellent:0,good:0,pass:0,needWork:0}),s=e.length,r=t.excellent/s,i=(t.excellent+t.good+t.pass)/s;return r>=Us.S_GRADE.excellentRatio&&i>=Us.S_GRADE.goodPlusRatio?"S":r>=Us.A_GRADE.excellentRatio&&i>=Us.A_GRADE.goodPlusRatio?"A":r>=Us.B_GRADE.excellentRatio&&i>=Us.B_GRADE.goodPlusRatio?"B":i>=Us.C_GRADE.goodPlusRatio?"C":i>=Us.D_GRADE.goodPlusRatio?"D":"E"}calculateOverallAccuracy(e){if(e.length===0)return 0;const t=e.reduce((s,r)=>s+r.accuracy,0);return Math.round(t/e.length)}calculateSessionGrade(e){const t=e.reduce((i,o)=>{const a=this.calculateNoteGrade(o.cents);return i[a]=(i[a]||0)+1,a!=="notMeasured"&&(i.totalError+=Math.abs(o.cents||0),i.measuredCount+=1),i},{excellent:0,good:0,pass:0,needWork:0,notMeasured:0,totalError:0,measuredCount:0}),s=t.measuredCount>0?t.totalError/t.measuredCount:100,r=t.excellent+t.good+t.pass;return t.notMeasured>3||t.needWork>2||t.measuredCount===0?"needWork":s<=20&&t.excellent>=6?"excellent":s<=30&&r>=7?"good":r>=5?"pass":"needWork"}calculateNoteGrade(e){if(e==null||isNaN(e))return"notMeasured";const t=Math.abs(e);return t<=Us.EXCELLENT?"excellent":t<=Us.GOOD?"good":t<=Us.PASS?"pass":"needWork"}createBackup(e){try{const t={timestamp:new Date().toISOString(),data:e};return localStorage.setItem(Jr.PROGRESS_BACKUP,JSON.stringify(t)),localStorage.setItem(Jr.LAST_BACKUP,t.timestamp),!0}catch(t){return console.warn("[SessionStorageManager] Backup creation failed:",t),!1}}restoreFromBackup(){try{const e=localStorage.getItem(Jr.PROGRESS_BACKUP);if(!e)return null;const t=JSON.parse(e);return go(t.data)?(console.info("[SessionStorageManager] Restored from backup:",t.timestamp),t.data):null}catch(e){return console.error("[SessionStorageManager] Restore failed:",e),null}}clearBackups(){try{localStorage.removeItem(Jr.PROGRESS_BACKUP),localStorage.removeItem(Jr.LAST_BACKUP)}catch(e){console.warn("[SessionStorageManager] Backup cleanup failed:",e)}}migrateDataVersion(e){try{return!e.version||e.version==="1.0.0"?{...e,version:_o,availableBaseNotes:e.availableBaseNotes||[...ar],usedBaseNotes:e.usedBaseNotes||[],lastUpdatedAt:e.lastUpdatedAt||new Date().toISOString()}:(console.warn("[SessionStorageManager] Unknown data version:",e.version),null)}catch(t){return console.error("[SessionStorageManager] Migration failed:",t),null}}getProgress(){return this.progress}getStorageInfo(){try{const e="storage-test",t="x".repeat(1024);return localStorage.setItem(e,t),localStorage.removeItem(e),{used:JSON.stringify(localStorage).length,available:!0}}catch{return{used:-1,available:!1}}}getBaseNoteName(e){return D0[e]||e}startNewCycleIfCompleted(){const e=this.progress||this.loadProgress();if(e&&e.isCompleted&&e.sessionHistory.length>=8){console.info("[SessionStorageManager] 8セッション完了検出: 新サイクル開始");const t=this.generateUnifiedScoreData();return t&&this.createCompletedCycleBackup(t),this.createNewProgress(),console.info("[SessionStorageManager] 新サイクル開始完了: セッション1/8から再開"),!0}return!1}createCompletedCycleBackup(e){try{const t=`completed-cycle-${Date.now()}`,s={timestamp:new Date().toISOString(),cycleData:e};localStorage.setItem(t,JSON.stringify(s)),console.info("[SessionStorageManager] 完了サイクルバックアップ作成:",t)}catch(t){console.warn("[SessionStorageManager] 完了サイクルバックアップ失敗:",t)}}};ho(lr,"instance");let ri=lr;const $0=Object.freeze(Object.defineProperty({__proto__:null,SessionStorageManager:ri},Symbol.toStringTag,{value:"Module"})),ts=_r(null),dr=_r(1),pr=_r("C4"),mr=_r("ド（低）"),Hi=_r(!1),Mo=_r(null),hh=cn(ts,n=>(n==null?void 0:n.isCompleted)||!1),ya=cn(ts,n=>(n==null?void 0:n.sessionHistory)||[]);cn(ts,n=>(n==null?void 0:n.overallGrade)||null);cn(ts,n=>(n==null?void 0:n.overallAccuracy)||0);cn(ts,n=>(n==null?void 0:n.totalPlayTime)||0);cn(ts,n=>(n==null?void 0:n.usedBaseNotes)||[]);const fh=cn(ts,n=>n?ri.getInstance().generateUnifiedScoreData():null);cn(ts,n=>n?Math.min(n.sessionHistory.length/8*100,100):0);const dh=cn(ts,n=>n?Math.max(8-n.sessionHistory.length,0):8);cn(ya,n=>n.length===0?null:n[n.length-1]);function lo(){return ri.getInstance()}async function co(n,e){try{return Mo.set(null),await n()}catch(t){return console.error(`[SessionStorage] ${e}:`,t),Mo.set(`${e}: ${t.message}`),null}}async function $o(){return await co(async()=>{Hi.set(!0);const n=lo(),e=n.loadProgress();if(e){ts.set(e),dr.set(e.currentSessionId);const t=n.getNextBaseNote();pr.set(t),mr.set(n.getBaseNoteName(t)),console.info("[SessionStorage] Progress loaded successfully:",{sessionCount:e.sessionHistory.length,currentSession:e.currentSessionId,isCompleted:e.isCompleted})}else{const t=n.createNewProgress();ts.set(t),dr.set(1);const s=n.getNextBaseNote();pr.set(s),mr.set(n.getBaseNoteName(s)),console.info("[SessionStorage] New progress created")}return Hi.set(!1),!0},"Failed to load progress")!==null}async function ph(n,e,t,s){return await co(async()=>{const r=lo(),i=bh(ts);if(!i)throw new Error("No progress data available");const o={sessionId:i.currentSessionId,baseNote:t,baseName:s,grade:r.calculateSessionGrade(n),accuracy:R0(n),averageError:P0(n),completedAt:new Date().toISOString(),duration:e,noteResults:n,outliers:V0(n),distribution:x0(n),isCompleted:!0},a=r.addSessionResult(o);if(a){const l=r.loadProgress();if(l){if(ts.set(l),dr.set(l.currentSessionId),!l.isCompleted){const c=r.getNextBaseNote();pr.set(c),mr.set(r.getBaseNoteName(c))}console.info("[SessionStorage] Session result saved:",{sessionId:o.sessionId,grade:o.grade,accuracy:o.accuracy,isCompleted:l.isCompleted})}}return a},"Failed to save session result")!==null}async function O0(){return await co(async()=>{const e=lo().resetProgress();return e&&(ts.set(null),dr.set(1),pr.set("C4"),mr.set("ド（低）"),console.info("[SessionStorage] Progress reset successfully")),e},"Failed to reset progress")!==null}async function Kr(){return await co(async()=>{const n=lo();if(n.startNewCycleIfCompleted()){const t=n.loadProgress();if(t){ts.set(t),dr.set(1);const s=n.getNextBaseNote();return pr.set(s),mr.set(n.getBaseNoteName(s)),console.info("[SessionStorage] 新サイクル開始: 8セッション完了から自動リセット"),!0}}return!1},"Failed to start new cycle")!==null}function R0(n){const e=n.filter(r=>r.cents!==null&&r.cents!==void 0&&!isNaN(r.cents));if(e.length===0)return 0;const s=e.reduce((r,i)=>r+Math.abs(i.cents),0)/e.length;return Math.max(0,Math.min(100,100-s/50*100))}function P0(n){const e=n.filter(s=>s.cents!==null&&s.cents!==void 0&&!isNaN(s.cents));if(e.length===0)return 100;const t=e.reduce((s,r)=>s+Math.abs(r.cents),0);return Math.round(t/e.length)}function V0(n){return n.filter(e=>e.cents!==null&&Math.abs(e.cents)>=50).map(e=>({name:e.name,cents:e.cents,severity:Math.abs(e.cents)>=100?"critical":"attention"}))}function x0(n){return n.reduce((e,t)=>{if(t.cents===null||t.cents===void 0||isNaN(t.cents))e.notMeasured++;else{const s=Math.abs(t.cents);s<=15?e.excellent++:s<=25?e.good++:s<=40?e.pass++:e.needWork++}return e},{excellent:0,good:0,pass:0,needWork:0,notMeasured:0})}const F0=Object.freeze(Object.defineProperty({__proto__:null,currentSessionId:dr,isCompleted:hh,isLoading:Hi,loadProgress:$o,nextBaseName:mr,nextBaseNote:pr,remainingSessions:dh,resetProgress:O0,saveSessionResult:ph,sessionHistory:ya,startNewCycleIfCompleted:Kr,storageError:Mo,trainingProgress:ts,unifiedScoreData:fh},Symbol.toStringTag,{value:"Module"}));function Ec(n,e,t){const s=n.slice();return s[87]=e[t],s[89]=t,s}function Ic(n,e,t){const s=n.slice();return s[90]=e[t],s}function Dc(n){var F,q,B;let e,t,s,r,i=(((F=n[19])==null?void 0:F.length)||0)+"",o,a,l,c,u,h=8-(((q=n[19])==null?void 0:q.length)||0)+"",f,d,m,_,g,y,b,k,I=Math.round((((B=n[19])==null?void 0:B.length)||0)/8*100)+"",T,C,A,w,D,M=n[0]==="results"&&Mc(n);return{c(){e=E("div"),t=E("div"),s=E("div"),r=E("span"),o=P(i),a=P("/8"),l=x(),c=E("span"),u=P("残り "),f=P(h),d=P(" セッション"),m=x(),_=E("div"),g=E("div"),y=E("div"),b=x(),k=E("span"),T=P(I),C=P("%"),A=x(),M&&M.c(),w=Gt(),this.h()},l(G){e=N(G,"DIV",{class:!0});var Y=$(e);t=N(Y,"DIV",{class:!0});var U=$(t);s=N(U,"DIV",{class:!0});var L=$(s);r=N(L,"SPAN",{class:!0});var K=$(r);o=R(K,i),a=R(K,"/8"),K.forEach(v),l=V(L),c=N(L,"SPAN",{class:!0});var z=$(c);u=R(z,"残り "),f=R(z,h),d=R(z," セッション"),z.forEach(v),L.forEach(v),m=V(U),_=N(U,"DIV",{class:!0});var Q=$(_);g=N(Q,"DIV",{class:!0});var te=$(g);y=N(te,"DIV",{class:!0,style:!0}),$(y).forEach(v),te.forEach(v),b=V(Q),k=N(Q,"SPAN",{class:!0});var ce=$(k);T=R(ce,I),C=R(ce,"%"),ce.forEach(v),Q.forEach(v),U.forEach(v),Y.forEach(v),A=V(G),M&&M.l(G),w=Gt(),this.h()},h(){var G;S(r,"class","completed-count svelte-672hso"),S(c,"class","remaining-text svelte-672hso"),S(s,"class","session-info svelte-672hso"),S(y,"class","progress-fill svelte-672hso"),st(y,"width",(((G=n[19])==null?void 0:G.length)||0)/8*100+"%"),S(g,"class","progress-bar svelte-672hso"),S(k,"class","progress-text svelte-672hso"),S(_,"class","progress-section svelte-672hso"),S(t,"class","session-status svelte-672hso"),S(e,"class","session-progress svelte-672hso")},m(G,Y){H(G,e,Y),p(e,t),p(t,s),p(s,r),p(r,o),p(r,a),p(s,l),p(s,c),p(c,u),p(c,f),p(c,d),p(t,m),p(t,_),p(_,g),p(g,y),p(_,b),p(_,k),p(k,T),p(k,C),H(G,A,Y),M&&M.m(G,Y),H(G,w,Y),D=!0},p(G,Y){var U,L,K,z;(!D||Y[0]&524288)&&i!==(i=(((U=G[19])==null?void 0:U.length)||0)+"")&&ee(o,i),(!D||Y[0]&524288)&&h!==(h=8-(((L=G[19])==null?void 0:L.length)||0)+"")&&ee(f,h),(!D||Y[0]&524288)&&st(y,"width",(((K=G[19])==null?void 0:K.length)||0)/8*100+"%"),(!D||Y[0]&524288)&&I!==(I=Math.round((((z=G[19])==null?void 0:z.length)||0)/8*100)+"")&&ee(T,I),G[0]==="results"?M?(M.p(G,Y),Y[0]&1&&O(M,1)):(M=Mc(G),M.c(),O(M,1),M.m(w.parentNode,w)):M&&(Ae(),W(M,1,1,()=>{M=null}),Ne())},i(G){D||(O(M),D=!0)},o(G){W(M),D=!1},d(G){G&&(v(e),v(A),v(w)),M&&M.d(G)}}}function Mc(n){let e,t,s;return t=new uh({props:{isCompleted:n[18],position:"top"}}),t.$on("action",n[26]),{c(){e=E("div"),oe(t.$$.fragment),this.h()},l(r){e=N(r,"DIV",{class:!0});var i=$(e);de(t.$$.fragment,i),i.forEach(v),this.h()},h(){S(e,"class","top-action-buttons svelte-672hso")},m(r,i){H(r,e,i),ie(t,e,null),s=!0},p(r,i){const o={};i[0]&262144&&(o.isCompleted=r[18]),t.$set(o)},i(r){s||(O(t.$$.fragment,r),s=!0)},o(r){W(t.$$.fragment,r),s=!1},d(r){r&&v(e),re(t)}}}function q0(n){let e,t;return e=new ii({props:{class:"error-card",$$slots:{default:[H0]},$$scope:{ctx:n}}}),{c(){oe(e.$$.fragment)},l(s){de(e.$$.fragment,s)},m(s,r){ie(e,s,r),t=!0},p(s,r){const i={};r[3]&1&&(i.$$scope={dirty:r,ctx:s}),e.$set(i)},i(s){t||(O(e.$$.fragment,s),t=!0)},o(s){W(e.$$.fragment,s),t=!1},d(s){re(e,s)}}}function W0(n){let e,t,s,r,i,o,a,l={isActive:n[1]==="granted",trainingPhase:n[0],className:"pitch-detector-content",debugMode:!0,disableHarmonicCorrection:!1};t=new Th({props:l}),n[30](t),t.$on("pitchUpdate",n[25]),t.$on("stateChange",iy),t.$on("error",oy),t.$on("microphoneHealthChange",n[27]);let c=n[0]!=="results"&&$c(n),u=n[0]!=="results"&&Vc(n),h=n[0]==="results"&&qc(n);return{c(){e=E("div"),oe(t.$$.fragment),s=x(),c&&c.c(),r=x(),u&&u.c(),i=x(),h&&h.c(),o=Gt(),this.h()},l(f){e=N(f,"DIV",{style:!0});var d=$(e);de(t.$$.fragment,d),d.forEach(v),s=V(f),c&&c.l(f),r=V(f),u&&u.l(f),i=V(f),h&&h.l(f),o=Gt(),this.h()},h(){st(e,"display","none")},m(f,d){H(f,e,d),ie(t,e,null),H(f,s,d),c&&c.m(f,d),H(f,r,d),u&&u.m(f,d),H(f,i,d),h&&h.m(f,d),H(f,o,d),a=!0},p(f,d){const m={};d[0]&2&&(m.isActive=f[1]==="granted"),d[0]&1&&(m.trainingPhase=f[0]),t.$set(m),f[0]!=="results"?c?(c.p(f,d),d[0]&1&&O(c,1)):(c=$c(f),c.c(),O(c,1),c.m(r.parentNode,r)):c&&(Ae(),W(c,1,1,()=>{c=null}),Ne()),f[0]!=="results"?u?(u.p(f,d),d[0]&1&&O(u,1)):(u=Vc(f),u.c(),O(u,1),u.m(i.parentNode,i)):u&&(Ae(),W(u,1,1,()=>{u=null}),Ne()),f[0]==="results"?h?(h.p(f,d),d[0]&1&&O(h,1)):(h=qc(f),h.c(),O(h,1),h.m(o.parentNode,o)):h&&(Ae(),W(h,1,1,()=>{h=null}),Ne())},i(f){a||(O(t.$$.fragment,f),O(c),O(u),O(h),a=!0)},o(f){W(t.$$.fragment,f),W(c),W(u),W(h),a=!1},d(f){f&&(v(e),v(s),v(r),v(i),v(o)),n[30](null),re(t),c&&c.d(f),u&&u.d(f),h&&h.d(f)}}}function L0(n){let e;return{c(){e=P("🎤 マイクテストページへ移動")},l(t){e=R(t,"🎤 マイクテストページへ移動")},m(t,s){H(t,e,s)},d(t){t&&v(e)}}}function B0(n){let e;return{c(){e=P("🏠 ホームに戻る")},l(t){e=R(t,"🏠 ホームに戻る")},m(t,s){H(t,e,s)},d(t){t&&v(e)}}}function H0(n){let e,t,s="🎤",r,i,o="マイクテストが必要です",a,l,c="ランダム基音トレーニングを開始する前に、マイクテストページで音声入力の確認をお願いします。",u,h,f='<p class="svelte-672hso">このページは<strong>マイクテスト完了後</strong>にご利用いただけます。</p> <p class="svelte-672hso">まずはマイクテストページで音声確認を行ってください。</p>',d,m,_,g,y,b;return _=new vo({props:{variant:"primary",$$slots:{default:[L0]},$$scope:{ctx:n}}}),_.$on("click",n[23]),y=new vo({props:{variant:"secondary",$$slots:{default:[B0]},$$scope:{ctx:n}}}),y.$on("click",n[24]),{c(){e=E("div"),t=E("div"),t.textContent=s,r=x(),i=E("h3"),i.textContent=o,a=x(),l=E("p"),l.textContent=c,u=x(),h=E("div"),h.innerHTML=f,d=x(),m=E("div"),oe(_.$$.fragment),g=x(),oe(y.$$.fragment),this.h()},l(k){e=N(k,"DIV",{class:!0});var I=$(e);t=N(I,"DIV",{class:!0,"data-svelte-h":!0}),pe(t)!=="svelte-15rbx8n"&&(t.textContent=s),r=V(I),i=N(I,"H3",{class:!0,"data-svelte-h":!0}),pe(i)!=="svelte-17kvze2"&&(i.textContent=o),a=V(I),l=N(I,"P",{class:!0,"data-svelte-h":!0}),pe(l)!=="svelte-12s9olt"&&(l.textContent=c),u=V(I),h=N(I,"DIV",{class:!0,"data-svelte-h":!0}),pe(h)!=="svelte-13ge0u9"&&(h.innerHTML=f),d=V(I),m=N(I,"DIV",{class:!0});var T=$(m);de(_.$$.fragment,T),g=V(T),de(y.$$.fragment,T),T.forEach(v),I.forEach(v),this.h()},h(){S(t,"class","error-icon svelte-672hso"),S(i,"class","svelte-672hso"),S(l,"class","svelte-672hso"),S(h,"class","recommendation svelte-672hso"),S(m,"class","action-buttons"),S(e,"class","error-content svelte-672hso")},m(k,I){H(k,e,I),p(e,t),p(e,r),p(e,i),p(e,a),p(e,l),p(e,u),p(e,h),p(e,d),p(e,m),ie(_,m,null),p(m,g),ie(y,m,null),b=!0},p(k,I){const T={};I[3]&1&&(T.$$scope={dirty:I,ctx:k}),_.$set(T);const C={};I[3]&1&&(C.$$scope={dirty:I,ctx:k}),y.$set(C)},i(k){b||(O(_.$$.fragment,k),O(y.$$.fragment,k),b=!0)},o(k){W(_.$$.fragment,k),W(y.$$.fragment,k),b=!1},d(k){k&&v(e),re(_),re(y)}}}function $c(n){let e,t,s,r,i,o,a=!n[2]&&n[3].length>0&&Oc(n);return s=new ii({props:{class:"main-card half-width",$$slots:{default:[X0]},$$scope:{ctx:n}}}),i=new kh({props:{frequency:n[9],note:n[10],volume:n[8],isMuted:n[0]!=="guiding",muteMessage:"基音再生後に開始",className:"half-width"}}),{c(){a&&a.c(),e=x(),t=E("div"),oe(s.$$.fragment),r=x(),oe(i.$$.fragment),this.h()},l(l){a&&a.l(l),e=V(l),t=N(l,"DIV",{class:!0});var c=$(t);de(s.$$.fragment,c),r=V(c),de(i.$$.fragment,c),c.forEach(v),this.h()},h(){S(t,"class","side-by-side-container svelte-672hso")},m(l,c){a&&a.m(l,c),H(l,e,c),H(l,t,c),ie(s,t,null),p(t,r),ie(i,t,null),o=!0},p(l,c){!l[2]&&l[3].length>0?a?(a.p(l,c),c[0]&12&&O(a,1)):(a=Oc(l),a.c(),O(a,1),a.m(e.parentNode,e)):a&&(Ae(),W(a,1,1,()=>{a=null}),Ne());const u={};c[0]&113|c[3]&1&&(u.$$scope={dirty:c,ctx:l}),s.$set(u);const h={};c[0]&512&&(h.frequency=l[9]),c[0]&1024&&(h.note=l[10]),c[0]&256&&(h.volume=l[8]),c[0]&1&&(h.isMuted=l[0]!=="guiding"),i.$set(h)},i(l){o||(O(a),O(s.$$.fragment,l),O(i.$$.fragment,l),o=!0)},o(l){W(a),W(s.$$.fragment,l),W(i.$$.fragment,l),o=!1},d(l){l&&(v(e),v(t)),a&&a.d(l),re(s),re(i)}}}function Oc(n){let e,t;return e=new ii({props:{class:"warning-card",$$slots:{default:[j0]},$$scope:{ctx:n}}}),{c(){oe(e.$$.fragment)},l(s){de(e.$$.fragment,s)},m(s,r){ie(e,s,r),t=!0},p(s,r){const i={};r[0]&8|r[3]&1&&(i.$$scope={dirty:r,ctx:s}),e.$set(i)},i(s){t||(O(e.$$.fragment,s),t=!0)},o(s){W(e.$$.fragment,s),t=!1},d(s){re(e,s)}}}function Rc(n){let e,t=n[90]+"",s;return{c(){e=E("li"),s=P(t),this.h()},l(r){e=N(r,"LI",{class:!0});var i=$(e);s=R(i,t),i.forEach(v),this.h()},h(){S(e,"class","svelte-672hso")},m(r,i){H(r,e,i),p(e,s)},p(r,i){i[0]&8&&t!==(t=r[90]+"")&&ee(s,t)},d(r){r&&v(e)}}}function j0(n){let e,t='<h3 class="section-title svelte-672hso">⚠️ マイク接続に問題があります</h3>',s,r,i,o="マイクが正常に動作していません。以下の問題が検出されました：",a,l,c,u,h="<strong>解決方法:</strong> ページを再読み込みしてマイク許可を再度取得してください。",f=Ie(n[3]),d=[];for(let m=0;m<f.length;m+=1)d[m]=Rc(Ic(n,f,m));return{c(){e=E("div"),e.innerHTML=t,s=x(),r=E("div"),i=E("p"),i.textContent=o,a=x(),l=E("ul");for(let m=0;m<d.length;m+=1)d[m].c();c=x(),u=E("p"),u.innerHTML=h,this.h()},l(m){e=N(m,"DIV",{class:!0,"data-svelte-h":!0}),pe(e)!=="svelte-1mob8td"&&(e.innerHTML=t),s=V(m),r=N(m,"DIV",{class:!0});var _=$(r);i=N(_,"P",{class:!0,"data-svelte-h":!0}),pe(i)!=="svelte-171o2p0"&&(i.textContent=o),a=V(_),l=N(_,"UL",{class:!0});var g=$(l);for(let y=0;y<d.length;y+=1)d[y].l(g);g.forEach(v),c=V(_),u=N(_,"P",{class:!0,"data-svelte-h":!0}),pe(u)!=="svelte-1o4df0k"&&(u.innerHTML=h),_.forEach(v),this.h()},h(){S(e,"class","card-header svelte-672hso"),S(i,"class","warning-message svelte-672hso"),S(l,"class","error-list svelte-672hso"),S(u,"class","fix-instruction svelte-672hso"),S(r,"class","card-content svelte-672hso")},m(m,_){H(m,e,_),H(m,s,_),H(m,r,_),p(r,i),p(r,a),p(r,l);for(let g=0;g<d.length;g+=1)d[g]&&d[g].m(l,null);p(r,c),p(r,u)},p(m,_){if(_[0]&8){f=Ie(m[3]);let g;for(g=0;g<f.length;g+=1){const y=Ic(m,f,g);d[g]?d[g].p(y,_):(d[g]=Rc(y),d[g].c(),d[g].m(l,null))}for(;g<d.length;g+=1)d[g].d(1);d.length=f.length}},d(m){m&&(v(e),v(s),v(r)),dt(d,m)}}}function U0(n){let e;return{c(){e=P("🎹 ランダム基音再生")},l(t){e=R(t,"🎹 ランダム基音再生")},m(t,s){H(t,e,s)},p:Et,d(t){t&&v(e)}}}function z0(n){let e,t,s;return{c(){e=P("🔄 "),t=P(n[4]),s=P(" 再生")},l(r){e=R(r,"🔄 "),t=R(r,n[4]),s=R(r," 再生")},m(r,i){H(r,e,i),H(r,t,i),H(r,s,i)},p(r,i){i[0]&16&&ee(t,r[4])},d(r){r&&(v(e),v(t),v(s))}}}function G0(n){let e;return{c(){e=P("🎵 再生中...")},l(t){e=R(t,"🎵 再生中...")},m(t,s){H(t,e,s)},p:Et,d(t){t&&v(e)}}}function Z0(n){let e;function t(i,o){return i[6]?G0:i[4]&&i[5]>0?z0:U0}let s=t(n),r=s(n);return{c(){r.c(),e=Gt()},l(i){r.l(i),e=Gt()},m(i,o){r.m(i,o),H(i,e,o)},p(i,o){s===(s=t(i))&&r?r.p(i,o):(r.d(1),r=s(i),r&&(r.c(),r.m(e.parentNode,e)))},d(i){i&&v(e),r.d(i)}}}function Pc(n){let e,t,s,r,i,o=n[5].toFixed(1)+"",a,l;return{c(){e=E("div"),t=P("現在の基音: "),s=E("strong"),r=P(n[4]),i=P(" ("),a=P(o),l=P("Hz)"),this.h()},l(c){e=N(c,"DIV",{class:!0});var u=$(e);t=R(u,"現在の基音: "),s=N(u,"STRONG",{});var h=$(s);r=R(h,n[4]),h.forEach(v),i=R(u," ("),a=R(u,o),l=R(u,"Hz)"),u.forEach(v),this.h()},h(){S(e,"class","base-note-info svelte-672hso")},m(c,u){H(c,e,u),p(e,t),p(e,s),p(s,r),p(e,i),p(e,a),p(e,l)},p(c,u){u[0]&16&&ee(r,c[4]),u[0]&32&&o!==(o=c[5].toFixed(1)+"")&&ee(a,o)},d(c){c&&v(e)}}}function X0(n){let e,t='<h3 class="section-title svelte-672hso">🎹 基音再生</h3>',s,r,i,o,a;i=new vo({props:{variant:"primary",disabled:n[6]||n[0]==="guiding"||n[0]==="waiting",$$slots:{default:[Z0]},$$scope:{ctx:n}}}),i.$on("click",n[22]);let l=n[4]&&Pc(n);return{c(){e=E("div"),e.innerHTML=t,s=x(),r=E("div"),oe(i.$$.fragment),o=x(),l&&l.c(),this.h()},l(c){e=N(c,"DIV",{class:!0,"data-svelte-h":!0}),pe(e)!=="svelte-o46h1v"&&(e.innerHTML=t),s=V(c),r=N(c,"DIV",{class:!0});var u=$(r);de(i.$$.fragment,u),o=V(u),l&&l.l(u),u.forEach(v),this.h()},h(){S(e,"class","card-header svelte-672hso"),S(r,"class","card-content svelte-672hso")},m(c,u){H(c,e,u),H(c,s,u),H(c,r,u),ie(i,r,null),p(r,o),l&&l.m(r,null),a=!0},p(c,u){const h={};u[0]&65&&(h.disabled=c[6]||c[0]==="guiding"||c[0]==="waiting"),u[0]&112|u[3]&1&&(h.$$scope={dirty:u,ctx:c}),i.$set(h),c[4]?l?l.p(c,u):(l=Pc(c),l.c(),l.m(r,null)):l&&(l.d(1),l=null)},i(c){a||(O(i.$$.fragment,c),a=!0)},o(c){W(i.$$.fragment,c),a=!1},d(c){c&&(v(e),v(s),v(r)),re(i),l&&l.d()}}}function Vc(n){let e,t;return e=new ii({props:{class:"main-card",$$slots:{default:[Y0]},$$scope:{ctx:n}}}),{c(){oe(e.$$.fragment)},l(s){de(e.$$.fragment,s)},m(s,r){ie(e,s,r),t=!0},p(s,r){const i={};r[0]&129|r[3]&1&&(i.$$scope={dirty:r,ctx:s}),e.$set(i)},i(s){t||(O(e.$$.fragment,s),t=!0)},o(s){W(e.$$.fragment,s),t=!1},d(s){re(e,s)}}}function xc(n){let e,t=n[87].name+"",s,r,i;return{c(){e=E("div"),s=P(t),r=x(),this.h()},l(o){e=N(o,"DIV",{class:!0});var a=$(e);s=R(a,t),r=V(a),a.forEach(v),this.h()},h(){S(e,"class",i="scale-item "+n[87].state+" svelte-672hso")},m(o,a){H(o,e,a),p(e,s),p(e,r)},p(o,a){a[0]&128&&t!==(t=o[87].name+"")&&ee(s,t),a[0]&128&&i!==(i="scale-item "+o[87].state+" svelte-672hso")&&S(e,"class",i)},d(o){o&&v(e)}}}function Fc(n){let e,t="ガイドに合わせて <strong>ドレミファソラシド</strong> を歌ってください";return{c(){e=E("div"),e.innerHTML=t,this.h()},l(s){e=N(s,"DIV",{class:!0,"data-svelte-h":!0}),pe(e)!=="svelte-sgc3nk"&&(e.innerHTML=t),this.h()},h(){S(e,"class","guide-instruction svelte-672hso")},m(s,r){H(s,e,r)},d(s){s&&v(e)}}}function Y0(n){let e,t='<h3 class="section-title svelte-672hso">🎵 ドレミ音階ガイド</h3>',s,r,i,o,a=Ie(n[7]),l=[];for(let u=0;u<a.length;u+=1)l[u]=xc(Ec(n,a,u));let c=n[0]==="guiding"&&Fc();return{c(){e=E("div"),e.innerHTML=t,s=x(),r=E("div"),i=E("div");for(let u=0;u<l.length;u+=1)l[u].c();o=x(),c&&c.c(),this.h()},l(u){e=N(u,"DIV",{class:!0,"data-svelte-h":!0}),pe(e)!=="svelte-z1jpw4"&&(e.innerHTML=t),s=V(u),r=N(u,"DIV",{class:!0});var h=$(r);i=N(h,"DIV",{class:!0});var f=$(i);for(let d=0;d<l.length;d+=1)l[d].l(f);f.forEach(v),o=V(h),c&&c.l(h),h.forEach(v),this.h()},h(){S(e,"class","card-header svelte-672hso"),S(i,"class","scale-guide svelte-672hso"),S(r,"class","card-content svelte-672hso")},m(u,h){H(u,e,h),H(u,s,h),H(u,r,h),p(r,i);for(let f=0;f<l.length;f+=1)l[f]&&l[f].m(i,null);p(r,o),c&&c.m(r,null)},p(u,h){if(h[0]&128){a=Ie(u[7]);let f;for(f=0;f<a.length;f+=1){const d=Ec(u,a,f);l[f]?l[f].p(d,h):(l[f]=xc(d),l[f].c(),l[f].m(i,null))}for(;f<l.length;f+=1)l[f].d(1);l.length=a.length}u[0]==="guiding"?c||(c=Fc(),c.c(),c.m(r,null)):c&&(c.d(1),c=null)},d(u){u&&(v(e),v(s),v(r)),dt(l,u),c&&c.d()}}}function qc(n){let e,t,s,r,i;const o=[J0,Q0],a=[];function l(u,h){return u[21]&&u[18]?0:u[16]?1:-1}~(e=l(n))&&(t=a[e]=o[e](n));let c=n[0]==="results"&&Wc(n);return{c(){t&&t.c(),s=x(),c&&c.c(),r=Gt()},l(u){t&&t.l(u),s=V(u),c&&c.l(u),r=Gt()},m(u,h){~e&&a[e].m(u,h),H(u,s,h),c&&c.m(u,h),H(u,r,h),i=!0},p(u,h){let f=e;e=l(u),e===f?~e&&a[e].p(u,h):(t&&(Ae(),W(a[f],1,1,()=>{a[f]=null}),Ne()),~e?(t=a[e],t?t.p(u,h):(t=a[e]=o[e](u),t.c()),O(t,1),t.m(s.parentNode,s)):t=null),u[0]==="results"?c?(c.p(u,h),h[0]&1&&O(c,1)):(c=Wc(u),c.c(),O(c,1),c.m(r.parentNode,r)):c&&(Ae(),W(c,1,1,()=>{c=null}),Ne())},i(u){i||(O(t),O(c),i=!0)},o(u){W(t),W(c),i=!1},d(u){u&&(v(s),v(r)),~e&&a[e].d(u),c&&c.d(u)}}}function Q0(n){let e,t;return e=new ch({props:{scoreData:n[16],showDetails:!1,className:"mb-6",currentScoreData:n[11],intervalData:n[12],consistencyData:n[13],feedbackData:n[14],sessionStatistics:n[15]}}),{c(){oe(e.$$.fragment)},l(s){de(e.$$.fragment,s)},m(s,r){ie(e,s,r),t=!0},p(s,r){const i={};r[0]&65536&&(i.scoreData=s[16]),r[0]&2048&&(i.currentScoreData=s[11]),r[0]&4096&&(i.intervalData=s[12]),r[0]&8192&&(i.consistencyData=s[13]),r[0]&16384&&(i.feedbackData=s[14]),r[0]&32768&&(i.sessionStatistics=s[15]),e.$set(i)},i(s){t||(O(e.$$.fragment,s),t=!0)},o(s){W(e.$$.fragment,s),t=!1},d(s){re(e,s)}}}function J0(n){let e,t;return e=new ch({props:{scoreData:n[21],showDetails:!1,className:"mb-6",currentScoreData:n[11],intervalData:n[12],consistencyData:n[13],feedbackData:n[14],sessionStatistics:n[15]}}),{c(){oe(e.$$.fragment)},l(s){de(e.$$.fragment,s)},m(s,r){ie(e,s,r),t=!0},p(s,r){const i={};r[0]&2097152&&(i.scoreData=s[21]),r[0]&2048&&(i.currentScoreData=s[11]),r[0]&4096&&(i.intervalData=s[12]),r[0]&8192&&(i.consistencyData=s[13]),r[0]&16384&&(i.feedbackData=s[14]),r[0]&32768&&(i.sessionStatistics=s[15]),e.$set(i)},i(s){t||(O(e.$$.fragment,s),t=!0)},o(s){W(e.$$.fragment,s),t=!1},d(s){re(e,s)}}}function Wc(n){let e,t;return e=new ii({props:{class:"main-card bottom-action-card",$$slots:{default:[K0]},$$scope:{ctx:n}}}),{c(){oe(e.$$.fragment)},l(s){de(e.$$.fragment,s)},m(s,r){ie(e,s,r),t=!0},p(s,r){const i={};r[0]&262144|r[3]&1&&(i.$$scope={dirty:r,ctx:s}),e.$set(i)},i(s){t||(O(e.$$.fragment,s),t=!0)},o(s){W(e.$$.fragment,s),t=!1},d(s){re(e,s)}}}function K0(n){let e,t,s;return t=new uh({props:{isCompleted:n[18],position:"bottom"}}),t.$on("action",n[26]),{c(){e=E("div"),oe(t.$$.fragment),this.h()},l(r){e=N(r,"DIV",{class:!0});var i=$(e);de(t.$$.fragment,i),i.forEach(v),this.h()},h(){S(e,"class","card-content svelte-672hso")},m(r,i){H(r,e,i),ie(t,e,null),s=!0},p(r,i){const o={};i[0]&262144&&(o.isCompleted=r[18]),t.$set(o)},i(r){s||(O(t.$$.fragment,r),s=!0)},o(r){W(t.$$.fragment,r),s=!1},d(r){r&&v(e),re(t)}}}function ey(n){let e,t,s="🎵 ランダム基音トレーニング",r,i,o="10種類の基音からランダムに選択してドレミファソラシドを練習",a,l,c,u,h,f,d,m,_,g,y,b,k,I,T,C,A=n[1]==="granted"&&!n[20]&&Dc(n);const w=[W0,q0],D=[];function M(F,q){return F[1]==="granted"?0:1}return k=M(n),I=D[k]=w[k](n),{c(){e=E("div"),t=E("h1"),t.textContent=s,r=x(),i=E("p"),i.textContent=o,a=x(),A&&A.c(),l=x(),c=E("div"),u=P("📱 "),h=P(Lc),f=P(" | "),d=P(Bc),m=E("br"),_=x(),g=E("small"),y=P(Hc),b=x(),I.c(),T=Gt(),this.h()},l(F){e=N(F,"DIV",{class:!0});var q=$(e);t=N(q,"H1",{class:!0,"data-svelte-h":!0}),pe(t)!=="svelte-1ptm9zr"&&(t.textContent=s),r=V(q),i=N(q,"P",{class:!0,"data-svelte-h":!0}),pe(i)!=="svelte-19nes7"&&(i.textContent=o),a=V(q),A&&A.l(q),l=V(q),c=N(q,"DIV",{class:!0});var B=$(c);u=R(B,"📱 "),h=R(B,Lc),f=R(B," | "),d=R(B,Bc),m=N(B,"BR",{}),_=V(B),g=N(B,"SMALL",{style:!0});var G=$(g);y=R(G,Hc),G.forEach(v),B.forEach(v),q.forEach(v),b=V(F),I.l(F),T=Gt(),this.h()},h(){S(t,"class","page-title svelte-672hso"),S(i,"class","page-description svelte-672hso"),st(g,"font-size","0.6rem"),S(c,"class","debug-info svelte-672hso"),S(e,"class","header-section svelte-672hso")},m(F,q){H(F,e,q),p(e,t),p(e,r),p(e,i),p(e,a),A&&A.m(e,null),p(e,l),p(e,c),p(c,u),p(c,h),p(c,f),p(c,d),p(c,m),p(c,_),p(c,g),p(g,y),H(F,b,q),D[k].m(F,q),H(F,T,q),C=!0},p(F,q){F[1]==="granted"&&!F[20]?A?(A.p(F,q),q[0]&1048578&&O(A,1)):(A=Dc(F),A.c(),O(A,1),A.m(e,l)):A&&(Ae(),W(A,1,1,()=>{A=null}),Ne());let B=k;k=M(F),k===B?D[k].p(F,q):(Ae(),W(D[B],1,1,()=>{D[B]=null}),Ne(),I=D[k],I?I.p(F,q):(I=D[k]=w[k](F),I.c()),O(I,1),I.m(T.parentNode,T))},i(F){C||(O(A),O(I),C=!0)},o(F){W(A),W(I),C=!1},d(F){F&&(v(e),v(b),v(T)),A&&A.d(),D[k].d(F)}}}function ty(n){let e,t;return e=new Ch({props:{$$slots:{default:[ey]},$$scope:{ctx:n}}}),{c(){oe(e.$$.fragment)},l(s){de(e.$$.fragment,s)},m(s,r){ie(e,s,r),t=!0},p(s,r){const i={};r[0]&4194303|r[3]&1&&(i.$$scope={dirty:r,ctx:s}),e.$set(i)},i(s){t||(O(e.$$.fragment,s),t=!0)},o(s){W(e.$$.fragment,s),t=!1},d(s){re(e,s)}}}const Lc="v2.3.1-ANIMATED",Bc="07/29 04:15",Hc="🎬 評価分布アニメーション実装・UX向上";function jc(n){return["unison","major_second","major_third","perfect_fourth","perfect_fifth","major_sixth","major_seventh","octave"].map(t=>{const s=Math.floor(Math.random()*3)+1,r=Math.floor(Math.random()*40)+60;return{type:t,mastery:r,attempts:s,accuracy:r}})}function sy(n){if(!n||n.length===0)return"needWork";const e=n.reduce((r,i)=>{const o=mh(i.cents);return r[o]=(r[o]||0)+1,o!=="notMeasured"&&(r.totalError+=Math.abs(i.cents),r.measuredCount+=1),r},{excellent:0,good:0,pass:0,needWork:0,notMeasured:0,totalError:0,measuredCount:0}),t=e.measuredCount>0?e.totalError/e.measuredCount:100,s=e.excellent+e.good+e.pass;return e.notMeasured>3||e.needWork>2||e.measuredCount===0?"needWork":t<=20&&e.excellent>=6?"excellent":t<=30&&s>=7?"good":s>=5?"pass":"needWork"}function mh(n){if(n==null||isNaN(n))return"notMeasured";const e=Math.abs(n);return e<=15?"excellent":e<=25?"good":e<=40?"pass":"needWork"}function ny(n){const e={excellent:0,good:0,pass:0,needWork:0,notMeasured:0};return n.forEach(t=>{if(t.accuracy==="notMeasured"||t.cents===null)e.notMeasured++;else{const s=Math.abs(t.cents);s<=15?e.excellent++:s<=25?e.good++:s<=40?e.pass++:e.needWork++}}),e}function ry(n){const e=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];if(n<=0)return"ーー";const s=Math.round(12*Math.log2(n/440)),r=(s+9+120)%12,i=Math.floor((s+9)/12)+4;return e[r]+i}function Uc(n,e){const t=[{factor:3,freq:n*3,description:"1.5オクターブ上"},{factor:2,freq:n*2,description:"1オクターブ上"},{factor:1.5,freq:n*1.5,description:"0.5オクターブ上"},{factor:1,freq:n,description:"補正なし"},{factor:.67,freq:n*.67,description:"0.5オクターブ下"},{factor:.5,freq:n*.5,description:"1オクターブ下"},{factor:.33,freq:n*.33,description:"1.5オクターブ下"}],s=e*.7,r=e*1.3,i=t.filter(l=>l.freq>=s&&l.freq<=r);if(i.length===0)return{correctedFrequency:n,factor:1,description:"補正なし（有効候補なし）",error:Math.abs(n-e)};let o=i[0],a=Math.abs(o.freq-e);for(const l of i){const c=Math.abs(l.freq-e);c<a&&(a=c,o=l)}return{correctedFrequency:o.freq,factor:o.factor,description:o.description,error:a}}function Ai(){try{"scrollTo"in window&&"behavior"in document.documentElement.style?window.scrollTo({top:0,behavior:"smooth"}):window.scrollTo(0,0),document.body&&(document.body.scrollTop=0),document.documentElement&&(document.documentElement.scrollTop=0),document.querySelectorAll("[data-scroll-container], .scroll-container, main").forEach(e=>{e.scrollTo?e.scrollTo(0,0):e.scrollTop=0})}catch(n){console.warn("スクロールエラー:",n);try{window.scroll(0,0)}catch(e){console.error("スクロール完全失敗:",e)}}}function iy(n){}function oy(n){console.error("❌ PitchDetectorエラー:",n.detail)}function ay(n,e,t){let s,r,i,o,a,l,c,u,h,f;Ut(n,hh,Z=>t(18,s=Z)),Ut(n,wh,Z=>t(47,r=Z)),Ut(n,dr,Z=>t(48,i=Z)),Ut(n,dh,Z=>t(49,o=Z)),Ut(n,mr,Z=>t(50,a=Z)),Ut(n,pr,Z=>t(51,l=Z)),Ut(n,ya,Z=>t(19,c=Z)),Ut(n,ts,Z=>t(52,u=Z)),Ut(n,Hi,Z=>t(20,h=Z)),Ut(n,fh,Z=>t(21,f=Z));let d="setup",m=typeof window<"u"?new URLSearchParams(window.location.search).get("from")==="microphone-test"?(Mt.info("[RandomTraining] マイクテストページからの遷移を検出"),"granted"):(Mt.info("[RandomTraining] ダイレクトアクセスを検出"),"checking"):"checking",_=!0,g=[];const y=["ド","レ","ミ","ファ","ソ","ラ","シ","ド（高）"];let b="",k=0,I=!1,T=0,C=y.map(Z=>({name:Z,state:"inactive",completed:!1})),A=null,w=!1,D=[],M=0,F=0,q="ーー",B=null,G={totalScore:0,grade:"C",componentScores:{pitchAccuracy:0,recognitionSpeed:0,intervalMastery:0,directionAccuracy:0,consistency:0}},Y=[],U=[],L={},K={totalAttempts:0,successRate:0,averageScore:0,bestScore:0,sessionDuration:0,streakCount:0,fatigueLevel:"fresh",mostDifficultInterval:"-",mostSuccessfulInterval:"-",averageResponseTime:0,sessionStart:Date.now()},z=[],Q=null,te=null,ce=!0,ve=null,Ce=null,ye=null,me=null,be=null;const X=[{note:"C4",name:"ド（中）",frequency:261.63,semitonesFromC:0},{note:"Db4",name:"ド#（中）",frequency:277.18,semitonesFromC:1},{note:"D4",name:"レ（中）",frequency:293.66,semitonesFromC:2},{note:"Eb4",name:"レ#（中）",frequency:311.13,semitonesFromC:3},{note:"E4",name:"ミ（中）",frequency:329.63,semitonesFromC:4},{note:"F4",name:"ファ（中）",frequency:349.23,semitonesFromC:5},{note:"Gb4",name:"ファ#（中）",frequency:369.99,semitonesFromC:6},{note:"Ab4",name:"ラb（中）",frequency:415.3,semitonesFromC:8},{note:"Bb3",name:"シb（低）",frequency:233.08,semitonesFromC:-2},{note:"B3",name:"シ（低）",frequency:246.94,semitonesFromC:-1}];async function Se(){var Z;t(1,m="checking");try{if(console.log("🎤 [RandomTraining] AudioManager経由でマイク許可確認開始"),!((Z=navigator.mediaDevices)!=null&&Z.getUserMedia)){t(1,m="error");return}const J=await Na.initialize();ye=J.audioContext,Ce=J.mediaStream,me=J.sourceNode,console.log("✅ [RandomTraining] AudioManager リソース取得完了"),t(1,m="granted"),t(0,d="setup"),setTimeout(async()=>{ve&&(Mt.audio("[RandomTraining] PitchDetector初期化開始"),await ve.initialize(),Mt.audio("[RandomTraining] PitchDetector初期化完了"))},200)}catch(J){Mt.error("[RandomTraining] マイク許可エラー:",J),t(1,m=(J==null?void 0:J.name)==="NotAllowedError"?"denied":"error")}}function fe(){const Z=l,J=a,ge=X.find(j=>j.note===Z)||X.find(j=>j.name===J)||X[0];if(t(4,b=ge.name),t(5,k=ge.frequency),Mt.info(`[BaseNote] 基音設定（localStorage連携）: ${b} = ${k}Hz`),Mt.info(`[BaseNote] localStorage基音情報: note=${Z}, name=${J}`),!k||k<=0)throw Mt.error("[BaseNote] 基音周波数設定エラー:",ge),new Error(`Invalid base frequency: ${k}`)}async function le(){if(I||!te||ce)return;if(m!=="granted"){console.log("🎤 [RandomTraining] マイク許可が必要です。許可取得を開始...");try{await Se(),console.log("🎤 [RandomTraining] マイク許可取得完了")}catch(J){console.error("❌ マイク許可エラー:",J);return}}if(!Ce&&m==="granted"){console.log("🎤 [RandomTraining] AudioManagerリソース未初期化のため取得します");try{await Se()}catch(J){console.error("❌ AudioManagerリソース初期化エラー:",J);return}}else Ce&&console.log("🎤 [RandomTraining] AudioManagerリソース既存のため再利用");t(6,I=!0),t(0,d="listening"),be=Date.now(),fe();const Z=X.find(J=>J.name===b).note;te.triggerAttackRelease(Z,2,el(),.7),setTimeout(()=>{t(6,I=!1),t(0,d="waiting"),setTimeout(()=>ae(),500)},2e3)}async function ue(){if(I||!te||h||!b)return;if(m!=="granted"){console.log("🎤 [RandomTraining] マイク許可が必要です。許可取得を開始...");try{await Se(),console.log("🎤 [RandomTraining] マイク許可取得完了")}catch(J){console.error("❌ マイク許可エラー:",J);return}}if(!Ce&&m==="granted"){console.log("🎤 [RandomTraining] AudioManagerリソース未初期化のため取得します");try{await Se()}catch(J){console.error("❌ AudioManagerリソース初期化エラー:",J);return}}else Ce&&console.log("🎤 [RandomTraining] AudioManagerリソース既存のため再利用");t(6,I=!0),t(0,d="listening"),be=Date.now();const Z=X.find(J=>J.name===b).note;te.triggerAttackRelease(Z,2,el(),.7),setTimeout(()=>{t(6,I=!1),t(0,d="waiting"),setTimeout(()=>ae(),500)},2e3)}function De(){b&&k>0?ue():le()}function Oe(Z,J){const j=[0,2,4,5,7,9,11,12][J],ne=Z*Math.pow(2,j/12);return Mt.debug(`[calculateExpectedFrequency] ${C[J].name}: 基音${Z.toFixed(1)}Hz + ${j}半音 = ${ne.toFixed(1)}Hz`),ne}function se(Z,J){return Oe(Z,J)}function ae(){t(0,d="guiding"),T=0,w=!0,D=[],console.log(`🎬 ガイド開始: ${b} (${k.toFixed(1)}Hz)`);function Z(){if(T<C.length){T>0&&t(7,C[T-1].state="inactive",C),t(7,C[T].state="active",C);const J=se(k,T);Ea.setScaleContext({baseFrequency:k,currentScale:C[T].name,targetFrequency:J}),console.log(`🎵 [Scale] 基音:${b}(${k.toFixed(0)}Hz) 現在:${C[T].name} 目標:${J.toFixed(0)}Hz`),T>=4&&console.log(`🔍 [デバッグ] Step ${T}: currentBaseFrequency=${k}, currentBaseNote='${b}'`),T++,A=setTimeout(Z,600)}else Me()}Z()}function Me(){w=!1,console.log(`🏁 ガイド完了: ${D.length}/${C.length}ステップ評価`),C.length>0&&t(7,C[C.length-1].state="inactive",C),ve&&ve.stopDetection(),Ea.clearContext(),we(),Rt(),z=y.map(Z=>{const J=D.find(ge=>ge.stepName===Z);return J?{name:J.stepName,cents:J.adjustedFrequency?Math.round(J.centDifference):null,targetFreq:J.expectedFrequency,detectedFreq:J.adjustedFrequency||null,diff:J.adjustedFrequency?J.adjustedFrequency-J.expectedFrequency:null,accuracy:J.accuracy}:{name:Z,cents:null,targetFreq:null,detectedFreq:null,diff:null,accuracy:"notMeasured"}}),Ke(),Re(),t(0,d="results")}function we(){let Z=0,J=0;D.forEach((ne,ke)=>{ne.isCorrect&&Z++,J+=ne.accuracy});const ge=D.length>0?Math.round(J/D.length):0,j=Math.round(Z/C.length*100);C.length,console.log(`🎯 結果: ${Z}/${C.length}正解 (${j}%) 平均精度${ge}%`),D.length>0&&[...D]}function Te(){Aa(`${fo}/microphone-test`)}function $e(){Aa(`${fo}/`)}async function je(){try{t(29,ce=!0),t(28,te=new vi({urls:{C4:"C4.mp3"},baseUrl:`${fo}/audio/piano/`,release:1.5,onload:()=>{t(29,ce=!1)},onerror:Z=>{console.error("❌ Salamander Piano音源読み込みエラー:",Z),t(29,ce=!1)}}).toDestination()),t(28,te.volume.value=-6,te)}catch(Z){console.error("サンプラー初期化エラー:",Z),t(29,ce=!1)}}async function Je(){try{(await navigator.permissions.query({name:"microphone"})).state==="granted"?await Se():t(1,m="denied")}catch{t(1,m="denied")}}function _t(){try{B=new Ah,Mt.info("[RandomTraining] 採点エンジン初期化完了")}catch(Z){Mt.error("[RandomTraining] 採点エンジン初期化エラー:",Z)}}function Ot(Z,J){if(!B||!w)return;const ge=T-1;if(ge<0||ge>=C.length)return;const j=Oe(k,ge),ne={baseFrequency:k,targetFrequency:j,detectedFrequency:Z,detectedNote:J,volume:M,timestamp:Date.now(),scaleIndex:ge,scaleName:C[ge].name};try{B.processAttempt(ne)}catch(ke){Mt.error("[RandomTraining] 採点エンジンエラー:",ke)}}function Rt(){if(!B){Mt.error("[RandomTraining] 採点エンジンが初期化されていません"),ut();return}try{const Z=B.generateDetailedReport();t(11,G={totalScore:Z.totalScore,grade:Z.grade,componentScores:Z.componentScores}),Z.intervalAnalysis&&Z.intervalAnalysis.masteryLevels?t(12,Y=Object.entries(Z.intervalAnalysis.masteryLevels).map(([J,ge])=>{var j,ne;return{type:J,mastery:Math.round(ge),attempts:((j=Z.intervalAnalysis.attemptCounts)==null?void 0:j[J])||0,accuracy:((ne=Z.intervalAnalysis.accuracyRates)==null?void 0:ne[J])||0}})):(console.warn("⚠️ [RandomTraining] intervalAnalysis.masteryLevels が未定義です"),t(12,Y=[])),Z.consistencyHistory&&Array.isArray(Z.consistencyHistory)?t(13,U=Z.consistencyHistory.map((J,ge)=>({score:Math.round(J),timestamp:Date.now()-(Z.consistencyHistory.length-ge)*1e3}))):(console.warn("⚠️ [RandomTraining] consistencyHistory が未定義または配列ではありません"),t(13,U=[])),t(14,L=Z.feedback||{primary:"採点結果を生成中です...",detailed:[],suggestions:[]}),t(15,K={totalAttempts:Z.totalAttempts||0,successRate:Z.successRate||0,averageScore:Z.totalScore||0,bestScore:Math.max(Z.totalScore||0,K.bestScore||0),sessionDuration:Math.round((Date.now()-K.sessionStart)/6e4)||0,streakCount:Z.streak||0,fatigueLevel:Z.fatigueLevel||"normal",mostDifficultInterval:Z.mostDifficultInterval||"-",mostSuccessfulInterval:Z.mostSuccessfulInterval||"-",averageResponseTime:Z.averageResponseTime||0}),Mt.info("[RandomTraining] 採点結果生成完了:",G)}catch(Z){Mt.error("[RandomTraining] 採点結果生成エラー:",Z)}}function ut(){Mt.info("[RandomTraining] テストデータで採点結果を生成"),t(11,G={totalScore:78,grade:"B+",componentScores:{pitchAccuracy:82,recognitionSpeed:75,intervalMastery:80,directionAccuracy:85,consistency:70}}),t(12,Y=[{type:"unison",mastery:95,attempts:8,accuracy:98},{type:"major_second",mastery:82,attempts:8,accuracy:85},{type:"major_third",mastery:78,attempts:8,accuracy:80},{type:"perfect_fourth",mastery:65,attempts:8,accuracy:68},{type:"perfect_fifth",mastery:88,attempts:8,accuracy:90},{type:"major_sixth",mastery:72,attempts:8,accuracy:75},{type:"major_seventh",mastery:58,attempts:8,accuracy:62},{type:"octave",mastery:92,attempts:8,accuracy:94}]),t(13,U=[{score:65,timestamp:Date.now()-42e4},{score:72,timestamp:Date.now()-36e4},{score:68,timestamp:Date.now()-3e5},{score:75,timestamp:Date.now()-24e4},{score:78,timestamp:Date.now()-18e4},{score:82,timestamp:Date.now()-12e4},{score:80,timestamp:Date.now()-6e4},{score:85,timestamp:Date.now()}]),t(14,L={type:"improvement",primary:"良い進歩が見られます！",summary:"音程の認識精度が向上しています。特に完全5度とオクターブの習得度が高く、基本的な音感が身についてきています。",details:[{category:"strengths",text:"ユニゾンとオクターブの認識がほぼ完璧です"},{category:"strengths",text:"完全5度の安定性が優秀です"},{category:"improvements",text:"完全4度の練習をもう少し増やしましょう"},{category:"improvements",text:"長7度の認識精度を向上させましょう"},{category:"tips",text:"4度は「ソーファー」の音程です"},{category:"practice",text:"毎日15分の継続練習を心がけましょう"}],nextSteps:["完全4度の集中練習を行いましょう","連続チャレンジモードで実践練習を","1日15分の継続練習を心がけましょう"],motivation:"継続は力なり！あなたの相対音感は確実に向上しています！"}),t(15,K={totalAttempts:32,successRate:68.8,averageScore:78,bestScore:85,sessionDuration:8,streakCount:4,fatigueLevel:"normal",mostDifficultInterval:"完全4度",mostSuccessfulInterval:"ユニゾン",averageResponseTime:2.1,sessionStart:Date.now()-48e4}),Mt.info("[RandomTraining] テスト採点結果生成完了")}function Ke(){if(!z||z.length===0){console.warn("[UnifiedScore] noteResultsForDisplay が空です");return}const Z=z.filter(Ye=>Ye.accuracy!=="notMeasured").length,J=z.length,ge=z.filter(Ye=>Ye.accuracy!=="notMeasured"&&typeof Ye.accuracy=="number").map(Ye=>Ye.accuracy),j=ge.length>0?Math.round(ge.reduce((Ye,kt)=>Ye+kt,0)/ge.length):0,ne=b||"Unknown",ke=k||0,Qe=z.map(Ye=>({name:Ye.name,note:Ye.note||Ye.name,frequency:Ye.targetFreq||Ye.expectedFrequency,detectedFrequency:Ye.detectedFreq,cents:Ye.cents,grade:mh(Ye.cents),targetFreq:Ye.targetFreq,diff:Ye.diff})),_e=u,Ve=(_e==null?void 0:_e.sessionHistory)||[],ns={timestamp:new Date,baseNote:ne,baseFrequency:ke,noteResults:Qe,measuredNotes:Z,accuracy:j,grade:sy(z)};t(16,Q={mode:"random",timestamp:new Date,duration:60,totalNotes:J,measuredNotes:Z,averageAccuracy:j,baseNote:ne,baseFrequency:ke,noteResults:Qe,distribution:ny(z),sessionHistory:[...Ve,ns]}),console.log("[UnifiedScore] 統合採点データ生成完了（完全版）:",Q),qt()}async function qt(){if(!z||z.length===0){console.warn("📊 [SessionStorage] 保存データなし");return}try{console.log("📊 [SessionStorage] セッション結果保存開始");const Z=z.map(ke=>({name:ke.name,cents:ke.cents,targetFreq:ke.targetFreq||ke.expectedFrequency,detectedFreq:ke.detectedFreq,diff:ke.diff,accuracy:typeof ke.accuracy=="number"?ke.accuracy:0})),J=be?Math.round((Date.now()-be)/1e3):60;await ph(Z,J,l,a)?(console.log("📊 [SessionStorage] セッション結果保存完了"),console.log("📊 [SessionStorage] 保存後の状況:",{currentSession:i,totalSessions:c.length,isCompleted:s,nextBaseNote:l,nextBaseName:a})):console.error("📊 [SessionStorage] セッション結果保存失敗")}catch(Z){console.error("📊 [SessionStorage] セッション保存エラー:",Z)}}function Re(){try{if(B){const Z=B.generateDetailedReport();t(11,G={totalScore:Z.totalScore||0,grade:Z.grade||"C",componentScores:Z.componentScores||{accuracy:0,speed:0,consistency:0}}),Z.intervalAnalysis&&Z.intervalAnalysis.masteryLevels?t(12,Y=Object.entries(Z.intervalAnalysis.masteryLevels).map(([J,ge])=>{var j;return{type:J,mastery:Math.round(ge),attempts:((j=Z.intervalAnalysis.attemptCounts)==null?void 0:j[J])||0,accuracy:Math.round(ge*.9)}})):t(12,Y=jc(z)),Z.consistencyHistory&&Array.isArray(Z.consistencyHistory)?t(13,U=Z.consistencyHistory.map((J,ge)=>({score:Math.round(J),timestamp:Date.now()-(Z.consistencyHistory.length-ge)*1e3}))):t(13,U=Ze(z)),t(14,L=Z.feedback||Yt(z)),t(15,K={totalAttempts:Z.totalAttempts||z.length,successRate:Z.successRate||z.filter(J=>J.accuracy!=="notMeasured").length/z.length*100,averageScore:Z.totalScore||(Q==null?void 0:Q.averageAccuracy)||0,bestScore:Math.max(Z.totalScore||0,K.bestScore||0),sessionDuration:Math.round(60),streakCount:Z.streak||0,fatigueLevel:Z.fatigueLevel||"normal",mostDifficultInterval:Z.mostDifficultInterval||"未特定",mostSuccessfulInterval:Z.mostSuccessfulInterval||"未特定",averageResponseTime:Z.averageResponseTime||2.5,sessionStart:Date.now()-6e4})}else Xt();console.log("[EnhancedScoring] 追加採点データ生成完了")}catch(Z){console.error("[EnhancedScoring] データ生成エラー:",Z),Xt()}}function Xt(){const Z=z.filter(ge=>ge.accuracy!=="notMeasured"),J=(Q==null?void 0:Q.averageAccuracy)||0;t(11,G={totalScore:Math.round(J*.8),grade:J>=90?"A":J>=80?"B":J>=70?"C":"D",componentScores:{accuracy:J,speed:85,consistency:Math.max(60,J-10)}}),t(12,Y=jc()),t(13,U=Ze()),t(14,L=Yt(z)),t(15,K={totalAttempts:z.length,successRate:Z.length/z.length*100,averageScore:J,bestScore:J,sessionDuration:60,streakCount:0,fatigueLevel:"normal",mostDifficultInterval:"未分析",mostSuccessfulInterval:"未分析",averageResponseTime:2.5,sessionStart:Date.now()-6e4})}function Ze(Z){const J=(Q==null?void 0:Q.averageAccuracy)||70;return Array.from({length:8},(ge,j)=>({score:Math.max(30,Math.min(100,J+(Math.random()-.5)*20)),timestamp:Date.now()-(8-j)*7500}))}function Yt(Z){const J=Z.filter(Qe=>Qe.accuracy!=="notMeasured").length,ge=(Q==null?void 0:Q.averageAccuracy)||0;let j,ne,ke;return ge>=85?(j="excellent",ne="すばらしい演奏でした！",ke="高い精度で音程を捉えています。この調子で練習を続けてください。"):ge>=70?(j="improvement",ne="良い進歩が見られます！",ke="音程の認識精度が向上しています。継続的な練習で更なる向上が期待できます。"):ge>=50?(j="practice",ne="練習を重ねましょう",ke="基本的な音程感覚は身についています。より正確な音程を意識して練習してみてください。"):(j="encouragement",ne="継続が大切です",ke="音程トレーニングは継続が重要です。焦らずに基本から練習していきましょう。"),{type:j,primary:ne,summary:ke,categories:[{name:"音程精度",icon:"Target",score:ge,message:`${ge}%の精度で音程を捉えています`},{name:"測定成功率",icon:"Mic",score:Math.round(J/Z.length*100),message:`${Z.length}音中${J}音を正常に測定`}]}}Yc(async()=>{if(!localStorage.getItem("mic-test-completed")){console.log("🚫 [RandomTraining] マイクテスト未完了 - 準備画面表示"),Je();return}console.log("📊 [SessionStorage] セッション管理初期化開始");try{if(await $o()){if(console.log("📊 [SessionStorage] セッション進行状況の読み込み完了"),console.log("📊 [SessionStorage] 現在のセッション:",i,"/ 8"),console.log("📊 [SessionStorage] 次の基音:",l,"(",a,")"),console.log("📊 [SessionStorage] 完了状況:",s?"8セッション完了":`残り${o}セッション`),s&&(console.log("🔄 [SessionStorage] 8セッション完了検出 - 新サイクル開始処理"),await Kr()?console.log("✅ [SessionStorage] 新サイクル開始完了 - セッション1/8から再開"):console.warn("⚠️ [SessionStorage] 新サイクル開始処理が失敗")),i>1&&!s){console.warn("🔄 [SessionStorage] セッション途中でのリロード検出 - セッション1から再開"),console.warn("🔄 [SessionStorage] 現在:",i,"セッション目 → ダイレクトアクセス誘導");const{SessionStorageManager:ge}=await Sa(async()=>{const{SessionStorageManager:ke}=await Promise.resolve().then(()=>$0);return{SessionStorageManager:ke}},void 0,import.meta.url),j=ge.getInstance();localStorage.removeItem("random-training-progress"),localStorage.removeItem("random-training-progress-backup");const{resetProgress:ne}=await Sa(async()=>{const{resetProgress:ke}=await Promise.resolve().then(()=>F0);return{resetProgress:ke}},void 0,import.meta.url);await ne(),console.log("🔄 [SessionStorage] localStorage + ストア状態完全リセット完了"),Je();return}}else console.log("📊 [SessionStorage] 新規セッション開始")}catch(J){console.error("📊 [SessionStorage] 初期化エラー:",J)}if(je(),_t(),r.url.searchParams.get("from")==="microphone-test"){console.log("🎤 [RandomTraining] マイクテストページからの遷移を検出");const J=new URL(window.location);if(J.searchParams.delete("from"),window.history.replaceState({},"",J),t(1,m="granted"),t(0,d="setup"),console.log('🎤 [RandomTraining] microphoneState="granted", trainingPhase="setup" に設定'),!Ce){console.log("🎤 [RandomTraining] AudioManagerリソース取得開始");try{const ge=await Na.initialize();ye=ge.audioContext,Ce=ge.mediaStream,me=ge.sourceNode,console.log("🎤 [RandomTraining] AudioManagerリソース取得完了")}catch(ge){console.warn("⚠️ AudioManagerリソース取得失敗（後で再試行）:",ge)}}if(await new Promise(ge=>setTimeout(ge,300)),ve&&ve.getIsInitialized&&!ve.getIsInitialized())try{console.log("🎙️ [RandomTraining] PitchDetector初期化開始"),await ve.initialize(),console.log("✅ [RandomTraining] PitchDetector初期化完了")}catch(ge){console.warn("⚠️ PitchDetector初期化失敗:",ge)}}else await new Promise(J=>setTimeout(J,100)),Je()});function Ct(Z){const{frequency:J,note:ge,volume:j,rawVolume:ne,clarity:ke}=Z.detail;let Qe=J,_e=ge;if(d==="guiding"&&w&&k>0&&J>0){const Ve=Qt(J);Ve&&(Qe=Ve.frequency,_e=Ve.note)}t(9,F=Qe),t(10,q=_e),t(8,M=j),Wt(J),B&&J>0&&k>0&&Ot(J,ge)}function Qt(Z){if(!Z||Z<=0||!w||!k||M<25)return null;const ge=T-1;if(ge<0||ge>=C.length)return null;const j=Oe(k,ge);if(!j||j<=0)return null;const ke=Uc(Z,j).correctedFrequency,Qe=ry(ke);return{frequency:Math.round(ke),note:Qe}}function Wt(Z,J){if(!Z||Z<=0||!w)return;if(!k||k<=0){console.error(`❌ [採点エラー] 基音周波数が無効: ${k}Hz`),console.error(`❌ [採点エラー] 基音名: ${b}`),console.error(`❌ [採点エラー] activeStepIndex: ${T-1}`),console.error(`❌ [採点エラー] trainingPhase: ${d}`),console.error(`❌ [採点エラー] isGuideAnimationActive: ${w}`);return}if(M<25)return;const j=T-1;if(j<0||j>=C.length)return;j>=4&&Mt.debug(`[採点デバッグ] activeStepIndex=${j} (${C[j].name}), currentBaseFrequency=${k}Hz`);const ne=Oe(k,j);if(j>=0&&Mt.debug(`[音程計算修正版] ${C[j].name}: 期待周波数 ${ne.toFixed(1)}Hz`),!ne||ne<=0||!isFinite(ne)){console.error("❌ [採点エラー] 期待周波数計算エラー:"),console.error(`   基音周波数: ${k}Hz`),console.error(`   音階インデックス: ${j}`),console.error(`   期待周波数: ${ne}Hz`);return}const ke=Uc(Z,ne),Qe=ke.correctedFrequency,_e=ke.factor,Ve=Math.round(1200*Math.log2(Qe/ne));if((Math.abs(Ve)>200||_e!==1)&&(Mt.debug(`[プロトタイプ式補正] ${C[j].name}:`),console.warn(`   検出周波数: ${Z.toFixed(1)}Hz`),console.warn(`   補正後周波数: ${Qe.toFixed(1)}Hz`),console.warn(`   期待周波数: ${ne.toFixed(1)}Hz`),console.warn(`   セント差: ${Ve}¢`),console.warn(`   補正係数: ${_e} (${ke.description})`),console.warn(`   基音: ${b} (${k.toFixed(1)}Hz)`)),!isFinite(Ve)){console.error("❌ [採点エラー] セント計算エラー:"),console.error(`   検出周波数: ${Z}Hz`),console.error(`   期待周波数: ${ne}Hz`),console.error(`   セント差: ${Ve}`);return}const Ye=Math.abs(Ve)<=50;if(M>=15){const Pt=Math.max(0,Math.round(100-Math.abs(Ve))),ds=D.findIndex(Jt=>Jt.stepIndex===j),as={stepIndex:j,stepName:C[j].name,expectedFrequency:Math.round(ne),detectedFrequency:Math.round(Z),adjustedFrequency:Math.round(Qe),centDifference:Ve,accuracy:Pt,isCorrect:Ye,correctionFactor:_e,correctionDescription:ke.description,timestamp:Date.now()};ds>=0?D[ds]=as:D.push(as),D.length%4===0&&Mt.realtime(`採点進捗: ${D.length}/${C.length}ステップ完了`)}}async function We(){if(s){console.warn("🚫 [RestartSame] 8セッション完了状態では再挑戦不可 - 新サイクル開始が必要"),await Kr()?(console.log("✅ [RestartSame] 新サイクル開始完了 - セッション1/8から再開"),window.location.reload()):console.error("❌ [RestartSame] 新サイクル開始失敗");return}Ai(),t(0,d="setup"),A&&(clearTimeout(A),A=null),ve&&ve.resetDisplayState&&ve.resetDisplayState(),Xe(),console.log("🔄 [RestartSame] 同じ基音で再挑戦:",b,k+"Hz"),console.log("🔄 [RestartSame] 基音情報保持完了 - ユーザー操作待機")}async function Ss(){if(s){console.warn("🚫 [RestartDifferent] 8セッション完了状態では再挑戦不可 - 新サイクル開始が必要"),await Kr()?(console.log("✅ [RestartDifferent] 新サイクル開始完了 - セッション1/8から再開"),window.location.reload()):console.error("❌ [RestartDifferent] 新サイクル開始失敗");return}Ai(),t(0,d="setup"),A&&(clearTimeout(A),A=null),t(4,b=""),t(5,k=0),console.log("🔄 [restartDifferentBaseNote] 基音情報をリセットしました"),ve&&ve.resetDisplayState&&ve.resetDisplayState(),Xe()}function Xe(){T=0,w=!1,D=[],t(7,C=C.map(Z=>({...Z,state:"inactive",completed:!1})))}async function et(){console.log("🚀 [StartNewCycle] 8セッション完了後の最初から挑戦開始");try{await Kr()?(console.log("✅ [StartNewCycle] 新サイクル開始完了"),localStorage.getItem("mic-test-completed")?(console.log("✅ [StartNewCycle] マイクテスト完了フラグ確認 - リロードなしで状態リセット"),Ai(),await $o(),t(0,d="setup"),Xe(),fe(),console.log("✅ [StartNewCycle] 状態リセット完了 - セッション1/8から再開")):window.location.reload()):(console.error("❌ [StartNewCycle] 新サイクル開始失敗"),$e())}catch(Z){console.error("❌ [StartNewCycle] 新サイクル開始エラー:",Z),$e()}}function $s(Z){const{type:J}=Z.detail;switch(J){case"same":We();break;case"different":Ss();break;case"restart":et();break;case"home":$e();break;default:console.warn("🚫 [ActionButtons] 未知のアクションタイプ:",J)}}function Tt(Z){const{healthy:J,errors:ge,details:j}=Z.detail;t(2,_=J),t(3,g=ge),J||(console.warn("⚠️ マイクの健康状態が悪化:",ge),d==="guiding"&&(t(0,d="setup"),console.warn("🛑 マイク問題によりトレーニングを停止")))}Sh(()=>{console.log("🔄 [RandomTraining] onDestroy - AudioManagerリソースは保持"),te&&(te.dispose(),t(28,te=null))});function Dt(Z){Zc[Z?"unshift":"push"](()=>{ve=Z,t(17,ve)})}return n.$$.update=()=>{n.$$.dirty[0]&805306374,n.$$.dirty[0]&1,n.$$.dirty[0]&3&&d==="setup"&&m==="granted"&&Ai()},[d,m,_,g,b,k,I,C,M,F,q,G,Y,U,L,K,Q,ve,s,c,h,f,De,Te,$e,Ct,$s,Tt,te,ce,Dt]}class Gy extends Be{constructor(e){super(),He(this,e,ay,ty,Le,{},null,[-1,-1,-1,-1])}}export{Gy as component};
