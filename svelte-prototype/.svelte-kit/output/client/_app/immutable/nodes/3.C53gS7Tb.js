import{S as ne,i as oe,d as L,s as ie,v as le,c as se,a as ce,D as ht,E as St,b as v,q as lt,r as $,u as Y,f as b,w as st,F as re,m as T,x as ct,p as N,y as rt,g as h,z as m,h as g,j as y,k as z,B as at,A as H,o as p,C as ut,G as It,H as Mt,l as Q,t as X,n as nt,e as _t,I as vt,J as ft,K as dt}from"../chunks/EvMzC0aQ.js";import{g as ae}from"../chunks/D0QH3NT1.js";import"../chunks/DrEUfQCr.js";import{p as gt}from"../chunks/0GndSS7-.js";import{P as Pt,B as wt,C as yt}from"../chunks/yXPAb40O.js";import{P as ue,V as Ft}from"../chunks/sE10pGVB.js";const{console:fe}=ae,_="src/routes/microphone-test/+page.svelte";function Rt(c){let t,n="üé§ „Éû„Ç§„ÇØ„ÉÜ„Çπ„Éà„ÇíÈñãÂßã„Åó„Å¶„Åè„Å†„Åï„ÅÑ",s,e,i="„Éû„Ç§„ÇØË®±ÂèØ„ÇíÂèñÂæó",l,r;const u={c:function(){t=p("div"),t.textContent=n,s=N(),e=p("button"),e.textContent=i,this.h()},l:function(o){t=y(o,"DIV",{class:!0,"data-svelte-h":!0}),H(t)!=="svelte-1trsgl3"&&(t.textContent=n),s=T(o),e=y(o,"BUTTON",{class:!0,"data-svelte-h":!0}),H(e)!=="svelte-1m6icav"&&(e.textContent=i),this.h()},h:function(){m(t,"class","status-indicator pending svelte-ztuqv4"),g(t,_,515,14,15782),m(e,"class","retry-button svelte-ztuqv4"),g(e,_,516,14,15859)},m:function(o,a){b(o,t,a),b(o,s,a),b(o,e,a),l||(r=ft(e,"click",c[11],!1),l=!0)},p:nt,d:function(o){o&&(v(t),v(s),v(e)),l=!1,r()}};return L("SvelteRegisterBlock",{block:u,id:Rt.name,type:"else",source:"(515:12) {:else}",ctx:c}),u}function Lt(c){let t,n="‚ùå „Éû„Ç§„ÇØ„Ç¢„ÇØ„Çª„Çπ„Ç®„É©„Éº„ÅåÁô∫Áîü„Åó„Åæ„Åó„Åü",s,e,i="„Éû„Ç§„ÇØË®±ÂèØ„ÇíÂÜçË©¶Ë°å",l,r;const u={c:function(){t=p("div"),t.textContent=n,s=N(),e=p("button"),e.textContent=i,this.h()},l:function(o){t=y(o,"DIV",{class:!0,"data-svelte-h":!0}),H(t)!=="svelte-11p6bhs"&&(t.textContent=n),s=T(o),e=y(o,"BUTTON",{class:!0,"data-svelte-h":!0}),H(e)!=="svelte-1co4n23"&&(e.textContent=i),this.h()},h:function(){m(t,"class","status-indicator error svelte-ztuqv4"),g(t,_,510,14,15563),m(e,"class","retry-button svelte-ztuqv4"),g(e,_,511,14,15639)},m:function(o,a){b(o,t,a),b(o,s,a),b(o,e,a),l||(r=ft(e,"click",c[11],!1),l=!0)},p:nt,d:function(o){o&&(v(t),v(s),v(e)),l=!1,r()}};return L("SvelteRegisterBlock",{block:u,id:Lt.name,type:"if",source:"(510:48) ",ctx:c}),u}function Tt(c){let t,n="‚ùå „Éû„Ç§„ÇØ„Ç¢„ÇØ„Çª„Çπ„ÅåÊãíÂê¶„Åï„Çå„Åæ„Åó„Åü",s,e,i="„Éû„Ç§„ÇØË®±ÂèØ„ÇíÂÜçË©¶Ë°å",l,r;const u={c:function(){t=p("div"),t.textContent=n,s=N(),e=p("button"),e.textContent=i,this.h()},l:function(o){t=y(o,"DIV",{class:!0,"data-svelte-h":!0}),H(t)!=="svelte-4rewx4"&&(t.textContent=n),s=T(o),e=y(o,"BUTTON",{class:!0,"data-svelte-h":!0}),H(e)!=="svelte-1co4n23"&&(e.textContent=i),this.h()},h:function(){m(t,"class","status-indicator error svelte-ztuqv4"),g(t,_,505,14,15317),m(e,"class","retry-button svelte-ztuqv4"),g(e,_,506,14,15391)},m:function(o,a){b(o,t,a),b(o,s,a),b(o,e,a),l||(r=ft(e,"click",c[11],!1),l=!0)},p:nt,d:function(o){o&&(v(t),v(s),v(e)),l=!1,r()}};return L("SvelteRegisterBlock",{block:u,id:Tt.name,type:"if",source:"(505:49) ",ctx:c}),u}function Nt(c){let t,n="‚úÖ „Éû„Ç§„ÇØ„Ç¢„ÇØ„Çª„ÇπË®±ÂèØÊ∏à„Åø",s,e;function i(f,o){if(!f[3]&&!f[4])return Ot;if(!f[3]&&f[4])return jt;if(f[3])return Ut}let l=i(c),r=l&&l(c);const u={c:function(){t=p("div"),t.textContent=n,s=N(),r&&r.c(),e=vt(),this.h()},l:function(o){t=y(o,"DIV",{class:!0,"data-svelte-h":!0}),H(t)!=="svelte-96x1w2"&&(t.textContent=n),s=T(o),r&&r.l(o),e=vt(),this.h()},h:function(){m(t,"class","status-indicator granted svelte-ztuqv4"),g(t,_,490,14,14511)},m:function(o,a){b(o,t,a),b(o,s,a),r&&r.m(o,a),b(o,e,a)},p:function(o,a){l===(l=i(o))&&r?r.p(o,a):(r&&r.d(1),r=l&&l(o),r&&(r.c(),r.m(e.parentNode,e)))},d:function(o){o&&(v(t),v(s),v(e)),r&&r.d(o)}};return L("SvelteRegisterBlock",{block:u,id:Nt.name,type:"if",source:"(490:50) ",ctx:c}),u}function Ht(c){let t,n="‚è≥ „Éû„Ç§„ÇØË®±ÂèØ„ÇíÁ¢∫Ë™ç‰∏≠...";const s={c:function(){t=p("div"),t.textContent=n,this.h()},l:function(i){t=y(i,"DIV",{class:!0,"data-svelte-h":!0}),H(t)!=="svelte-qiomfc"&&(t.textContent=n),this.h()},h:function(){m(t,"class","status-indicator pending svelte-ztuqv4"),g(t,_,488,14,14387)},m:function(i,l){b(i,t,l)},p:nt,d:function(i){i&&v(t)}};return L("SvelteRegisterBlock",{block:s,id:Ht.name,type:"if",source:"(488:12) {#if micPermission === 'pending'}",ctx:c}),s}function Ut(c){let t,n="üé§ „É™„Ç¢„É´„Çø„Ç§„É†Ëß£Êûê‰∏≠";const s={c:function(){t=p("div"),t.textContent=n,this.h()},l:function(i){t=y(i,"DIV",{class:!0,"data-svelte-h":!0}),H(t)!=="svelte-bm11qy"&&(t.textContent=n),this.h()},h:function(){m(t,"class","status-indicator success svelte-ztuqv4"),g(t,_,502,16,15176)},m:function(i,l){b(i,t,l)},p:nt,d:function(i){i&&v(t)}};return L("SvelteRegisterBlock",{block:s,id:Ut.name,type:"if",source:"(502:36) ",ctx:c}),s}function jt(c){let t,n="‚ö†Ô∏è Èü≥Â£∞„Ç≥„É≥„ÉÜ„Ç≠„Çπ„Éà„Åå„Éñ„É≠„ÉÉ„ÇØ„Åï„Çå„Å¶„ÅÑ„Åæ„Åô",s,e,i="Èü≥Â£∞Ê©üËÉΩ„ÇíÂÜçË©¶Ë°å",l,r;const u={c:function(){t=p("div"),t.textContent=n,s=N(),e=p("button"),e.textContent=i,this.h()},l:function(o){t=y(o,"DIV",{class:!0,"data-svelte-h":!0}),H(t)!=="svelte-rn7aam"&&(t.textContent=n),s=T(o),e=y(o,"BUTTON",{class:!0,"data-svelte-h":!0}),H(e)!=="svelte-hrmonq"&&(e.textContent=i),this.h()},h:function(){m(t,"class","status-indicator warning svelte-ztuqv4"),g(t,_,497,16,14920),m(e,"class","retry-button svelte-ztuqv4"),g(e,_,498,16,15003)},m:function(o,a){b(o,t,a),b(o,s,a),b(o,e,a),l||(r=ft(e,"click",c[12],!1),l=!0)},p:nt,d:function(o){o&&(v(t),v(s),v(e)),l=!1,r()}};return L("SvelteRegisterBlock",{block:u,id:jt.name,type:"if",source:"(497:60) ",ctx:c}),u}function Ot(c){let t,n="üéµ Èü≥Â£∞Ê©üËÉΩ„ÇíÈñãÂßã„Åó„Å¶„Åè„Å†„Åï„ÅÑ",s,e,i="üé§ „Éû„Ç§„ÇØ„ÉÜ„Çπ„Éà„ÇíÈñãÂßã",l,r;const u={c:function(){t=p("div"),t.textContent=n,s=N(),e=p("button"),e.textContent=i,this.h()},l:function(o){t=y(o,"DIV",{class:!0,"data-svelte-h":!0}),H(t)!=="svelte-13wnluo"&&(t.textContent=n),s=T(o),e=y(o,"BUTTON",{class:!0,"data-svelte-h":!0}),H(e)!=="svelte-4juur8"&&(e.textContent=i),this.h()},h:function(){m(t,"class","status-indicator warning svelte-ztuqv4"),g(t,_,492,16,14642),m(e,"class","retry-button svelte-ztuqv4"),g(e,_,493,16,14719)},m:function(o,a){b(o,t,a),b(o,s,a),b(o,e,a),l||(r=ft(e,"click",c[12],!1),l=!0)},p:nt,d:function(o){o&&(v(t),v(s),v(e)),l=!1,r()}};return L("SvelteRegisterBlock",{block:u,id:Ot.name,type:"if",source:"(492:14) {#if !isListening && !audioContextBlocked}",ctx:c}),u}function pt(c){let t,n,s,e="Èü≥Èáè„É¨„Éô„É´",i,l,r,u,f,o,a,C="Èü≥Á®ãÊ§úÂá∫",E,k,x,j=c[6].toFixed(1)+"",A,B,D,O,q,V,U,G,W,P,F;l=new Ft({props:{volume:c[5],height:"16px",className:"volume-bar-wrapper"},$$inline:!0});let I=!c[1]&&Ct(c),S=c[8]>0&&kt(c);function et(Z,w){return Z[2]?Z[8]<50?Wt:Gt:Jt}let d=et(c),M=d(c),R=c[1]&&!c[2]&&bt(c);const J={c:function(){t=p("div"),n=p("div"),s=p("h3"),s.textContent=e,i=N(),rt(l.$$.fragment),r=N(),u=p("div"),I&&I.c(),f=N(),o=p("div"),a=p("h3"),a.textContent=C,E=N(),k=p("div"),x=p("div"),A=X(j),B=X(" Hz"),D=N(),O=p("div"),q=X(c[7]),V=N(),S&&S.c(),U=N(),G=p("div"),M.c(),W=N(),R&&R.c(),P=vt(),this.h()},l:function(w){t=y(w,"DIV",{class:!0});var K=z(t);n=y(K,"DIV",{class:!0});var tt=z(n);s=y(tt,"H3",{class:!0,"data-svelte-h":!0}),H(s)!=="svelte-1nc8gri"&&(s.textContent=e),i=T(tt),ct(l.$$.fragment,tt),r=T(tt),u=y(tt,"DIV",{class:!0});var zt=z(u);I&&I.l(zt),zt.forEach(v),tt.forEach(v),f=T(K),o=y(K,"DIV",{class:!0});var ot=z(o);a=y(ot,"H3",{class:!0,"data-svelte-h":!0}),H(a)!=="svelte-1ofzoy2"&&(a.textContent=C),E=T(ot),k=y(ot,"DIV",{class:!0});var it=z(k);x=y(it,"DIV",{class:!0});var mt=z(x);A=Q(mt,j),B=Q(mt," Hz"),mt.forEach(v),D=T(it),O=y(it,"DIV",{class:!0});var Bt=z(O);q=Q(Bt,c[7]),Bt.forEach(v),V=T(it),S&&S.l(it),it.forEach(v),U=T(ot),G=y(ot,"DIV",{class:!0});var Dt=z(G);M.l(Dt),Dt.forEach(v),ot.forEach(v),K.forEach(v),W=T(w),R&&R.l(w),P=vt(),this.h()},h:function(){m(s,"class","display-title svelte-ztuqv4"),g(s,_,527,16,16221),m(u,"class","volume-status svelte-ztuqv4"),g(u,_,529,16,16372),m(n,"class","volume-section svelte-ztuqv4"),g(n,_,526,14,16176),m(a,"class","display-title svelte-ztuqv4"),g(a,_,538,16,16678),m(x,"class","frequency-value svelte-ztuqv4"),g(x,_,540,18,16780),m(O,"class","note-value svelte-ztuqv4"),g(O,_,541,18,16866),m(k,"class","frequency-display svelte-ztuqv4"),g(k,_,539,16,16730),m(G,"class","frequency-status svelte-ztuqv4"),g(G,_,554,16,17517),m(o,"class","frequency-section"),g(o,_,537,14,16630),m(t,"class","realtime-display svelte-ztuqv4"),g(t,_,524,12,16102)},m:function(w,K){b(w,t,K),h(t,n),h(n,s),h(n,i),st(l,n,null),h(n,r),h(n,u),I&&I.m(u,null),h(t,f),h(t,o),h(o,a),h(o,E),h(o,k),h(k,x),h(x,A),h(x,B),h(k,D),h(k,O),h(O,q),h(k,V),S&&S.m(k,null),h(o,U),h(o,G),M.m(G,null),b(w,W,K),R&&R.m(w,K),b(w,P,K),F=!0},p:function(w,K){const tt={};K&32&&(tt.volume=w[5]),l.$set(tt),w[1]?I&&(I.d(1),I=null):I||(I=Ct(w),I.c(),I.m(u,null)),(!F||K&64)&&j!==(j=w[6].toFixed(1)+"")&&_t(A,j),(!F||K&128)&&_t(q,w[7]),w[8]>0?S?S.p(w,K):(S=kt(w),S.c(),S.m(k,null)):S&&(S.d(1),S=null),d!==(d=et(w))&&(M.d(1),M=d(w),M&&(M.c(),M.m(G,null))),w[1]&&!w[2]?R||(R=bt(w),R.c(),R.m(P.parentNode,P)):R&&(R.d(1),R=null)},i:function(w){F||(Y(l.$$.fragment,w),F=!0)},o:function(w){$(l.$$.fragment,w),F=!1},d:function(w){w&&(v(t),v(W),v(P)),lt(l),I&&I.d(),S&&S.d(),M.d(),R&&R.d(w)}};return L("SvelteRegisterBlock",{block:J,id:pt.name,type:"if",source:"(524:10) {#if micPermission === 'granted' && isListening}",ctx:c}),J}function Ct(c){let t,n="‚è≥ Â£∞„ÇíÂá∫„Åó„Å¶Èü≥Èáè„ÇíÁ¢∫Ë™ç„Åó„Å¶„Åè„Å†„Åï„ÅÑ";const s={c:function(){t=p("span"),t.textContent=n,this.h()},l:function(i){t=y(i,"SPAN",{class:!0,"data-svelte-h":!0}),H(t)!=="svelte-7eexnn"&&(t.textContent=n),this.h()},h:function(){m(t,"class","status-pending svelte-ztuqv4"),g(t,_,531,20,16460)},m:function(i,l){b(i,t,l)},d:function(i){i&&v(t)}};return L("SvelteRegisterBlock",{block:s,id:Ct.name,type:"if",source:"(531:18) {#if !volumeDetected}",ctx:c}),s}function kt(c){let t,n,s,e,i,l;const r={c:function(){t=p("div"),n=X("‰ø°È†ºÂ∫¶: "),s=X(c[8]),e=X(`%
                      `),i=p("div"),l=p("div"),this.h()},l:function(f){t=y(f,"DIV",{class:!0});var o=z(t);n=Q(o,"‰ø°È†ºÂ∫¶: "),s=Q(o,c[8]),e=Q(o,`%
                      `),i=y(o,"DIV",{class:!0});var a=z(i);l=y(a,"DIV",{class:!0,style:!0}),z(l).forEach(v),a.forEach(v),o.forEach(v),this.h()},h:function(){m(l,"class","confidence-fill svelte-ztuqv4"),dt(l,"width",c[8]+"%"),dt(l,"background-color",c[8]>70?"#10b981":c[8]>40?"#f59e0b":"#ef4444"),g(l,_,546,24,17136),m(i,"class","confidence-bar svelte-ztuqv4"),g(i,_,545,22,17083),m(t,"class","confidence-display svelte-ztuqv4"),g(t,_,543,20,16978)},m:function(f,o){b(f,t,o),h(t,n),h(t,s),h(t,e),h(t,i),h(i,l)},p:function(f,o){o&256&&_t(s,f[8]),o&256&&dt(l,"width",f[8]+"%"),o&256&&dt(l,"background-color",f[8]>70?"#10b981":f[8]>40?"#f59e0b":"#ef4444")},d:function(f){f&&v(t)}};return L("SvelteRegisterBlock",{block:r,id:kt.name,type:"if",source:"(543:18) {#if detectionConfidence > 0}",ctx:c}),r}function Gt(c){let t,n="‚úÖ Èü≥Á®ãÊ§úÂá∫‰∏≠";const s={c:function(){t=p("span"),t.textContent=n,this.h()},l:function(i){t=y(i,"SPAN",{class:!0,"data-svelte-h":!0}),H(t)!=="svelte-acahk5"&&(t.textContent=n),this.h()},h:function(){m(t,"class","status-success svelte-ztuqv4"),g(t,_,560,20,17842)},m:function(i,l){b(i,t,l)},d:function(i){i&&v(t)}};return L("SvelteRegisterBlock",{block:s,id:Gt.name,type:"else",source:"(560:18) {:else}",ctx:c}),s}function Wt(c){let t,n="‚ö†Ô∏è „Çà„ÇäÊòéÁ¢∫„Å´Áô∫Â£∞„Åó„Å¶„Åè„Å†„Åï„ÅÑ";const s={c:function(){t=p("span"),t.textContent=n,this.h()},l:function(i){t=y(i,"SPAN",{class:!0,"data-svelte-h":!0}),H(t)!=="svelte-lq2kpp"&&(t.textContent=n),this.h()},h:function(){m(t,"class","status-warning svelte-ztuqv4"),g(t,_,558,20,17743)},m:function(i,l){b(i,t,l)},d:function(i){i&&v(t)}};return L("SvelteRegisterBlock",{block:s,id:Wt.name,type:"if",source:"(558:53) ",ctx:c}),s}function Jt(c){let t,n="‚è≥ „Äå„Éâ„Äç„ÇíÁô∫Â£∞„Åó„Å¶Èü≥Á®ã„ÇíÁ¢∫Ë™ç„Åó„Å¶„Åè„Å†„Åï„ÅÑ";const s={c:function(){t=p("span"),t.textContent=n,this.h()},l:function(i){t=y(i,"SPAN",{class:!0,"data-svelte-h":!0}),H(t)!=="svelte-lvftl7"&&(t.textContent=n),this.h()},h:function(){m(t,"class","status-pending svelte-ztuqv4"),g(t,_,556,20,17611)},m:function(i,l){b(i,t,l)},d:function(i){i&&v(t)}};return L("SvelteRegisterBlock",{block:s,id:Jt.name,type:"if",source:"(556:18) {#if !frequencyDetected}",ctx:c}),s}function bt(c){let t,n,s,e="„Äå„Éâ„Äç„ÇíÁô∫Â£∞„Åó„Å¶„Åè„Å†„Åï„ÅÑ",i,l,r="‰ªªÊÑè„ÅÆÈ´ò„Åï„Åß„Äå„Éâ„Éº„Äç„Å®Ê≠å„ÅÜ„Çà„ÅÜ„Å´Áô∫Â£∞„Åó„Å¶„Åè„Å†„Åï„ÅÑ";const u={c:function(){t=p("div"),n=p("div"),s=p("h3"),s.textContent=e,i=N(),l=p("p"),l.textContent=r,this.h()},l:function(o){t=y(o,"DIV",{class:!0});var a=z(t);n=y(a,"DIV",{class:!0});var C=z(n);s=y(C,"H3",{class:!0,"data-svelte-h":!0}),H(s)!=="svelte-xe90gt"&&(s.textContent=e),i=T(C),l=y(C,"P",{class:!0,"data-svelte-h":!0}),H(l)!=="svelte-1rtajtc"&&(l.textContent=r),C.forEach(v),a.forEach(v),this.h()},h:function(){m(s,"class","svelte-ztuqv4"),g(s,_,570,18,18158),m(l,"class","svelte-ztuqv4"),g(l,_,571,18,18198),m(n,"class","guidance-content svelte-ztuqv4"),g(n,_,569,16,18109),m(t,"class","guidance svelte-ztuqv4"),g(t,_,568,14,18070)},m:function(o,a){b(o,t,a),h(t,n),h(n,s),h(n,i),h(n,l)},d:function(o){o&&v(t)}};return L("SvelteRegisterBlock",{block:u,id:bt.name,type:"if",source:"(568:12) {#if volumeDetected && !frequencyDetected}",ctx:c}),u}function Zt(c){let t,n,s,e;function i(o,a){return o[0]==="pending"?Ht:o[0]==="granted"?Nt:o[0]==="denied"?Tt:o[0]==="error"?Lt:Rt}let l=i(c),r=l(c),u=c[0]==="granted"&&c[3]&&pt(c);const f={c:function(){t=p("div"),n=p("div"),r.c(),s=N(),u&&u.c(),this.h()},l:function(a){t=y(a,"DIV",{class:!0});var C=z(t);n=y(C,"DIV",{class:!0});var E=z(n);r.l(E),E.forEach(v),s=T(C),u&&u.l(C),C.forEach(v),this.h()},h:function(){m(n,"class","mic-status svelte-ztuqv4"),g(n,_,486,10,14302),m(t,"class","mic-test-content svelte-ztuqv4"),g(t,_,483,8,14223)},m:function(a,C){b(a,t,C),h(t,n),r.m(n,null),h(t,s),u&&u.m(t,null),e=!0},p:function(a,C){l===(l=i(a))&&r?r.p(a,C):(r.d(1),r=l(a),r&&(r.c(),r.m(n,null))),a[0]==="granted"&&a[3]?u?(u.p(a,C),C&9&&Y(u,1)):(u=pt(a),u.c(),Y(u,1),u.m(t,null)):u&&(It(),$(u,1,1,()=>{u=null}),Mt())},i:function(a){e||(Y(u),e=!0)},o:function(a){$(u),e=!1},d:function(a){a&&v(t),r.d(),u&&u.d()}};return L("SvelteRegisterBlock",{block:f,id:Zt.name,type:"slot",source:'(483:6) <Card variant=\\"default\\" padding=\\"lg\\">',ctx:c}),f}function Kt(c){let t,n;t=new wt({props:{variant:"disabled",size:"lg",fullWidth:!0,disabled:!0,$$slots:{default:[Qt]},$$scope:{ctx:c}},$$inline:!0});const s={c:function(){rt(t.$$.fragment)},l:function(i){ct(t.$$.fragment,i)},m:function(i,l){st(t,i,l),n=!0},p:function(i,l){const r={};l&33554432&&(r.$$scope={dirty:l,ctx:i}),t.$set(r)},i:function(i){n||(Y(t.$$.fragment,i),n=!0)},o:function(i){$(t.$$.fragment,i),n=!1},d:function(i){lt(t,i)}};return L("SvelteRegisterBlock",{block:s,id:Kt.name,type:"else",source:"(599:10) {:else}",ctx:c}),s}function Yt(c){let t,n;t=new wt({props:{href:c[10].path,variant:"primary",size:"lg",fullWidth:!0,$$slots:{default:[Xt]},$$scope:{ctx:c}},$$inline:!0});const s={c:function(){rt(t.$$.fragment)},l:function(i){ct(t.$$.fragment,i)},m:function(i,l){st(t,i,l),n=!0},p:function(i,l){const r={};l&33554432&&(r.$$scope={dirty:l,ctx:i}),t.$set(r)},i:function(i){n||(Y(t.$$.fragment,i),n=!0)},o:function(i){$(t.$$.fragment,i),n=!1},d:function(i){lt(t,i)}};return L("SvelteRegisterBlock",{block:s,id:Yt.name,type:"if",source:"(590:10) {#if startButtonEnabled}",ctx:c}),s}function Qt(c){let t;const n={c:function(){t=X("„Éû„Ç§„ÇØ„ÉÜ„Çπ„ÉàÂÆå‰∫ÜÂæå„Å´ÈñãÂßã")},l:function(e){t=Q(e,"„Éû„Ç§„ÇØ„ÉÜ„Çπ„ÉàÂÆå‰∫ÜÂæå„Å´ÈñãÂßã")},m:function(e,i){b(e,t,i)},d:function(e){e&&v(t)}};return L("SvelteRegisterBlock",{block:n,id:Qt.name,type:"slot",source:'(600:12) <Button                variant=\\"disabled\\"                size=\\"lg\\"                fullWidth                disabled             >',ctx:c}),n}function Xt(c){let t;const n={c:function(){t=X("„Éà„É¨„Éº„Éã„É≥„Ç∞ÈñãÂßã")},l:function(e){t=Q(e,"„Éà„É¨„Éº„Éã„É≥„Ç∞ÈñãÂßã")},m:function(e,i){b(e,t,i)},d:function(e){e&&v(t)}};return L("SvelteRegisterBlock",{block:n,id:Xt.name,type:"slot",source:'(591:12) <Button                href={selectedMode.path}                variant=\\"primary\\"                size=\\"lg\\"                fullWidth             >',ctx:c}),n}function $t(c){let t,n,s=c[10].name+"",e,i,l,r=c[10].description+"",u,f,o,a,C;const E=[Yt,Kt],k=[];function x(A,B){return A[9]?0:1}o=x(c),a=k[o]=E[o](c);const j={c:function(){t=p("div"),n=p("h3"),e=X(s),i=N(),l=p("p"),u=X(r),f=N(),a.c(),this.h()},l:function(B){t=y(B,"DIV",{class:!0});var D=z(t);n=y(D,"H3",{class:!0});var O=z(n);e=Q(O,s),O.forEach(v),i=T(D),l=y(D,"P",{class:!0});var q=z(l);u=Q(q,r),q.forEach(v),f=T(D),a.l(D),D.forEach(v),this.h()},h:function(){m(n,"class","start-title svelte-ztuqv4"),g(n,_,584,10,18492),m(l,"class","start-description svelte-ztuqv4"),g(l,_,585,10,18551),m(t,"class","start-content svelte-ztuqv4"),g(t,_,583,8,18454)},m:function(B,D){b(B,t,D),h(t,n),h(n,e),h(t,i),h(t,l),h(l,u),h(t,f),k[o].m(t,null),C=!0},p:function(B,D){let O=o;o=x(B),o===O?k[o].p(B,D):(It(),$(k[O],1,1,()=>{k[O]=null}),Mt(),a=k[o],a?a.p(B,D):(a=k[o]=E[o](B),a.c()),Y(a,1),a.m(t,null))},i:function(B){C||(Y(a),C=!0)},o:function(B){$(a),C=!1},d:function(B){B&&v(t),k[o].d()}};return L("SvelteRegisterBlock",{block:j,id:$t.name,type:"slot",source:'(583:6) <Card variant=\\"default\\" padding=\\"lg\\">',ctx:c}),j}function te(c){let t,n,s,e,i,l,r,u,f,o,a,C,E="„Éû„Ç§„ÇØ„ÉÜ„Çπ„Éà",k,x,j="Èü≥ÊÑü„Éà„É¨„Éº„Éã„É≥„Ç∞„ÇíÂßã„ÇÅ„ÇãÂâç„Å´„ÄÅ„Éû„Ç§„ÇØ„ÅÆÂãï‰Ωú„ÇíÁ¢∫Ë™ç„Åó„Åæ„Åô",A,B,D,O,q,V,U;D=new yt({props:{variant:"default",padding:"lg",$$slots:{default:[Zt]},$$scope:{ctx:c}},$$inline:!0}),V=new yt({props:{variant:"default",padding:"lg",$$slots:{default:[$t]},$$scope:{ctx:c}},$$inline:!0});const G={c:function(){t=p("div"),n=p("div"),s=p("div"),e=p("div"),i=ut("svg"),l=ut("path"),r=ut("path"),u=ut("line"),f=ut("line"),o=N(),a=p("div"),C=p("h1"),C.textContent=E,k=N(),x=p("p"),x.textContent=j,A=N(),B=p("div"),rt(D.$$.fragment),O=N(),q=p("div"),rt(V.$$.fragment),this.h()},l:function(P){t=y(P,"DIV",{class:!0});var F=z(t);n=y(F,"DIV",{class:!0});var I=z(n);s=y(I,"DIV",{class:!0});var S=z(s);e=y(S,"DIV",{class:!0});var et=z(e);i=at(et,"svg",{width:!0,height:!0,viewBox:!0,fill:!0,stroke:!0,"stroke-width":!0});var d=z(i);l=at(d,"path",{d:!0}),z(l).forEach(v),r=at(d,"path",{d:!0}),z(r).forEach(v),u=at(d,"line",{x1:!0,x2:!0,y1:!0,y2:!0}),z(u).forEach(v),f=at(d,"line",{x1:!0,x2:!0,y1:!0,y2:!0}),z(f).forEach(v),d.forEach(v),et.forEach(v),o=T(S),a=y(S,"DIV",{});var M=z(a);C=y(M,"H1",{class:!0,"data-svelte-h":!0}),H(C)!=="svelte-z7m4lk"&&(C.textContent=E),k=T(M),x=y(M,"P",{class:!0,"data-svelte-h":!0}),H(x)!=="svelte-1vtv92f"&&(x.textContent=j),M.forEach(v),S.forEach(v),I.forEach(v),A=T(F),B=y(F,"DIV",{class:!0});var R=z(B);ct(D.$$.fragment,R),R.forEach(v),O=T(F),q=y(F,"DIV",{class:!0});var J=z(q);ct(V.$$.fragment,J),J.forEach(v),F.forEach(v),this.h()},h:function(){m(l,"d","M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z"),g(l,_,467,12,13687),m(r,"d","M19 10v2a7 7 0 0 1-14 0v-2"),g(r,_,468,12,13764),m(u,"x1","12"),m(u,"x2","12"),m(u,"y1","19"),m(u,"y2","22"),g(u,_,469,12,13815),m(f,"x1","8"),m(f,"x2","16"),m(f,"y1","22"),m(f,"y2","22"),g(f,_,470,12,13867),m(i,"width","48"),m(i,"height","48"),m(i,"viewBox","0 0 24 24"),m(i,"fill","none"),m(i,"stroke","currentColor"),m(i,"stroke-width","2"),g(i,_,466,10,13575),m(e,"class","mic-icon svelte-ztuqv4"),g(e,_,465,8,13542),m(C,"class","mic-test-title svelte-ztuqv4"),g(C,_,474,10,13962),m(x,"class","mic-test-description svelte-ztuqv4"),g(x,_,475,10,14011),g(a,_,473,8,13946),m(s,"class","mic-test-header svelte-ztuqv4"),g(s,_,464,6,13504),m(n,"class","header svelte-ztuqv4"),g(n,_,463,4,13477),m(B,"class","test-section"),g(B,_,481,4,14144),m(q,"class","start-section"),g(q,_,581,4,18374),m(t,"class","microphone-test svelte-ztuqv4"),g(t,_,461,2,13425)},m:function(P,F){b(P,t,F),h(t,n),h(n,s),h(s,e),h(e,i),h(i,l),h(i,r),h(i,u),h(i,f),h(s,o),h(s,a),h(a,C),h(a,k),h(a,x),h(t,A),h(t,B),st(D,B,null),h(t,O),h(t,q),st(V,q,null),U=!0},p:function(P,F){const I={};F&33554943&&(I.$$scope={dirty:F,ctx:P}),D.$set(I);const S={};F&33554944&&(S.$$scope={dirty:F,ctx:P}),V.$set(S)},i:function(P){U||(Y(D.$$.fragment,P),Y(V.$$.fragment,P),U=!0)},o:function(P){$(D.$$.fragment,P),$(V.$$.fragment,P),U=!1},d:function(P){P&&v(t),lt(D),lt(V)}};return L("SvelteRegisterBlock",{block:G,id:te.name,type:"slot",source:"(461:0) <PageLayout showBackButton={true}>",ctx:c}),G}function qt(c){let t,n,s;n=new Pt({props:{showBackButton:!0,$$slots:{default:[te]},$$scope:{ctx:c}},$$inline:!0});const e={c:function(){t=N(),rt(n.$$.fragment),this.h()},l:function(l){re("svelte-8st1fo",document.head).forEach(v),t=T(l),ct(n.$$.fragment,l),this.h()},h:function(){document.title="„Éû„Ç§„ÇØ„ÉÜ„Çπ„Éà - Áõ∏ÂØæÈü≥ÊÑü„Éà„É¨„Éº„Éã„É≥„Ç∞"},m:function(l,r){b(l,t,r),st(n,l,r),s=!0},p:function(l,[r]){const u={};r&33555455&&(u.$$scope={dirty:r,ctx:l}),n.$set(u)},i:function(l){s||(Y(n.$$.fragment,l),s=!0)},o:function(l){$(n.$$.fragment,l),s=!1},d:function(l){l&&v(t),lt(n,l)}};return L("SvelteRegisterBlock",{block:e,id:qt.name,type:"component",source:"",ctx:c}),e}const Et=5;function xt(c){if(c<=0)return"C4Ôºà„Éâ4Ôºâ";const n=Math.round(12*Math.log2(c/440)),s=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],e=((n+9)%12+12)%12,i=Math.floor((n+9)/12)+4,l=s[e];return`${l}${i}Ôºà${{C:"„Éâ","C#":"„Éâ#",D:"„É¨","D#":"„É¨#",E:"„Éü",F:"„Éï„Ç°","F#":"„Éï„Ç°#",G:"„ÇΩ","G#":"„ÇΩ#",A:"„É©","A#":"„É©#",B:"„Ç∑"}[l]}${i}Ôºâ`}function At(c,t){let n=0;for(let o=0;o<c.length;o++)n+=c[o]*c[o];if(n=Math.sqrt(n/c.length),n<.01)return 0;const s=ee(c,t,70),e=Math.floor(t/800),i=Math.floor(t/70);let l=0,r=0,u=0;for(let o=e;o<=i;o++){let a=0,C=0;for(let E=0;E<s.length-o;E++)a+=s[E]*s[E+o],C+=s[E]*s[E];C>0&&(a=a/Math.sqrt(C),a>l?(u=l,l=a,r=o):a>u&&(u=a))}const f=l-u;if(l>.3&&f>.05&&r>0){const o=Math.min(1,l*f*2);return{frequency:t/r,confidence:o}}return{frequency:0,confidence:0}}function ee(c,t,n){const s=1/t,e=1/(n*2*Math.PI),i=e/(e+s),l=new Float32Array(c.length);l[0]=c[0];for(let r=1;r<c.length;r++)l[r]=i*(l[r-1]+c[r]-c[r-1]);return l}function Vt(c){if(c.length===0)return 0;if(c.length===1)return c[0];const t=[...c].sort((l,r)=>l-r),n=t[Math.floor(t.length/2)],s=c.filter(l=>Math.abs(l-n)/n<.1);if(s.length===0)return n;let e=0,i=0;for(let l=0;l<s.length;l++){const r=l+1;e+=s[l]*r,i+=r}return e/i}function de(c,t,n){let s,e;le(gt,"page"),se(c,gt,d=>n(20,e=d));let{$$slots:i={},$$scope:l}=t;ce("Page",i,[]);let r="random";ht(()=>{e.url.searchParams.has("mode")&&(r=e.url.searchParams.get("mode")||"random")});let u="initial",f=!1,o=!1,a=0,C=0,E="",k=!1,x=0,j=!1,A=[];const B={random:{name:"„É©„É≥„ÉÄ„É†Âü∫Èü≥„É¢„Éº„Éâ",description:"10Á®ÆÈ°û„ÅÆÂü∫Èü≥„Åã„Çâ„É©„É≥„ÉÄ„É†„Å´ÈÅ∏Êäû„Åó„Å¶„Éà„É¨„Éº„Éã„É≥„Ç∞",color:"green",path:"./training/random"},continuous:{name:"ÈÄ£Á∂ö„ÉÅ„É£„É¨„É≥„Ç∏„É¢„Éº„Éâ",description:"ÈÅ∏Êäû„Åó„ÅüÂõûÊï∞„Å†„ÅëÈÄ£Á∂ö„ÅßÂÆüË°å„Åó„ÄÅÁ∑èÂêàË©ï‰æ°„ÇíÁ¢∫Ë™ç",color:"orange",path:"./training/continuous"},chromatic:{name:"12Èü≥Èöé„É¢„Éº„Éâ",description:"„ÇØ„É≠„Éû„ÉÅ„ÉÉ„ÇØ„Çπ„Ç±„Éº„É´„ÅÆ‰∏äË°å„Éª‰∏ãË°å„ÅßÂÆåÂÖ®Âà∂Ë¶á",color:"purple",path:"./training/chromatic"}},D=B[r]||B.random;async function O(){console.log("„Éû„Ç§„ÇØË®±ÂèØ„É™„ÇØ„Ç®„Çπ„ÉàÈñãÂßã"),n(0,u="pending");try{const d=await navigator.mediaDevices.getUserMedia({audio:!0});console.log("„Éû„Ç§„ÇØË®±ÂèØÂèñÂæóÊàêÂäü"),n(0,u="granted"),d.getTracks().forEach(M=>M.stop()),console.log("„Éû„Ç§„ÇØË®±ÂèØÂÆå‰∫Ü - „É¶„Éº„Ç∂„Éº„ÇØ„É™„ÉÉ„ÇØ„ÅßAudioContextÈñãÂßã„ÇíÂæÖÊ©ü")}catch(d){console.error("„Éû„Ç§„ÇØË®±ÂèØ„Ç®„É©„Éº:",d),n(0,u="denied")}}let q=null,V=null,U=null,G=null,W=null;async function P(){var d;if(console.log("startListening ÈñãÂßã, micPermission:",u),u!=="granted"){console.log("„Éû„Ç§„ÇØË®±ÂèØ„Åå„ÅÇ„Çä„Åæ„Åõ„Çì");return}if(!q){console.log("AudioContext„Åå‰ΩúÊàê„Åï„Çå„Å¶„ÅÑ„Åæ„Åõ„Çì"),n(4,j=!0);return}try{console.log("AudioContext state:",q.state),q.state==="suspended"&&(console.log("AudioContext suspended - attempting resume..."),await q.resume(),console.log("AudioContext resumed, new state:",q.state)),console.log("„Éû„Ç§„ÇØ„Ç¢„ÇØ„Çª„ÇπÈñãÂßã...");try{V=await navigator.mediaDevices.getUserMedia({audio:!0}),console.log("Âü∫Êú¨Ë®≠ÂÆö„ÅßMediaStreamÂèñÂæóÊàêÂäü")}catch(J){console.log("Âü∫Êú¨Ë®≠ÂÆöÂ§±Êïó„ÄÅË©≥Á¥∞Ë®≠ÂÆö„ÅßÂÜçË©¶Ë°å...",J),V=await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!1,noiseSuppression:!1,autoGainControl:!1}}),console.log("Ë©≥Á¥∞Ë®≠ÂÆö„ÅßMediaStreamÂèñÂæóÊàêÂäü")}console.log("MediaStreamÂèñÂæóÊàêÂäü:",{tracks:V.getTracks().length,active:V.active,trackState:(d=V.getTracks()[0])==null?void 0:d.readyState}),V.getTracks().forEach((J,Z)=>{console.log(`Track ${Z}:`,{kind:J.kind,label:J.label,enabled:J.enabled,readyState:J.readyState}),J.addEventListener("ended",()=>{console.log("MediaStreamTrack ended - stopping analysis"),I(),n(0,u="error")}),J.addEventListener("mute",()=>{console.log("MediaStreamTrack muted")}),J.addEventListener("unmute",()=>{console.log("MediaStreamTrack unmuted")})}),console.log("„Ç¢„Éä„É©„Ç§„Ç∂„ÉºË®≠ÂÆö‰∏≠..."),U=q.createAnalyser(),U.fftSize=2048,U.smoothingTimeConstant=.8,q.createMediaStreamSource(V).connect(U),console.log("„É°„Éá„Ç£„Ç¢„Çπ„Éà„É™„Éº„É†„ÇΩ„Éº„ÇπÊé•Á∂öÂÆå‰∫Ü");const R=U.frequencyBinCount;G=new Uint8Array(R),console.log("„Éá„Éº„ÇøÈÖçÂàóÊ∫ñÂÇôÂÆå‰∫Ü, bufferLength:",R),n(3,k=!0),console.log("„É™„Ç¢„É´„Çø„Ç§„É†Ëß£ÊûêÈñãÂßã"),F()}catch(M){console.error("„Éû„Ç§„ÇØ„Ç¢„ÇØ„Çª„Çπ„Ç®„É©„Éº:",M),console.error("„Ç®„É©„ÉºË©≥Á¥∞:",{name:M.name,message:M.message,code:M.code}),n(0,u="error"),n(4,j=!0)}}function F(){if(!k||!U){console.log("Ëß£ÊûêÂÅúÊ≠¢: isListening=",k,"analyser=",!!U);return}window.firstAnalysisLogged||(console.log("ÂàùÂõûÈü≥Â£∞Ëß£ÊûêÂÆüË°å‰∏≠..."),window.firstAnalysisLogged=!0),U.getByteFrequencyData(G);let d=0;for(let Z=0;Z<G.length;Z++)d+=G[Z]*G[Z];const M=Math.sqrt(d/G.length);n(5,a=Math.min(100,M/128*100)),window.volumeLogCount||(window.volumeLogCount=0),window.volumeLogCount++,window.volumeLogCount%60===0&&console.log("Èü≥ÈáèÂÄ§:",a.toFixed(1),"RMS:",M.toFixed(3)),a>20&&(f||console.log("Èü≥ÈáèÊ§úÂá∫ÊàêÂäü:",a),n(1,f=!0));const R=new Float32Array(U.fftSize);U.getFloatTimeDomainData(R);const J=At(R,q.sampleRate);if(J.frequency>0){A.push(J.frequency),A.length>Et&&A.shift();const Z=Vt(A);n(6,C=Z),n(7,E=xt(C)),n(8,x=Math.round(J.confidence*100)),C>80&&C<800&&(o||console.log("Âë®Ê≥¢Êï∞Ê§úÂá∫ÊàêÂäü:",C,"Hz",E),n(2,o=!0))}else A=[],n(6,C=0),n(7,E=""),n(8,x=0);W=requestAnimationFrame(F)}function I(){n(3,k=!1),W&&(cancelAnimationFrame(W),W=null),V&&(V.getTracks().forEach(d=>d.stop()),V=null),q&&q.state!=="closed"&&(q.close(),q=null),U=null,G=null}St(()=>{I()});async function S(){if(console.log("„É¶„Éº„Ç∂„Éº„ÇØ„É™„ÉÉ„ÇØ„ÅßAudioContextÈñãÂßã..."),u!=="granted"){console.log("„Éû„Ç§„ÇØË®±ÂèØ„ÅåÂøÖË¶Å„Åß„Åô");return}try{q=new(window.AudioContext||window.webkitAudioContext),console.log("AudioContext‰ΩúÊàêÂÆå‰∫Ü, state:",q.state),n(4,j=!1),await P()}catch(d){console.error("AudioContextÈñãÂßãÂ§±Êïó:",d),n(4,j=!0)}}ht(()=>{console.log("„Éö„Éº„Ç∏Ë™≠„ÅøËæº„ÅøÂÆå‰∫Ü - „É¶„Éº„Ç∂„ÉºÊìç‰Ωú„ÇíÂæÖÊ©ü‰∏≠"),console.log("ÂàùÊúüÁä∂ÊÖã - micPermission:",u,"isListening:",k,"audioContextBlocked:",j)});const et=[];return Object.keys(t).forEach(d=>{!~et.indexOf(d)&&d.slice(0,2)!=="$$"&&d!=="slot"&&fe.warn(`<Page> was created with unknown prop '${d}'`)}),c.$capture_state=()=>({onMount:ht,onDestroy:St,page:gt,Card:yt,Button:wt,PageLayout:Pt,VolumeBar:Ft,PitchDisplay:ue,mode:r,micPermission:u,volumeDetected:f,frequencyDetected:o,currentVolume:a,currentFrequency:C,currentNote:E,isListening:k,detectionConfidence:x,audioContextBlocked:j,frequencyHistory:A,HISTORY_SIZE:Et,trainingModes:B,selectedMode:D,frequencyToNote:xt,requestMicrophone:O,audioContext:q,mediaStream:V,analyser:U,dataArray:G,animationFrame:W,startListening:P,analyzeAudio:F,detectPitchWithAutocorrelation:At,applyHighPassFilter:ee,smoothFrequency:Vt,stopListening:I,startAudioContextManually:S,startButtonEnabled:s,$page:e}),c.$inject_state=d=>{"mode"in d&&(r=d.mode),"micPermission"in d&&n(0,u=d.micPermission),"volumeDetected"in d&&n(1,f=d.volumeDetected),"frequencyDetected"in d&&n(2,o=d.frequencyDetected),"currentVolume"in d&&n(5,a=d.currentVolume),"currentFrequency"in d&&n(6,C=d.currentFrequency),"currentNote"in d&&n(7,E=d.currentNote),"isListening"in d&&n(3,k=d.isListening),"detectionConfidence"in d&&n(8,x=d.detectionConfidence),"audioContextBlocked"in d&&n(4,j=d.audioContextBlocked),"frequencyHistory"in d&&(A=d.frequencyHistory),"audioContext"in d&&(q=d.audioContext),"mediaStream"in d&&(V=d.mediaStream),"analyser"in d&&(U=d.analyser),"dataArray"in d&&(G=d.dataArray),"animationFrame"in d&&(W=d.animationFrame),"startButtonEnabled"in d&&n(9,s=d.startButtonEnabled)},t&&"$$inject"in t&&c.$inject_state(t.$$inject),c.$$.update=()=>{c.$$.dirty&25&&console.log("Áä∂ÊÖãÂ§âÊõ¥ - micPermission:",u,"isListening:",k,"audioContextBlocked:",j),c.$$.dirty&7&&n(9,s=u==="granted"&&f&&o)},[u,f,o,k,j,a,C,E,x,s,D,O,S]}class pe extends ne{constructor(t){super(t),oe(this,t,de,qt,ie,{}),L("SvelteRegisterComponent",{component:this,tagName:"Page",options:t,id:qt.name})}}export{pe as component};
