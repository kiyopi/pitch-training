import{S as Ce,i as De,s as Ee,n as ve,d as h,K as L,y as _,b as q,c as i,e as m,f as C,h as w,j as g,k as V,I as Fe,Q as je,a as U,z as de,G as J,g as y,t as N,C as le,m as X,o as Y,D as ne,H as Ge,E as ae,F as re,J as Re,p as Ue,q as We,L as Le,r as $e}from"../chunks/Dh4MrDnZ.js";import{e as ge}from"../chunks/D6YF6ztN.js";import"../chunks/IHki7fMi.js";import{P as Je,C as ue}from"../chunks/BIrZeKHn.js";import{B as ze}from"../chunks/CyYDdAyA.js";const Ke=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function Qe(l){let e,t,o,a,s,n;return{c(){e=g("div"),t=g("div"),o=g("div"),a=V(),s=g("div"),this.h()},l(r){e=m(r,"DIV",{class:!0});var f=C(e);t=m(f,"DIV",{class:!0,style:!0});var b=C(t);o=m(b,"DIV",{class:!0,style:!0}),C(o).forEach(h),b.forEach(h),a=w(f),s=m(f,"DIV",{class:!0,style:!0}),C(s).forEach(h),f.forEach(h),this.h()},h(){_(o,"class","volume-bar-fill"),L(o,"position","absolute"),L(o,"top","0"),L(o,"left","0"),L(o,"height","100%"),_(t,"class","volume-bar-bg"),L(t,"height",l[1]),L(t,"border-radius","9999px"),L(t,"background-color","#e2e8f0"),L(t,"position","relative"),L(t,"overflow","hidden"),_(s,"class","threshold-indicator svelte-13z7ppf"),L(s,"position","absolute"),L(s,"top","0"),L(s,"left",l[0]+"%"),L(s,"width","2px"),L(s,"height",l[1]),L(s,"background-color","#64748b"),L(s,"border-radius","1px"),_(e,"class",n="volume-bar-container "+l[2]+" svelte-13z7ppf")},m(r,f){q(r,e,f),i(e,t),i(t,o),l[5](o),i(e,a),i(e,s)},p(r,[f]){f&2&&L(t,"height",r[1]),f&1&&L(s,"left",r[0]+"%"),f&2&&L(s,"height",r[1]),f&4&&n!==(n="volume-bar-container "+r[2]+" svelte-13z7ppf")&&_(e,"class",n)},i:ve,o:ve,d(r){r&&h(e),l[5](null)}}}function Oe(l,e,t){let{volume:o=0}=e,{threshold:a=30}=e,{height:s="12px"}=e,{className:n=""}=e,r;function f(c){return c<a?"#94a3b8":c<60?"#10b981":c<80?"#f59e0b":"#ef4444"}function b(c){if(r){const u=Math.max(0,Math.min(100,c)),p=f(u);(!window.volumeBarLastUpdate||Math.abs(window.volumeBarLastUpdate-u)>10)&&(console.log("VolumeBar更新:",u.toFixed(1),"%","color:",p),window.volumeBarLastUpdate=u),t(3,r.style.width=`${u}%`,r),t(3,r.style.backgroundColor=p,r)}}Fe(()=>{r&&(t(3,r.style.width="0%",r),t(3,r.style.backgroundColor="#94a3b8",r),t(3,r.style.height=s,r),t(3,r.style.borderRadius="9999px",r),t(3,r.style.transition="all 0.1s ease-out",r))});function d(c){je[c?"unshift":"push"](()=>{r=c,t(3,r)})}return l.$$set=c=>{"volume"in c&&t(4,o=c.volume),"threshold"in c&&t(0,a=c.threshold),"height"in c&&t(1,s=c.height),"className"in c&&t(2,n=c.className)},l.$$.update=()=>{l.$$.dirty&16&&b(o)},[a,s,n,r,o,d]}class Xe extends Ce{constructor(e){super(),De(this,e,Oe,Qe,Ee,{volume:4,threshold:0,height:1,className:2})}}function ke(l){let e,t,o="精度",a,s,n,r,f,b,d,c=ye(l[3])+"",u,p,v,z=l[3]>0?"+":"",D,H=l[3].toFixed(1)+"",T,B;return{c(){e=g("div"),t=g("div"),t.textContent=o,a=V(),s=g("div"),n=g("div"),r=V(),f=g("div"),b=V(),d=g("div"),u=N(c),p=V(),v=g("div"),D=N(z),T=N(H),B=N("%"),this.h()},l($){e=m($,"DIV",{class:!0});var E=C(e);t=m(E,"DIV",{class:!0,"data-svelte-h":!0}),J(t)!=="svelte-4oi8f7"&&(t.textContent=o),a=w(E),s=m(E,"DIV",{class:!0});var A=C(s);n=m(A,"DIV",{class:!0,style:!0}),C(n).forEach(h),r=w(A),f=m(A,"DIV",{class:!0}),C(f).forEach(h),A.forEach(h),b=w(E),d=m(E,"DIV",{class:!0,style:!0});var P=C(d);u=y(P,c),P.forEach(h),p=w(E),v=m(E,"DIV",{class:!0});var k=C(v);D=y(k,z),T=y(k,H),B=y(k,"%"),k.forEach(h),E.forEach(h),this.h()},h(){_(t,"class","label svelte-17lpbmi"),_(n,"class","accuracy-bar svelte-17lpbmi"),L(n,"background-color",me(l[3])),L(n,"width",Math.abs(l[3])+"%"),_(f,"class","accuracy-center svelte-17lpbmi"),_(s,"class","accuracy-bar-container svelte-17lpbmi"),_(d,"class","accuracy-text svelte-17lpbmi"),L(d,"color",me(l[3])),_(v,"class","accuracy-value svelte-17lpbmi"),_(e,"class","accuracy-display svelte-17lpbmi")},m($,E){q($,e,E),i(e,t),i(e,a),i(e,s),i(s,n),i(s,r),i(s,f),i(e,b),i(e,d),i(d,u),i(e,p),i(e,v),i(v,D),i(v,T),i(v,B)},p($,E){E&8&&L(n,"background-color",me($[3])),E&8&&L(n,"width",Math.abs($[3])+"%"),E&8&&c!==(c=ye($[3])+"")&&U(u,c),E&8&&L(d,"color",me($[3])),E&8&&z!==(z=$[3]>0?"+":"")&&U(D,z),E&8&&H!==(H=$[3].toFixed(1)+"")&&U(T,H)},d($){$&&h(e)}}}function Ye(l){let e,t,o,a="目標音程",s,n,r=l[6](l[1])+"",f,b,d,c,u="現在の音程",p,v,z=(l[4]&&l[6](l[2])||"---")+"",D,H,T,B,$="周波数",E,A,P=Ne(l[0])+"",k,te,W,S=l[4]&&l[2]&&ke(l);return{c(){e=g("div"),t=g("div"),o=g("div"),o.textContent=a,s=V(),n=g("div"),f=N(r),b=V(),d=g("div"),c=g("div"),c.textContent=u,p=V(),v=g("div"),D=N(z),H=V(),T=g("div"),B=g("div"),B.textContent=$,E=V(),A=g("div"),k=N(P),te=V(),S&&S.c(),this.h()},l(j){e=m(j,"DIV",{class:!0});var G=C(e);t=m(G,"DIV",{class:!0});var Z=C(t);o=m(Z,"DIV",{class:!0,"data-svelte-h":!0}),J(o)!=="svelte-101q5wq"&&(o.textContent=a),s=w(Z),n=m(Z,"DIV",{class:!0});var ce=C(n);f=y(ce,r),ce.forEach(h),Z.forEach(h),b=w(G),d=m(G,"DIV",{class:!0});var K=C(d);c=m(K,"DIV",{class:!0,"data-svelte-h":!0}),J(c)!=="svelte-1p184h3"&&(c.textContent=u),p=w(K),v=m(K,"DIV",{class:!0});var x=C(v);D=y(x,z),x.forEach(h),K.forEach(h),H=w(G),T=m(G,"DIV",{class:!0});var oe=C(T);B=m(oe,"DIV",{class:!0,"data-svelte-h":!0}),J(B)!=="svelte-1iigar3"&&(B.textContent=$),E=w(oe),A=m(oe,"DIV",{class:!0});var se=C(A);k=y(se,P),se.forEach(h),oe.forEach(h),te=w(G),S&&S.l(G),G.forEach(h),this.h()},h(){_(o,"class","label svelte-17lpbmi"),_(n,"class","note-name target svelte-17lpbmi"),_(t,"class","target-note svelte-17lpbmi"),_(c,"class","label svelte-17lpbmi"),_(v,"class","note-name current svelte-17lpbmi"),de(v,"detecting",l[4]),_(d,"class","current-note svelte-17lpbmi"),_(B,"class","label svelte-17lpbmi"),_(A,"class","frequency-value svelte-17lpbmi"),_(T,"class","frequency-display svelte-17lpbmi"),_(e,"class",W="pitch-display "+l[5]+" svelte-17lpbmi")},m(j,G){q(j,e,G),i(e,t),i(t,o),i(t,s),i(t,n),i(n,f),i(e,b),i(e,d),i(d,c),i(d,p),i(d,v),i(v,D),i(e,H),i(e,T),i(T,B),i(T,E),i(T,A),i(A,k),i(e,te),S&&S.m(e,null)},p(j,[G]){G&2&&r!==(r=j[6](j[1])+"")&&U(f,r),G&20&&z!==(z=(j[4]&&j[6](j[2])||"---")+"")&&U(D,z),G&16&&de(v,"detecting",j[4]),G&1&&P!==(P=Ne(j[0])+"")&&U(k,P),j[4]&&j[2]?S?S.p(j,G):(S=ke(j),S.c(),S.m(e,null)):S&&(S.d(1),S=null),G&32&&W!==(W="pitch-display "+j[5]+" svelte-17lpbmi")&&_(e,"class",W)},i:ve,o:ve,d(j){j&&h(e),S&&S.d()}}}function me(l){const e=Math.abs(l);return e<=10?"#10b981":e<=25?"#f59e0b":"#ef4444"}function ye(l){const e=Math.abs(l);return e<=10?"素晴らしい！":e<=25?"もう少し！":"調整が必要"}function Ne(l){return l>0?`${l.toFixed(1)} Hz`:"--.- Hz"}function Ze(l,e,t){let{frequency:o=0}=e,{targetNote:a="C"}=e,{currentNote:s=""}=e,{accuracy:n=0}=e,{isDetecting:r=!1}=e,{className:f=""}=e;const b={C:"ド","C#":"ド#",Db:"レ♭",D:"レ","D#":"レ#",Eb:"ミ♭",E:"ミ",F:"ファ","F#":"ファ#",Gb:"ソ♭",G:"ソ","G#":"ソ#",Ab:"ラ♭",A:"ラ","A#":"ラ#",Bb:"シ♭",B:"シ"};function d(c){return b[c]||c}return l.$$set=c=>{"frequency"in c&&t(0,o=c.frequency),"targetNote"in c&&t(1,a=c.targetNote),"currentNote"in c&&t(2,s=c.currentNote),"accuracy"in c&&t(3,n=c.accuracy),"isDetecting"in c&&t(4,r=c.isDetecting),"className"in c&&t(5,f=c.className)},[o,a,s,n,r,f,d]}class xe extends Ce{constructor(e){super(),De(this,e,Ze,Ye,Ee,{frequency:0,targetNote:1,currentNote:2,accuracy:3,isDetecting:4,className:5})}}const{document:Te}=Ke;function Me(l,e,t){const o=l.slice();return o[33]=e[t],o[35]=t,o}function Pe(l,e,t){const o=l.slice();return o[33]=e[t],o[35]=t,o}function et(l){let e,t,o;return t=new ue({props:{variant:"default",padding:"lg",$$slots:{default:[rt]},$$scope:{ctx:l}}}),{c(){e=g("div"),re(t.$$.fragment),this.h()},l(a){e=m(a,"DIV",{class:!0});var s=C(e);ae(t.$$.fragment,s),s.forEach(h),this.h()},h(){_(e,"class","results-screen")},m(a,s){q(a,e,s),ne(t,e,null),o=!0},p(a,s){const n={};s[0]&49159|s[1]&64&&(n.$$scope={dirty:s,ctx:a}),t.$set(n)},i(a){o||(Y(t.$$.fragment,a),o=!0)},o(a){X(t.$$.fragment,a),o=!1},d(a){a&&h(e),le(t)}}}function tt(l){let e,t,o,a,s,n,r,f,b,d,c;return t=new ue({props:{variant:"default",padding:"lg",$$slots:{default:[ot]},$$scope:{ctx:l}}}),n=new ue({props:{variant:"default",padding:"md",$$slots:{default:[it]},$$scope:{ctx:l}}}),f=new ue({props:{variant:"default",padding:"md",$$slots:{default:[ct]},$$scope:{ctx:l}}}),d=new ue({props:{variant:"default",padding:"md",$$slots:{default:[ft]},$$scope:{ctx:l}}}),{c(){e=g("div"),re(t.$$.fragment),o=V(),a=g("div"),s=g("div"),re(n.$$.fragment),r=V(),re(f.$$.fragment),b=V(),re(d.$$.fragment),this.h()},l(u){e=m(u,"DIV",{class:!0});var p=C(e);ae(t.$$.fragment,p),o=w(p),a=m(p,"DIV",{class:!0});var v=C(a);s=m(v,"DIV",{class:!0});var z=C(s);ae(n.$$.fragment,z),r=w(z),ae(f.$$.fragment,z),z.forEach(h),v.forEach(h),b=w(p),ae(d.$$.fragment,p),p.forEach(h),this.h()},h(){_(s,"class","display-grid svelte-f96z79"),_(a,"class","realtime-display svelte-f96z79"),_(e,"class","detection-screen")},m(u,p){q(u,e,p),ne(t,e,null),i(e,o),i(e,a),i(a,s),ne(n,s,null),i(s,r),ne(f,s,null),i(e,b),ne(d,e,null),c=!0},p(u,p){const v={};p[0]&769|p[1]&64&&(v.$$scope={dirty:p,ctx:u}),t.$set(v);const z={};p[0]&2048|p[1]&64&&(z.$$scope={dirty:p,ctx:u}),n.$set(z);const D={};p[0]&12928|p[1]&64&&(D.$$scope={dirty:p,ctx:u}),f.$set(D);const H={};p[0]&516|p[1]&64&&(H.$$scope={dirty:p,ctx:u}),d.$set(H)},i(u){c||(Y(t.$$.fragment,u),Y(n.$$.fragment,u),Y(f.$$.fragment,u),Y(d.$$.fragment,u),c=!0)},o(u){X(t.$$.fragment,u),X(n.$$.fragment,u),X(f.$$.fragment,u),X(d.$$.fragment,u),c=!1},d(u){u&&h(e),le(t),le(n),le(f),le(d)}}}function st(l){let e,t,o;return t=new ue({props:{variant:"success",padding:"lg",$$slots:{default:[ut]},$$scope:{ctx:l}}}),{c(){e=g("div"),re(t.$$.fragment),this.h()},l(a){e=m(a,"DIV",{class:!0});var s=C(e);ae(t.$$.fragment,s),s.forEach(h),this.h()},h(){_(e,"class","playing-screen")},m(a,s){q(a,e,s),ne(t,e,null),o=!0},p(a,s){const n={};s[0]&256|s[1]&64&&(n.$$scope={dirty:s,ctx:a}),t.$set(n)},i(a){o||(Y(t.$$.fragment,a),o=!0)},o(a){X(t.$$.fragment,a),o=!1},d(a){a&&h(e),le(t)}}}function lt(l){let e,t,o;return t=new ue({props:{variant:"default",padding:"lg",$$slots:{default:[pt]},$$scope:{ctx:l}}}),{c(){e=g("div"),re(t.$$.fragment),this.h()},l(a){e=m(a,"DIV",{class:!0});var s=C(e);ae(t.$$.fragment,s),s.forEach(h),this.h()},h(){_(e,"class","start-screen")},m(a,s){q(a,e,s),ne(t,e,null),o=!0},p(a,s){const n={};s[0]&56|s[1]&64&&(n.$$scope={dirty:s,ctx:a}),t.$set(n)},i(a){o||(Y(t.$$.fragment,a),o=!0)},o(a){X(t.$$.fragment,a),o=!1},d(a){a&&h(e),le(t)}}}function He(l){let e,t,o=l[33]+"",a,s,n,r=l[0][l[35]]?"✓":"×",f,b,d;return{c(){e=g("div"),t=g("span"),a=N(o),s=V(),n=g("span"),f=N(r),d=V(),this.h()},l(c){e=m(c,"DIV",{class:!0});var u=C(e);t=m(u,"SPAN",{class:!0});var p=C(t);a=y(p,o),p.forEach(h),s=w(u),n=m(u,"SPAN",{class:!0});var v=C(n);f=y(v,r),v.forEach(h),d=w(u),u.forEach(h),this.h()},h(){_(t,"class","scale-note-name svelte-f96z79"),_(n,"class",b="scale-result-icon "+(l[0][l[35]]?"correct":"incorrect")+" svelte-f96z79"),_(e,"class","scale-result svelte-f96z79")},m(c,u){q(c,e,u),i(e,t),i(t,a),i(e,s),i(e,n),i(n,f),i(e,d)},p(c,u){u[0]&1&&r!==(r=c[0][c[35]]?"✓":"×")&&U(f,r),u[0]&1&&b!==(b="scale-result-icon "+(c[0][c[35]]?"correct":"incorrect")+" svelte-f96z79")&&_(n,"class",b)},d(c){c&&h(e)}}}function nt(l){let e;return{c(){e=N("もう一度チャレンジ")},l(t){e=y(t,"もう一度チャレンジ")},m(t,o){q(t,e,o)},d(t){t&&h(e)}}}function at(l){let e;return{c(){e=N("結果を保存")},l(t){e=y(t,"結果を保存")},m(t,o){q(t,e,o)},d(t){t&&h(e)}}}function rt(l){let e,t,o="トレーニング結果",a,s,n,r,f,b,d,c="点",u,p,v,z,D,H,T,B,$,E,A,P,k,te,W,S,j="音階別結果",G,Z,ce,K,x,oe,se,I,ee=ge(l[16]),R=[];for(let M=0;M<ee.length;M+=1)R[M]=He(Me(l,ee,M));return x=new ze({props:{variant:"success",size:"lg",fullWidth:!0,$$slots:{default:[nt]},$$scope:{ctx:l}}}),x.$on("click",l[19]),se=new ze({props:{variant:"secondary",size:"md",fullWidth:!0,$$slots:{default:[at]},$$scope:{ctx:l}}}),{c(){e=g("div"),t=g("h2"),t.textContent=o,a=V(),s=g("div"),n=g("div"),r=g("span"),f=N(l[1]),b=V(),d=g("span"),d.textContent=c,p=V(),v=g("div"),z=g("h3"),D=N(l[15]),H=V(),T=g("p"),B=N("8音階中 "),$=N(l[2]),E=N("音階 正解"),A=V(),P=g("p"),k=N(l[14]),te=V(),W=g("div"),S=g("h3"),S.textContent=j,G=V(),Z=g("div");for(let M=0;M<R.length;M+=1)R[M].c();ce=V(),K=g("div"),re(x.$$.fragment),oe=V(),re(se.$$.fragment),this.h()},l(M){e=m(M,"DIV",{class:!0});var F=C(e);t=m(F,"H2",{class:!0,"data-svelte-h":!0}),J(t)!=="svelte-1w4iqdy"&&(t.textContent=o),a=w(F),s=m(F,"DIV",{class:!0});var Q=C(s);n=m(Q,"DIV",{class:!0});var fe=C(n);r=m(fe,"SPAN",{class:!0});var O=C(r);f=y(O,l[1]),O.forEach(h),b=w(fe),d=m(fe,"SPAN",{class:!0,"data-svelte-h":!0}),J(d)!=="svelte-yaz7vv"&&(d.textContent=c),fe.forEach(h),p=w(Q),v=m(Q,"DIV",{class:!0});var ie=C(v);z=m(ie,"H3",{class:!0});var we=C(z);D=y(we,l[15]),we.forEach(h),H=w(ie),T=m(ie,"P",{class:!0});var he=C(T);B=y(he,"8音階中 "),$=y(he,l[2]),E=y(he,"音階 正解"),he.forEach(h),A=w(ie),P=m(ie,"P",{class:!0});var Ve=C(P);k=y(Ve,l[14]),Ve.forEach(h),ie.forEach(h),Q.forEach(h),te=w(F),W=m(F,"DIV",{class:!0});var pe=C(W);S=m(pe,"H3",{class:!0,"data-svelte-h":!0}),J(S)!=="svelte-140f1nw"&&(S.textContent=j),G=w(pe),Z=m(pe,"DIV",{class:!0});var Ie=C(Z);for(let be=0;be<R.length;be+=1)R[be].l(Ie);Ie.forEach(h),pe.forEach(h),ce=w(F),K=m(F,"DIV",{class:!0});var _e=C(K);ae(x.$$.fragment,_e),oe=w(_e),ae(se.$$.fragment,_e),_e.forEach(h),F.forEach(h),this.h()},h(){_(t,"class","results-title svelte-f96z79"),_(r,"class","score-value svelte-f96z79"),_(d,"class","score-unit svelte-f96z79"),_(n,"class",u="score-circle "+l[15].toLowerCase()+" svelte-f96z79"),_(z,"class","grade-title svelte-f96z79"),_(T,"class","score-description svelte-f96z79"),_(P,"class","feedback-message svelte-f96z79"),_(v,"class","grade-info svelte-f96z79"),_(s,"class","score-display svelte-f96z79"),_(S,"class","details-title svelte-f96z79"),_(Z,"class","scale-results svelte-f96z79"),_(W,"class","detailed-results"),_(K,"class","action-buttons svelte-f96z79"),_(e,"class","results-content svelte-f96z79")},m(M,F){q(M,e,F),i(e,t),i(e,a),i(e,s),i(s,n),i(n,r),i(r,f),i(n,b),i(n,d),i(s,p),i(s,v),i(v,z),i(z,D),i(v,H),i(v,T),i(T,B),i(T,$),i(T,E),i(v,A),i(v,P),i(P,k),i(e,te),i(e,W),i(W,S),i(W,G),i(W,Z);for(let Q=0;Q<R.length;Q+=1)R[Q]&&R[Q].m(Z,null);i(e,ce),i(e,K),ne(x,K,null),i(K,oe),ne(se,K,null),I=!0},p(M,F){if((!I||F[0]&2)&&U(f,M[1]),(!I||F[0]&32768&&u!==(u="score-circle "+M[15].toLowerCase()+" svelte-f96z79"))&&_(n,"class",u),(!I||F[0]&32768)&&U(D,M[15]),(!I||F[0]&4)&&U($,M[2]),(!I||F[0]&16384)&&U(k,M[14]),F[0]&65537){ee=ge(M[16]);let O;for(O=0;O<ee.length;O+=1){const ie=Me(M,ee,O);R[O]?R[O].p(ie,F):(R[O]=He(ie),R[O].c(),R[O].m(Z,null))}for(;O<R.length;O+=1)R[O].d(1);R.length=ee.length}const Q={};F[1]&64&&(Q.$$scope={dirty:F,ctx:M}),x.$set(Q);const fe={};F[1]&64&&(fe.$$scope={dirty:F,ctx:M}),se.$set(fe)},i(M){I||(Y(x.$$.fragment,M),Y(se.$$.fragment,M),I=!0)},o(M){X(x.$$.fragment,M),X(se.$$.fragment,M),I=!1},d(M){M&&h(e),Le(R,M),le(x),le(se)}}}function qe(l){let e,t=l[0][l[35]]?"✓":"×",o,a;return{c(){e=g("span"),o=N(t),this.h()},l(s){e=m(s,"SPAN",{class:!0});var n=C(e);o=y(n,t),n.forEach(h),this.h()},h(){_(e,"class",a="result-icon "+(l[0][l[35]]?"correct":"incorrect")+" svelte-f96z79")},m(s,n){q(s,e,n),i(e,o)},p(s,n){n[0]&1&&t!==(t=s[0][s[35]]?"✓":"×")&&U(o,t),n[0]&1&&a!==(a="result-icon "+(s[0][s[35]]?"correct":"incorrect")+" svelte-f96z79")&&_(e,"class",a)},d(s){s&&h(e)}}}function Be(l){let e,t,o=l[33]+"",a,s,n,r=l[18](l[8],l[35])+"",f,b,d,c,u=l[0][l[35]]!==void 0&&qe(l);return{c(){e=g("div"),t=g("span"),a=N(o),s=V(),n=g("span"),f=N(r),b=N("Hz"),d=V(),u&&u.c(),c=V(),this.h()},l(p){e=m(p,"DIV",{class:!0});var v=C(e);t=m(v,"SPAN",{class:!0});var z=C(t);a=y(z,o),z.forEach(h),s=w(v),n=m(v,"SPAN",{class:!0});var D=C(n);f=y(D,r),b=y(D,"Hz"),D.forEach(h),d=w(v),u&&u.l(v),c=w(v),v.forEach(h),this.h()},h(){_(t,"class","note-text svelte-f96z79"),_(n,"class","note-frequency svelte-f96z79"),_(e,"class","scale-note svelte-f96z79"),de(e,"active",l[35]===l[9]),de(e,"completed",l[0][l[35]]!==void 0)},m(p,v){q(p,e,v),i(e,t),i(t,a),i(e,s),i(e,n),i(n,f),i(n,b),i(e,d),u&&u.m(e,null),i(e,c)},p(p,v){v[0]&256&&r!==(r=p[18](p[8],p[35])+"")&&U(f,r),p[0][p[35]]!==void 0?u?u.p(p,v):(u=qe(p),u.c(),u.m(e,c)):u&&(u.d(1),u=null),v[0]&512&&de(e,"active",p[35]===p[9]),v[0]&1&&de(e,"completed",p[0][p[35]]!==void 0)},d(p){p&&h(e),u&&u.d()}}}function ot(l){let e,t,o="ドレミファソラシドを歌ってください",a,s,n=ge(l[16]),r=[];for(let f=0;f<n.length;f+=1)r[f]=Be(Pe(l,n,f));return{c(){e=g("div"),t=g("h2"),t.textContent=o,a=V(),s=g("div");for(let f=0;f<r.length;f+=1)r[f].c();this.h()},l(f){e=m(f,"DIV",{class:!0});var b=C(e);t=m(b,"H2",{class:!0,"data-svelte-h":!0}),J(t)!=="svelte-9l8glf"&&(t.textContent=o),a=w(b),s=m(b,"DIV",{class:!0});var d=C(s);for(let c=0;c<r.length;c+=1)r[c].l(d);d.forEach(h),b.forEach(h),this.h()},h(){_(t,"class","guide-title svelte-f96z79"),_(s,"class","scale-guide svelte-f96z79"),_(e,"class","guide-content svelte-f96z79")},m(f,b){q(f,e,b),i(e,t),i(e,a),i(e,s);for(let d=0;d<r.length;d+=1)r[d]&&r[d].m(s,null)},p(f,b){if(b[0]&328449){n=ge(f[16]);let d;for(d=0;d<n.length;d+=1){const c=Pe(f,n,d);r[d]?r[d].p(c,b):(r[d]=Be(c),r[d].c(),r[d].m(s,null))}for(;d<r.length;d+=1)r[d].d(1);r.length=n.length}},d(f){f&&h(e),Le(r,f)}}}function it(l){let e,t,o="音量レベル",a,s,n;return s=new Xe({props:{volume:l[11],height:"20px"}}),{c(){e=g("div"),t=g("h3"),t.textContent=o,a=V(),re(s.$$.fragment),this.h()},l(r){e=m(r,"DIV",{class:!0});var f=C(e);t=m(f,"H3",{class:!0,"data-svelte-h":!0}),J(t)!=="svelte-1nc8gri"&&(t.textContent=o),a=w(f),ae(s.$$.fragment,f),f.forEach(h),this.h()},h(){_(t,"class","display-title svelte-f96z79"),_(e,"class","volume-display")},m(r,f){q(r,e,f),i(e,t),i(e,a),ne(s,e,null),n=!0},p(r,f){const b={};f[0]&2048&&(b.volume=r[11]),s.$set(b)},i(r){n||(Y(s.$$.fragment,r),n=!0)},o(r){X(s.$$.fragment,r),n=!1},d(r){r&&h(e),le(s)}}}function ct(l){let e,t;return e=new xe({props:{frequency:l[12],targetNote:l[16][l[9]],currentNote:l[13],accuracy:0,isDetecting:l[7]}}),{c(){re(e.$$.fragment)},l(o){ae(e.$$.fragment,o)},m(o,a){ne(e,o,a),t=!0},p(o,a){const s={};a[0]&4096&&(s.frequency=o[12]),a[0]&512&&(s.targetNote=o[16][o[9]]),a[0]&8192&&(s.currentNote=o[13]),a[0]&128&&(s.isDetecting=o[7]),e.$set(s)},i(o){t||(Y(e.$$.fragment,o),t=!0)},o(o){X(e.$$.fragment,o),t=!1},d(o){le(e,o)}}}function ft(l){let e,t,o="進行状況",a,s,n,r,f=l[16][l[9]]+"",b,d,c=l[9]+1+"",u,p,v,z,D,H,T,B;return{c(){e=g("div"),t=g("h3"),t.textContent=o,a=V(),s=g("div"),n=g("span"),r=N("現在: "),b=N(f),d=N(" ("),u=N(c),p=N("/8)"),v=V(),z=g("span"),D=N("正解: "),H=N(l[2]),T=N("/"),B=N(l[9]),this.h()},l($){e=m($,"DIV",{class:!0});var E=C(e);t=m(E,"H3",{class:!0,"data-svelte-h":!0}),J(t)!=="svelte-v1qnd4"&&(t.textContent=o),a=w(E),s=m(E,"DIV",{class:!0});var A=C(s);n=m(A,"SPAN",{});var P=C(n);r=y(P,"現在: "),b=y(P,f),d=y(P," ("),u=y(P,c),p=y(P,"/8)"),P.forEach(h),v=w(A),z=m(A,"SPAN",{});var k=C(z);D=y(k,"正解: "),H=y(k,l[2]),T=y(k,"/"),B=y(k,l[9]),k.forEach(h),A.forEach(h),E.forEach(h),this.h()},h(){_(t,"class","progress-title svelte-f96z79"),_(s,"class","progress-details svelte-f96z79"),_(e,"class","progress-info svelte-f96z79")},m($,E){q($,e,E),i(e,t),i(e,a),i(e,s),i(s,n),i(n,r),i(n,b),i(n,d),i(n,u),i(n,p),i(s,v),i(s,z),i(z,D),i(z,H),i(z,T),i(z,B)},p($,E){E[0]&512&&f!==(f=$[16][$[9]]+"")&&U(b,f),E[0]&512&&c!==(c=$[9]+1+"")&&U(u,c),E[0]&4&&U(H,$[2]),E[0]&512&&U(B,$[9])},d($){$&&h(e)}}}function ut(l){let e,t,o='<svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"></circle><polygon points="10,8 16,12 10,16"></polygon></svg>',a,s,n="基音再生中",r,f,b,d,c,u,p,v=l[17](l[8])+"",z,D,H,T,B="この音を覚えて「ド」として認識してください",$,E,A='<div class="progress-bar svelte-f96z79"><div class="progress-fill svelte-f96z79"></div></div>';return{c(){e=g("div"),t=g("div"),t.innerHTML=o,a=V(),s=g("h2"),s.textContent=n,r=V(),f=g("p"),b=N("基音: "),d=N(l[8]),c=V(),u=g("p"),p=N("周波数: "),z=N(v),D=N("Hz"),H=V(),T=g("p"),T.textContent=B,$=V(),E=g("div"),E.innerHTML=A,this.h()},l(P){e=m(P,"DIV",{class:!0});var k=C(e);t=m(k,"DIV",{class:!0,"data-svelte-h":!0}),J(t)!=="svelte-11l4yoz"&&(t.innerHTML=o),a=w(k),s=m(k,"H2",{class:!0,"data-svelte-h":!0}),J(s)!=="svelte-1maueo6"&&(s.textContent=n),r=w(k),f=m(k,"P",{class:!0});var te=C(f);b=y(te,"基音: "),d=y(te,l[8]),te.forEach(h),c=w(k),u=m(k,"P",{class:!0});var W=C(u);p=y(W,"周波数: "),z=y(W,v),D=y(W,"Hz"),W.forEach(h),H=w(k),T=m(k,"P",{class:!0,"data-svelte-h":!0}),J(T)!=="svelte-1hcrx2z"&&(T.textContent=B),$=w(k),E=m(k,"DIV",{class:!0,"data-svelte-h":!0}),J(E)!=="svelte-4yu433"&&(E.innerHTML=A),k.forEach(h),this.h()},h(){_(t,"class","playing-icon svelte-f96z79"),_(s,"class","playing-title svelte-f96z79"),_(f,"class","playing-note svelte-f96z79"),_(u,"class","playing-frequency svelte-f96z79"),_(T,"class","playing-instruction svelte-f96z79"),_(E,"class","playing-progress svelte-f96z79"),_(e,"class","playing-content svelte-f96z79")},m(P,k){q(P,e,k),i(e,t),i(e,a),i(e,s),i(e,r),i(e,f),i(f,b),i(f,d),i(e,c),i(e,u),i(u,p),i(u,z),i(u,D),i(e,H),i(e,T),i(e,$),i(e,E)},p(P,k){k[0]&256&&U(d,P[8]),k[0]&256&&v!==(v=P[17](P[8])+"")&&U(z,v)},d(P){P&&h(e)}}}function dt(l){let e;return{c(){e=N("トレーニング開始")},l(t){e=y(t,"トレーニング開始")},m(t,o){q(t,e,o)},p:ve,d(t){t&&h(e)}}}function vt(l){let e;return{c(){e=N(l[5])},l(t){e=y(t,l[5])},m(t,o){q(t,e,o)},p(t,o){o[0]&32&&U(e,t[5])},d(t){t&&h(e)}}}function ht(l){let e;function t(s,n){return s[3]?dt:vt}let o=t(l),a=o(l);return{c(){a.c(),e=$e()},l(s){a.l(s),e=$e()},m(s,n){a.m(s,n),q(s,e,n)},p(s,n){o===(o=t(s))&&a?a.p(s,n):(a.d(1),a=o(s),a&&(a.c(),a.m(e.parentNode,e)))},d(s){s&&h(e),a.d(s)}}}function Ae(l){let e,t,o,a,s=l[4]&&Se(l);return{c(){e=g("div"),t=g("p"),o=N(l[5]),a=V(),s&&s.c(),this.h()},l(n){e=m(n,"DIV",{class:!0});var r=C(e);t=m(r,"P",{class:!0});var f=C(t);o=y(f,l[5]),f.forEach(h),a=w(r),s&&s.l(r),r.forEach(h),this.h()},h(){_(t,"class","loading-message svelte-f96z79"),_(e,"class","loading-info svelte-f96z79")},m(n,r){q(n,e,r),i(e,t),i(t,o),i(e,a),s&&s.m(e,null)},p(n,r){r[0]&32&&U(o,n[5]),n[4]?s?s.p(n,r):(s=Se(n),s.c(),s.m(e,null)):s&&(s.d(1),s=null)},d(n){n&&h(e),s&&s.d()}}}function Se(l){let e,t,o,a,s,n="ページを再読み込みしてみてください";return{c(){e=g("p"),t=N("❌ "),o=N(l[4]),a=V(),s=g("p"),s.textContent=n,this.h()},l(r){e=m(r,"P",{class:!0});var f=C(e);t=y(f,"❌ "),o=y(f,l[4]),f.forEach(h),a=w(r),s=m(r,"P",{class:!0,"data-svelte-h":!0}),J(s)!=="svelte-9ee3kx"&&(s.textContent=n),this.h()},h(){_(e,"class","error-message svelte-f96z79"),_(s,"class","retry-message svelte-f96z79")},m(r,f){q(r,e,f),i(e,t),i(e,o),q(r,a,f),q(r,s,f)},p(r,f){f[0]&16&&U(o,r[4])},d(r){r&&(h(e),h(a),h(s))}}}function pt(l){let e,t,o="トレーニング開始",a,s,n=`基音を聞いた後、その音を「ド」として<br/>
              ドレミファソラシドを連続して歌ってください`,r,f,b='<div class="instruction-item svelte-f96z79"><span class="step-number svelte-f96z79">1</span> <div><h3 class="svelte-f96z79">基音を聞く</h3> <p class="svelte-f96z79">ランダムに選ばれた基音をピアノで再生します</p></div></div> <div class="instruction-item svelte-f96z79"><span class="step-number svelte-f96z79">2</span> <div><h3 class="svelte-f96z79">連続歌唱</h3> <p class="svelte-f96z79">基音を「ド」として、ドレミファソラシドを連続して歌います</p></div></div> <div class="instruction-item svelte-f96z79"><span class="step-number svelte-f96z79">3</span> <div><h3 class="svelte-f96z79">自動判定</h3> <p class="svelte-f96z79">歌唱中にリアルタイムで各音階を自動判定します</p></div></div>',d,c,u,p;c=new ze({props:{variant:"success",size:"lg",fullWidth:!0,disabled:!l[3],$$slots:{default:[ht]},$$scope:{ctx:l}}}),c.$on("click",l[19]);let v=!l[3]&&Ae(l);return{c(){e=g("div"),t=g("h2"),t.textContent=o,a=V(),s=g("p"),s.innerHTML=n,r=V(),f=g("div"),f.innerHTML=b,d=V(),re(c.$$.fragment),u=V(),v&&v.c(),this.h()},l(z){e=m(z,"DIV",{class:!0});var D=C(e);t=m(D,"H2",{class:!0,"data-svelte-h":!0}),J(t)!=="svelte-177yn6"&&(t.textContent=o),a=w(D),s=m(D,"P",{class:!0,"data-svelte-h":!0}),J(s)!=="svelte-c83iab"&&(s.innerHTML=n),r=w(D),f=m(D,"DIV",{class:!0,"data-svelte-h":!0}),J(f)!=="svelte-u1n8ly"&&(f.innerHTML=b),d=w(D),ae(c.$$.fragment,D),u=w(D),v&&v.l(D),D.forEach(h),this.h()},h(){_(t,"class","start-title svelte-f96z79"),_(s,"class","start-description svelte-f96z79"),_(f,"class","instructions svelte-f96z79"),_(e,"class","start-content svelte-f96z79")},m(z,D){q(z,e,D),i(e,t),i(e,a),i(e,s),i(e,r),i(e,f),i(e,d),ne(c,e,null),i(e,u),v&&v.m(e,null),p=!0},p(z,D){const H={};D[0]&8&&(H.disabled=!z[3]),D[0]&40|D[1]&64&&(H.$$scope={dirty:D,ctx:z}),c.$set(H),z[3]?v&&(v.d(1),v=null):v?v.p(z,D):(v=Ae(z),v.c(),v.m(e,null))},i(z){p||(Y(c.$$.fragment,z),p=!0)},o(z){X(c.$$.fragment,z),p=!1},d(z){z&&h(e),le(c),v&&v.d()}}}function _t(l){let e,t,o='<div class="mode-header svelte-f96z79"><div class="mode-icon svelte-f96z79"><svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 18V5l12-2v13"></path><circle cx="6" cy="18" r="3"></circle><circle cx="18" cy="16" r="3"></circle></svg></div> <div><h1 class="mode-title svelte-f96z79">ランダム基音モード</h1> <p class="mode-description svelte-f96z79">10種類の基音からランダムに選択してトレーニング</p></div></div>',a,s,n,r;const f=[lt,st,tt,et],b=[];function d(c,u){return!c[6]&&!c[7]&&!c[10]?0:c[6]?1:c[7]?2:c[10]?3:-1}return~(s=d(l))&&(n=b[s]=f[s](l)),{c(){e=g("div"),t=g("div"),t.innerHTML=o,a=V(),n&&n.c(),this.h()},l(c){e=m(c,"DIV",{class:!0});var u=C(e);t=m(u,"DIV",{class:!0,"data-svelte-h":!0}),J(t)!=="svelte-1oabx6r"&&(t.innerHTML=o),a=w(u),n&&n.l(u),u.forEach(h),this.h()},h(){_(t,"class","header svelte-f96z79"),_(e,"class","random-training svelte-f96z79")},m(c,u){q(c,e,u),i(e,t),i(e,a),~s&&b[s].m(e,null),r=!0},p(c,u){let p=s;s=d(c),s===p?~s&&b[s].p(c,u):(n&&(Ue(),X(b[p],1,1,()=>{b[p]=null}),We()),~s?(n=b[s],n?n.p(c,u):(n=b[s]=f[s](c),n.c()),Y(n,1),n.m(e,null)):n=null)},i(c){r||(Y(n),r=!0)},o(c){X(n),r=!1},d(c){c&&h(e),~s&&b[s].d()}}}function mt(l){let e,t,o;return t=new Je({props:{showBackButton:!0,$$slots:{default:[_t]},$$scope:{ctx:l}}}),{c(){e=V(),re(t.$$.fragment),this.h()},l(a){Ge("svelte-1nfe5e4",Te.head).forEach(h),e=w(a),ae(t.$$.fragment,a),this.h()},h(){Te.title="ランダム基音モード - 相対音感トレーニング"},m(a,s){q(a,e,s),ne(t,a,s),o=!0},p(a,s){const n={};s[0]&65535|s[1]&64&&(n.$$scope={dirty:s,ctx:a}),t.$set(n)},i(a){o||(Y(t.$$.fragment,a),o=!0)},o(a){X(t.$$.fragment,a),o=!1},d(a){a&&h(e),le(t,a)}}}function gt(l,e,t){let o,a,s,n,r=null,f=null,b=!1,d=null,c="Tone.js読み込み中...",u=!1,p=!1,v="",z=0,D=[],H=!1,T=0,B=0,$="";const E=["ド","レ","ミ","ファ","ソ","ラ","シ","ド"],A=["Bb3","B3","C4","Db4","D4","Eb4","E4","F4","Gb4","Ab4"],P={Bb3:233.08,B3:246.94,C4:261.63,Db4:277.18,D4:293.66,Eb4:311.13,E4:329.63,F4:349.23,Gb4:369.99,Ab4:415.3},k=[1,9/8,5/4,4/3,3/2,5/3,15/8,2];async function te(){try{if(t(5,c="Tone.js CDN読み込み中..."),console.log("Tone.js初期化開始"),typeof window<"u"&&!window.Tone){const I=document.createElement("script");I.src="https://unpkg.com/tone@14.7.77/build/Tone.js",I.onload=async()=>{console.log("Tone.js CDN読み込み完了"),t(5,c="Tone.js初期化中..."),window.Tone=window.Tone,r=window.Tone,await W()},I.onerror=ee=>{console.error("Tone.js CDN読み込みエラー:",ee),t(4,d="Tone.js CDNの読み込みに失敗しました"),t(5,c="エラー")},document.head.appendChild(I)}else window.Tone?(console.log("Tone.js既に読み込み済み"),r=window.Tone,await W()):(console.log("window未定義"),t(5,c="ブラウザ環境チェック中..."))}catch(I){console.error("Tone.js初期化エラー:",I),t(4,d=`初期化エラー: ${I.message}`),t(5,c="エラー")}}async function W(){try{if(!r){console.error("Tone.js未初期化");return}console.log("サンプラー設定開始"),t(5,c="AudioContext初期化中..."),r.context.state!=="running"&&(console.log("AudioContext開始中..."),await r.start()),t(5,c="ピアノ音源読み込み中..."),console.log("Salamander Grand Piano サンプラー作成中..."),f=new r.Sampler({urls:{C4:"C4.mp3"},baseUrl:"https://tonejs.github.io/audio/salamander/",release:1.5,onload:()=>{t(3,b=!0),t(5,c="読み込み完了"),console.log("✅ Salamander Grand Piano読み込み完了")}}).toDestination(),setTimeout(()=>{b||(console.warn("⚠️ ピアノ音源読み込みタイムアウト"),t(4,d="ピアノ音源の読み込みがタイムアウトしました"),t(5,c="タイムアウト"))},1e4)}catch(I){console.error("サンプラー設定エラー:",I),t(4,d=`サンプラーエラー: ${I.message}`),t(5,c="エラー")}}Fe(()=>{te()}),Re(()=>{f&&f.dispose()});function S(I){return Math.round(P[I]||0)}function j(I,ee){const R=P[I];return R?Math.round(R*k[ee]):0}function G(){const I=Math.floor(Math.random()*A.length);return t(8,v=A[I]),v}function Z(){t(9,z=0),t(0,D=[]),t(10,H=!1);const I=G();ce(I)}async function ce(I){t(6,u=!0),console.log(`基音再生: ${I}`);try{if(!b||!f){console.warn("Tone.js または Sampler が未初期化"),setTimeout(()=>{t(6,u=!1),K()},2500);return}r.context.state!=="running"&&await r.start(),f.triggerAttackRelease(I,"2.5"),console.log(`Salamander Grand Piano で ${I} 再生開始`),setTimeout(()=>{t(6,u=!1),K()},2500)}catch(ee){console.error("基音再生エラー:",ee),setTimeout(()=>{t(6,u=!1),K()},2500)}}function K(){t(7,p=!0);const I=E.map((R,M)=>j(v,M)),ee=setInterval(()=>{if(!p){clearInterval(ee);return}t(11,T=40+Math.random()*50);const R=I[z],M=(Math.random()-.5)*40;t(12,B=R+M);const F=Math.max(0,100-Math.abs(M)*2);if(t(13,$=E[z]),Math.random()>.6){const Q=F>70;t(0,D[z]=Q,D),t(9,z++,z),console.log(`${$}: ${F.toFixed(1)}% 精度, ${Q?"正解":"不正解"}`),z>=8&&x()}},300)}function x(){t(7,p=!1),t(10,H=!0)}function oe(I){return I>=90?"Excellent":I>=70?"Good":I>=50?"Practice":"Needs Work"}function se(I){return I>=90?"素晴らしい相対音感です！完璧な演奏でした。":I>=70?"良好な相対音感です。もう少し練習すれば完璧になります。":I>=50?"基本的な相対音感は身についています。継続練習で向上できます。":"相対音感の基礎練習から始めましょう。毎日少しずつ練習することが大切です。"}return l.$$.update=()=>{l.$$.dirty[0]&1&&t(2,o=D.filter(I=>I).length),l.$$.dirty[0]&4&&t(1,a=Math.round(o/8*100)),l.$$.dirty[0]&2&&t(15,s=oe(a)),l.$$.dirty[0]&2&&t(14,n=se(a))},[D,a,o,b,d,c,u,p,v,z,H,T,B,$,n,s,E,S,j,Z]}class wt extends Ce{constructor(e){super(),De(this,e,gt,mt,Ee,{},null,[-1,-1])}}export{wt as component};
