# マイクテストページ設計仕様書

## 📋 概要

マイクテストページは単なるマイク許可取得ではなく、**ユーザーのトレーニング成功率を向上させるための重要な準備段階**として設計されています。

## 🎯 設計思想

### 核心概念
**「トレーニング準備最適化」** - ユーザーが本番でスムーズに音程検出できるよう事前準備を行う

## 🎤 主要機能

### 1. 音量・周波数感覚習得
- **目的**: ユーザーが「どれくらいの声の大きさで、どれくらいの周波数が検出されるか」を事前確認
- **効果**: トレーニング本番でのスムーズな音程検出を実現
- **実装**: リアルタイム周波数表示による発声レベル確認

### 2. 個人音域測定（将来実装予定）
- **目的**: 12音モード用の最適開始キー決定
- **効果**: ユーザーの音域に合わせたパーソナライズされたトレーニング
- **実装予定**: ユーザーの発声可能音域の自動測定機能

### 3. モード別準備最適化
- **ランダムモード**: 基本的な発声確認・音程検出システムとの相性確認
- **連続モード**: **特に重要** - 感覚習得後に最初の1フェーズを安定して実行可能
- **12音モード**: 個人音域に基づく最適設定の決定

## 🚦 ダイレクトアクセス時の対応方針

### パターンA: マイクテストページ経由（推奨）
```
直接URL → マイク許可確認画面 → [マイクテストページへ移動] 
→ マイクテストページ完了 → トレーニング開始
```
- **利点**: 完全な準備によるトレーニング成功率向上
- **対象**: すべてのユーザー（特に初回利用者）

### パターンB: 直接マイク許可（非推奨）
```
直接URL → マイク許可確認画面 → [直接マイク許可を取得] 
→ マイク許可 → トレーニング開始
```
- **位置づけ**: 緊急避難的選択肢
- **問題**: 準備不足によるトレーニング失敗率の増加
- **使用場面**: 既に十分な経験があるユーザーの時短要求時のみ

## 📊 設計根拠

### トレーニング成功率への影響
1. **音量感覚なし**: 音程検出失敗 → フラストレーション → 離脱
2. **周波数感覚なし**: 適切な発声ができない → 誤検出 → 学習効果低下
3. **準備完了**: スムーズな音程検出 → 集中してトレーニング → 学習効果向上

### UX設計の考慮
- **初回ユーザー**: 必須の準備段階として位置づけ
- **リピーター**: 感覚の再確認・リフレッシュとして有効
- **上級ユーザー**: 緊急避難的な直接開始も選択可能

## 🔧 技術実装

### localStorage連携
```javascript
// マイクテスト完了時
localStorage.setItem('mic-test-completed', 'true');
```
- **意味**: 単なるマイク許可ではなく「トレーニング準備完了」の証明
- **効果**: 2回目以降のダイレクトアクセス時にスムーズな開始が可能

### 状態管理
- マイク許可状態
- 音量・周波数感覚習得状態
- 個人音域測定結果（将来）
- モード別準備完了状態

## 📈 将来拡張

### 12音モード対応
- 個人音域の自動測定
- 最適開始キーの提案
- 音域に応じたトレーニング難易度調整

### 学習分析
- 過去の準備データ蓄積
- 個人の傾向分析
- パーソナライズされた準備提案

## ⚠️ 重要な留意点

1. **パターンBは最小限に**: 準備不足によるトレーニング品質低下を防ぐ
2. **マイクテストの価値訴求**: 単なる手間ではなく価値ある準備段階として認識促進
3. **継続的改善**: ユーザーフィードバックに基づく準備機能の向上

---

**この仕様書は、マイクテストページの設計・実装・改善時の必須参照文書です。**