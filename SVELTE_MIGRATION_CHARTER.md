# 相対音感トレーニングアプリ - Svelte移行プロジェクト憲章

作成日: 2025-01-25  
最終更新: 2025-01-25  
ステータス: **検討中**

## 🎯 プロジェクトの絶対的な目的（変更不可）

### **アプリケーションの目的**
**ユーザーの相対音感（音程の相対的な関係を聞き分ける能力）を効果的に鍛えるWebアプリケーション**

### **核心価値**
1. **高精度な音程検出**: Pitchy (McLeod Method) による±5セントの精度
2. **リアルタイム処理**: 遅延のない即座のフィードバック
3. **モバイル対応**: 特にiPhone Safariでの完全動作
4. **直感的なUI**: 音感練習に集中できるシンプルなインターフェース

## 🔒 絶対に守るべき要求事項

### **技術的要求**
1. **音程検出**: Pitchy ライブラリの使用（変更不可）
2. **音源**: Tone.js + Salamander Grand Piano（変更不可）
3. **リアルタイム性**: 60fps維持（必須）
4. **精度**: 音程検出精度95%以上（必須）

### **機能要求**
1. **3つのトレーニングモード**
   - ランダム基音モード（10種類の基音）
   - 連続チャレンジモード
   - 12音階モード
2. **マイクテスト機能**: 音声入力の信頼性確保
3. **視覚的フィードバック**: リアルタイム音程表示

## 🚫 絶対にやってはいけないこと

1. **音響処理をフレームワークに依存させる**
   - Virtual DOMによる遅延は許容不可
   - 音響処理の抽象化は禁止

2. **複雑な状態管理システムの導入**
   - Redux、MobX等の重い状態管理は禁止
   - シンプルさを維持

3. **仕様書を無視した独自実装**
   - デザインシステムからの逸脱
   - 音響処理仕様の変更

4. **パフォーマンスを犠牲にする選択**
   - 重いアニメーションライブラリ
   - 過度な抽象化

## ✅ Svelte移行の判断基準

### **移行GO条件（すべて満たす必要）**
- [ ] 音量バー更新が60fps維持
- [ ] バンドルサイズ50%以上削減
- [ ] 開発速度の向上を実感
- [ ] スタイリング問題の解決
- [ ] 音響処理との自然な統合

### **移行NO-GO条件（1つでも該当したら中止）**
- [ ] パフォーマンスがNext.js版を下回る
- [ ] 開発の複雑性が増加
- [ ] 必要な機能が実装不可能
- [ ] 2025-02-10までに検証未完了

## 📅 マイルストーン

1. **Phase 1: プロトタイプ検証**（2025-01-25 〜 2025-02-01）
   - マイクテストページのSvelte実装
   - パフォーマンス測定

2. **Phase 2: 判断**（2025-02-01 〜 2025-02-03）
   - GO/NO-GO判断
   - 移行計画確定 or 中止

3. **Phase 3: 本格移行**（GO判断の場合のみ）
   - 全ページ移行
   - テスト・最適化

## 🎨 デザイン原則（不変）

1. **シンプル**: 音感練習に集中できるUI
2. **一貫性**: 全ページで統一されたUX
3. **レスポンシブ**: モバイルファースト設計
4. **高速**: 即座の反応とフィードバック

## 📋 成功の定義

1. **技術的成功**
   - すべての機能が正常動作
   - パフォーマンス基準を満たす
   - コードの保守性向上

2. **ユーザー体験の成功**
   - より快適な練習体験
   - 安定した動作
   - 直感的な操作

## ⚠️ リスクと対策

### **技術的リスク**
- **リスク**: Svelteエコシステムの未成熟
- **対策**: 必要機能の事前検証、代替案準備

### **スケジュールリスク**
- **リスク**: 移行期間の長期化
- **対策**: 明確な判断基準と期限設定

### **品質リスク**
- **リスク**: 移行による不具合発生
- **対策**: 段階的移行、十分なテスト

---

**この憲章は、プロジェクトの方向性を定める最上位文書です。**  
**すべての決定は、この憲章に記載された目的と原則に従って行われます。**